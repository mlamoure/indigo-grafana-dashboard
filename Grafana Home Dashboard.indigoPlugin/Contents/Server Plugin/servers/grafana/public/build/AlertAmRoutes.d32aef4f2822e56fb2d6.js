"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[8648],{"./public/app/core/hooks/useCleanup.ts":(e,t,a)=>{a.d(t,{x:()=>l});var n=a("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),r=a("./.yarn/__virtual__/react-redux-virtual-7ad20a440e/3/opt/drone/yarncache/react-redux-npm-7.2.6-134f5ed64d-0bf142ce0d.zip/node_modules/react-redux/es/index.js"),i=a("./public/app/core/actions/cleanUp.ts");function l(e){const t=(0,r.useDispatch)(),a=(0,n.useRef)(e);a.current=e,(0,n.useEffect)((()=>()=>{t((0,i.e)({stateSelector:a.current}))}),[t])}},"./public/app/features/alerting/unified/AmRoutes.tsx":(e,t,a)=>{a.r(t),a.d(t,{default:()=>Je});var n=a("./.yarn/__virtual__/@emotion-css-virtual-72c314ddb1/3/opt/drone/yarncache/@emotion-css-npm-11.7.1-25ff8755a7-ac1f56656f.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),r=a("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),i=a("./.yarn/__virtual__/react-redux-virtual-7ad20a440e/3/opt/drone/yarncache/react-redux-npm-7.2.6-134f5ed64d-0bf142ce0d.zip/node_modules/react-redux/es/index.js"),l=a("./packages/grafana-ui/src/index.ts"),s=a("./public/app/core/hooks/useCleanup.ts"),o=a("./public/app/features/alerting/unified/components/AlertManagerPicker.tsx"),c=a("./public/app/features/alerting/unified/components/AlertingPageWrapper.tsx"),u=a("./public/app/features/alerting/unified/components/NoAlertManagerWarning.tsx"),d=a("./public/app/features/alerting/unified/components/Authorize.tsx"),p=a("./public/app/features/alerting/unified/utils/access-control.ts"),m=a("./public/app/features/alerting/unified/utils/datasource.ts"),g=a("../../opt/drone/yarncache/lodash-npm-4.17.21-6382451519-eb835a2e51.zip/node_modules/lodash/lodash.js"),h=a("./public/app/plugins/datasource/alertmanager/types.ts"),v=a("./public/app/features/alerting/unified/utils/alertmanager.ts"),x=a("./public/app/features/alerting/unified/utils/time.ts");const f=["",""],j=(e,t)=>Object.entries(null!=e?e:{}).reduce(((e,a)=>{let[n,r]=a;return[...e,{name:n,value:r,operator:t?h._M.regex:h._M.equal}]}),[]),b=(e,t)=>{if(!e)return null!=t?t:f;const[a,n]=e?(0,x.bG)(e):[void 0,void 0],r=x.qr.find((e=>e.value===n));return a&&r?[String(a),r.value]:f},y=e=>e.value,C={name:"",value:"",operator:h._M.equal},S={id:"",groupBy:[],object_matchers:[],routes:[],continue:!1,receiver:"",overrideTimings:!1,groupWaitValue:"",groupWaitValueType:x.qr[0].value,groupIntervalValue:"",groupIntervalValueType:x.qr[0].value,repeatIntervalValue:"",repeatIntervalValueType:x.qr[0].value,muteTimeIntervals:[]},_=e=>{var t,a,n,r,i,l,s,o,c;if(!e||0===Object.keys(e).length)return[S,{}];const[u,d]=b(e.group_wait,["","s"]),[p,m]=b(e.group_interval,["","m"]),[g,h]=b(e.repeat_interval,["","h"]),x=String(Math.random()),f={[x]:e},y=[];null===(t=e.routes)||void 0===t||t.forEach((e=>{const[t,a]=_(e);y.push(t),Object.assign(f,a)}));return[{id:x,object_matchers:[...e.matchers?null!==(a=null===(n=e.matchers)||void 0===n?void 0:n.map((e=>(0,v.cm)((0,v.tC)(e)))))&&void 0!==a?a:[]:null!==(r=null===(i=e.object_matchers)||void 0===i?void 0:i.map((e=>({name:e[0],operator:e[1],value:e[2]}))))&&void 0!==r?r:[],...j(e.match,!1),...j(e.match_re,!0)],continue:null!==(l=e.continue)&&void 0!==l&&l,receiver:null!==(s=e.receiver)&&void 0!==s?s:"",groupBy:null!==(o=e.group_by)&&void 0!==o?o:[],overrideTimings:[u,p,g].some(Boolean),groupWaitValue:u,groupWaitValueType:d,groupIntervalValue:p,groupIntervalValueType:m,repeatIntervalValue:g,repeatIntervalValueType:h,routes:y,muteTimeIntervals:null!==(c=e.mute_time_intervals)&&void 0!==c?c:[]},f]},N=(e,t,a)=>{const n=a[t.id],{overrideTimings:r,groupWaitValue:i,groupWaitValueType:l,groupIntervalValue:s,groupIntervalValueType:o,repeatIntervalValue:c,repeatIntervalValueType:u}=t,d=r&&i?`${i}${l}`:void 0,p=r&&s?`${s}${o}`:void 0,h=r&&c?`${c}${u}`:void 0,v=Object.assign({},null!=n?n:{},{continue:t.continue,group_by:t.groupBy,object_matchers:t.object_matchers.length?t.object_matchers.map((e=>[e.name,e.operator,e.value])):void 0,match:void 0,match_re:void 0,group_wait:d,group_interval:p,repeat_interval:h,routes:t.routes.map((t=>N(e,t,a))),mute_time_intervals:t.muteTimeIntervals});return e!==m.GC?(v.matchers=t.object_matchers.map((e=>{let{name:t,operator:a,value:n}=e;return`${t}${a}${n}`})),v.object_matchers=void 0):v.matchers=void 0,t.receiver&&(v.receiver=t.receiver),(0,g.omitBy)(v,g.isUndefined)},I=e=>({label:e,value:e}),w=e=>(null!=e?e:[]).map(I),M=e=>{var t;return e&&null!==(t=y(e))&&void 0!==t?t:""},V=e=>{return e?(null!=(t=e)?t:[]).map(y):[];var t},k=e=>{if(e)return/^\d+$/.test(e)?void 0:"Must be a positive integer."};var $=a("./public/app/features/alerting/unified/utils/misc.ts");const O=e=>({container:n.css`
      align-items: center;
      display: flex;
      flex-flow: row nowrap;

      & > * + * {
        margin-left: ${e.spacing(1)};
      }
    `,input:n.css`
      flex: 1;
    `,timingContainer:n.css`
      max-width: ${e.spacing(33)};
    `,smallInput:n.css`
      width: ${e.spacing(6.5)};
    `,linkText:n.css`
      text-decoration: underline;
    `,collapse:n.css`
      border: none;
      background: none;
      color: ${e.colors.text.primary};
    `});var T,B,A=a("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const F=["onChange","ref"],q=["onChange","ref"],z=["onChange","ref"],P=["onChange","ref"],G=["onChange","ref"];function W(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}const E=e=>{var t;let{alertManagerSourceName:a,onCancel:i,onSave:s,receivers:o,routes:c}=e;const u=(0,l.useStyles2)(O),[d,p]=(0,r.useState)(!1),[m,g]=(0,r.useState)(w(c.groupBy));return(0,A.jsx)(l.Form,{defaultValues:Object.assign({},c,{overrideTimings:!0}),onSubmit:s,children:e=>{var r,s,c,h;let{control:v,errors:f,setValue:j}=e;return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(l.Field,{label:"Default contact point",invalid:!!f.receiver,error:null===(r=f.receiver)||void 0===r?void 0:r.message,children:(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)("div",{className:u.container,"data-testid":"am-receiver-select",children:[(0,A.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,a=W(e.field,F);return(0,A.jsx)(l.Select,Object.assign({"aria-label":"Default contact point"},a,{className:u.input,onChange:e=>t(M(e)),options:o,menuShouldPortal:!0}))},control:v,name:"receiver",rules:{required:{value:!0,message:"Required."}}}),T||(T=(0,A.jsx)("span",{children:"or"})),(0,A.jsx)(l.Link,{className:u.linkText,href:(0,$.eQ)("/alerting/notifications/receivers/new",a),children:"Create a contact point"})]})})}),(0,A.jsx)(l.Field,{label:"Group by",description:"Group alerts when you receive a notification based on labels.","data-testid":"am-group-select",children:(0,A.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,a=W(e.field,q);return(0,A.jsx)(l.MultiSelect,Object.assign({"aria-label":"Group by",menuShouldPortal:!0},a,{allowCustomValue:!0,className:u.input,onCreateOption:e=>{g((t=>[...t,I(e)])),j("groupBy",[...a.value,e])},onChange:e=>t(V(e)),options:m}))},control:v,name:"groupBy"})}),(0,A.jsxs)(l.Collapse,{collapsible:!0,className:u.collapse,isOpen:d,label:"Timing options",onToggle:p,children:[(0,A.jsx)(l.Field,{label:"Group wait",description:"The waiting time until the initial notification is sent for a new group created by an incoming alert. Default 30 seconds.",invalid:!!f.groupWaitValue,error:null===(s=f.groupWaitValue)||void 0===s?void 0:s.message,"data-testid":"am-group-wait",children:(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)("div",{className:(0,n.cx)(u.container,u.timingContainer),children:[(0,A.jsx)(l.InputControl,{render:e=>{let{field:t,fieldState:{invalid:a}}=e;return(0,A.jsx)(l.Input,Object.assign({},t,{className:u.smallInput,invalid:a,placeholder:"30"}))},control:v,name:"groupWaitValue",rules:{validate:k}}),(0,A.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,a=W(e.field,z);return(0,A.jsx)(l.Select,Object.assign({menuShouldPortal:!0},a,{className:u.input,onChange:e=>t(M(e)),options:x.qr,"aria-label":"Group wait type"}))},control:v,name:"groupWaitValueType"})]})})}),(0,A.jsx)(l.Field,{label:"Group interval",description:"The waiting time to send a batch of new alerts for that group after the first notification was sent. Default 5 minutes.",invalid:!!f.groupIntervalValue,error:null===(c=f.groupIntervalValue)||void 0===c?void 0:c.message,"data-testid":"am-group-interval",children:(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)("div",{className:(0,n.cx)(u.container,u.timingContainer),children:[(0,A.jsx)(l.InputControl,{render:e=>{let{field:t,fieldState:{invalid:a}}=e;return(0,A.jsx)(l.Input,Object.assign({},t,{className:u.smallInput,invalid:a,placeholder:"5"}))},control:v,name:"groupIntervalValue",rules:{validate:k}}),(0,A.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,a=W(e.field,P);return(0,A.jsx)(l.Select,Object.assign({menuShouldPortal:!0},a,{className:u.input,onChange:e=>t(M(e)),options:x.qr,"aria-label":"Group interval type"}))},control:v,name:"groupIntervalValueType"})]})})}),(0,A.jsx)(l.Field,{label:"Repeat interval",description:"The waiting time to resend an alert after they have successfully been sent. Default 4 hours.",invalid:!!f.repeatIntervalValue,error:null===(h=f.repeatIntervalValue)||void 0===h?void 0:h.message,"data-testid":"am-repeat-interval",children:(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)("div",{className:(0,n.cx)(u.container,u.timingContainer),children:[(0,A.jsx)(l.InputControl,{render:e=>{let{field:t,fieldState:{invalid:a}}=e;return(0,A.jsx)(l.Input,Object.assign({},t,{className:u.smallInput,invalid:a,placeholder:"4"}))},control:v,name:"repeatIntervalValue",rules:{validate:k}}),(0,A.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,a=W(e.field,G);return(0,A.jsx)(l.Select,Object.assign({menuShouldPortal:!0},a,{className:u.input,menuPlacement:"top",onChange:e=>t(M(e)),options:x.qr,"aria-label":"Repeat interval type"}))},control:v,name:"repeatIntervalValueType"})]})})})]}),(0,A.jsxs)("div",{className:u.container,children:[B||(B=(0,A.jsx)(l.Button,{type:"submit",children:"Save"})),t||(t=(0,A.jsx)(l.Button,{onClick:i,type:"reset",variant:"secondary",fill:"outline",children:"Cancel"}))]})]})}})},R=e=>({container:n.css`
      display: grid;
      font-style: ${e.typography.fontSize};
      grid-template-columns: ${e.spacing(15.5)} auto;

      ${e.breakpoints.down("md")} {
        grid-template-columns: 100%;
      }
    `,titleCell:n.css`
      color: ${e.colors.text.primary};
    `,valueCell:n.css`
      color: ${e.colors.text.secondary};
      margin-bottom: ${e.spacing(1)};
    `}),L=e=>{let{routes:t}=e;const a=(0,l.useStyles2)(R),n=t.receiver||"-",r=t.groupBy.join(", ")||"-",i=t.groupWaitValue?`${t.groupWaitValue}${t.groupWaitValueType}`:"-",s=t.groupIntervalValue?`${t.groupIntervalValue}${t.groupIntervalValueType}`:"-",o=t.repeatIntervalValue?`${t.repeatIntervalValue}${t.repeatIntervalValueType}`:"-";return(0,A.jsxs)("div",{className:a.container,children:[(0,A.jsx)("div",{className:a.titleCell,children:"Contact point"}),(0,A.jsx)("div",{className:a.valueCell,"data-testid":"am-routes-root-receiver",children:n}),(0,A.jsx)("div",{className:a.titleCell,children:"Group by"}),(0,A.jsx)("div",{className:a.valueCell,"data-testid":"am-routes-root-group-by",children:r}),(0,A.jsx)("div",{className:a.titleCell,children:"Timings"}),(0,A.jsxs)("div",{className:a.valueCell,"data-testid":"am-routes-root-timings",children:["Group wait: ",i," | Group interval: ",s," | Repeat interval: ",o]})]})};var D,K;const J=e=>{let{isEditMode:t,onSave:a,onEnterEditMode:n,onExitEditMode:r,receivers:i,routes:s,alertManagerSourceName:o}=e;const c=(0,l.useStyles2)(U),u=(0,p.Ko)(o),g=(0,m.RY)(o);return(0,A.jsxs)("div",{className:c.container,"data-testid":"am-root-route-container",children:[(0,A.jsxs)("div",{className:c.titleContainer,children:[(0,A.jsxs)("h5",{className:c.title,children:["Root policy - ",D||(D=(0,A.jsx)("i",{children:"default for all alerts"}))]}),!t&&!g&&(0,A.jsx)(d.q,{actions:[u.update],children:(0,A.jsx)(l.Button,{icon:"pen",onClick:n,size:"sm",type:"button",variant:"secondary",children:"Edit"})})]}),K||(K=(0,A.jsx)("p",{children:"All alerts will go to the default contact point, unless you set additional matchers in the specific routing area."})),t?(0,A.jsx)(E,{alertManagerSourceName:o,onCancel:r,onSave:a,receivers:i,routes:s}):(0,A.jsx)(L,{routes:s})]})},U=e=>({container:n.css`
      background-color: ${e.colors.background.secondary};
      color: ${e.colors.text.secondary};
      padding: ${e.spacing(2)};
    `,titleContainer:n.css`
      color: ${e.colors.text.primary};
      display: flex;
      flex-flow: row nowrap;
    `,title:n.css`
      flex: 100%;
    `});var Y=a("./.yarn/__virtual__/react-use-virtual-00326e70ba/3/opt/drone/yarncache/react-use-npm-17.3.2-a032cbeb01-7379460f51.zip/node_modules/react-use/esm/useDebounce.js"),Z=a("./public/app/core/services/context_srv.ts"),Q=a("./public/app/features/alerting/unified/hooks/useURLSearchParams.ts");const H=e=>{let{children:t}=e;const a=(0,l.useStyles)(X);return(0,A.jsx)("div",{className:a.container,children:t})},X=e=>({container:n.css`
      background-color: ${e.colors.bg2};
      color: ${e.colors.textSemiWeak};
      padding: ${e.spacing.xl};
      text-align: center;
    `}),ee=e=>{let{buttonIcon:t,buttonLabel:a,buttonSize:n="lg",buttonVariant:r="primary",onButtonClick:i,text:s,href:o,showButton:c=!0}=e;const u=(0,l.useStyles)(te),d={className:u.button,icon:t,size:n,variant:r};return(0,A.jsx)(H,{children:(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("p",{className:u.text,children:s}),c&&(o?(0,A.jsx)(l.LinkButton,Object.assign({href:o,type:"button"},d,{children:a})):(0,A.jsx)(l.Button,Object.assign({onClick:i,type:"button"},d,{children:a})))]})})},te=e=>({container:n.css`
      background-color: ${e.colors.bg2};
      color: ${e.colors.textSemiWeak};
      padding: ${e.spacing.xl};
      text-align: center;
    `,text:n.css`
      margin-bottom: ${e.spacing.md};
    `,button:n.css`
      margin: ${e.spacing.md} 0 ${e.spacing.sm};
    `});var ae=a("./public/app/features/alerting/unified/components/alert-groups/MatcherFilter.tsx");var ne=a("./public/app/features/alerting/unified/components/DynamicTable.tsx"),re=a("./public/app/features/alerting/unified/components/silences/Matchers.tsx"),ie=a("./public/app/features/alerting/unified/utils/redux.ts"),le=a("./public/app/features/alerting/unified/hooks/useAlertManagerSourceName.ts"),se=a("./public/app/features/alerting/unified/hooks/useAlertManagerSources.ts"),oe=a("./public/app/features/alerting/unified/hooks/useUnifiedAlertingSelector.ts");const ce=["onChange","ref"],ue=["onChange","ref"],de=["onChange","ref"],pe=["onChange","ref"],me=["onChange","ref"],ge=["onChange","ref"],he=["onChange","ref"];var ve,xe;function fe(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}const je=e=>{var t;let{onCancel:a,onSave:i,receivers:s,routes:o}=e;const c=(0,l.useStyles2)(be),u=(0,l.useStyles2)(O),[d,p]=(0,r.useState)(o.groupBy.length>0),[m,g]=(0,r.useState)(w(o.groupBy)),h=function(){const e=(0,se.k)("notification"),[t]=(0,le.k)(e),a=(0,oe._)((e=>e.amConfigs));return(0,r.useMemo)((()=>{var e,n,r;const{result:i}=t&&a[t]||ie.oq,l=null!==(e=null==i?void 0:i.alertmanager_config)&&void 0!==e?e:{};return null!==(n=null==l||null===(r=l.mute_time_intervals)||void 0===r?void 0:r.map((e=>({value:e.name,label:e.name,description:e.time_intervals.map((e=>(0,v.uK)(e))).join(", AND ")}))))&&void 0!==n?n:[]}),[t,a])}();return(0,A.jsx)(l.Form,{defaultValues:o,onSubmit:i,children:e=>{var r,i,o;let{control:f,register:j,errors:b,setValue:y,watch:S}=e;return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("input",Object.assign({type:"hidden"},j("id"))),(0,A.jsx)(l.FieldArray,{name:"object_matchers",control:f,children:e=>{let{fields:t,append:a,remove:n}=e;return(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)(l.VerticalGroup,{justify:"flex-start",spacing:"md",children:[ve||(ve=(0,A.jsx)("div",{children:"Matching labels"})),0===t.length&&(0,A.jsx)(l.Badge,{color:"orange",className:c.noMatchersWarning,icon:"exclamation-triangle",text:"If no matchers are specified, this notification policy will handle all alert instances."}),t.length>0&&(0,A.jsx)("div",{className:c.matchersContainer,children:t.map(((e,t)=>{var a,r,i,s,o,u,d,p,m,g;const h=`object_matchers[${t}]`;return(0,A.jsxs)(l.HorizontalGroup,{align:"flex-start",height:"auto",children:[(0,A.jsx)(l.Field,{label:"Label",invalid:!(null===(a=b.object_matchers)||void 0===a||null===(r=a[t])||void 0===r||!r.name),error:null===(i=b.object_matchers)||void 0===i||null===(s=i[t])||void 0===s||null===(o=s.name)||void 0===o?void 0:o.message,children:(0,A.jsx)(l.Input,Object.assign({},j(`${h}.name`,{required:"Field is required"}),{defaultValue:e.name,placeholder:"label"}))}),(0,A.jsx)(l.Field,{label:"Operator",children:(0,A.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,a=fe(e.field,ce);return(0,A.jsx)(l.Select,Object.assign({},a,{className:c.matchersOperator,onChange:e=>t(null==e?void 0:e.value),options:v.tA,"aria-label":"Operator",menuShouldPortal:!0}))},defaultValue:e.operator,control:f,name:`${h}.operator`,rules:{required:{value:!0,message:"Required."}}})}),(0,A.jsx)(l.Field,{label:"Value",invalid:!(null===(u=b.object_matchers)||void 0===u||null===(d=u[t])||void 0===d||!d.value),error:null===(p=b.object_matchers)||void 0===p||null===(m=p[t])||void 0===m||null===(g=m.value)||void 0===g?void 0:g.message,children:(0,A.jsx)(l.Input,Object.assign({},j(`${h}.value`,{required:"Field is required"}),{defaultValue:e.value,placeholder:"value"}))}),(0,A.jsx)(l.IconButton,{className:c.removeButton,tooltip:"Remove matcher",name:"trash-alt",onClick:()=>n(t),children:"Remove"})]},e.id)}))}),(0,A.jsx)(l.Button,{className:c.addMatcherBtn,icon:"plus",onClick:()=>a(C),variant:"secondary",type:"button",children:"Add matcher"})]})})}}),(0,A.jsx)(l.Field,{label:"Contact point",children:(0,A.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,a=fe(e.field,ue);return(0,A.jsx)(l.Select,Object.assign({"aria-label":"Contact point"},a,{className:u.input,onChange:e=>t(M(e)),options:s,menuShouldPortal:!0}))},control:f,name:"receiver"})}),(0,A.jsx)(l.Field,{label:"Continue matching subsequent sibling nodes",children:(0,A.jsx)(l.Switch,Object.assign({id:"continue-toggle"},j("continue")))}),(0,A.jsx)(l.Field,{label:"Override grouping",children:(0,A.jsx)(l.Switch,{id:"override-grouping-toggle",value:d,onChange:()=>p((e=>!e))})}),d&&(0,A.jsx)(l.Field,{label:"Group by",description:"Group alerts when you receive a notification based on labels. If empty it will be inherited from the parent policy.",children:(0,A.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,a=fe(e.field,de);return(0,A.jsx)(l.MultiSelect,Object.assign({"aria-label":"Group by",menuShouldPortal:!0},a,{allowCustomValue:!0,className:u.input,onCreateOption:e=>{g((t=>[...t,I(e)])),y("groupBy",[...a.value,e])},onChange:e=>t(V(e)),options:m}))},control:f,name:"groupBy"})}),(0,A.jsx)(l.Field,{label:"Override general timings",children:(0,A.jsx)(l.Switch,Object.assign({id:"override-timings-toggle"},j("overrideTimings")))}),S().overrideTimings&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(l.Field,{label:"Group wait",description:"The waiting time until the initial notification is sent for a new group created by an incoming alert. If empty it will be inherited from the parent policy.",invalid:!!b.groupWaitValue,error:null===(r=b.groupWaitValue)||void 0===r?void 0:r.message,children:(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)("div",{className:(0,n.cx)(u.container,u.timingContainer),children:[(0,A.jsx)(l.InputControl,{render:e=>{let{field:t,fieldState:{invalid:a}}=e;return(0,A.jsx)(l.Input,Object.assign({},t,{className:u.smallInput,invalid:a,"aria-label":"Group wait value"}))},control:f,name:"groupWaitValue",rules:{validate:k}}),(0,A.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,a=fe(e.field,pe);return(0,A.jsx)(l.Select,Object.assign({menuShouldPortal:!0},a,{className:u.input,onChange:e=>t(M(e)),options:x.qr,"aria-label":"Group wait type"}))},control:f,name:"groupWaitValueType"})]})})}),(0,A.jsx)(l.Field,{label:"Group interval",description:"The waiting time to send a batch of new alerts for that group after the first notification was sent. If empty it will be inherited from the parent policy.",invalid:!!b.groupIntervalValue,error:null===(i=b.groupIntervalValue)||void 0===i?void 0:i.message,children:(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)("div",{className:(0,n.cx)(u.container,u.timingContainer),children:[(0,A.jsx)(l.InputControl,{render:e=>{let{field:t,fieldState:{invalid:a}}=e;return(0,A.jsx)(l.Input,Object.assign({},t,{className:u.smallInput,invalid:a,"aria-label":"Group interval value"}))},control:f,name:"groupIntervalValue",rules:{validate:k}}),(0,A.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,a=fe(e.field,me);return(0,A.jsx)(l.Select,Object.assign({menuShouldPortal:!0},a,{className:u.input,onChange:e=>t(M(e)),options:x.qr,"aria-label":"Group interval type"}))},control:f,name:"groupIntervalValueType"})]})})}),(0,A.jsx)(l.Field,{label:"Repeat interval",description:"The waiting time to resend an alert after they have successfully been sent.",invalid:!!b.repeatIntervalValue,error:null===(o=b.repeatIntervalValue)||void 0===o?void 0:o.message,children:(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)("div",{className:(0,n.cx)(u.container,u.timingContainer),children:[(0,A.jsx)(l.InputControl,{render:e=>{let{field:t,fieldState:{invalid:a}}=e;return(0,A.jsx)(l.Input,Object.assign({},t,{className:u.smallInput,invalid:a,"aria-label":"Repeat interval value"}))},control:f,name:"repeatIntervalValue",rules:{validate:k}}),(0,A.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,a=fe(e.field,ge);return(0,A.jsx)(l.Select,Object.assign({menuShouldPortal:!0},a,{className:u.input,menuPlacement:"top",onChange:e=>t(M(e)),options:x.qr,"aria-label":"Repeat interval type"}))},control:f,name:"repeatIntervalValueType"})]})})})]}),(0,A.jsx)(l.Field,{label:"Mute timings","data-testid":"am-mute-timing-select",description:"Add mute timing to policy",invalid:!!b.muteTimeIntervals,children:(0,A.jsx)(l.InputControl,{render:e=>{let{field:{onChange:t}}=e,a=fe(e.field,he);return(0,A.jsx)(l.MultiSelect,Object.assign({"aria-label":"Mute timings",menuShouldPortal:!0},a,{className:u.input,onChange:e=>t(V(e)),options:h}))},control:f,name:"muteTimeIntervals"})}),(0,A.jsxs)("div",{className:c.buttonGroup,children:[xe||(xe=(0,A.jsx)(l.Button,{type:"submit",children:"Save policy"})),t||(t=(0,A.jsx)(l.Button,{onClick:a,fill:"outline",type:"button",variant:"secondary",children:"Cancel"}))]})]})}})},be=e=>{const t=e.spacing(3.5);return{addMatcherBtn:n.css`
      margin-bottom: ${t};
    `,matchersContainer:n.css`
      background-color: ${e.colors.background.secondary};
      margin: ${e.spacing(1,0)};
      padding: ${e.spacing(1,4.6,1,1.5)};
      width: fit-content;
    `,matchersOperator:n.css`
      min-width: 140px;
    `,nestedPolicies:n.css`
      margin-top: ${t};
    `,removeButton:n.css`
      margin-left: ${e.spacing(1)};
      margin-top: ${e.spacing(2.5)};
    `,buttonGroup:n.css`
      margin: ${e.spacing(6)} 0 ${t};

      & > * + * {
        margin-left: ${e.spacing(1.5)};
      }
    `,noMatchersWarning:n.css`
      padding: ${e.spacing(1)} ${e.spacing(2)};
    `}};var ye,Ce,Se,_e,Ne,Ie,we=a("./public/app/features/alerting/unified/state/actions.ts");const Me=e=>{var t;let{alertManagerSourceName:a,muteTimingNames:n,hideActions:s}=e;const o=(0,l.useStyles2)(ke),c=(0,i.useDispatch)(),u=(0,p.Ko)(a),m=(0,oe._)((e=>e.amConfigs)),[g,h]=(0,r.useState)(""),{result:v}=a&&m[a]||ie.oq,x=(0,r.useMemo)((()=>{var e,t;return(null!==(e=null==v||null===(t=v.alertmanager_config)||void 0===t?void 0:t.mute_time_intervals)&&void 0!==e?e:[]).filter((e=>{let{name:t}=e;return!n||n.includes(t)})).map((e=>({id:e.name,data:e})))}),[null==v||null===(t=v.alertmanager_config)||void 0===t?void 0:t.mute_time_intervals,n]),f=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0;const n=(0,p.Ko)(e),i=Z.Vt.hasPermission(n.update),s=Z.Vt.hasPermission(n.delete),o=!t&&(i||s);return(0,r.useMemo)((()=>{const t=[{id:"name",label:"Name",renderCell:function(e){let{data:t}=e;return t.name},size:"250px"},{id:"timeRange",label:"Time range",renderCell:e=>{let{data:t}=e;return Ve(t.time_intervals)}}];return o&&t.push({id:"actions",label:"Actions",renderCell:function(t){let{data:r}=t;return(0,A.jsxs)("div",{children:[(0,A.jsx)(d.q,{actions:[n.update],children:(0,A.jsx)(l.Link,{href:(0,$.eQ)("/alerting/routes/mute-timing/edit",e,{muteName:r.name}),children:_e||(_e=(0,A.jsx)(l.IconButton,{name:"edit",title:"Edit mute timing"}))})}),(0,A.jsx)(d.q,{actions:[n.delete],children:(0,A.jsx)(l.IconButton,{name:"trash-alt",title:"Delete mute timing",onClick:()=>a(r.name)})})]})},size:"100px"}),t}),[e,a,o,n])}(a,s,h);return(0,A.jsxs)("div",{className:o.container,children:[!s&&(ye||(ye=(0,A.jsx)("h5",{children:"Mute timings"}))),!s&&(Ce||(Ce=(0,A.jsx)("p",{children:"Mute timings are a named interval of time that may be referenced in the notification policy tree to mute particular notification policies for specific times of the day."}))),!s&&x.length>0&&(0,A.jsx)(d.q,{actions:[u.create],children:(0,A.jsx)(l.LinkButton,{className:o.addMuteButton,icon:"plus",variant:"primary",href:(0,$.eQ)("alerting/routes/mute-timing/new",a),children:"New mute timing"})}),x.length>0?(0,A.jsx)(ne.t,{items:x,cols:f}):s?Se||(Se=(0,A.jsx)("p",{children:"No mute timings configured"})):(0,A.jsx)(ee,{text:"You haven't created any mute timings yet",buttonLabel:"Add mute timing",buttonIcon:"plus",buttonSize:"lg",href:(0,$.eQ)("alerting/routes/mute-timing/new",a),showButton:Z.Vt.hasPermission(u.create)}),!s&&(0,A.jsx)(l.ConfirmModal,{isOpen:!!g,title:"Delete mute timing",body:`Are you sure you would like to delete "${g}"`,confirmText:"Delete",onConfirm:()=>c((0,we.r0)(a,g)),onDismiss:()=>h("")})]})};function Ve(e){return e.map(((e,t)=>{const{times:a,weekdays:n,days_of_month:i,months:l,years:s}=e,o=(0,v.u6)(a),c=(0,v.v7)(n),u=(0,v.J8)(i),d=(0,v.m8)(l),p=(0,v.qw)(s);return(0,A.jsxs)(r.Fragment,{children:[`${o} ${c}`,Ne||(Ne=(0,A.jsx)("br",{})),[u,d,p].join(" | "),Ie||(Ie=(0,A.jsx)("br",{}))]},JSON.stringify(e)+t)}))}const ke=e=>({container:n.css`
    display: flex;
    flex-flow: column nowrap;
  `,addMuteButton:n.css`
    margin-bottom: ${e.spacing(2)};
    align-self: flex-end;
  `});var $e;const Oe=e=>{let{onChange:t,receivers:a,routes:n,readOnly:i=!1,alertManagerSourceName:s}=e;const o=(0,l.useStyles2)(Te),c=(0,l.useStyles2)(R),u=(0,p.Ko)(s),m=n.groupWaitValue?`${n.groupWaitValue}${n.groupWaitValueType}`:"-",g=n.groupIntervalValue?`${n.groupIntervalValue}${n.groupIntervalValueType}`:"-",h=n.repeatIntervalValue?`${n.repeatIntervalValue}${n.repeatIntervalValueType}`:"-",[v,x]=(0,r.useState)(n.routes),[f,j]=(0,r.useState)(!1);return(0,A.jsxs)("div",{className:c.container,children:[(0,A.jsx)("div",{className:c.titleCell,children:"Group wait"}),(0,A.jsx)("div",{className:c.valueCell,children:m}),(0,A.jsx)("div",{className:c.titleCell,children:"Group interval"}),(0,A.jsx)("div",{className:c.valueCell,children:g}),(0,A.jsx)("div",{className:c.titleCell,children:"Repeat interval"}),(0,A.jsx)("div",{className:c.valueCell,children:h}),(0,A.jsx)("div",{className:c.titleCell,children:"Nested policies"}),(0,A.jsxs)("div",{className:c.valueCell,children:[v.length?(0,A.jsx)(qe,{isAddMode:f,onCancelAdd:()=>{j(!1),x((e=>{const t=[...e];return t.pop(),t}))},onChange:e=>{t(Object.assign({},n,{routes:e})),f&&j(!1)},receivers:a,routes:v,alertManagerSourceName:s}):$e||($e=(0,A.jsx)("p",{children:"No nested policies configured."})),!f&&!i&&(0,A.jsx)(d.q,{actions:[u.create],children:(0,A.jsx)(l.Button,{className:o.addNestedRoutingBtn,icon:"plus",onClick:()=>{x((e=>[...e,S])),j(!0)},variant:"secondary",type:"button",children:"Add nested policy"})})]}),(0,A.jsx)("div",{className:c.titleCell,children:"Mute timings"}),(0,A.jsx)("div",{className:c.valueCell,children:(0,A.jsx)(Me,{alertManagerSourceName:s,muteTimingNames:n.muteTimeIntervals,hideActions:!0})})]})},Te=e=>({addNestedRoutingBtn:n.css`
      margin-top: ${e.spacing(2)};
    `});var Be,Ae;const Fe=(e,t)=>{const a=[...e],n=a.findIndex((e=>e.id===t.id));return n>=0&&(a[n]=Object.assign({},a[n],t)),a},qe=e=>{let{isAddMode:t,onCancelAdd:a,onChange:n,receivers:i,routes:s,filters:o,readOnly:c=!1,alertManagerSourceName:u}=e;const[d,m]=(0,r.useState)(!1),[h,x]=(0,r.useState)(void 0),[f,j]=(0,r.useState)(),b=(0,p.Ko)(u),y=Z.Vt.hasPermission(b.update),C=Z.Vt.hasPermission(b.delete),S=!c&&(y||C),_=(0,r.useCallback)((e=>j(e.id)),[]),N=(0,r.useCallback)((()=>j(void 0)),[]),I=[{id:"matchingCriteria",label:"Matching labels",renderCell:e=>e.data.object_matchers.length?(0,A.jsx)(re.g,{matchers:e.data.object_matchers.map(v._J)}):Be||(Be=(0,A.jsx)("span",{children:"Matches all alert instances"})),size:10},{id:"groupBy",label:"Group by",renderCell:e=>e.data.groupBy.join(", ")||"-",size:5},{id:"receiverChannel",label:"Contact point",renderCell:e=>e.data.receiver||"-",size:5},{id:"muteTimings",label:"Mute timings",renderCell:e=>e.data.muteTimeIntervals.join(", ")||"-",size:5},...S?[{id:"actions",label:"Actions",renderCell:e=>{if(e.renderExpandedContent)return null;return(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)(l.HorizontalGroup,{children:[(0,A.jsx)(l.Button,{"aria-label":"Edit route",icon:"pen",onClick:()=>{_(e),m(!0)},size:"sm",type:"button",variant:"secondary",children:"Edit"}),(0,A.jsx)(l.IconButton,{"aria-label":"Delete route",name:"trash-alt",onClick:()=>{x(e.data.id)},type:"button"})]})})},size:"100px"}]:[]],w=(0,r.useMemo)((()=>((e,t,a)=>{const n=(0,v.Zh)(null!=t?t:"");let r=e;return n.length&&(r=e.filter((e=>{const t=e.object_matchers.map(v._J);return(0,g.intersectionWith)(t,n,g.isEqual).length>0}))),a&&a.length>0&&(r=r.filter((e=>e.receiver.toLowerCase().includes(a.toLowerCase())))),r})(s,null==o?void 0:o.queryString,null==o?void 0:o.contactPoint)),[s,o]),M=(0,r.useMemo)((()=>{return(t?s:w).map(((t,a)=>{var n;return{id:null!==(n=null==e?void 0:e(t))&&void 0!==n?n:a,data:t}}));var e}),[t,s,w]);return(0,r.useEffect)((()=>{t&&M.length&&j(M[M.length-1].id),!t&&M.length&&j(void 0)}),[t,M]),s.length>0&&0===w.length?Ae||(Ae=(0,A.jsx)(H,{children:(0,A.jsx)("p",{children:"No policies found"})})):(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(ne.t,{cols:I,isExpandable:!0,items:M,testIdGenerator:()=>"am-routes-row",onCollapse:N,onExpand:_,isExpanded:e=>f===e.id,renderExpandedContent:e=>t||d?(0,A.jsx)(je,{onCancel:()=>{t&&a(),m(!1)},onSave:e=>{const t=Fe(s,e);m(!1),n(t)},receivers:i,routes:e.data}):(0,A.jsx)(Oe,{onChange:e=>{const t=Fe(s,e);n(t)},receivers:i,routes:e.data,readOnly:c,alertManagerSourceName:u})}),(0,A.jsx)(l.ConfirmModal,{isOpen:!!h,title:"Delete notification policy",body:"Deleting this notification policy will permanently remove it. Are you sure you want to delete this policy?",confirmText:"Yes, delete",icon:"exclamation-triangle",onConfirm:()=>{if(h){const e=((e,t)=>e.filter((e=>e.id!==t)))(s,h);n(e),x(void 0)}},onDismiss:()=>x(void 0)})]})};var ze,Pe,Ge,We,Ee,Re;const Le=e=>{var t,a;let{alertManagerSourceName:n,onChange:i,onRootRouteEdit:s,receivers:o,routes:c,readOnly:u=!1}=e;const[m,g]=(0,r.useState)([...c.routes]),[h,v]=(0,r.useState)(!1),x=(0,p.Ko)(n),f=Z.Vt.hasPermission(x.create),[j,b]=(0,Q.j)(),{queryString:y,contactPoint:_}=(0,$.$f)(j),[N,I]=(0,r.useState)({queryString:y,contactPoint:_});(0,Y.Z)((()=>{b({queryString:N.queryString,contactPoint:N.contactPoint})}),400,[N]);const w=(0,l.useStyles2)(De),M=()=>{I({queryString:void 0,contactPoint:void 0}),b({queryString:void 0,contactPoint:void 0})},V=()=>{M(),v(!0),g((()=>[...c.routes,Object.assign({},S,{matchers:[C]})]))};return(0,A.jsxs)("div",{className:w.container,children:[ze||(ze=(0,A.jsx)("h5",{children:"Specific routing"})),Pe||(Pe=(0,A.jsx)("p",{children:"Send specific alerts to chosen contact points, based on matching criteria"})),c.receiver?m.length>0?(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("div",{children:[!h&&(0,A.jsxs)("div",{className:w.searchContainer,children:[(0,A.jsx)(ae.F,{onFilterChange:e=>I((t=>Object.assign({},t,{queryString:e}))),queryString:null!==(t=N.queryString)&&void 0!==t?t:"",className:w.filterInput}),(0,A.jsxs)("div",{className:w.filterInput,children:[We||(We=(0,A.jsx)(l.Label,{children:"Search by contact point"})),(0,A.jsx)(l.Input,{onChange:e=>{let{currentTarget:t}=e;return I((e=>Object.assign({},e,{contactPoint:t.value})))},value:null!==(a=N.contactPoint)&&void 0!==a?a:"",placeholder:"Search by contact point","data-testid":"search-query-input",prefix:Ee||(Ee=(0,A.jsx)(l.Icon,{name:"search"}))})]}),(y||_)&&(0,A.jsx)(l.Button,{variant:"secondary",icon:"times",onClick:M,className:w.clearFilterBtn,children:"Clear filters"})]}),!h&&!u&&(0,A.jsx)(d.q,{actions:[x.create],children:(0,A.jsx)("div",{className:w.addMatcherBtnRow,children:(0,A.jsx)(l.Button,{className:w.addMatcherBtn,icon:"plus",onClick:V,type:"button",children:"New policy"})})})]}),(0,A.jsx)(qe,{isAddMode:h,readOnly:u,onCancelAdd:()=>{v(!1),g([...c.routes])},onChange:e=>{i(Object.assign({},c,{routes:e})),h&&v(!1)},receivers:o,routes:m,filters:{queryString:y,contactPoint:_},alertManagerSourceName:n})]}):u?Re||(Re=(0,A.jsx)(H,{children:(0,A.jsx)("p",{children:"There are no specific policies configured."})})):(0,A.jsx)(ee,{buttonIcon:"plus",buttonLabel:"New specific policy",onButtonClick:V,text:"You haven't created any specific policies yet.",showButton:f}):u?Ge||(Ge=(0,A.jsx)(H,{children:(0,A.jsx)("p",{children:"There is no default contact point configured for the root route."})})):(0,A.jsx)(ee,{buttonIcon:"rocket",buttonLabel:"Set a default contact point",onButtonClick:s,text:"You haven't set a default contact point for the root route yet.",showButton:f})]})},De=e=>({container:n.css`
      display: flex;
      flex-flow: column wrap;
    `,searchContainer:n.css`
      display: flex;
      flex-flow: row nowrap;
      padding-bottom: ${e.spacing(2)};
      border-bottom: 1px solid ${e.colors.border.strong};
    `,clearFilterBtn:n.css`
      align-self: flex-end;
      margin-left: ${e.spacing(1)};
    `,filterInput:n.css`
      width: 340px;
      & + & {
        margin-left: ${e.spacing(1)};
      }
    `,addMatcherBtnRow:n.css`
      display: flex;
      flex-flow: column nowrap;
      padding: ${e.spacing(2)} 0;
    `,addMatcherBtn:n.css`
      align-self: flex-end;
    `});var Ke;const Je=(0,l.withErrorBoundary)((()=>{var e;const t=(0,i.useDispatch)(),a=(0,l.useStyles2)(Ue),[n,d]=(0,r.useState)(!1),p=(0,se.k)("notification"),[g,h]=(0,le.k)(p),v=!g||(0,m.RY)(g),x=(0,oe._)((e=>e.amConfigs)),f=(0,r.useCallback)((()=>{g&&t((0,we.Yh)(g))}),[g,t]);(0,r.useEffect)((()=>{f()}),[f]);const{result:j,loading:b,error:y}=g&&x[g]||ie.oq,C=null==j?void 0:j.alertmanager_config,[S,I]=(0,r.useMemo)((()=>_(null==C?void 0:C.route)),[null==C?void 0:C.route]),M=w((null!==(e=null==C?void 0:C.receivers)&&void 0!==e?e:[]).map((e=>e.name))),V=()=>{d(!0)},k=()=>{d(!1)};(0,s.x)((e=>e.unifiedAlerting.saveAMConfig));const $=e=>{if(!j)return;const a=N(g,Object.assign({},S,e),I);n&&k(),t((0,we.mM)({newConfig:Object.assign({},j,{alertmanager_config:Object.assign({},j.alertmanager_config,{route:a})}),oldConfig:j,alertManagerSourceName:g,successMessage:"Saved",refetch:!0}))};return g?(0,A.jsxs)(c.J,{pageId:"am-routes",children:[(0,A.jsx)(o.P,{current:g,onChange:h,dataSources:p}),y&&!b&&(0,A.jsx)(l.Alert,{severity:"error",title:"Error loading Alertmanager config",children:y.message||"Unknown error."}),b&&(Ke||(Ke=(0,A.jsx)(l.LoadingPlaceholder,{text:"Loading Alertmanager config..."}))),j&&!b&&!y&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(J,{alertManagerSourceName:g,isEditMode:n,onSave:$,onEnterEditMode:V,onExitEditMode:k,receivers:M,routes:S}),(0,A.jsx)("div",{className:a.break}),(0,A.jsx)(Le,{alertManagerSourceName:g,onChange:$,readOnly:v,onRootRouteEdit:V,receivers:M,routes:S}),(0,A.jsx)("div",{className:a.break}),(0,A.jsx)(Me,{alertManagerSourceName:g})]})]}):(0,A.jsx)(c.J,{pageId:"am-routes",children:(0,A.jsx)(u.I,{availableAlertManagers:p})})}),{style:"page"}),Ue=e=>({break:n.css`
    width: 100%;
    height: 0;
    margin-bottom: ${e.spacing(2)};
  `})},"./public/app/features/alerting/unified/components/AlertingPageWrapper.tsx":(e,t,a)=>{a.d(t,{J:()=>s});a("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js");var n=a("./.yarn/__virtual__/react-redux-virtual-7ad20a440e/3/opt/drone/yarncache/react-redux-npm-7.2.6-134f5ed64d-0bf142ce0d.zip/node_modules/react-redux/es/index.js"),r=a("./public/app/core/components/Page/Page.tsx"),i=a("./public/app/core/selectors/navModel.ts"),l=a("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const s=e=>{let{children:t,pageId:a,isLoading:s}=e;const o=(0,i.h)((0,n.useSelector)((e=>e.navIndex)),a);return(0,l.jsx)(r.Z,{navModel:o,children:(0,l.jsx)(r.Z.Contents,{isLoading:s,children:t})})}},"./public/app/features/alerting/unified/components/Authorize.tsx":(e,t,a)=>{a.d(t,{q:()=>i});a("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js");var n=a("./public/app/core/services/context_srv.ts"),r=a("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const i=e=>{let{actions:t,children:a,fallback:i=!0}=e;return t.some((e=>n.Vt.hasAccess(e,i)))?(0,r.jsx)(r.Fragment,{children:a}):null}},"./public/app/features/alerting/unified/components/NoAlertManagerWarning.tsx":(e,t,a)=>{a.d(t,{I:()=>m});a("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js");var n,r,i,l,s=a("./packages/grafana-ui/src/index.ts"),o=a("./public/app/features/alerting/unified/hooks/useAlertManagerSourceName.ts"),c=a("./public/app/features/alerting/unified/components/AlertManagerPicker.tsx"),u=a("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const d=()=>n||(n=(0,u.jsx)(s.Alert,{title:"No Alertmanager found",severity:"warning",children:"We could not find any external Alertmanagers and you may not have access to the built-in Grafana Alertmanager."})),p=()=>r||(r=(0,u.jsx)(s.Alert,{title:"Selected Alertmanager not found. Select a different Alertmanager.",severity:"warning",children:"Selected Alertmanager no longer exists or you may not have permission to access it."})),m=e=>{let{availableAlertManagers:t}=e;const[a,n]=(0,o.k)(t),r=t.length>0;return(0,u.jsx)("div",{children:r?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(c.P,{onChange:n,dataSources:t}),i||(i=(0,u.jsx)(p,{}))]}):l||(l=(0,u.jsx)(d,{}))})}},"./public/app/features/alerting/unified/components/alert-groups/MatcherFilter.tsx":(e,t,a)=>{a.d(t,{F:()=>u});var n,r,i,l=a("./.yarn/__virtual__/@emotion-css-virtual-72c314ddb1/3/opt/drone/yarncache/@emotion-css-npm-11.7.1-25ff8755a7-ac1f56656f.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),s=(a("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),a("./.yarn/__virtual__/@grafana-experimental-virtual-920bad95a1/3/opt/drone/yarncache/@grafana-experimental-npm-0.0.2-canary.22-45d2c4f135-b9a64c0abc.zip/node_modules/@grafana/experimental/index.js")),o=a("./packages/grafana-ui/src/index.ts"),c=a("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const u=e=>{let{className:t,onFilterChange:a,defaultQueryString:l,queryString:u}=e;const p=(0,o.useStyles2)(d),m=n||(n=(0,c.jsx)(o.Icon,{name:"search"}));return(0,c.jsxs)("div",{className:t,children:[(0,c.jsx)(o.Label,{children:(0,c.jsxs)(s.Stack,{gap:.5,children:[r||(r=(0,c.jsx)("span",{children:"Search by label"})),(0,c.jsx)(o.Tooltip,{content:i||(i=(0,c.jsxs)("div",{children:["Filter alerts using label querying, ex:",(0,c.jsx)("pre",{children:'{severity="critical", instance=~"cluster-us-.+"}'})]})),children:(0,c.jsx)(o.Icon,{className:p.icon,name:"info-circle",size:"sm"})})]})}),(0,c.jsx)(o.Input,{placeholder:"Search",defaultValue:l,value:u,onChange:e=>{const t=e.target;a(t.value)},"data-testid":"search-query-input",prefix:m,className:p.inputWidth})]})},d=e=>({icon:l.css`
    margin-right: ${e.spacing(.5)};
  `,inputWidth:l.css`
    width: 340px;
    flex-grow: 0;
  `})},"./public/app/features/alerting/unified/components/silences/Matchers.tsx":(e,t,a)=>{a.d(t,{g:()=>s});var n=a("./.yarn/__virtual__/@emotion-css-virtual-72c314ddb1/3/opt/drone/yarncache/@emotion-css-npm-11.7.1-25ff8755a7-ac1f56656f.zip/node_modules/@emotion/css/dist/emotion-css.esm.js"),r=(a("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),a("./packages/grafana-ui/src/index.ts")),i=a("./public/app/features/alerting/unified/utils/alertmanager.ts"),l=a("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/jsx-runtime.js");const s=e=>{let{matchers:t}=e;const a=(0,r.useStyles2)(o);return(0,l.jsx)("div",{children:(0,l.jsx)(r.TagList,{className:a.tags,tags:t.map((e=>`${e.name}${(0,i.zy)(e)}${e.value}`))})})},o=()=>({tags:n.css`
    justify-content: flex-start;
  `})},"./public/app/features/alerting/unified/hooks/useAlertManagerSourceName.ts":(e,t,a)=>{a.d(t,{k:()=>o});var n=a("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),r=a("./public/app/core/hooks/useQueryParams.ts"),i=a("./public/app/core/store.ts"),l=a("./public/app/features/alerting/unified/utils/constants.ts"),s=a("./public/app/features/alerting/unified/utils/datasource.ts");function o(e){const[t,a]=(0,r.K)(),o=function(e){return(0,n.useCallback)((t=>e.map((e=>e.name)).includes(t)),[e])}(e),c=(0,n.useCallback)((e=>{o(e)&&(e===s.GC?(i.Z.delete(l.de),a({[l.c4]:null})):(i.Z.set(l.de,e),a({[l.c4]:e})))}),[a,o]),u=t[l.c4];if(u&&"string"==typeof u)return o(u)?[u,c]:[void 0,c];const d=i.Z.get(l.de);return d&&"string"==typeof d&&o(d)?(c(d),[d,c]):o(s.GC)?[s.GC,c]:[void 0,c]}},"./public/app/features/alerting/unified/hooks/useAlertManagerSources.ts":(e,t,a)=>{a.d(t,{k:()=>i});var n=a("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),r=a("./public/app/features/alerting/unified/utils/datasource.ts");function i(e){return(0,n.useMemo)((()=>(0,r.LE)(e)),[e])}},"./public/app/features/alerting/unified/hooks/useURLSearchParams.ts":(e,t,a)=>{a.d(t,{j:()=>l});var n=a("../../opt/drone/yarncache/react-npm-17.0.2-99ba37d931-b254cc17ce.zip/node_modules/react/index.js"),r=a("./.yarn/__virtual__/react-router-virtual-31642fe47a/3/opt/drone/yarncache/react-router-npm-5.2.1-ea754d7473-7daae084bf.zip/node_modules/react-router/esm/react-router.js"),i=a("./packages/grafana-runtime/src/index.ts");function l(){const{search:e}=(0,r.TH)();return[(0,n.useMemo)((()=>new URLSearchParams(e)),[e]),(0,n.useCallback)(((e,t)=>{i.locationService.partial(e,t)}),[])]}}}]);
//# sourceMappingURL=AlertAmRoutes.d32aef4f2822e56fb2d6.js.map