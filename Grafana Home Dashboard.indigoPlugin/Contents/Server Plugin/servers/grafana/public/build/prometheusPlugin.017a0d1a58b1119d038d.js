(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{EaOu:function(e,t,r){"use strict";r.r(t);var n=r("Obii"),a=r("BkRI"),o=r.n(a),i=r("la6v"),u=r.n(i),s=r("+2Rf"),c=r.n(s),l=r("PbtU"),f=r("F/XL"),p=r("0/uQ"),m=r("p0ib"),h=r("VNr4"),d=r("xMyE"),v=r("VnD/"),y=r("67Y/"),g=r("LvDl"),b=r.n(g),O=r("NPB1");function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var x=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.datasource=t,this.query=r,this.datasource=t,this.query=r,this.range=Object(O.a)().timeRange()}var t,r,n;return t=e,(r=[{key:"process",value:function(){if(this.query.match(/^label_names\(\)\s*$/))return this.labelNamesQuery();var e=this.query.match(/^label_values\((?:(.+),\s*)?([a-zA-Z_][a-zA-Z0-9_]*)\)\s*$/);if(e)return e[1]?this.labelValuesQuery(e[2],e[1]):this.labelValuesQuery(e[2],null);var t=this.query.match(/^metrics\((.+)\)\s*$/);if(t)return this.metricNameQuery(t[1]);var r=this.query.match(/^query_result\((.+)\)\s*$/);return r?this.queryResultQuery(r[1]):this.metricNameAndLabelsQuery(this.query)}},{key:"labelNamesQuery",value:function(){return this.datasource.metadataRequest("/api/v1/labels").then((function(e){return b.a.map(e.data.data,(function(e){return{text:e}}))}))}},{key:"labelValuesQuery",value:function(e,t){var r;if(t){var n=this.datasource.getPrometheusTime(this.range.from,!1),a=this.datasource.getPrometheusTime(this.range.to,!0),o=new URLSearchParams({"match[]":t,start:n.toString(),end:a.toString()});return r="/api/v1/series?".concat(o.toString()),this.datasource.metadataRequest(r).then((function(t){var r=b.a.map(t.data.data,(function(t){return t[e]||""})).filter((function(e){return""!==e}));return b.a.uniq(r).map((function(e){return{text:e,expandable:!0}}))}))}return r="/api/v1/label/"+e+"/values",this.datasource.metadataRequest(r).then((function(e){return b.a.map(e.data.data,(function(e){return{text:e}}))}))}},{key:"metricNameQuery",value:function(e){return this.datasource.metadataRequest("/api/v1/label/__name__/values").then((function(t){return b.a.chain(t.data.data).filter((function(t){return new RegExp(e).test(t)})).map((function(e){return{text:e,expandable:!0}})).value()}))}},{key:"queryResultQuery",value:function(e){var t=this.datasource.getPrometheusTime(this.range.to,!0),r={expr:e};return this.datasource.performInstantQuery(r,t).then((function(e){return b.a.map(e.data.data.result,(function(e){var t=e.metric.__name__||"";return delete e.metric.__name__,t+="{"+b.a.map(e.metric,(function(e,t){return t+'="'+e+'"'})).join(",")+"}",{text:t+=" "+e.value[1]+" "+1e3*e.value[0],expandable:!0}}))}))}},{key:"metricNameAndLabelsQuery",value:function(e){var t=this.datasource.getPrometheusTime(this.range.from,!1),r=this.datasource.getPrometheusTime(this.range.to,!0),n=new URLSearchParams({"match[]":e,start:t.toString(),end:r.toString()}),a="/api/v1/series?".concat(n.toString()),o=this;return this.datasource.metadataRequest(a).then((function(e){return b.a.map(e.data.data,(function(e){return{text:o.datasource.getOriginalMetricName(e),expandable:!0}}))}))}}])&&w(t.prototype,r),n&&w(t,n),e}(),j=r("iZOS");function k(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var P=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.templateSrv=t}var t,r,a;return t=e,(r=[{key:"transform",value:function(e,t){var r=e.data.data.result;if("table"===t.format)return[this.transformMetricDataToTable(r,t.responseListLength,t.refId,t.meta,t.valueWithRefId)];if(r&&"heatmap"===t.format){var n=[],a=!0,o=!1,i=void 0;try{for(var u,s=r[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var c=u.value;n.push(this.transformMetricData(c,t,t.start,t.end))}}catch(e){o=!0,i=e}finally{try{a||null==s.return||s.return()}finally{if(o)throw i}}return n.sort(E),n=this.transformToHistogramOverTime(n)}if(r){var l=[],f=!0,p=!1,m=void 0;try{for(var h,d=r[Symbol.iterator]();!(f=(h=d.next()).done);f=!0){var v=h.value;"matrix"===e.data.data.resultType?l.push(this.transformMetricData(v,t,t.start,t.end)):"vector"===e.data.data.resultType&&l.push(this.transformInstantMetricData(v,t))}}catch(e){p=!0,m=e}finally{try{f||null==d.return||d.return()}finally{if(p)throw m}}return l}return[]}},{key:"transformMetricData",value:function(e,t,r,n){var a=[],o=this.createLabelInfo(e.metric,t),i=o.name,u=o.labels,s=o.title,c=1e3*parseFloat(t.step),l=1e3*r;if(void 0===e.values)throw new Error("Prometheus heatmap error: data should be a time series");var f=!0,p=!1,m=void 0;try{for(var h,d=e.values[Symbol.iterator]();!(f=(h=d.next()).done);f=!0){var v=h.value,y=parseFloat(v[1]);b.a.isNaN(y)&&(y=null);for(var g=1e3*parseFloat(v[0]),O=l;O<g;O+=c)a.push([null,O]);l=g+c,a.push([y,g])}}catch(e){p=!0,m=e}finally{try{f||null==d.return||d.return()}finally{if(p)throw m}}for(var w=1e3*n,x=l;x<=w;x+=c)a.push([null,x]);return{datapoints:a,query:t.query,refId:t.refId,target:i,tags:u,title:s,meta:t.meta}}},{key:"transformMetricDataToTable",value:function(e,t,r,a,o){var i,u,s=new j.a;s.refId=r,s.meta=a;var c={};if(!e||0===e.length)return s;b.a.each(e,(function(e){for(var t in e.metric)c.hasOwnProperty(t)||(c[t]=1)}));var l=b.a.keys(c).sort();s.columns.push({text:"Time",type:n.FieldType.time}),b.a.each(l,(function(e,t){c[e]=t+1,s.columns.push({text:e,filterable:!0})}));var f=t>1||o?"Value #".concat(r):"Value";return s.columns.push({text:f}),b.a.each(e,(function(e){if(e.value&&(e.values=[e.value]),e.values)for(i=0;i<e.values.length;i++){var t=e.values[i],r=[1e3*t[0]];if(e.metric)for(u=0;u<l.length;u++){var n=l[u];e.metric.hasOwnProperty(n)?r.push(e.metric[n]):r.push("")}r.push(parseFloat(t[1])),s.rows.push(r)}})),s}},{key:"transformInstantMetricData",value:function(e,t){var r=[],n=this.createLabelInfo(e.metric,t),a=n.name,o=n.labels;return r.push([parseFloat(e.value[1]),1e3*e.value[0]]),{target:a,title:a,datapoints:r,tags:o,refId:t.refId,meta:t.meta}}},{key:"createLabelInfo",value:function(e,t){if(null==t?void 0:t.legendFormat){var r=this.renderTemplate(this.templateSrv.replace(t.legendFormat),e);return{name:r,title:r,labels:e}}var a=e.__name__,o=k(e,["__name__"]),i=a||"",u=Object(n.formatLabels)(o);return i||u||(i=t.query),{name:i="".concat(null!=a?a:"").concat(u),title:i,labels:o}}},{key:"getOriginalMetricName",value:function(e){var t=e.__name__||"";delete e.__name__;var r=Object.entries(e).map((function(e){return"".concat(e[0],'="').concat(e[1],'"')})).join(",");return"".concat(t,"{").concat(r,"}")}},{key:"renderTemplate",value:function(e,t){return e.replace(/\{\{\s*(.+?)\s*\}\}/g,(function(e,r){return t[r]?t[r]:""}))}},{key:"transformToHistogramOverTime",value:function(e){for(var t=e.length-1;t>0;t--){var r=e[t].datapoints,n=e[t-1].datapoints;if(!r||!n)throw new Error("Prometheus heatmap transform error: data should be a time series");for(var a=0;a<r.length;a++){var o=n[a]||[0];r[a][0]-=o[0]}}return e}}])&&_(t.prototype,r),a&&_(t,a),e}();function E(e,t){var r,n;try{r=S(e.target),n=S(t.target)}catch(e){return console.log(e),0}return r>n?1:r<n?-1:0}function S(e){return"+Inf"===e?1/0:Number(e)}var T=r("HyWp"),R=r.n(T),q=r("ceQ3"),C=r("itod");function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Q(e,t,r,n,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,a)}function L(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Q(o,n,a,i,u,"next",e)}function u(e){Q(o,n,a,i,u,"throw",e)}i(void 0)}))}}function M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function H(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){V(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function V(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var B=["job","instance"],$=function(e){return{label:e}},G=function(e){return e.kind="function",e};var W=/(="|!="|=~"|!~"|\{|\[|\(|\+|-|\/|\*|%|\^|\band\b|\bor\b|\bunless\b|==|>=|!=|<=|>|<|=|~|,)/,K=function(e){function t(e,r){var a,o,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,i=F(t).call(this),(a=!i||"object"!==D(i)&&"function"!=typeof i?A(o):i).labelsCache=new R.a(10),a.request=function(){var e=L(regeneratorRuntime.mark((function e(t,r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.datasource.metadataRequest(t);case 3:return n=e.sent,e.next=6,n.data||n.json();case 6:return o=e.sent,e.abrupt("return",o.data);case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:return e.abrupt("return",r);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,r){return e.apply(this,arguments)}}(),a.start=L(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.datasource.lookupsDisabled){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,a.request("/api/v1/label/__name__/values",[]);case 4:return a.metrics=e.sent,a.lookupsDisabled=a.metrics.length>a.lookupMetricsThreshold,e.t0=q.b,e.next=9,a.request("/api/v1/metadata",{});case 9:return e.t1=e.sent,a.metricsMetadata=(0,e.t0)(e.t1),a.processHistogramMetrics(a.metrics),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e)}))),a.processHistogramMetrics=function(e){var t=Object(q.e)(e).values;t&&t.__name__&&(a.histogramMetrics=t.__name__.slice().sort())},a.provideCompletionItems=function(){var e=L(regeneratorRuntime.mark((function e(t){var r,n,o,i,u,s,c,l,f,p,m,h,d,v,y,g,b=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.prefix,n=t.text,o=t.value,i=t.labelKey,u=t.wrapperClasses,s=b.length>1&&void 0!==b[1]?b[1]:{history:[]},c=0===o.document.text.length,l=o.document.getTextsAtRange(o.selection),f=1===l.size?l.first().getText():null,p=f?f[o.selection.anchor.offset]:null,m=u.length>3,h=r&&!m,d=!p||")"===p,v=r&&!n.match(/^[\]})\s]+$/)&&d,y=/[+\-*/^%]/,g=n.match(y),!u.includes("context-range")){e.next=16;break}return e.abrupt("return",a.getRangeCompletionItems());case 16:if(!u.includes("context-labels")){e.next=20;break}return e.abrupt("return",a.getLabelCompletionItems({prefix:r,text:n,value:o,labelKey:i,wrapperClasses:u}));case 20:if(!u.includes("context-aggregation")){e.next=24;break}return e.abrupt("return",a.getAggregationCompletionItems(o));case 24:if(!c){e.next=28;break}return e.abrupt("return",a.getEmptyCompletionItems(s));case 28:if(!h||!d||g){e.next=32;break}return e.abrupt("return",a.getBeginningCompletionItems(s));case 32:if(!h||!v){e.next=34;break}return e.abrupt("return",a.getTermCompletionItems());case 34:return e.abrupt("return",{suggestions:[]});case 35:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.getBeginningCompletionItems=function(e){return{suggestions:[].concat(I(a.getEmptyCompletionItems(e).suggestions),I(a.getTermCompletionItems().suggestions))}},a.getEmptyCompletionItems=function(e){var t=e.history,r=[];if(t&&t.length){var a=b.a.chain(t).map((function(e){return e.query.expr})).filter().uniq().take(5).map($).map((function(e){return function(e,t){var r=Date.now()-864e5,a=t.filter((function(t){return t.ts>r&&t.query===e.label})),o=a.length,i=a[0],u="Queried ".concat(o," times in the last 24h.");if(i){var s=Object(n.dateTime)(i.ts).fromNow();u="".concat(u," Last queried ").concat(s,".")}return H({},e,{documentation:u})}(e,t)})).value();r.push({prefixMatch:!0,skipSort:!0,label:"History",items:a})}return{suggestions:r}},a.getTermCompletionItems=function(){var e=A(a),t=e.metrics,r=e.metricsMetadata,n=[];return n.push({prefixMatch:!0,label:"Functions",items:C.a.map(G)}),t&&t.length&&n.push({label:"Metrics",items:t.map((function(e){return function(e,t){var r={label:e};if(t&&t[e]){var n=t[e][0],a=n.type,o=n.help;r.documentation="".concat(a.toUpperCase(),": ").concat(o)}return r}(e,r)}))}),{suggestions:n}},a.getAggregationCompletionItems=function(){var e=L(regeneratorRuntime.mark((function e(t){var r,n,o,i,u,s,c,l,f,p,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],o=t.document.getBlocks().reduce((function(e,r){var a=r.getText();return t.anchorBlock.key===r.key&&(n=t.selection.anchor.offset+e.length),e+a}),""),i=o.lastIndexOf("(",n),u=o.lastIndexOf("(",i-1),s=o.indexOf(")",u),-1===u&&(c=o.indexOf(")",n),s=o.indexOf(")",c+1),u=o.lastIndexOf("(",s)),l={suggestions:r,context:"context-aggregation"},-1!==u){e.next=9;break}return e.abrupt("return",l);case 9:return f=o.slice(u+1,s).replace(/\[[^\]]+\]$/,""),p=Object(q.d)(f,f.length-2).selector,e.next=13,a.getLabelValues(p);case 13:return(m=e.sent)&&r.push({label:"Labels",items:Object.keys(m).map($)}),e.abrupt("return",l);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.getLabelCompletionItems=function(){var e=L(regeneratorRuntime.mark((function e(t){var r,n,o,i,u,s,c,l,f,p,m,h,d,v,y,g,O,w,x,j,k,_,P;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.text,n=t.wrapperClasses,o=t.labelKey,i=t.value,u=[],s=i.anchorBlock.getText(),c=i.selection.anchor.offset,l=s.substr(c),f=s.substr(0,c),p=r.match(/^(=|=~|!=|!~)/),m=l.match(/^"?[,}]/),h=f.match(/(=|=~|!=|!~)$/)&&l.match(/^"/),d=m&&!p,(p&&m||d)&&!h){e.next=13;break}return e.abrupt("return",{suggestions:u});case 13:try{y=Object(q.d)(s,c),v=y.selector}catch(e){v="{}"}if(g=v.includes("__name__="),O=y?y.labelKeys:[],!v){e.next=20;break}return e.next=19,a.getLabelValues(v,!g);case 19:w=e.sent;case 20:if(w){e.next=23;break}return console.warn("Server did not return any values for selector = ".concat(v)),e.abrupt("return",{suggestions:u});case 23:return r&&p||n.includes("attr-value")?o&&w[o]&&(x="context-label-values",u.push({label:'Label values for "'.concat(o,'"'),items:w[o].map($)})):(j=w?Object.keys(w):g?null:B)&&(k=b.a.difference(j,O)).length&&(x="context-labels",_=k.map((function(e){return{label:e}})),P={label:"Labels",items:_},u.push(P)),e.abrupt("return",{context:x,suggestions:u});case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.fetchLabelValues=function(){var e=L(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.request("/api/v1/label/".concat(t,"/values"),[]);case 2:return r=e.sent,e.abrupt("return",V({},t,r));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.fetchSeriesLabels=function(){var e=L(regeneratorRuntime.mark((function e(t,r){var n,o,i,u,s,c,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.datasource.getTimeRange(),o=new URLSearchParams({"match[]":t,start:n.start.toString(),end:n.end.toString()}),i="/api/v1/series?".concat(o.toString()),o.set("start",a.roundToMinutes(n.start).toString()),o.set("end",a.roundToMinutes(n.end).toString()),o.append("withName",r?"true":"false"),u="/api/v1/series?".concat(o.toString()),s=a.labelsCache.get(u)){e.next=15;break}return e.next=11,a.request(i,[]);case 11:c=e.sent,l=Object(q.f)(c,r),f=l.values,s=f,a.labelsCache.set(u,s);case 15:return e.abrupt("return",s);case 16:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),a.fetchDefaultLabels=b.a.once(L(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(B.map((function(e){return a.fetchLabelValues(e)})));case 2:return t=e.sent,e.abrupt("return",t.reduce((function(e,t){return H({},e,{},t)}),{}));case 4:case"end":return e.stop()}}),e)})))),a.datasource=e,a.histogramMetrics=[],a.timeRange={start:0,end:0},a.metrics=[],a.lookupMetricsThreshold=1e4,a.lookupsDisabled=!0,Object.assign(A(a),r),a}var r,a,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(t,e),r=t,(a=[{key:"cleanText",value:function(e){return e.split(W).pop().trimLeft().replace(/"$/,"").replace(/^"/,"")}},{key:"getRangeCompletionItems",value:function(){return{context:"context-range",suggestions:[{label:"Range vector",items:I(C.b)}]}}},{key:"getLabelValues",value:(i=L(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.lookupsDisabled){e.next=2;break}return e.abrupt("return",void 0);case 2:if(e.prev=2,"{}"!==t){e.next=9;break}return e.next=6,this.fetchDefaultLabels();case 6:return e.abrupt("return",e.sent);case 9:return e.next=11,this.fetchSeriesLabels(t,r);case 11:return e.abrupt("return",e.sent);case 12:e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(2),console.error(e.t0),e.abrupt("return",void 0);case 18:case"end":return e.stop()}}),e,this,[[2,14]])}))),function(e,t){return i.apply(this,arguments)})},{key:"roundToMinutes",value:function(e){return Math.floor(e/60)}},{key:"syntax",get:function(){return C.c}}])&&M(r.prototype,a),o&&M(r,o),t}(n.LanguageProvider),z=r("t8hP"),X=r("eqT+");function Y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function J(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z(e,t,r){var n=[];if(e.trim().match(/^\w+_bucket$/)){n.push({type:"HISTOGRAM_QUANTILE",label:"Time series has buckets, you probably wanted a histogram.",fix:{label:"Fix by adding histogram_quantile().",action:{type:"ADD_HISTOGRAM_QUANTILE",query:e}}})}if(-1===e.indexOf("rate(")&&-1===e.indexOf("increase(")){var a,o=e.match(/\b(\w+_(total|sum|count))\b/),i=o?o[1]:"",u=null==r?void 0:null===(a=r.languageProvider)||void 0===a?void 0:a.metricsMetadata,s=!1;if(b.a.size(u)>0&&(i=Object.keys(u).find((function(t){if("counter"===u[t][0].type.toLowerCase()){var r=new RegExp("\\b".concat(t,"\\b"));if(e.match(r))return s=!0,!0}return!1}))),i){var c,l=e.trim().match(/^\w+$/),f=s?"is":"looks like",p="Metric ".concat(i," ").concat(f," a counter.");l?c={label:"Fix by adding rate().",action:{type:"ADD_RATE",query:e}}:p="".concat(p," Try applying a rate() function."),n.push({type:"APPLY_RATE",label:p,fix:c})}}if(r&&r.ruleMappings){var m=r.ruleMappings,h=Object.keys(m).reduce((function(t,r){return e.search(r)>-1?function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(r),!0).forEach((function(t){J(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,J({},r,m[r])):t}),{});if(b.a.size(h)>0){n.push({type:"EXPAND_RULES",label:"Query contains recording rules.",fix:{label:"Expand rules",action:{type:"EXPAND_RULES",query:e,mapping:h}}})}}t&&t.length>=20&&(e.trim().match(/^\w+$/)&&n.push({type:"ADD_SUM",label:"Many time series results returned.",fix:{label:"Consider aggregating with sum().",action:{type:"ADD_SUM",query:e,preventSubmit:!0}}}));return n.length>0?n:null}var ee=r("m257"),te=r("5kRJ");function re(e){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ne(e,t,r,n,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,a)}function ae(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){ne(o,n,a,i,u,"next",e)}function u(e){ne(o,n,a,i,u,"throw",e)}i(void 0)}))}}function oe(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==u.return||u.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ue(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(r),!0).forEach((function(t){ce(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ue(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ce(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function le(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fe(e){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function me(e,t){return(me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var he=function(e){function t(e){var r,a,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,i=fe(t).call(this,e),(r=!i||"object"!==re(i)&&"function"!=typeof i?pe(a):i).init=function(){r.loadRules()},r.processResult=function(e,t,n,a){var o={format:n.format,step:t.step,legendFormat:n.legendFormat,start:t.start,end:t.end,query:t.expr,responseListLength:a,refId:n.refId,valueWithRefId:n.valueWithRefId,meta:{preferredVisualisationType:t.instant?"table":"graph"}};return r.resultTransformer.transform(e,o)},r.prepareTargets=function(e,t,a){var i=[],u=[],s=!0,c=!1,l=void 0;try{for(var f,p=e.targets[Symbol.iterator]();!(s=(f=p.next()).done);s=!0){var m=f.value;if(m.expr&&!m.hide)if(m.requestId=e.panelId+m.refId,e.app===n.CoreApp.Explore){if(m.showingTable){var h=o()(m);h.format="table",h.instant=!0,h.valueWithRefId=!0,delete h.maxDataPoints,h.requestId+="_instant",u.push(h),i.push(r.createQuery(h,e,t,a))}m.showingGraph&&(m.format="time_series",m.instant=!1,u.push(m),i.push(r.createQuery(m,e,t,a)))}else u.push(m),i.push(r.createQuery(m,e,t,a))}}catch(e){c=!0,l=e}finally{try{s||null==p.return||p.return()}finally{if(c)throw l}}return{queries:i,activeTargets:u}},r.handleErrors=function(e,t){var r={message:e&&e.statusText||"Unknown error during query transaction. Please check JS console logs.",refId:t.refId};return e.data?"string"==typeof e.data?r.message=e.data:e.data.error&&(r.message=Object(ee.t)(e.data.error)):e.message?r.message=e.message:"string"==typeof e&&(r.message=e),r.status=e.status,r.statusText=e.statusText,r},r.createAnnotationQueryOptions=function(e){var t=e.annotation;return se({},e,{interval:t&&t.step&&"string"==typeof t.step?t.step:"60s"})},r.type="prometheus",r.editorSrc="app/features/prometheus/partials/query.editor.html",r.url=e.url,r.basicAuth=e.basicAuth,r.withCredentials=e.withCredentials,r.interval=e.jsonData.timeInterval||"15s",r.queryTimeout=e.jsonData.queryTimeout,r.httpMethod=e.jsonData.httpMethod||"GET",r.directUrl=e.jsonData.directUrl,r.resultTransformer=new P(te.b),r.ruleMappings={},r.languageProvider=new K(pe(r)),r.lookupsDisabled=e.jsonData.disableMetricsLookup,r.customQueryParameters=new URLSearchParams(e.jsonData.customQueryParameters),r}var r,a,i,s,g,b,w,j,k;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&me(e,t)}(t,e),r=t,(a=[{key:"getQueryDisplayText",value:function(e){return e.expr}},{key:"_addTracingHeaders",value:function(e,t){e.headers={},!this.url.match(/^http/)&&(e.headers["X-Dashboard-Id"]=t.dashboardId,e.headers["X-Panel-Id"]=t.panelId)}},{key:"_request",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return"GET"===(r=u()(r||{},{url:this.url+e,method:this.httpMethod,headers:{}})).method?t&&Object.keys(t).length&&(r.url=r.url+"?"+Object.entries(t).map((function(e){var t=ie(e,2),r=t[0],n=t[1];return"".concat(encodeURIComponent(r),"=").concat(encodeURIComponent(n))})).join("&")):(r.headers["Content-Type"]="application/x-www-form-urlencoded",r.transformRequest=function(e){return c.a.param(e)},r.data=t),(this.basicAuth||this.withCredentials)&&(r.withCredentials=!0),this.basicAuth&&(r.headers.Authorization=this.basicAuth),Object(z.getBackendSrv)().datasourceRequest(r)}},{key:"metadataRequest",value:function(e){return this._request(e,null,{method:"GET",silent:!0})}},{key:"interpolateQueryExpr",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(!t.multi&&!t.includeAll)return ve(e);if("string"==typeof e)return ye(e);var r=e.map((function(e){return ye(e)}));return r.join("|")}},{key:"targetContainsTemplate",value:function(e){return te.b.variableExists(e.expr)}},{key:"query",value:function(e){var t=this.getPrometheusTime(e.range.from,!1),r=this.getPrometheusTime(e.range.to,!0),a=this.prepareTargets(e,t,r),o=a.queries,i=a.activeTargets;return o&&o.length?e.app===n.CoreApp.Explore?this.exploreQuery(o,i,r):this.panelsQuery(o,i,r,e.requestId):Object(f.a)({data:[],state:n.LoadingState.Done})}},{key:"exploreQuery",value:function(e,t,r){var a=this,o=e.length,i=e.map((function(i,u){var s=t[u];return(i.instant?Object(p.a)(a.performInstantQuery(i,r)):Object(p.a)(a.performTimeSeriesQuery(i,i.start,i.end))).pipe(Object(d.a)((function(){return o--})),Object(v.a)((function(e){return!e.cancelled})),Object(y.a)((function(t){return{data:a.processResult(t,i,s,e.length),key:i.requestId,state:0===o?n.LoadingState.Done:n.LoadingState.Loading}})))}));return m.a.apply(void 0,oe(i))}},{key:"panelsQuery",value:function(e,t,r,a){var o=this,i=e.map((function(n,a){var i=t[a];return(n.instant?Object(p.a)(o.performInstantQuery(n,r)):Object(p.a)(o.performTimeSeriesQuery(n,n.start,n.end))).pipe(Object(v.a)((function(e){return!e.cancelled})),Object(y.a)((function(t){return o.processResult(t,n,i,e.length)})))}));return Object(h.a)(i).pipe(Object(y.a)((function(e){return{data:e.reduce((function(e,t){return[].concat(oe(e),oe(t))}),[]),key:a,state:n.LoadingState.Done}})))}},{key:"createQuery",value:function(e,t,r,n){var a={hinting:e.hinting,instant:e.instant,step:0,expr:"",requestId:e.requestId,refId:e.refId,start:0,end:0},o=Math.ceil(n-r),i=l.a.interval_to_seconds(t.interval),u=l.a.interval_to_seconds(te.b.replace(e.interval,t.scopedVars)||t.interval),s=e.intervalFactor||1,c=this.adjustInterval(i,u,o,s),f=se({},t.scopedVars,{},this.getRangeScopedVars(t.range));i!==c&&(i=c,f=Object.assign({},t.scopedVars,se({__interval:{text:i+"s",value:i+"s"},__interval_ms:{text:1e3*i,value:1e3*i}},this.getRangeScopedVars(t.range)))),a.step=i;var p=e.expr;p=te.b.getAdhocFilters(this.name).reduce((function(e,t){var r=t.key,n=t.operator,a=t.value;return"=~"!==n&&"!~"!==n||(a=ve(a)),Object(X.b)(e,r,a,n)}),p),a.expr=te.b.replace(p,f,this.interpolateQueryExpr);var m=function(e,t,r,n){var a=Math.floor((t+n)/r)*r-n,o=Math.floor((e+n)/r)*r-n;return{end:a,start:o}}(r,n,a.step,60*Object(O.a)().timeRange().to.utcOffset());return a.start=m.start,a.end=m.end,this._addTracingHeaders(a,t),a}},{key:"adjustInterval",value:function(e,t,r,n){var a=r/11e3;return a>1&&(a=Math.ceil(a)),Math.max(e*n,t,a)}},{key:"performTimeSeriesQuery",value:function(e,t,r){var n=this;if(t>r)throw{message:"Invalid time range"};var a={query:e.expr,start:t,end:r,step:e.step};this.queryTimeout&&(a.timeout=this.queryTimeout);var o=!0,i=!1,u=void 0;try{for(var s,c=this.customQueryParameters[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var l=ie(s.value,2),f=l[0],p=l[1];null==a[f]&&(a[f]=p)}}catch(e){i=!0,u=e}finally{try{o||null==c.return||c.return()}finally{if(i)throw u}}return this._request("/api/v1/query_range",a,{requestId:e.requestId,headers:e.headers}).catch((function(t){if(t.cancelled)return t;throw n.handleErrors(t,e)}))}},{key:"performInstantQuery",value:function(e,t){var r=this,n={query:e.expr,time:t};this.queryTimeout&&(n.timeout=this.queryTimeout);var a=!0,o=!1,i=void 0;try{for(var u,s=this.customQueryParameters[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var c=ie(u.value,2),l=c[0],f=c[1];null==n[l]&&(n[l]=f)}}catch(e){o=!0,i=e}finally{try{a||null==s.return||s.return()}finally{if(o)throw i}}return this._request("/api/v1/query",n,{requestId:e.requestId,headers:e.headers}).catch((function(t){if(t.cancelled)return t;throw r.handleErrors(t,e)}))}},{key:"performSuggestQuery",value:(k=ae(regeneratorRuntime.mark((function e(t){var r,n,a=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.length>1&&void 0!==a[1]&&a[1]&&(null===(r=this.metricsNameCache)||void 0===r?void 0:r.expire)>Date.now())){e.next=3;break}return e.abrupt("return",this.metricsNameCache.data.filter((function(e){return 1!==e.indexOf(t)})));case 3:return e.next=5,this.metadataRequest("/api/v1/label/__name__/values");case 5:return n=e.sent,this.metricsNameCache={data:n.data.data,expire:Date.now()+6e4},e.abrupt("return",n.data.data.filter((function(e){return 1!==e.indexOf(t)})));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"metricFindQuery",value:function(e){if(!e)return Promise.resolve([]);var t=se({__interval:{text:this.interval,value:this.interval},__interval_ms:{text:l.a.interval_to_ms(this.interval),value:l.a.interval_to_ms(this.interval)}},this.getRangeScopedVars(Object(O.a)().timeRange())),r=te.b.replace(e,t,this.interpolateQueryExpr),n=new x(this,r);return n.process()}},{key:"getRangeScopedVars",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(O.a)().timeRange(),t=e.to.diff(e.from),r=Math.round(t/1e3);return{__range_ms:{text:t,value:t},__range_s:{text:r,value:r},__range:{text:r+"s",value:r+"s"}}}},{key:"annotationQuery",value:(j=ae(regeneratorRuntime.mark((function e(t){var r,n,a,o,i,u,s,c,l,f,p,m,h,d,v,y,g,b,O,w,x,j;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.annotation,i=o.expr,u=void 0===i?"":i,s=o.tagKeys,c=void 0===s?"":s,l=o.titleFormat,f=void 0===l?"":l,p=o.textFormat,m=void 0===p?"":p,u){e.next=4;break}return e.abrupt("return",Promise.resolve([]));case 4:return h=this.getPrometheusTime(t.range.from,!1),d=this.getPrometheusTime(t.range.to,!0),v=this.createAnnotationQueryOptions(t),y={expr:u,interval:"1s",refId:"X",requestId:"prom-query-".concat(o.name)},g=this.createQuery(y,v,h,d),b=this,e.next=13,this.performTimeSeriesQuery(g,g.start,g.end);case 13:if(O=e.sent,w=[],x=c.split(","),!O.cancelled){e.next=18;break}return e.abrupt("return",[]);case 18:return j=1e3*Math.floor(g.step),null==O||null===(r=O.data)||void 0===r||null===(n=r.data)||void 0===n||null===(a=n.result)||void 0===a||a.forEach((function(e){var t=Object.entries(e.metric).filter((function(e){var t=ie(e,1)[0];return x.includes(t)})).map((function(e){var t=ie(e,2);return t[0],t[1]}));e.values.forEach((function(e){var t;o.useValueForTime?(t=Math.floor(parseFloat(e[1])),e[1]=1):t=1e3*Math.floor(parseFloat(e[0])),e[0]=t}));var r=e.values.filter((function(e){return parseFloat(e[1])>=1})).map((function(e){return e[0]})),n=null;r.forEach((function(r){n&&n.timeEnd+j>=r?n.timeEnd=r:(n&&w.push(n),n={time:r,timeEnd:r,annotation:o,title:b.resultTransformer.renderTemplate(f,e.metric),tags:t,text:b.resultTransformer.renderTemplate(m,e.metric)})})),n&&(n.timeEnd=r[r.length-1],w.push(n))})),e.abrupt("return",w);case 21:case"end":return e.stop()}}),e,this)}))),function(e){return j.apply(this,arguments)})},{key:"getTagKeys",value:(w=ae(regeneratorRuntime.mark((function e(){var t,r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.metadataRequest("/api/v1/labels");case 2:return a=e.sent,e.abrupt("return",null!==(t=null==a?void 0:null===(r=a.data)||void 0===r?void 0:null===(n=r.data)||void 0===n?void 0:n.map((function(e){return{text:e}})))&&void 0!==t?t:[]);case 4:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"getTagValues",value:(b=ae(regeneratorRuntime.mark((function e(){var t,r,n,a,o,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.length>0&&void 0!==i[0]?i[0]:{},e.next=3,this.metadataRequest("/api/v1/label/".concat(a.key,"/values"));case 3:return o=e.sent,e.abrupt("return",null!==(t=null==o?void 0:null===(r=o.data)||void 0===r?void 0:null===(n=r.data)||void 0===n?void 0:n.map((function(e){return{text:e}})))&&void 0!==t?t:[]);case 5:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"testDatasource",value:(g=ae(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(new Date).getTime(),r={expr:"1+1"},e.next=4,this.performInstantQuery(r,t/1e3);case 4:return n=e.sent,e.abrupt("return","success"===n.data.status?{status:"success",message:"Data source is working"}:{status:"error",message:n.error});case 6:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"interpolateVariablesInQueries",value:function(e,t){var r=this,n=e;return e&&e.length&&(n=e.map((function(e){return se({},e,{datasource:r.name,expr:te.b.replace(e.expr,t,r.interpolateQueryExpr)})}))),n}},{key:"getQueryHints",value:function(e,t){var r;return Z(null!==(r=e.expr)&&void 0!==r?r:"",t,this)}},{key:"loadRules",value:(s=ae(regeneratorRuntime.mark((function e(){var t,r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.metadataRequest("/api/v1/rules");case 3:r=e.sent,n=r.data||r.json(),(a=null==n?void 0:null===(t=n.data)||void 0===t?void 0:t.groups)&&(this.ruleMappings=de(a)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("Rules API is experimental. Ignore next error."),console.error(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return s.apply(this,arguments)})},{key:"modifyQuery",value:function(e,t){var r,n=null!==(r=e.expr)&&void 0!==r?r:"";switch(t.type){case"ADD_FILTER":n=Object(X.b)(n,t.key,t.value);break;case"ADD_HISTOGRAM_QUANTILE":n="histogram_quantile(0.95, sum(rate(".concat(n,"[5m])) by (le))");break;case"ADD_RATE":n="rate(".concat(n,"[5m])");break;case"ADD_SUM":n="sum(".concat(n.trim(),") by ($1)");break;case"EXPAND_RULES":t.mapping&&(n=Object(q.a)(n,t.mapping))}return se({},e,{expr:n})}},{key:"getPrometheusTime",value:function(e,t){return"string"==typeof e&&(e=n.dateMath.parse(e,t)),Math.ceil(e.valueOf()/1e3)}},{key:"getTimeRange",value:function(){var e=Object(O.a)().timeRange();return{start:this.getPrometheusTime(e.from,!1),end:this.getPrometheusTime(e.to,!0)}}},{key:"getOriginalMetricName",value:function(e){return this.resultTransformer.getOriginalMetricName(e)}}])&&le(r.prototype,a),i&&le(r,i),t}(n.DataSourceApi);function de(e){return e.reduce((function(e,t){return t.rules.filter((function(e){return"recording"===e.type})).reduce((function(e,t){return se({},e,ce({},t.name,t.query))}),e)}),{})}function ve(e){return"string"==typeof e?e.replace(/'/g,"\\\\'"):e}function ye(e){return"string"==typeof e?ve(e.replace(/\\/g,"\\\\\\\\").replace(/[$^*{}\[\]+?.()|]/g,"\\\\$&")):e}var ge=r("q1tI"),be=r.n(ge),Oe=r("kDLi"),we=r("wZee"),xe=r.n(we),je=r("sGFA");function ke(e){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _e(e,t,r,n,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,a)}function Pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ee(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Se(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Te(e,t){return!t||"object"!==ke(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Re(e){return(Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qe(e,t){return(qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ce(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var De="__histograms__";function Ie(e,t){var r=t.typeaheadContext,n=t.typeaheadText;switch(r){case"context-labels":var a=Oe.DOMUtil.getNextCharacter();a&&"}"!==a&&","!==a||(e+="=");break;case"context-label-values":n.match(/^(!?=~?"|")/)||(e='"'.concat(e)),'"'!==Oe.DOMUtil.getNextCharacter()&&(e="".concat(e,'"'))}return e}var Qe=function(e){function t(e,r){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=Te(this,Re(t).call(this,e,r))).refreshHint=function(){var e=a.props,t=e.datasource,r=e.query,o=e.data;if(o&&0!==o.series.length){var i=Object(n.isDataFrame)(o.series[0])?o.series.map(n.toLegacyResponseData):o.series,u=t.getQueryHints(r,i),s=u&&u.length>0?u[0]:null;a.setState({hint:s})}else a.setState({hint:null})},a.refreshMetrics=function(){var e=a.props.datasource.languageProvider;a.setState({syntaxLoaded:!1}),xe.a.languages.promql=e.syntax,a.languageProviderInitializationPromise=Object(je.a)(e.start()),a.languageProviderInitializationPromise.promise.then((function(e){e.map((function(e){return e.then(a.onUpdateLanguage).catch((function(){}))}))})).then((function(){return a.onUpdateLanguage()})).catch((function(e){if(!e.isCanceled)throw e}))},a.onChangeMetrics=function(e,t){var r;if(1===t.length){var n=t[0];if(n.children&&0!==n.children.length)return;r=n.value}else{var o=t[0].value,i=t[1].value;r=o===De?"histogram_quantile(0.95, sum(rate(".concat(i,"[5m])) by (le))"):i}a.onChangeQuery(r,!0)},a.onChangeQuery=function(e,t){var r=a.props,n=r.query,o=r.onChange,i=r.onRunQuery;o&&(o(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(r),!0).forEach((function(t){Ee(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},n,{expr:e})),t&&i&&i())},a.onClickHintFix=function(){var e=a.props,t=e.datasource,r=e.query,n=e.onChange,o=e.onRunQuery,i=a.state.hint;n(t.modifyQuery(r,i.fix.action)),o()},a.onUpdateLanguage=function(){var e=a.props,t=e.datasource,r=e.datasource.languageProvider,n=r.histogramMetrics,o=r.metrics,i=r.metricsMetadata,u=r.lookupMetricsThreshold;if(o){var s,c=function(e,t){var r=/:\w+:/,n=e.filter((function(e){return r.test(e)})),a={label:"Recording rules",value:"__recording_rules__",children:n.slice().sort().map((function(e){return{label:e,value:e}}))},o=n.length>0?[a]:[],i=b.a.chain(e).filter((function(e){return!r.test(e)})).groupBy((function(e){return e.split("_")[0]})).map((function(e,r){return{children:1===e.length&&e[0]===r?[]:e.sort().map((function(e){return function(e,t){var r={label:e,value:e};if(t&&t[e]){var n=t[e][0],a=n.type,o=void 0===a?"":a,i=n.help;r.title=[e,o.toUpperCase(),i].join("\n")}return r}(e,t)})),label:r,value:r}})).sortBy("label").value();return[].concat(o,Ce(i))}(o,i),l=n.map((function(e){return{label:e,value:e}})),f=n.length>0?[{label:"Histograms",value:De,children:l,isLeaf:!1}].concat(Ce(c)):c;!t.lookupsDisabled&&r.lookupsDisabled&&(s={label:"Dynamic label lookup is disabled for datasources with more than ".concat(u," metrics."),type:"INFO"}),a.setState({hint:s,metricsOptions:f,syntaxLoaded:!0})}},a.onTypeahead=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var r,n,o,i,u,s,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.props.datasource.languageProvider){e.next=3;break}return e.abrupt("return",{suggestions:[]});case 3:return n=a.props.history,o=t.prefix,i=t.text,u=t.value,s=t.wrapperClasses,c=t.labelKey,e.next=7,r.provideCompletionItems({text:i,value:u,prefix:o,wrapperClasses:s,labelKey:c},{history:n});case 7:return l=e.sent,e.abrupt("return",l);case 9:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){_e(o,n,a,i,u,"next",e)}function u(e){_e(o,n,a,i,u,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),a.plugins=[Object(Oe.BracesPlugin)(),Object(Oe.SlatePrism)({onlyIn:function(e){return"code_block"===e.type},getSyntax:function(e){return"promql"}})],a.state={metricsOptions:[],syntaxLoaded:!1,hint:null},a}var r,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qe(e,t)}(t,e),r=t,(a=[{key:"componentDidMount",value:function(){this.props.datasource.languageProvider&&this.refreshMetrics(),this.refreshHint()}},{key:"componentWillUnmount",value:function(){this.languageProviderInitializationPromise&&this.languageProviderInitializationPromise.cancel()}},{key:"componentDidUpdate",value:function(e){var t=this.props,r=t.data;t.datasource.languageProvider!==e.datasource.languageProvider&&this.refreshMetrics(),r&&e.data&&e.data.series!==r.series&&this.refreshHint()}},{key:"render",value:function(){var e,t,r,n=this.props,a=n.datasource,o=n.datasource.languageProvider,i=n.query,u=n.ExtraFieldElement,s=this.state,c=s.metricsOptions,l=s.syntaxLoaded,f=s.hint,p=o?o.cleanText:void 0,m=(e=a.lookupsDisabled,t=l,r=c,e?"(Disabled)":t?r&&0===r.length?"(No metrics found)":"Metrics":"Loading metrics..."),h=!(l&&c&&c.length>0);return be.a.createElement(be.a.Fragment,null,be.a.createElement("div",{className:"gf-form-inline gf-form-inline--nowrap flex-grow-1"},be.a.createElement("div",{className:"gf-form flex-shrink-0"},be.a.createElement(Oe.ButtonCascader,{options:c,disabled:h,onChange:this.onChangeMetrics},m)),be.a.createElement("div",{className:"gf-form gf-form--grow flex-shrink-1"},be.a.createElement(Oe.QueryField,{additionalPlugins:this.plugins,cleanText:p,query:i.expr,onTypeahead:this.onTypeahead,onWillApplySuggestion:Ie,onBlur:this.props.onBlur,onChange:this.onChangeQuery,onRunQuery:this.props.onRunQuery,placeholder:"Enter a PromQL query (run with Shift+Enter)",portalOrigin:"prometheus",syntaxLoaded:l})),u),f?be.a.createElement("div",{className:"query-row-break"},be.a.createElement("div",{className:"prom-query-field-info text-warning"},f.label," ",f.fix?be.a.createElement("a",{className:"text-link muted",onClick:this.onClickHintFix},f.fix.label):null)):null)}}])&&Se(r.prototype,a),o&&Se(r,o),t}(be.a.PureComponent),Le=r("WnbS");function Me(e){return(Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(e,t,r,n,a,o,i){try{var u=e[o](i),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,a)}function Ae(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Fe(o,n,a,i,u,"next",e)}function u(e){Fe(o,n,a,i,u,"throw",e)}i(void 0)}))}}function Ne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ue(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function He(e,t){return!t||"object"!==Me(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ve(e){return(Ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Be(e,t){return(Be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $e=function(e){function t(){var e,r;Ne(this,t);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(r=He(this,(e=Ve(t)).call.apply(e,[this].concat(a)))).state={href:null},r}var r,n,a,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Be(e,t)}(t,e),r=t,(n=[{key:"componentDidUpdate",value:(i=Ae(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.props.panelData)||!r.request||t.panelData===r){e.next=6;break}return e.next=4,this.getExternalLink(r);case 4:n=e.sent,this.setState({href:n});case 6:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getExternalLink",value:(o=Ae(regeneratorRuntime.mark((function e(t){var r,n,a,o,i,u,s,c,l,f,p,m,h,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.props.query,n=t.request){e.next=4;break}return e.abrupt("return","");case 4:if(a=n.targets.length>0?n.targets[0]:{datasource:null},!(o=a.datasource)){e.next=12;break}return e.next=9,Object(Le.a)().get(o);case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=this.props.datasource;case 13:return i=e.t0,u=n.range,s=i.getPrometheusTime(u.from,!1),c=i.getPrometheusTime(u.to,!0),l=Math.ceil(c-s),f=u.to.utc().format("YYYY-MM-DD HH:mm"),p={interval:n.interval},m=i.createQuery(r,p,s,c),h={"g0.expr":m.expr,"g0.range_input":l+"s","g0.end_input":f,"g0.step_input":m.step,"g0.tab":0},d=b.a.map(h,(function(e,t){return t+"="+encodeURIComponent(e)})).join("&"),e.abrupt("return","".concat(i.directUrl,"/graph?").concat(d));case 24:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"render",value:function(){var e=this.state.href;return be.a.createElement("a",{href:e,target:"_blank",rel:"noopener"},"Prometheus")}}])&&Ue(r.prototype,n),a&&Ue(r,a),t}(ge.Component);function Ge(e){return(Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function We(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ke(e){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ze(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xe(e,t){return(Xe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ye=Oe.LegacyForms.Switch,Je=[{label:"Time series",value:"time_series"},{label:"Table",value:"table"},{label:"Heatmap",value:"heatmap"}],Ze=b.a.map([1,2,3,4,5,10],(function(e){return{value:e,label:"1/"+e}})),et=function(e){function t(e){var r,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,a=Ke(t).call(this,e),(r=!a||"object"!==Ge(a)&&"function"!=typeof a?ze(n):a).onFieldChange=function(e,t){r.query.expr=e.expr},r.onFormatChange=function(e){r.query.format=e.value,r.setState({formatOption:e},r.onRunQuery)},r.onInstantChange=function(e){var t=e.target.checked;r.query.instant=t,r.setState({instant:t},r.onRunQuery)},r.onIntervalChange=function(e){var t=e.currentTarget.value;r.query.interval=t,r.setState({interval:t})},r.onIntervalFactorChange=function(e){r.query.intervalFactor=e.value,r.setState({intervalFactorOption:e},r.onRunQuery)},r.onLegendChange=function(e){var t=e.currentTarget.value;r.query.legendFormat=t,r.setState({legendFormat:t})},r.onRunQuery=function(){var e=ze(r).query;r.props.onChange(e),r.props.onRunQuery()};var o=Object.assign({},{expr:"",legendFormat:"",interval:""},e.query);return r.query=o,r.state={interval:o.interval,legendFormat:o.legendFormat,formatOption:Je.find((function(e){return e.value===o.format}))||Je[0],intervalFactorOption:Ze.find((function(e){return e.value===o.intervalFactor}))||Ze[0],instant:Boolean(o.instant)},r}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xe(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this.props,t=e.datasource,r=e.query,n=e.data,a=this.state,o=a.formatOption,i=a.instant,u=a.interval,s=a.intervalFactorOption,c=a.legendFormat;return be.a.createElement("div",null,be.a.createElement(Qe,{datasource:t,query:r,onRunQuery:this.onRunQuery,onChange:this.onFieldChange,history:[],data:n}),be.a.createElement("div",{className:"gf-form-inline"},be.a.createElement("div",{className:"gf-form"},be.a.createElement(Oe.InlineFormLabel,{width:7,tooltip:"Controls the name of the time series, using name or pattern. For example {{hostname}} will be replaced with label value for the label hostname."},"Legend"),be.a.createElement("input",{type:"text",className:"gf-form-input",placeholder:"legend format",value:c,onChange:this.onLegendChange,onBlur:this.onRunQuery})),be.a.createElement("div",{className:"gf-form"},be.a.createElement(Oe.InlineFormLabel,{width:7,tooltip:be.a.createElement(be.a.Fragment,null,"An additional lower limit for the step parameter of the Prometheus query and for the"," ",be.a.createElement("code",null,"$__interval"),' variable. The limit is absolute and not modified by the "Resolution" setting.')},"Min step"),be.a.createElement("input",{type:"text",className:"gf-form-input width-8",placeholder:u,onChange:this.onIntervalChange,onBlur:this.onRunQuery,value:u})),be.a.createElement("div",{className:"gf-form"},be.a.createElement("div",{className:"gf-form-label"},"Resolution"),be.a.createElement(Oe.Select,{isSearchable:!1,options:Ze,onChange:this.onIntervalFactorChange,value:s})),be.a.createElement("div",{className:"gf-form"},be.a.createElement("div",{className:"gf-form-label width-7"},"Format"),be.a.createElement(Oe.Select,{width:16,isSearchable:!1,options:Je,onChange:this.onFormatChange,value:o}),be.a.createElement(Ye,{label:"Instant",checked:i,onChange:this.onInstantChange}),be.a.createElement(Oe.InlineFormLabel,{width:10,tooltip:"Link to Graph in Prometheus"},be.a.createElement($e,{datasource:t,query:this.query,panelData:n})))))}}])&&We(r.prototype,n),a&&We(r,a),t}(ge.PureComponent),tt=[{title:"Request Rate",expression:"rate(http_request_total[5m])",label:"Given an HTTP request counter, this query calculates the per-second average request rate over the last 5 minutes."},{title:"95th Percentile of Request Latencies",expression:"histogram_quantile(0.95, sum(rate(prometheus_http_request_duration_seconds_bucket[5m])) by (le))",label:"Calculates the 95th percentile of HTTP request rate over 5 minute windows."},{title:"Alerts Firing",expression:'sort_desc(sum(sum_over_time(ALERTS{alertstate="firing"}[24h])) by (alertname))',label:"Sums up the alerts that have been firing over the last 24 hours."},{title:"Step",label:"Defines the graph resolution using a duration format (15s, 1m, 3h, ...). Small steps create high-resolution graphs but can be slow over larger time ranges. Using a longer step lowers the resolution and smooths the graph by producing fewer datapoints. If no step is given the resolution is calculated automatically."}];function rt(e){var t=e.label,r=e.onChangeFunc,n=e.onKeyDownFunc,a=e.value,o=e.hasTooltip,i=e.tooltipContent;return be.a.createElement("div",{className:"gf-form-inline explore-input--ml","aria-label":"Prometheus extra field"},be.a.createElement("div",{className:"gf-form"},be.a.createElement(Oe.InlineFormLabel,{width:5,tooltip:o?i:null},t),be.a.createElement("input",{type:"text",className:"gf-form-input width-4",placeholder:"auto",onChange:r,onKeyDown:n,value:a})))}Object(ge.memo)(rt);function nt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function at(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ot=Object(ge.memo)((function(e){var t=e.query,r=e.data,n=e.datasource,a=e.history,o=e.onChange,i=e.onRunQuery;function u(t){var r=e.query;(0,e.onChange)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nt(Object(r),!0).forEach((function(t){at(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r,{interval:t}))}return be.a.createElement(Qe,{datasource:n,query:t,onRunQuery:i,onChange:o,onBlur:function(){},history:a,data:r,ExtraFieldElement:be.a.createElement(rt,{label:"Step",onChangeFunc:function(e){e.currentTarget.value!==t.interval&&u(e.currentTarget.value)},onKeyDownFunc:function(e){"Enter"===e.key&&i()},value:t.interval||"",hasTooltip:!0,tooltipContent:"Time units can be used here, for example: 5s, 1m, 3h, 1d, 1y (Default if no unit is specified: s)"})})}));function it(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ut(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?it(Object(r),!0).forEach((function(t){st(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):it(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function st(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ct=Oe.LegacyForms.Select,lt=Oe.LegacyForms.Input,ft=Oe.LegacyForms.FormField,pt=Oe.LegacyForms.Switch,mt=[{value:"GET",label:"GET"},{value:"POST",label:"POST"}],ht=function(e){var t=e.options,r=e.onOptionsChange;return be.a.createElement(be.a.Fragment,null,be.a.createElement("div",{className:"gf-form-group"},be.a.createElement("div",{className:"gf-form-inline"},be.a.createElement("div",{className:"gf-form"},be.a.createElement(ft,{label:"Scrape interval",labelWidth:13,inputEl:be.a.createElement(lt,{className:"width-6",value:t.jsonData.timeInterval,spellCheck:!1,placeholder:"15s",onChange:yt("timeInterval",t,r),validationEvents:dt}),tooltip:"Set this to the typical scrape and evaluation interval configured in Prometheus. Defaults to 15s."}))),be.a.createElement("div",{className:"gf-form-inline"},be.a.createElement("div",{className:"gf-form"},be.a.createElement(ft,{label:"Query timeout",labelWidth:13,inputEl:be.a.createElement(lt,{className:"width-6",value:t.jsonData.queryTimeout,onChange:yt("queryTimeout",t,r),spellCheck:!1,placeholder:"60s",validationEvents:dt}),tooltip:"Set the Prometheus query timeout."}))),be.a.createElement("div",{className:"gf-form"},be.a.createElement(Oe.InlineFormLabel,{width:13,tooltip:"Specify the HTTP Method to query Prometheus. (POST is only available in Prometheus >= v2.1.0)"},"HTTP Method"),be.a.createElement(ct,{options:mt,value:mt.find((function(e){return e.value===t.jsonData.httpMethod})),onChange:yt("httpMethod",t,r),width:7}))),be.a.createElement("h3",{className:"page-heading"},"Misc"),be.a.createElement("div",{className:"gf-form-group"},be.a.createElement("div",{className:"gf-form"},be.a.createElement(pt,{checked:t.jsonData.disableMetricsLookup,label:"Disable metrics lookup",labelClass:"width-14",onChange:Object(n.onUpdateDatasourceJsonDataOptionChecked)(e,"disableMetricsLookup"),tooltip:"Checking this option will disable the metrics chooser and metric/label support in the query field's autocomplete. This helps if you have performance issues with bigger Prometheus instances."})),be.a.createElement("div",{className:"gf-form-inline"},be.a.createElement("div",{className:"gf-form max-width-30"},be.a.createElement(ft,{label:"Custom query parameters",labelWidth:14,tooltip:"Add Custom parameters to Prometheus or Thanos queries.",inputEl:be.a.createElement(lt,{className:"width-25",value:t.jsonData.customQueryParameters,onChange:yt("customQueryParameters",t,r),spellCheck:!1,placeholder:"Example: max_source_resolution=5m&timeout=10"})})))))},dt=st({},Oe.EventsWithValidation.onBlur,[Object(Oe.regexValidation)(/^$|^\d+(ms|[Mwdhmsy])$/,"Value is not valid, you can use number with time unit specifier: y, M, w, d, h, m, s")]),vt=function(e){return e?e.hasOwnProperty("currentTarget")?e.currentTarget.value:e.value:""},yt=function(e,t,r){return function(n){r(ut({},t,{jsonData:ut({},t.jsonData,st({},e,vt(n)))}))}};r.d(t,"plugin",(function(){return bt}));var gt=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.stepDefaultValuePlaceholder="60s"};gt.templateUrl="partials/annotations.editor.html";var bt=new n.DataSourcePlugin(he).setQueryEditor(et).setConfigEditor((function(e){var t=e.options,r=e.onOptionsChange;return be.a.createElement(be.a.Fragment,null,be.a.createElement(Oe.DataSourceHttpSettings,{defaultUrl:"http://localhost:9090",dataSourceConfig:t,showAccessOptions:!0,onChange:r}),be.a.createElement(ht,{options:t,onOptionsChange:r}))})).setExploreMetricsQueryField(ot).setAnnotationQueryCtrl(gt).setExploreStartPage((function(e){return be.a.createElement("div",null,be.a.createElement("h2",null,"PromQL Cheat Sheet"),tt.map((function(t,r){return be.a.createElement("div",{className:"cheat-sheet-item",key:r},be.a.createElement("div",{className:"cheat-sheet-item__title"},t.title),t.expression?be.a.createElement("div",{className:"cheat-sheet-item__example",onClick:function(r){return e.onClickExample({refId:"A",expr:t.expression})}},be.a.createElement("code",null,t.expression)):null,be.a.createElement("div",{className:"cheat-sheet-item__label"},t.label))})))}))},sGFA:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(e){var t=!1;return{promise:new Promise((function(r,n){e.then((function(e){return t?n({isCanceled:!0}):r(e)})),e.catch((function(e){return n(t?{isCanceled:!0}:e)}))})),cancel:function(){t=!0}}}}}]);
//# sourceMappingURL=prometheusPlugin.017a0d1a58b1119d038d.js.map