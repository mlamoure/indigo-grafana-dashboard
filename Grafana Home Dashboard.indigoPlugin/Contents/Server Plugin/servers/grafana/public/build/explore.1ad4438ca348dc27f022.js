(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1450:function(e,t,n){"use strict";n.d(t,"a",function(){return d}),n.d(t,"b",function(){return m}),n.d(t,"d",function(){return h}),n.d(t,"e",function(){return g}),n.d(t,"f",function(){return f}),n.d(t,"g",function(){return v}),n.d(t,"h",function(){return b}),n.d(t,"i",function(){return w}),n.d(t,"j",function(){return x}),n.d(t,"k",function(){return S}),n.d(t,"l",function(){return k}),n.d(t,"m",function(){return N}),n.d(t,"n",function(){return T}),n.d(t,"o",function(){return I}),n.d(t,"p",function(){return _}),n.d(t,"q",function(){return R}),n.d(t,"c",function(){return j});var a=n(2),r=n(1),o=n.n(r),i=n(52),s=n(102),l=n(64),c=n(27),u=n(40),p=function(e,t){return function(n){n(Object(u.G)(a.a({exploreId:e},t))),n(L())}};function d(e,t){var n=Object(l.h)(t+1);return Object(u.b)({exploreId:e,index:t,query:n})}function m(e,t){var n=this;return function(r,o){return a.b(n,void 0,void 0,function(){var n,i,c,p;return a.d(this,function(d){switch(d.label){case 0:return[4,Object(s.a)().get(t)];case 1:return n=d.sent(),i=o().explore[e].datasourceInstance,c=o().explore[e].queries,[4,r(function(e,t,n,r){var o=this;return function(i){return a.b(o,void 0,void 0,function(){var o,s;return a.d(this,function(c){switch(c.label){case 0:return o=t,n.meta.id!==r.meta.id?[3,1]:(o=t.slice(),[3,4]);case 1:return r.importQueries?[4,r.importQueries(t,n.meta)]:[3,3];case 2:return o=c.sent(),[3,4];case 3:o=Object(l.g)(),c.label=4;case 4:return s=o.map(function(e,t){return a.a({},e,Object(l.h)(t))}),i(Object(u.o)({exploreId:e,queries:s})),[2]}})})}}(e,c,i,n))];case 2:d.sent(),r(Object(u.F)({exploreId:e,datasourceInstance:n})),d.label=3;case 3:return d.trys.push([3,5,,6]),[4,r(E(e,n))];case 4:return d.sent(),[3,6];case 5:return p=d.sent(),console.error(p),[2];case 6:return r(x(e)),[2]}})})}}function h(e,t,n,r){return function(o){null===t&&(t=a.a({},Object(l.h)(n))),o(Object(u.c)({exploreId:e,query:t,index:n,override:r})),r&&o(x(e))}}function g(e,t){var n=t.height,a=t.width;return Object(u.d)({exploreId:e,height:n,width:a})}function f(e,t){return function(n){n(Object(u.e)({exploreId:e,range:t})),n(x(e))}}function v(e){return function(t){t(Object(u.x)({exploreId:e})),t(Object(u.f)({exploreId:e})),t(L())}}function b(e,t,n,r,o,i,l){var c=this;return function(p){return a.b(c,void 0,void 0,function(){var c,d,m,h;return a.d(this,function(a){switch(a.label){case 0:if(c=Object(s.a)().getExternal().map(function(e){return{value:e.name,name:e.name,meta:e.meta}}),p(Object(u.h)({exploreId:e,containerWidth:o,eventBridge:i,exploreDatasources:c,queries:n,range:r,ui:l})),!(c.length>=1))return[3,11];if(d=void 0,!t)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Object(s.a)().get(t)];case 2:return d=a.sent(),[3,4];case 3:return m=a.sent(),console.error(m),[3,4];case 4:return d?[3,6]:[4,Object(s.a)().get()];case 5:d=a.sent(),a.label=6;case 6:p(Object(u.F)({exploreId:e,datasourceInstance:d})),a.label=7;case 7:return a.trys.push([7,9,,10]),[4,p(E(e,d))];case 8:return a.sent(),[3,10];case 9:return h=a.sent(),console.error(h),[2];case 10:return p(x(e,!0)),[3,12];case 11:p(Object(u.k)({exploreId:e})),a.label=12;case 12:return[2]}})})}}var y=function(e,t){var n=t.meta.metrics,a=t.meta.logs,r=t.meta.tables,o=t.pluginExports.ExploreStartPage,s="grafana.explore.history."+t.meta.id,c=i.a.getObject(s,[]);return i.a.set(l.c,t.name),Object(u.m)({exploreId:e,StartPage:o,datasourceInstance:t,history:c,showingStartPage:Boolean(o),supportsGraph:n,supportsLogs:a,supportsTable:r})};function E(e,t){var n=this;return function(r,o){return a.b(n,void 0,void 0,function(){var n,i,s,l;return a.d(this,function(a){switch(a.label){case 0:n=t.name,r(Object(u.l)({exploreId:e,requestedDatasourceName:n})),i=null,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.testDatasource()];case 2:return s=a.sent(),i="success"===s.status?null:s.message,[3,4];case 3:return l=a.sent(),i=l&&l.statusText||"Network error",[3,4];case 4:return i?(r(Object(u.j)({exploreId:e,error:i})),[2,Promise.reject(n+" loading failed")]):n!==o().explore[e].requestedDatasourceName?[2]:(t.init&&t.init(),n!==o().explore[e].requestedDatasourceName?[2]:(r(y(e,t)),[2,Promise.resolve()]))}})})}}function w(e,t,n,a){return function(r){r(Object(u.n)({exploreId:e,modification:t,index:n,modifier:a})),t.preventSubmit||r(x(e))}}function x(e,t){return void 0===t&&(t=!1),function(n,a){var r=a().explore[e],o=r.datasourceInstance,i=r.queries,s=r.showingLogs,c=r.showingGraph,p=r.showingTable,d=r.supportsGraph,m=r.supportsLogs,h=r.supportsTable;if(!Object(l.l)(i))return n(Object(u.u)({exploreId:e})),void n(L());var g=o.interval;(t||p)&&h&&n(C(e,"Table",{interval:g,format:"table",instant:!0,valueWithRefId:!0},function(e){return e[0]})),(t||c)&&d&&n(C(e,"Graph",{interval:g,format:"time_series",instant:!1},l.m)),(t||s)&&m&&n(C(e,"Logs",{interval:g,format:"logs"})),n(L())}}function C(e,t,n,r){var i=this;return function(s,c){return a.b(i,void 0,void 0,function(){var i,p,d,m,h,g,f,v,b=this;return a.d(this,function(y){return i=c().explore[e],p=i.datasourceInstance,d=i.eventBridge,m=i.queries,h=i.queryIntervals,g=i.range,f=i.scanning,v=p.meta.id,m.forEach(function(i,c){return a.b(b,void 0,void 0,function(){var b,y,E,w,x,C;return a.d(this,function(S){switch(S.label){case 0:b=Object(l.d)(i,c,t,n,g,h,f),s(Object(u.q)({exploreId:e,resultType:t,rowIndex:c,transaction:b})),S.label=1;case 1:return S.trys.push([1,3,,4]),y=Date.now(),[4,p.query(b.options)];case 2:return E=S.sent(),d.emit("data-received",E.data||[]),w=Date.now()-y,x=r?r(E.data):E.data,s(function(e,t,n,r,i,s){return function(c,p){var d=p().explore[e],m=d.datasourceInstance,h=d.history,g=d.queryTransactions,f=d.scanner,v=d.scanning;if(m.meta.id===s){var b=g.find(function(e){return e.id===t});if(b){var y;m.getQueryHints&&(y=m.getQueryHints(b.query,n));var E=g.map(function(e){return e.id===t?a.a({},e,{hints:y,latency:r,result:n,done:!0}):e}),w=Object(l.p)(h,s,i);if(c(Object(u.r)({exploreId:e,history:w,queryTransactions:E})),v)if(0===o.a.size(n)){if(!E.find(function(e){return e.scanning&&!e.done})){var x=f();c(Object(u.v)({exploreId:e,range:x}))}}else c(Object(u.x)({exploreId:e}))}}}}(e,b.id,x,w,m,v)),[3,4];case 3:return C=S.sent(),d.emit("data-error",C),s(function(e,t,n,r){return function(o,i){var s=i().explore[e],l=s.datasourceInstance,c=s.queryTransactions;if(l.meta.id===r&&!n.cancelled&&c.find(function(e){return e.id===t})){var p,d;if(console.error(n),n.data)if("string"==typeof n.data)p=n.data;else{if(!n.data.error)throw new Error("Could not handle error response");p=n.data.error,n.data.response&&(d=n.data.response)}else p=n.message?n.message:"string"==typeof n?n:"Unknown error during query transaction. Please check JS console logs.";var m=c.map(function(e){return e.id===t?a.a({},e,{error:p,errorDetails:d,done:!0}):e});o(Object(u.p)({exploreId:e,queryTransactions:m}))}}}(e,b.id,C,v)),[3,4];case 4:return[2]}})})}),[2]})})}}function S(e,t){return function(n){n(Object(u.w)({exploreId:e,scanner:t}));var a=t();n(Object(u.v)({exploreId:e,range:a}))}}function k(e,t){return function(n){var r=t.map(function(e){return a.a({},e,Object(l.h)())});n(Object(u.y)({exploreId:e,queries:r})),n(x(e))}}function N(){return function(e){e(Object(u.z)()),e(L())}}function T(){return function(e,t){var n=t().explore.left,r=a.a({},n,{queryTransactions:[],queries:n.queries.slice()});e(Object(u.A)({itemState:r})),e(L())}}function L(){return function(e,t){var n=t().explore,a=n.left,r=n.right,o=n.split,i={},s={datasource:a.datasourceInstance.name,queries:a.queries.map(l.f),range:a.range,ui:{showingGraph:a.showingGraph,showingLogs:a.showingLogs,showingTable:a.showingTable,dedupStrategy:a.dedupStrategy}};if(i.left=Object(l.o)(s,!0),o){var u={datasource:r.datasourceInstance.name,queries:r.queries.map(l.f),range:r.range,ui:{showingGraph:r.showingGraph,showingLogs:r.showingLogs,showingTable:r.showingTable,dedupStrategy:r.dedupStrategy}};i.right=Object(l.o)(u,!0)}e(Object(c.c)({query:i}))}}var O=function(e){return function(t,n){return function(a){var r,o=!n;switch(e.type){case u.B.type:r={showingGraph:!n};break;case u.D.type:r={showingLogs:!n};break;case u.E.type:r={showingTable:!n}}a(e({exploreId:t})),a(p(t,r)),o&&a(x(t))}}},I=O(u.B),_=O(u.D),R=O(u.E),j=function(e,t){return function(n){n(p(e,{dedupStrategy:t}))}}},1451:function(e,t,n){"use strict";var a=n(2),r=n(0),o=n.n(r),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickToggle=function(){return t.props.onToggle(!t.props.isOpen)},t}return a.c(t,e),t.prototype.render=function(){var e=this.props,t=e.isOpen,n=e.loading,a=t?"fa fa-caret-up":"fa fa-caret-down",r=n?"explore-panel__loader explore-panel__loader--active":"explore-panel__loader";return o.a.createElement("div",{className:"explore-panel panel-container"},o.a.createElement("div",{className:"explore-panel__header",onClick:this.onClickToggle},o.a.createElement("div",{className:"explore-panel__header-buttons"},o.a.createElement("span",{className:a})),o.a.createElement("div",{className:"explore-panel__header-label"},this.props.label)),t&&o.a.createElement("div",{className:"explore-panel__body"},o.a.createElement("div",{className:r}),this.props.children))},t}(r.PureComponent);t.a=i},1452:function(e,t,n){"use strict";var a=n(2),r=n(0),o=n.n(r),i=function(e){function t(t){var n=e.call(this,t)||this;return n.state={error:null,errorInfo:null},n}return a.c(t,e),t.prototype.componentDidCatch=function(e,t){this.setState({error:e,errorInfo:t})},t.prototype.render=function(){return this.state.errorInfo?o.a.createElement("div",{className:"explore-container"},o.a.createElement("h3",null,"An unexpected error happened."),o.a.createElement("details",{style:{whiteSpace:"pre-wrap"}},this.state.error&&this.state.error.toString(),o.a.createElement("br",null),this.state.errorInfo.componentStack)):this.props.children},t}(r.Component);t.a=i},1453:function(e,t,n){"use strict";n.d(t,"b",function(){return d});var a=n(2),r=n(0),o=n.n(r),i=n(4),s=n.n(i),l=n(35),c=n(130),u="YYYY-MM-DD HH:mm:ss",p={from:"now-6h",to:"now"};function d(e,t,n){if(void 0===t&&(t=!1),void 0===n&&(n=!1),s.a.isMoment(e))return n?e.format(u):e;if(-1!==e.indexOf("now"))return e;var a=e;return isNaN(a)||(a=parseInt(a,10)),(a=t?s.a.utc(a):s()(a)).format(u)}var m=function(e){function t(t){var n=e.call(this,t)||this;return n.handleChangeFrom=function(e){n.setState({fromRaw:e.target.value})},n.handleChangeTo=function(e){n.setState({toRaw:e.target.value})},n.handleClickApply=function(){var e,t=n.props.onChangeTime;n.setState(function(t){var a=n.state,r=a.toRaw,o=a.fromRaw;return e={from:l.parse(o,!1),to:l.parse(r,!0)},{isOpen:!1,rangeString:c.b(e)}},function(){t&&t(e)})},n.handleClickLeft=function(){return n.move(-1)},n.handleClickPicker=function(){n.setState(function(e){return{isOpen:!e.isOpen}})},n.handleClickRight=function(){return n.move(1)},n.handleClickRefresh=function(){},n.handleClickRelativeOption=function(e){var t=n.props.onChangeTime,a=c.b(e);n.setState({toRaw:e.to,fromRaw:e.from,isOpen:!1,rangeString:a},function(){t&&t(e)})},n.dropdownRef=function(e){n.dropdownEl=e},n.state={isOpen:t.isOpen,isUtc:t.isUtc,rangeString:"",fromRaw:"",toRaw:"",initialRange:p,refreshInterval:""},n}return a.c(t,e),t.getDerivedStateFromProps=function(e,t){if(t.initialRange&&t.initialRange===e.range)return t;var n=e.range?e.range.from:p.from,r=e.range?e.range.to:p.to,o=d(n,e.isUtc,!0),i=d(r,e.isUtc,!0),s={from:o,to:i};return a.a({},t,{fromRaw:o,toRaw:i,initialRange:e.range,rangeString:c.b(s)})},t.prototype.move=function(e,t){var n,a,r=this.props.onChangeTime,o=this.state,i=o.fromRaw,p=o.toRaw,d=l.parse(i,!1),m=l.parse(p,!0),h=t?1:2,g=(m.valueOf()-d.valueOf())/h;-1===e?(n=m.valueOf()-g,a=d.valueOf()-g):1===e?(n=m.valueOf()+g,a=d.valueOf()+g,n>Date.now()&&m<Date.now()&&(n=Date.now(),a=d.valueOf())):(n=m.valueOf(),a=d.valueOf());var f={from:s()(a),to:s()(n)},v={raw:f,from:f.from,to:f.to};return this.setState({rangeString:c.b(f),fromRaw:f.from.format(u),toRaw:f.to.format(u)},function(){r(v,t)}),f},t.prototype.getTimeOptions=function(){return c.c({},this.state.rangeString)},t.prototype.renderDropdown=function(){var e=this,t=this.state,n=t.fromRaw,a=t.isOpen,r=t.toRaw;if(!a)return null;var i=this.getTimeOptions();return o.a.createElement("div",{ref:this.dropdownRef,className:"gf-timepicker-dropdown"},o.a.createElement("div",{className:"popover-box"},o.a.createElement("div",{className:"popover-box__header"},o.a.createElement("span",{className:"popover-box__title"},"Quick ranges")),o.a.createElement("div",{className:"popover-box__body gf-timepicker-relative-section"},Object.keys(i).map(function(t){var n=i[t];return o.a.createElement("ul",{key:t},n.map(function(t){return o.a.createElement("li",{className:t.active?"active":"",key:t.display},o.a.createElement("a",{onClick:function(){return e.handleClickRelativeOption(t)}},t.display))}))}))),o.a.createElement("div",{className:"popover-box"},o.a.createElement("div",{className:"popover-box__header"},o.a.createElement("span",{className:"popover-box__title"},"Custom range")),o.a.createElement("div",{className:"popover-box__body gf-timepicker-absolute-section"},o.a.createElement("label",{className:"small"},"From:"),o.a.createElement("div",{className:"gf-form-inline"},o.a.createElement("div",{className:"gf-form max-width-28"},o.a.createElement("input",{type:"text",className:"gf-form-input input-large timepicker-from",value:n,onChange:this.handleChangeFrom}))),o.a.createElement("label",{className:"small"},"To:"),o.a.createElement("div",{className:"gf-form-inline"},o.a.createElement("div",{className:"gf-form max-width-28"},o.a.createElement("input",{type:"text",className:"gf-form-input input-large timepicker-to",value:r,onChange:this.handleChangeTo}))),o.a.createElement("div",{className:"gf-form"},o.a.createElement("button",{className:"btn gf-form-btn btn-secondary",onClick:this.handleClickApply},"Apply")))))},t.prototype.render=function(){var e=this.state,t=e.isUtc,n=e.rangeString,a=e.refreshInterval;return o.a.createElement("div",{className:"timepicker"},o.a.createElement("div",{className:"navbar-buttons"},o.a.createElement("button",{className:"btn navbar-button navbar-button--tight timepicker-left",onClick:this.handleClickLeft},o.a.createElement("i",{className:"fa fa-chevron-left"})),o.a.createElement("button",{className:"btn navbar-button gf-timepicker-nav-btn",onClick:this.handleClickPicker},o.a.createElement("i",{className:"fa fa-clock-o"}),o.a.createElement("span",{className:"timepicker-rangestring"},n),t?o.a.createElement("span",{className:"gf-timepicker-utc"},"UTC"):null,a?o.a.createElement("span",{className:"text-warning"},"  Refresh every ",a):null),o.a.createElement("button",{className:"btn navbar-button navbar-button--tight timepicker-right",onClick:this.handleClickRight},o.a.createElement("i",{className:"fa fa-chevron-right"}))),this.renderDropdown())},t}(r.PureComponent);t.a=m},1454:function(e,t,n){"use strict";var a=n(2),r=n(10),o=n.n(r),i=n(0),s=n.n(i),l=n(4),c=n.n(l),u=(n(209),n(397),n(396),n(398),n(35)),p=n(13),d=n.n(p),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickLabel=function(e){return t.props.onClickLabel(t.props.series,e)},t}return a.c(t,e),t.prototype.render=function(){var e=this.props,t=e.hidden,n=e.series,a=d()({"graph-legend-series-hidden":t});return s.a.createElement("div",{className:"graph-legend-series "+a},s.a.createElement("div",{className:"graph-legend-icon"},s.a.createElement("i",{className:"fa fa-minus pointer",style:{color:n.color}})),s.a.createElement("a",{className:"graph-legend-alias pointer",title:n.alias,onClick:this.onClickLabel},n.alias))},t}(i.PureComponent),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickLabel=function(e,n){(0,t.props.onToggleSeries)(e,!(n.ctrlKey||n.metaKey||n.shiftKey))},t}return a.c(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.data,a=t.hiddenSeries,r=n||[];return s.a.createElement("div",{className:"graph-legend ps"},r.map(function(t,n){return s.a.createElement(m,{hidden:a.has(t.alias),key:t.id+"-"+n,onClickLabel:e.onClickLabel,series:t})}))},t.defaultProps={onToggleSeries:function(){}},t}(i.PureComponent);var g={legend:{show:!1},series:{lines:{linewidth:1,zero:!1},shadowSize:0},grid:{minBorderMargin:0,markings:[],backgroundColor:null,borderWidth:0,clickable:!0,color:"#a1a1a1",margin:{left:0,right:0},labelMarginX:0},selection:{mode:"x",color:"#666"}},f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dynamicOptions=null,t.state={hiddenSeries:new Set,showAllTimeSeries:!1},t.onPlotSelected=function(e,n){if(t.props.onChangeTime){var a={from:c()(n.xaxis.from),to:c()(n.xaxis.to)};t.props.onChangeTime(a)}},t.onShowAllTimeSeries=function(){t.setState({showAllTimeSeries:!0},t.draw)},t.onToggleSeries=function(e,n){t.setState(function(t,a){var r=a.data,o=a.onToggleSeries,i=t.hiddenSeries,s=i.size===new Set(r.map(function(e){return e.alias})).size-1,l=new Set;if(n)!i.has(e.alias)&&s||(l=new Set(r.filter(function(t){return t.alias!==e.alias}).map(function(e){return e.alias})));else{var c=new Set(r.map(function(e){return e.alias}));(l=function(e,t){for(var n=new Set,a=t.values();;){var r=a.next(),o=r.value;if(r.done)return n;e.has(o)&&n.add(o)}}(new Set(i),c)).has(e.alias)?l.delete(e.alias):l.add(e.alias)}return o&&o(e.alias,l),{hiddenSeries:l}},t.draw)},t}return a.c(t,e),t.prototype.getGraphData=function(){var e=this.props.data;return this.state.showAllTimeSeries?e:e.slice(0,20)},t.prototype.componentDidMount=function(){this.draw(),this.$el=o()("#"+this.props.id),this.$el.bind("plotselected",this.onPlotSelected)},t.prototype.componentDidUpdate=function(e,t){e.data===this.props.data&&e.range===this.props.range&&e.split===this.props.split&&e.height===this.props.height&&e.width===this.props.width&&function(e,t){if(e.size!==t.size)return!1;for(var n=e.values();;){var a=n.next(),r=a.value;if(a.done)return!0;if(!t.has(r))return!1}}(t.hiddenSeries,this.state.hiddenSeries)||this.draw()},t.prototype.componentWillUnmount=function(){this.$el.unbind("plotselected",this.onPlotSelected)},t.prototype.getDynamicOptions=function(){var e=this.props,t=e.range,n=(e.width||0)/100,a=t.from,r=t.to;c.a.isMoment(a)||(a=u.parse(a,!1)),c.a.isMoment(r)||(r=u.parse(r,!0));var o=a.valueOf(),i=r.valueOf();return{xaxis:{mode:"time",min:o,max:i,label:"Datetime",ticks:n,timezone:"browser",timeformat:function(e,t,n){if(t&&n&&e){var a=n-t,r=a/e/1e3;return r<=45?"%H:%M:%S":r<=7200||a<=864e5?"%H:%M":r<=8e4?"%m/%d %H:%M":r<=2419200||a<=31536e6?"%m/%d":"%Y-%m"}return"%H:%M"}(n,o,i)}}},t.prototype.draw=function(){var e=this.props.userOptions,t=void 0===e?{}:e,n=this.state.hiddenSeries,r=this.getGraphData(),i=o()("#"+this.props.id),s=[{data:[[0,0]]}];r&&r.length>0&&(s=r.filter(function(e){return!n.has(e.alias)}).map(function(e){return{color:e.color,label:e.label,data:e.getFlotPairs("null")}})),this.dynamicOptions=this.getDynamicOptions();var l=a.a({},g,this.dynamicOptions,t);o.a.plot(i,s,l)},t.prototype.render=function(){var e=this.props,t=e.height,n=void 0===t?100:t,a=e.id,r=void 0===a?"graph":a,o=this.state.hiddenSeries,i=this.getGraphData();return s.a.createElement(s.a.Fragment,null,this.props.data&&this.props.data.length>20&&!this.state.showAllTimeSeries&&s.a.createElement("div",{className:"time-series-disclaimer"},s.a.createElement("i",{className:"fa fa-fw fa-warning disclaimer-icon"}),"Showing only 20 time series. ",s.a.createElement("span",{className:"show-all-time-series",onClick:this.onShowAllTimeSeries},"Show all "+this.props.data.length)),s.a.createElement("div",{id:r,className:"explore-graph",style:{height:n}}),s.a.createElement(h,{data:i,hiddenSeries:o,onToggleSeries:this.onToggleSeries}))},t}(i.PureComponent);t.a=f},1455:function(e,t,n){"use strict";(function(e){var a=n(2),r=n(0),o=n.n(r),i=n(38),s=n(23),l=n(666),c=n(52),u=n(1456),p=n(1452),d=n(1457),m=n(1458),h=n(1459),g=n(1462),f=n(1453),v=n(1450),b=n(64),y=n(150),E=n(1464),w=n(40),x=function(e){function t(t){var n=e.call(this,t)||this;return n.getRef=function(e){n.el=e},n.onChangeTime=function(e,t){n.props.scanning&&!t&&n.onStopScanning(),n.props.changeTime(n.props.exploreId,e)},n.onClickExample=function(e){n.props.setQueries(n.props.exploreId,[e])},n.onClickLabel=function(e,t){n.onModifyQueries({type:"ADD_FILTER",key:e,value:t})},n.onModifyQueries=function(e,t){var a=n.props.datasourceInstance;if(a&&a.modifyQuery){n.props.modifyQueries(n.props.exploreId,e,t,function(e,t){return a.modifyQuery(e,t)})}},n.onResize=function(e){n.props.changeSize(n.props.exploreId,e)},n.onStartScanning=function(){var e=n.scanPreviousRange;n.props.scanStart(n.props.exploreId,e)},n.scanPreviousRange=function(){return n.timepickerRef.current.move(-1,!0)},n.onStopScanning=function(){n.props.scanStopAction({exploreId:n.props.exploreId})},n.exploreEvents=new y.a,n.timepickerRef=o.a.createRef(),n}return a.c(t,e),t.prototype.componentDidMount=function(){return a.b(this,void 0,void 0,function(){var e,t,n,r,o,i,s,l,u,p,d,m,h,g,v;return a.d(this,function(a){return e=this.props,t=e.exploreId,n=e.initialized,r=e.urlState,n||(i=(o=r||{}).datasource,s=o.queries,l=o.range,u=void 0===l?b.a:l,p=o.ui,d=void 0===p?b.b:p,m=i||c.a.get(b.c),h=Object(b.g)(s),g={from:Object(f.b)(u.from),to:Object(f.b)(u.to)},v=this.el?this.el.offsetWidth:0,this.props.initializeExplore(t,m,h,g,v,this.exploreEvents,d)),[2]})})},t.prototype.componentWillUnmount=function(){this.exploreEvents.removeAllListeners()},t.prototype.render=function(){var e=this,t=this.props,n=t.StartPage,a=t.datasourceInstance,r=t.datasourceError,i=t.datasourceLoading,s=t.datasourceMissing,c=t.exploreId,f=t.showingStartPage,v=t.split,b=t.supportsGraph,y=t.supportsLogs,w=t.supportsTable,x=t.queryKeys,C=v?"explore explore-split":"explore";return o.a.createElement("div",{className:C,ref:this.getRef},o.a.createElement(E.a,{exploreId:c,timepickerRef:this.timepickerRef,onChangeTime:this.onChangeTime}),i?o.a.createElement("div",{className:"explore-container"},"Loading datasource..."):null,s?o.a.createElement("div",{className:"explore-container"},"Please add a datasource that supports Explore (e.g., Prometheus)."):null,r&&o.a.createElement("div",{className:"explore-container"},o.a.createElement(u.a,{message:"Error connecting to datasource: "+r})),a&&!r&&o.a.createElement("div",{className:"explore-container"},o.a.createElement(h.a,{exploreEvents:this.exploreEvents,exploreId:c,queryKeys:x}),o.a.createElement(l.a,{onResize:this.onResize,disableHeight:!0},function(t){var a=t.width;return 0===a?null:o.a.createElement("main",{className:"m-t-2",style:{width:a}},o.a.createElement(p.a,null,f&&o.a.createElement(n,{onClickExample:e.onClickExample}),!f&&o.a.createElement(o.a.Fragment,null,b&&!y&&o.a.createElement(d.a,{width:a,exploreId:c}),w&&o.a.createElement(g.a,{exploreId:c,onClickCell:e.onClickLabel}),y&&o.a.createElement(m.a,{width:a,exploreId:c,onChangeTime:e.onChangeTime,onClickLabel:e.onClickLabel,onStartScanning:e.onStartScanning,onStopScanning:e.onStopScanning}))))})))},t}(o.a.PureComponent);var C={changeSize:v.e,changeTime:v.f,initializeExplore:v.h,modifyQueries:v.i,scanStart:v.k,scanStopAction:w.x,setQueries:v.l};t.a=Object(i.hot)(e)(Object(s.b)(function(e,t){var n=t.exploreId,a=e.explore,r=a.split,o=a[n];return{StartPage:o.StartPage,datasourceError:o.datasourceError,datasourceInstance:o.datasourceInstance,datasourceLoading:o.datasourceLoading,datasourceMissing:o.datasourceMissing,initialized:o.initialized,range:o.range,showingStartPage:o.showingStartPage,split:r,supportsGraph:o.supportsGraph,supportsLogs:o.supportsLogs,supportsTable:o.supportsTable,queryKeys:o.queryKeys}},C)(x))}).call(this,n(74)(e))},1456:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(0),r=n.n(a),o=function(e){var t=e.message;return r.a.createElement("div",{className:"gf-form-group section"},r.a.createElement("div",{className:"alert-error alert"},r.a.createElement("div",{className:"alert-icon"},r.a.createElement("i",{className:"fa fa-exclamation-triangle"})),r.a.createElement("div",{className:"alert-body"},r.a.createElement("div",{className:"alert-title"},t))))}},1457:function(e,t,n){"use strict";(function(e){var a=n(2),r=n(0),o=n.n(r),i=n(38),s=n(23),l=n(1450),c=n(1454),u=n(1451),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickGraphButton=function(){t.props.toggleGraph(t.props.exploreId,t.props.showingGraph)},t.onChangeTime=function(e){t.props.changeTime(t.props.exploreId,e)},t}return a.c(t,e),t.prototype.render=function(){var e=this.props,t=e.exploreId,n=e.graphResult,a=e.loading,r=e.showingGraph,i=e.showingTable,s=e.range,l=e.split,p=e.width,d=r&&i?200:400;return n?o.a.createElement(u.a,{label:"Graph",isOpen:r,loading:a,onToggle:this.onClickGraphButton},o.a.createElement(c.a,{data:n,height:d,id:"explore-graph-"+t,onChangeTime:this.onChangeTime,range:s,split:l,width:p})):null},t}(r.PureComponent);var d={toggleGraph:l.o,changeTime:l.f};t.a=Object(i.hot)(e)(Object(s.b)(function(e,t){var n=t.exploreId,a=e.explore,r=a.split,o=a[n],i=o.graphResult,s=o.queryTransactions,l=o.range,c=o.showingGraph,u=o.showingTable;return{graphResult:i,loading:s.some(function(e){return"Graph"===e.resultType&&!e.done}),range:l,showingGraph:c,showingTable:u,split:r}},d)(p))}).call(this,n(74)(e))},1458:function(e,t,n){"use strict";(function(e){var a=n(2),r=n(0),o=n.n(r),i=n(38),s=n(23),l=n(109),c=n(1450),u=n(1466),p=n(1451),d=n(40),m=n(1467),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickLogsButton=function(){t.props.toggleLogs(t.props.exploreId,t.props.showingLogs)},t.handleDedupStrategyChange=function(e){t.props.changeDedupStrategy(t.props.exploreId,e)},t.hangleToggleLogLevel=function(e){var n=t.props.exploreId;t.props.toggleLogLevelAction({exploreId:n,hiddenLogLevels:e})},t}return a.c(t,e),t.prototype.render=function(){var e=this.props,t=e.exploreId,n=e.loading,a=e.logsHighlighterExpressions,r=e.logsResult,i=e.dedupedResult,s=e.onChangeTime,c=e.onClickLabel,d=e.onStartScanning,m=e.onStopScanning,h=e.range,g=e.showingLogs,f=e.scanning,v=e.scanRange,b=e.width,y=e.hiddenLogLevels;return o.a.createElement(p.a,{label:"Logs",loading:n,isOpen:g,onToggle:this.onClickLogsButton},o.a.createElement(u.a,{dedupStrategy:this.props.dedupStrategy||l.c.none,data:r,dedupedData:i,exploreId:t,key:r&&r.id,highlighterExpressions:a,loading:n,onChangeTime:s,onClickLabel:c,onStartScanning:d,onStopScanning:m,onDedupStrategyChange:this.handleDedupStrategyChange,onToggleLogLevel:this.hangleToggleLogLevel,range:h,scanning:f,scanRange:v,width:b,hiddenLogLevels:y}))},t}(r.PureComponent);var g={toggleLogs:c.p,changeDedupStrategy:c.c,toggleLogLevelAction:d.C};t.a=Object(i.hot)(e)(Object(s.b)(function(e,t){var n=t.exploreId,a=e.explore[n],r=a.logsHighlighterExpressions,o=a.logsResult,i=a.queryTransactions,s=a.scanning,l=a.scanRange,c=a.range,u=i.some(function(e){return"Logs"===e.resultType&&!e.done}),p=Object(m.b)(a);return{loading:u,logsHighlighterExpressions:r,logsResult:o,scanning:s,scanRange:l,showingLogs:p.showingLogs,range:c,dedupStrategy:p.dedupStrategy,hiddenLogLevels:new Set(a.hiddenLogLevels),dedupedResult:Object(m.a)(a)}},g)(h))}).call(this,n(74)(e))},1459:function(e,t,n){"use strict";var a=n(2),r=n(0),o=n.n(r),i=n(1460),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.c(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=void 0===t?"":t,a=e.exploreEvents,r=e.exploreId,s=e.queryKeys;return o.a.createElement("div",{className:n},s.map(function(e,t){return o.a.createElement(i.a,{key:e,exploreEvents:a,exploreId:r,index:t})}))},t}(r.PureComponent);t.a=s},1460:function(e,t,n){"use strict";(function(e){var a=n(2),r=n(0),o=n.n(r),i=n(1),s=n.n(i),l=n(38),c=n(23),u=n(1461),p=n(1468),d=n(1450),m=n(40);var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onExecuteQuery=function(){var e=t.props.exploreId;t.props.runQueries(e)},t.onChangeQuery=function(e,n){var a=t.props,r=a.datasourceInstance,o=a.exploreId,i=a.index;t.props.changeQuery(o,e,i,n),e&&!n&&r.getHighlighterExpression&&0===i&&t.updateLogsHighlights(e)},t.onClickAddButton=function(){var e=t.props,n=e.exploreId,a=e.index;t.props.addQueryRow(n,a)},t.onClickClearButton=function(){t.onChangeQuery(null,!0)},t.onClickHintFix=function(e){var n=t.props,a=n.datasourceInstance,r=n.exploreId,o=n.index;if(a&&a.modifyQuery){t.props.modifyQueries(r,e,o,function(e,t){return a.modifyQuery(e,t)})}},t.onClickRemoveButton=function(){var e=t.props,n=e.exploreId,a=e.index;t.props.removeQueryRowAction({exploreId:n,index:a})},t.updateLogsHighlights=s.a.debounce(function(e){var n=t.props.datasourceInstance;if(n.getHighlighterExpression){var a=t.props.exploreId,r=[n.getHighlighterExpression(e)];t.props.highlightLogsExpressionAction({exploreId:a,expressions:r})}},500),t}return a.c(t,e),t.prototype.componentWillUnmount=function(){console.log("QueryRow will unmount")},t.prototype.render=function(){var e=this.props,t=e.datasourceInstance,n=e.history,a=e.index,r=e.query,i=e.queryTransactions,s=e.exploreEvents,l=e.range,c=i.filter(function(e){return e.rowIndex===a}),d=c.find(function(e){return void 0!==e.error}),m=function(e){var t=e.find(function(e){return e.hints&&e.hints.length>0});if(t)return t.hints[0]}(c),h=d?d.error:null,g=t.pluginExports.ExploreQueryField;return o.a.createElement("div",{className:"query-row"},o.a.createElement("div",{className:"query-row-status"},o.a.createElement(p.a,{transactions:c})),o.a.createElement("div",{className:"query-row-field flex-shrink-1"},g?o.a.createElement(g,{datasource:t,query:r,error:h,hint:m,history:n,onExecuteQuery:this.onExecuteQuery,onExecuteHint:this.onClickHintFix,onQueryChange:this.onChangeQuery}):o.a.createElement(u.a,{datasource:t,error:h,onQueryChange:this.onChangeQuery,onExecuteQuery:this.onExecuteQuery,initialQuery:r,exploreEvents:s,range:l})),o.a.createElement("div",{className:"gf-form-inline flex-shrink-0"},o.a.createElement("div",{className:"gf-form"},o.a.createElement("button",{className:"gf-form-label gf-form-label--btn",onClick:this.onClickClearButton},o.a.createElement("i",{className:"fa fa-times"}))),o.a.createElement("div",{className:"gf-form"},o.a.createElement("button",{className:"gf-form-label gf-form-label--btn",onClick:this.onClickAddButton},o.a.createElement("i",{className:"fa fa-plus"}))),o.a.createElement("div",{className:"gf-form"},o.a.createElement("button",{className:"gf-form-label gf-form-label--btn",onClick:this.onClickRemoveButton},o.a.createElement("i",{className:"fa fa-minus"})))))},t}(r.PureComponent);var g={addQueryRow:d.a,changeQuery:d.d,highlightLogsExpressionAction:m.g,modifyQueries:d.i,removeQueryRowAction:m.s,runQueries:d.j};t.a=Object(l.hot)(e)(Object(c.b)(function(e,t){var n=t.exploreId,a=t.index,r=e.explore[n],o=r.datasourceInstance,i=r.history,s=r.queries,l=r.queryTransactions,c=r.range;return{datasourceInstance:o,history:i,query:s[a],queryTransactions:l,range:c}},g)(h))}).call(this,n(74)(e))},1461:function(e,t,n){"use strict";var a=n(2),r=n(0),o=n.n(r),i=n(62),s=n(140),l=(n(113),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.c(t,e),t.prototype.componentDidMount=function(){return a.b(this,void 0,void 0,function(){var e,t,n,r,o,s,l,c,u,p=this;return a.d(this,function(d){return this.element?(e=this.props,t=e.datasource,n=e.initialQuery,r=e.exploreEvents,o=e.range,this.initTimeSrv(o),s=Object(i.a)(),l='<plugin-component type="query-ctrl"> </plugin-component>',c=a.a({datasource:t.name},n),u={ctrl:{datasource:t,target:c,refresh:function(){p.props.onQueryChange(c),p.props.onExecuteQuery()},events:r,panel:{datasource:t,targets:[c]},dashboard:{}}},this.component=s.load(this.element,u,l),this.props.onQueryChange(c),[2]):[2]})})},t.prototype.componentWillUnmount=function(){this.component&&this.component.destroy()},t.prototype.initTimeSrv=function(e){Object(s.a)().init({time:e,refresh:!1,getTimezone:function(){return"utc"},timeRangeUpdated:function(){return console.log("refreshDashboard!")}})},t.prototype.render=function(){var e=this;return o.a.createElement("div",{className:"gf-form-query",ref:function(t){return e.element=t},style:{width:"100%"}})},t}(r.PureComponent));t.a=l},1462:function(e,t,n){"use strict";(function(e){var a=n(2),r=n(0),o=n.n(r),i=n(38),s=n(23),l=n(1450),c=n(1463),u=n(1451),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickTableButton=function(){t.props.toggleTable(t.props.exploreId,t.props.showingTable)},t}return a.c(t,e),t.prototype.render=function(){var e=this.props,t=e.loading,n=e.onClickCell,a=e.showingTable,r=e.tableResult;return r?o.a.createElement(u.a,{label:"Table",loading:t,isOpen:a,onToggle:this.onClickTableButton},o.a.createElement(c.a,{data:r,loading:t,onClickCell:n})):null},t}(r.PureComponent);var d={toggleTable:l.q};t.a=Object(i.hot)(e)(Object(s.b)(function(e,t){var n=t.exploreId,a=e.explore[n],r=a.queryTransactions,o=a.showingTable,i=a.tableResult;return{loading:r.some(function(e){return"Table"===e.resultType&&!e.done}),showingTable:o,tableResult:i}},d)(p))}).call(this,n(74)(e))},1463:function(e,t,n){"use strict";var a=n(2),r=n(1),o=n.n(r),i=n(0),s=n.n(i),l=n(1449),c=new(n(81).a),u=/^[Vv]alue #\d+/;var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getCellProps=function(e,n,a){return{onClick:function(e){if(e.target&&"link"===e.target.className){var r=a.Header,o=n.row[r];t.props.onClickCell(r,o)}}}},t}return a.c(t,e),t.prototype.render=function(){var e=this.props,t=e.data,n=e.loading,a=t||c,r=a.columns.map(function(e){return e.text}),i=a.columns.map(function(e){var t=e.filterable,n=e.text;return{Header:n,accessor:n,className:u.test(n)?"text-right":"",show:"Time"!==n,Cell:function(e){return s.a.createElement("span",{className:t?"link":""},e.value)}}}),p=t?"The queries returned no data for a table.":"";return s.a.createElement(l.a,{columns:i,data:a.rows,getTdProps:this.getCellProps,loading:n,minRows:0,noDataText:p,resolveData:function(e){return function(e,t){return e.map(function(e){return o.a.zipObject(t,e)})}(e,r)},showPagination:Boolean(t)})},t}(i.PureComponent);t.a=p},1464:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return f});var a,r=n(2),o=n(0),i=n.n(o),s=n(23),l=n(38),c=n(377),u=n(1450),p=n(1453),d=n(660);!function(e){e.left="left",e.right="right"}(a||(a={}));var m=function(e){var t={iconSide:a.left},n=r.a({},e,{defaultOptions:t}),o=n.title,s=n.onClick,l=n.buttonClassName,c=n.iconClassName,u=n.splitted,p=n.iconSide;return i.a.createElement("button",{className:"btn navbar-button "+(l||""),onClick:s},c&&p===a.left?i.a.createElement("i",{className:c+" icon-margin-right"}):null,i.a.createElement("span",{className:"btn-title"},u?"":o),c&&p===a.right?i.a.createElement("i",{className:c+" icon-margin-left"}):null)},h=function(e){function t(t){var n=e.call(this,t)||this;return n.onChangeDatasource=function(e){return r.b(n,void 0,void 0,function(){return r.d(this,function(t){return this.props.changeDatasource(this.props.exploreId,e.value),[2]})})},n.onClearAll=function(){n.props.clearAll(n.props.exploreId)},n.onRunQuery=function(){n.props.runQuery(n.props.exploreId)},n.onCloseTimePicker=function(){n.props.timepickerRef.current.setState({isOpen:!1})},n}return r.c(t,e),t.prototype.render=function(){var e=this.props,t=e.datasourceMissing,n=e.exploreDatasources,r=e.exploreId,o=e.loading,s=e.range,l=e.selectedDatasource,u=e.splitted,h=e.timepickerRef;return i.a.createElement("div",{className:u?"explore-toolbar splitted":"explore-toolbar"},i.a.createElement("div",{className:"explore-toolbar-item"},i.a.createElement("div",{className:"explore-toolbar-header"},i.a.createElement("div",{className:"explore-toolbar-header-title"},"left"===r&&i.a.createElement("span",{className:"navbar-page-btn"},i.a.createElement("i",{className:"gicon gicon-explore"}),"Explore")),"right"===r&&i.a.createElement("a",{className:"explore-toolbar-header-close",onClick:this.props.closeSplit},i.a.createElement("i",{className:"fa fa-times fa-fw"})))),i.a.createElement("div",{className:"explore-toolbar-item"},i.a.createElement("div",{className:"explore-toolbar-content"},t?null:i.a.createElement("div",{className:"explore-toolbar-content-item"},i.a.createElement("div",{className:"datasource-picker"},i.a.createElement(c.a,{onChange:this.onChangeDatasource,datasources:n,current:l}))),"left"!==r||u?null:i.a.createElement("div",{className:"explore-toolbar-content-item"},m({splitted:u,title:"Split",onClick:this.props.split,iconClassName:"fa fa-fw fa-columns icon-margin-right",iconSide:a.left})),i.a.createElement("div",{className:"explore-toolbar-content-item timepicker"},i.a.createElement(d.a,{onClick:this.onCloseTimePicker},i.a.createElement(p.a,{ref:h,range:s,onChangeTime:this.props.onChangeTime}))),i.a.createElement("div",{className:"explore-toolbar-content-item"},i.a.createElement("button",{className:"btn navbar-button navbar-button--no-icon",onClick:this.onClearAll},"Clear All")),i.a.createElement("div",{className:"explore-toolbar-content-item"},m({splitted:u,title:"Run Query",onClick:this.onRunQuery,buttonClassName:"navbar-button--secondary",iconClassName:o?"fa fa-spinner fa-fw fa-spin run-icon":"fa fa-level-down fa-fw run-icon",iconSide:a.right})))))},t}(o.PureComponent),g={changeDatasource:u.b,clearAll:u.g,runQuery:u.j,closeSplit:u.m,split:u.n},f=Object(l.hot)(e)(Object(s.b)(function(e,t){var n=t.exploreId,a=e.explore.split,r=e.explore[n],o=r.datasourceInstance,i=r.datasourceMissing,s=r.exploreDatasources,l=r.queryTransactions,c=r.range,u=o?s.find(function(e){return e.name===o.name}):void 0;return{datasourceMissing:i,exploreDatasources:s,loading:l.some(function(e){return!e.done}),range:c,selectedDatasource:u,splitted:a}},g)(h))}).call(this,n(74)(e))},1466:function(e,t,n){"use strict";var a=n(2),r=n(1),o=n.n(r),i=n(0),s=n.n(i),l=n(130),c=n(6),u=n(78),p=n(109),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.c(t,e),t.prototype.render=function(){var e=this.props,t=e.children,n=e.label,a=e.transparent;return s.a.createElement("div",{className:"gf-form"},n&&s.a.createElement("label",{className:"gf-form-label "+(a?"gf-form-label--transparent":"")},n),s.a.createElement("div",{className:"toggle-button-group "+(a?"toggle-button-group--transparent":"")},t))},t}(i.PureComponent),m=function(e){var t=e.children,n=e.selected,a=e.className,r=void 0===a?"":a,o=e.value,i=void 0===o?null:o,l=e.tooltip,u=e.onChange,p="btn "+r+" "+(n?"active":""),d=s.a.createElement("button",{className:p,onClick:function(e){e.stopPropagation(),u&&u(i)}},s.a.createElement("span",null,t));return l?s.a.createElement(c.Tooltip,{content:l,placement:"bottom"},d):d},h=n(1454),g=n(13),f=n.n(g);function v(e){var t=e.active,n=e.count,a=e.proportion,r=e.value,o=Math.round(100*a)+"%",i={width:o},l=f()("logs-stats-row",{"logs-stats-row--active":t});return s.a.createElement("div",{className:l},s.a.createElement("div",{className:"logs-stats-row__label"},s.a.createElement("div",{className:"logs-stats-row__value"},r),s.a.createElement("div",{className:"logs-stats-row__count"},n),s.a.createElement("div",{className:"logs-stats-row__percent"},o)),s.a.createElement("div",{className:"logs-stats-row__bar"},s.a.createElement("div",{className:"logs-stats-row__innerbar",style:i})))}var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.c(t,e),t.prototype.render=function(){var e=this.props,t=e.label,n=e.rowCount,r=e.stats,o=e.value,i=e.onClickClose,l=r.slice(0,5),c=l.find(function(e){return e.value===o}),u=r.slice(5),p=!c;p&&(c=u.find(function(e){return e.value===o}),u=u.filter(function(e){return e.value!==o}));var d=u.reduce(function(e,t){return e+t.count},0),m=l.reduce(function(e,t){return e+t.count},0)+d,h=d/m;return s.a.createElement("div",{className:"logs-stats"},s.a.createElement("div",{className:"logs-stats__header"},s.a.createElement("span",{className:"logs-stats__title"},t,": ",m," of ",n," rows have that label"),s.a.createElement("span",{className:"logs-stats__close fa fa-remove",onClick:i})),s.a.createElement("div",{className:"logs-stats__body"},l.map(function(e){return s.a.createElement(v,a.a({key:e.value},e,{active:e.value===o}))}),p&&c&&s.a.createElement(v,a.a({key:c.value},c,{active:!0})),d>0&&s.a.createElement(v,{key:"__OTHERS__",count:d,value:"Other",proportion:h})))},t}(i.PureComponent),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={stats:null,showStats:!1},t.onClickClose=function(){t.setState({showStats:!1})},t.onClickLabel=function(){var e=t.props,n=e.onClickLabel,a=e.label,r=e.value;n&&n(a,r)},t.onClickStats=function(){t.setState(function(e){if(e.showStats)return{showStats:!1,stats:null};var n=t.props.getRows();return{showStats:!0,stats:Object(p.f)(n,t.props.label)}})},t}return a.c(t,e),t.prototype.render=function(){var e=this.props,t=e.getRows,n=e.label,a=e.plain,r=e.value,o=this.state,i=o.showStats,l=o.stats,c=n+": "+r;return s.a.createElement("span",{className:"logs-label"},s.a.createElement("span",{className:"logs-label__value",title:c},r),!a&&s.a.createElement("span",{title:"Filter for label",onClick:this.onClickLabel,className:"logs-label__icon fa fa-search-plus"}),!a&&t&&s.a.createElement("span",{onClick:this.onClickStats,className:"logs-label__icon fa fa-signal"}),i&&s.a.createElement("span",{className:"logs-label__stats"},s.a.createElement(b,{stats:l,rowCount:t().length,label:n,value:r,onClickClose:this.onClickClose})))},t}(i.PureComponent),E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.c(t,e),t.prototype.render=function(){var e=this.props,t=e.getRows,n=e.labels,a=e.onClickLabel,r=e.plain;return Object.keys(n).map(function(e){return s.a.createElement(y,{key:e,getRows:t,label:e,value:n[e],plain:r,onClickLabel:a})})},t}(i.PureComponent),w=n(267),x=n.n(w),C=n(645),S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={fieldCount:0,fieldLabel:null,fieldStats:null,fieldValue:null,parsed:!1,parser:void 0,parsedFieldHighlights:[],showFieldStats:!1},t.onClickClose=function(){t.setState({showFieldStats:!1})},t.onClickHighlight=function(e){var n=t.props.getRows,a=t.state.parser,r=n(),o=a.getLabelFromField(e),i=a.getValueFromField(e),s=a.buildMatcher(o),l=Object(p.e)(r,s),c=l.reduce(function(e,t){return e+t.count},0);t.setState({fieldCount:c,fieldLabel:o,fieldStats:l,fieldValue:i,showFieldStats:!0})},t.onMouseOverMessage=function(){t.mouseMessageTimer=setTimeout(t.parseMessage,500)},t.onMouseOutMessage=function(){clearTimeout(t.mouseMessageTimer),t.setState({parsed:!1})},t.parseMessage=function(){if(!t.state.parsed){var e=t.props.row,n=Object(p.i)(e.entry);if(n){var a=n.getFields(t.props.row.entry);t.setState({parsedFieldHighlights:a,parsed:!0,parser:n})}}},t}return a.c(t,e),t.prototype.componentWillUnmount=function(){clearTimeout(this.mouseMessageTimer)},t.prototype.render=function(){var e=this.props,t=e.getRows,n=e.highlighterExpressions,a=e.onClickLabel,r=e.row,i=e.showDuplicates,l=e.showLabels,c=e.showLocalTime,u=e.showUtc,p=this.state,d=p.fieldCount,m=p.fieldLabel,h=p.fieldStats,g=p.fieldValue,v=p.parsed,y=p.parsedFieldHighlights,w=p.showFieldStats,S=n&&!o.a.isEqual(n,r.searchWords),k=S?n:r.searchWords,N=k&&k.length>0,T=f()("logs-row__match-highlight",{"logs-row__match-highlight--preview":S});return s.a.createElement("div",{className:"logs-row"},i&&s.a.createElement("div",{className:"logs-row__duplicates"},r.duplicates>0?r.duplicates+1+"x":null),s.a.createElement("div",{className:r.logLevel?"logs-row__level logs-row__level--"+r.logLevel:""}),u&&s.a.createElement("div",{className:"logs-row__time",title:"Local: "+r.timeLocal+" ("+r.timeFromNow+")"},r.timestamp),c&&s.a.createElement("div",{className:"logs-row__time",title:r.timestamp+" ("+r.timeFromNow+")"},r.timeLocal),l&&s.a.createElement("div",{className:"logs-row__labels"},s.a.createElement(E,{getRows:t,labels:r.uniqueLabels,onClickLabel:a})),s.a.createElement("div",{className:"logs-row__message",onMouseEnter:this.onMouseOverMessage,onMouseLeave:this.onMouseOutMessage},v&&s.a.createElement(x.a,{autoEscape:!0,highlightTag:function(e){return function(t){return s.a.createElement("span",{className:t.className,style:t.style},t.children,s.a.createElement("span",{className:"logs-row__field-highlight--icon fa fa-signal",onClick:function(){return e(t.children)}}))}}(this.onClickHighlight),textToHighlight:r.entry,searchWords:y,highlightClassName:"logs-row__field-highlight"}),!v&&N&&s.a.createElement(x.a,{textToHighlight:r.entry,searchWords:k,findChunks:C.a,highlightClassName:T}),!v&&!N&&r.entry,w&&s.a.createElement("div",{className:"logs-row__stats"},s.a.createElement(b,{stats:h,label:m,value:g,onClickClose:this.onClickClose,rowCount:d}))))},t}(i.PureComponent),k={series:{stack:!0,bars:{show:!0,lineWidth:5}},yaxis:{tickDecimals:0}};var N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={deferLogs:!0,renderAll:!1,showLabels:null,showLocalTime:!0,showUtc:!1},t.onChangeDedup=function(e){var n=t.props.onDedupStrategyChange;return t.props.dedupStrategy===e?n(p.c.none):n(e)},t.onChangeLabels=function(e){var n=e.target;t.setState({showLabels:n.checked})},t.onChangeLocalTime=function(e){var n=e.target;t.setState({showLocalTime:n.checked})},t.onChangeUtc=function(e){var n=e.target;t.setState({showUtc:n.checked})},t.onToggleLogLevel=function(e,n){var a=new Set(Array.from(n).map(function(e){return p.a[e]}));t.props.onToggleLogLevel(a)},t.onClickScan=function(e){e.preventDefault(),t.props.onStartScanning()},t.onClickStopScan=function(e){e.preventDefault(),t.props.onStopScanning()},t}return a.c(t,e),t.prototype.componentDidMount=function(){var e=this;if(this.state.deferLogs){var t=this.props.data,n=t&&t.rows?t.rows.length:0,a=n<=200;this.deferLogsTimer=setTimeout(function(){return e.setState({deferLogs:!1,renderAll:a})},n)}},t.prototype.componentDidUpdate=function(e,t){var n=this;!t.deferLogs||this.state.deferLogs||this.state.renderAll||(this.renderAllTimer=setTimeout(function(){return n.setState({renderAll:!0})},2e3))},t.prototype.componentWillUnmount=function(){clearTimeout(this.deferLogsTimer),clearTimeout(this.renderAllTimer)},t.prototype.render=function(){var e=this,t=this.props,n=t.data,a=t.exploreId,r=t.highlighterExpressions,i=t.loading,g=void 0!==i&&i,f=t.onClickLabel,v=t.range,b=t.scanning,y=t.scanRange,w=t.width,x=t.dedupedData;if(!n)return null;var C=this.state,N=C.deferLogs,T=C.renderAll,L=C.showLocalTime,O=C.showUtc,I=this.state.showLabels,_=this.props.dedupStrategy,R=n&&n.rows&&n.rows.length>0,j=_!==p.c.none,D=x.rows.reduce(function(e,t){return e+t.duplicates},0),q=n.meta.slice();_!==p.c.none&&q.push({label:"Dedup count",value:D,kind:p.d.Number});var P=x.rows,Q=P.slice(0,100),M=P.slice(100);null===I&&(I=!R||n.rows.some(function(e){return o.a.size(e.uniqueLabels)>0}));var A=y?"Scanning "+l.b(y):"Scanning...",H=function(){return P},F=n.series.map(function(e){return new u.a(e)});return s.a.createElement("div",{className:"logs-panel"},s.a.createElement("div",{className:"logs-panel-graph"},s.a.createElement(h.a,{data:F,height:100,width:w,range:v,id:"explore-logs-graph-"+a,onChangeTime:this.props.onChangeTime,onToggleSeries:this.onToggleLogLevel,userOptions:k})),s.a.createElement("div",{className:"logs-panel-options"},s.a.createElement("div",{className:"logs-panel-controls"},s.a.createElement(c.Switch,{label:"Timestamp",checked:O,onChange:this.onChangeUtc,transparent:!0}),s.a.createElement(c.Switch,{label:"Local time",checked:L,onChange:this.onChangeLocalTime,transparent:!0}),s.a.createElement(c.Switch,{label:"Labels",checked:I,onChange:this.onChangeLabels,transparent:!0}),s.a.createElement(d,{label:"Dedup",transparent:!0},Object.keys(p.c).map(function(t,n){return s.a.createElement(m,{key:n,value:t,onChange:e.onChangeDedup,selected:_===t,tooltip:p.b[t]},t)})))),R&&q&&s.a.createElement("div",{className:"logs-panel-meta"},q.map(function(e){return s.a.createElement("div",{className:"logs-panel-meta__item",key:e.label},s.a.createElement("span",{className:"logs-panel-meta__label"},e.label,":"),s.a.createElement("span",{className:"logs-panel-meta__value"},function(e,t){return t===p.d.LabelsMap?s.a.createElement("span",{className:"logs-meta-item__labels"},s.a.createElement(E,{labels:e,plain:!0})):e}(e.value,e.kind)))})),s.a.createElement("div",{className:"logs-rows"},R&&!N&&Q.map(function(e){return s.a.createElement(S,{key:e.key+e.duplicates,getRows:H,highlighterExpressions:r,row:e,showDuplicates:j,showLabels:I,showLocalTime:L,showUtc:O,onClickLabel:f})}),R&&!N&&T&&M.map(function(e){return s.a.createElement(S,{key:e.key+e.duplicates,getRows:H,row:e,showDuplicates:j,showLabels:I,showLocalTime:L,showUtc:O,onClickLabel:f})}),R&&N&&s.a.createElement("span",null,"Rendering ",x.rows.length," rows...")),!g&&!R&&!b&&s.a.createElement("div",{className:"logs-panel-nodata"},"No logs found.",s.a.createElement("a",{className:"link",onClick:this.onClickScan},"Scan for older logs")),b&&s.a.createElement("div",{className:"logs-panel-nodata"},s.a.createElement("span",null,A),s.a.createElement("a",{className:"link",onClick:this.onClickStopScan},"Stop scan")))},t}(i.PureComponent);t.a=N},1467:function(e,t,n){"use strict";var a=n(1),r=n(1448),o=Object(r.a)(a.memoize,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce(function(e,t){return e+"-"+JSON.stringify(t)},"")}),i=n(109);n.d(t,"b",function(){return s}),n.d(t,"a",function(){return l});var s=function(e){return{showingGraph:e.showingGraph,showingLogs:e.showingLogs,showingTable:e.showingTable,showingStartPage:e.showingStartPage,dedupStrategy:e.dedupStrategy}},l=o(function(e){return e.logsResult},function(e){return e.hiddenLogLevels},function(e){return e.dedupStrategy},function(e,t,n){if(!e)return null;var a=Object(i.h)(e,new Set(t));return Object(i.g)(a,n)})},1468:function(e,t,n){"use strict";var a=n(2),r=n(0),o=n.n(r),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={elapsed:0},t.tick=function(){var e=Date.now()-t.offset;t.setState({elapsed:e})},t}return a.c(t,e),t.prototype.start=function(){this.offset=Date.now(),this.timer=window.setInterval(this.tick,150)},t.prototype.componentWillReceiveProps=function(e){e.time?clearInterval(this.timer):this.props.time&&this.start()},t.prototype.componentDidMount=function(){this.start()},t.prototype.componentWillUnmount=function(){clearInterval(this.timer)},t.prototype.render=function(){var e=this.state.elapsed,t=this.props,n=t.className,a=(t.time||e)/1e3;return o.a.createElement("span",{className:"elapsed-time "+n},a.toFixed(1),"s")},t}(r.PureComponent);var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.c(t,e),t.prototype.render=function(){var e=this.props.transaction,t=e.done?"query-transaction":"query-transaction query-transaction--loading";return o.a.createElement("div",{className:t},o.a.createElement("div",{className:"query-transaction__type"},e.resultType,":"),o.a.createElement("div",{className:"query-transaction__duration"},e.done?function(e){return(e/1e3).toFixed(1)+"s"}(e.latency):o.a.createElement(i,null)))},t}(r.PureComponent),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.c(t,e),t.prototype.render=function(){var e=this.props.transactions;return o.a.createElement("div",{className:"query-transactions"},e.map(function(e,t){return o.a.createElement(s,{key:e.rowIndex+":"+e.resultType,transaction:e})}))},t}(r.PureComponent);t.a=l},1469:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"Wrapper",function(){return g});var a=n(2),r=n(0),o=n.n(r),i=n(38),s=n(23),l=n(27),c=n(194),u=n(64),p=n(1452),d=n(1455),m=n(6),h=n(40),g=function(e){function t(t){var n=e.call(this,t)||this;n.urlStates={};var a=t.urlStates,r=a.left,o=a.right;return t.urlStates.left&&(n.urlStates.leftState=Object(u.n)(r)),t.urlStates.right&&(n.urlStates.rightState=Object(u.n)(o),n.initialSplit=!0),n}return a.c(t,e),t.prototype.componentDidMount=function(){this.initialSplit&&this.props.initializeExploreSplitAction()},t.prototype.componentWillUnmount=function(){this.props.resetExploreAction()},t.prototype.render=function(){var e=this.props.split,t=this.urlStates,n=t.leftState,a=t.rightState;return o.a.createElement("div",{className:"page-scrollbar-wrapper"},o.a.createElement(m.CustomScrollbar,{autoHeightMin:"100%"},o.a.createElement("div",{className:"explore-wrapper"},o.a.createElement(p.a,null,o.a.createElement(d.a,{exploreId:c.a.left,urlState:n})),e&&o.a.createElement(p.a,null,o.a.createElement(d.a,{exploreId:c.a.right,urlState:a})))))},t}(r.Component),f={initializeExploreSplitAction:h.i,updateLocation:l.c,resetExploreAction:h.t};t.default=Object(i.hot)(e)(Object(s.b)(function(e){var t=e.location.query;return{split:e.explore.split,urlStates:t}},f)(g))}.call(this,n(74)(e))}}]);
//# sourceMappingURL=explore.1ad4438ca348dc27f022.js.map