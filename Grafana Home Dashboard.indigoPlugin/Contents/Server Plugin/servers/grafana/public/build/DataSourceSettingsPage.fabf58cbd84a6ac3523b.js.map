{"version":3,"sources":["webpack:///./public/app/features/datasources/settings/ButtonRow.tsx","webpack:///./public/app/features/plugins/PluginStateInfo.tsx","webpack:///./public/app/features/datasources/settings/PluginSettings.tsx","webpack:///./public/app/features/datasources/settings/BasicSettings.tsx","webpack:///./public/app/features/datasources/settings/DataSourceSettingsPage.tsx","webpack:///./public/app/core/selectors/location.ts","webpack:///./public/app/features/datasources/state/selectors.ts"],"names":["react__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","react__WEBPACK_IMPORTED_MODULE_0___default","n","app_core_config__WEBPACK_IMPORTED_MODULE_1__","__webpack_exports__","_a","isReadOnly","onDelete","onSubmit","onTest","a","createElement","className","type","disabled","onClick","event","aria-label","href","appSubUrl","props","text","state","_grafana_data__WEBPACK_IMPORTED_MODULE_3__","alpha","beta","getPluginStateInfoText","react__WEBPACK_IMPORTED_MODULE_1___default","_grafana_ui__WEBPACK_IMPORTED_MODULE_2__","Object","emotion__WEBPACK_IMPORTED_MODULE_4__","templateObject_1","tslib__WEBPACK_IMPORTED_MODULE_0__","PluginSettings","_super","_this","call","this","onModelChanged","dataSource","onModelChange","scopeProps","ctrl","datasourceMeta","dataSourceMeta","current","lodash__WEBPACK_IMPORTED_MODULE_2___default","cloneDeep","bind","prototype","componentDidMount","plugin","element","components","ConfigEditor","loader","_grafana_runtime__WEBPACK_IMPORTED_MODULE_3__","component","load","componentDidUpdate","prevProps","digest","componentWillUnmount","destroy","render","ref","options","onOptionsChange","react__WEBPACK_IMPORTED_MODULE_1__","_grafana_ui__WEBPACK_IMPORTED_MODULE_1__","dataSourceName","isDefault","onDefaultChange","onNameChange","style","marginRight","tooltip","value","placeholder","onChange","target","required","label","checked","DataSourceSettingsPage","evt","preventDefault","updateDataSource","sent","testDataSource","app_core_app_events__WEBPACK_IMPORTED_MODULE_9__","emit","app_types___WEBPACK_IMPORTED_MODULE_16__","showConfirmModal","title","yesText","icon","onConfirm","confirmDelete","deleteDataSource","dataSourceLoaded","loadPlugin","pluginId","app_features_plugins_plugin_loader__WEBPACK_IMPORTED_MODULE_19__","importedPlugin","console","log","e_1","setState","loadDataSource","pageId","isNaN","loadError","_b","err_1","readOnly","renderIsReadOnlyMessage","app_features_plugins_datasource_srv__WEBPACK_IMPORTED_MODULE_11__","get","name","dsApi","testDatasource","isTesting","testingMessage","testingStatus","app_core_services_backend_srv__WEBPACK_IMPORTED_MODULE_10__","withNoBackendCache","result","status","message","err_2","statusText","defineProperty","id","renderLoadError","showDelete","msg","toString","data","lodash_isString__WEBPACK_IMPORTED_MODULE_4___default","node","subTitle","nav","main","app_core_components_Page_Page__WEBPACK_IMPORTED_MODULE_5__","navModel","Contents","renderConfigPageBody","page","configPages","_c","next","done","p","body","query","renderSettings","setDataSourceName","setIsDefault","app_features_plugins_PluginStateInfo__WEBPACK_IMPORTED_MODULE_18__","_BasicSettings__WEBPACK_IMPORTED_MODULE_7__","_PluginSettings__WEBPACK_IMPORTED_MODULE_6__","_ButtonRow__WEBPACK_IMPORTED_MODULE_8__","isLoading","hasDataSource","mapDispatchToProps","_state_actions__WEBPACK_IMPORTED_MODULE_13__","react_hot_loader__WEBPACK_IMPORTED_MODULE_2__","module","react_redux__WEBPACK_IMPORTED_MODULE_3__","app_core_selectors_location__WEBPACK_IMPORTED_MODULE_15__","location","_state_selectors__WEBPACK_IMPORTED_MODULE_12__","dataSources","app_core_selectors_navModel__WEBPACK_IMPORTED_MODULE_14__","navIndex","_state_navModel__WEBPACK_IMPORTED_MODULE_17__","d","getRouteParamsId","getRouteParamsPage","routeParams","getDataSources","getDataSourceTypes","getDataSource","getDataSourceMeta","getDataSourcesSearchQuery","getDataSourcesLayoutMode","getDataSourcesCount","regex","RegExp","searchQuery","filter","test","database","dataSourceTypeSearchQuery","dataSourceTypes","dataSourceId","parseInt","layoutMode","dataSourcesCount"],"mappings":"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","file":"DataSourceSettingsPage.fabf58cbd84a6ac3523b.js","sourcesContent":["import React, { FC } from 'react';\nimport config from 'app/core/config';\n\nexport interface Props {\n  isReadOnly: boolean;\n  onDelete: () => void;\n  onSubmit: (event: any) => void;\n  onTest: (event: any) => void;\n}\n\nconst ButtonRow: FC<Props> = ({ isReadOnly, onDelete, onSubmit, onTest }) => {\n  return (\n    <div className=\"gf-form-button-row\">\n      {!isReadOnly && (\n        <button\n          type=\"submit\"\n          className=\"btn btn-primary\"\n          disabled={isReadOnly}\n          onClick={event => onSubmit(event)}\n          aria-label=\"Save and Test button\"\n        >\n          Save &amp; Test\n        </button>\n      )}\n      {isReadOnly && (\n        <button type=\"submit\" className=\"btn btn-success\" onClick={onTest}>\n          Test\n        </button>\n      )}\n      <button\n        type=\"submit\"\n        className=\"btn btn-danger\"\n        disabled={isReadOnly}\n        onClick={onDelete}\n        aria-label=\"Delete button\"\n      >\n        Delete\n      </button>\n      <a className=\"btn btn-inverse\" href={`${config.appSubUrl}/datasources`}>\n        Back\n      </a>\n    </div>\n  );\n};\n\nexport default ButtonRow;\n","import React, { FC } from 'react';\nimport { AlphaNotice } from '@grafana/ui';\nimport { PluginState } from '@grafana/data';\nimport { css } from 'emotion';\n\ninterface Props {\n  state?: PluginState;\n}\n\nfunction getPluginStateInfoText(state?: PluginState): string | null {\n  switch (state) {\n    case PluginState.alpha:\n      return 'Alpha Plugin: This plugin is a work in progress and updates may include breaking changes';\n    case PluginState.beta:\n      return 'Beta Plugin: There could be bugs and minor breaking changes to this plugin';\n  }\n  return null;\n}\n\nconst PluginStateinfo: FC<Props> = props => {\n  const text = getPluginStateInfoText(props.state);\n\n  if (!text) {\n    return null;\n  }\n\n  return (\n    <AlphaNotice\n      state={props.state}\n      text={text}\n      className={css`\n        margin-left: 16px;\n      `}\n    />\n  );\n};\n\nexport default PluginStateinfo;\n","import React, { PureComponent } from 'react';\nimport _ from 'lodash';\nimport {\n  DataSourceSettings,\n  DataSourcePlugin,\n  DataSourcePluginMeta,\n  DataSourceApi,\n  DataQuery,\n  DataSourceJsonData,\n} from '@grafana/data';\nimport { getAngularLoader, AngularComponent } from '@grafana/runtime';\n\nexport type GenericDataSourcePlugin = DataSourcePlugin<DataSourceApi<DataQuery, DataSourceJsonData>>;\n\nexport interface Props {\n  plugin: GenericDataSourcePlugin;\n  dataSource: DataSourceSettings;\n  dataSourceMeta: DataSourcePluginMeta;\n  onModelChange: (dataSource: DataSourceSettings) => void;\n}\n\nexport class PluginSettings extends PureComponent<Props> {\n  element: any;\n  component: AngularComponent;\n  scopeProps: {\n    ctrl: { datasourceMeta: DataSourcePluginMeta; current: DataSourceSettings };\n    onModelChanged: (dataSource: DataSourceSettings) => void;\n  };\n\n  constructor(props: Props) {\n    super(props);\n\n    this.scopeProps = {\n      ctrl: { datasourceMeta: props.dataSourceMeta, current: _.cloneDeep(props.dataSource) },\n      onModelChanged: this.onModelChanged,\n    };\n    this.onModelChanged = this.onModelChanged.bind(this);\n  }\n\n  componentDidMount() {\n    const { plugin } = this.props;\n\n    if (!this.element) {\n      return;\n    }\n\n    if (!plugin.components.ConfigEditor) {\n      // React editor is not specified, let's render angular editor\n      // How to apprach this better? Introduce ReactDataSourcePlugin interface and typeguard it here?\n      const loader = getAngularLoader();\n      const template = '<plugin-component type=\"datasource-config-ctrl\" />';\n\n      this.component = loader.load(this.element, this.scopeProps, template);\n    }\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    const { plugin } = this.props;\n    if (!plugin.components.ConfigEditor && this.props.dataSource !== prevProps.dataSource) {\n      this.scopeProps.ctrl.current = _.cloneDeep(this.props.dataSource);\n\n      this.component.digest();\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.component) {\n      this.component.destroy();\n    }\n  }\n\n  onModelChanged = (dataSource: DataSourceSettings) => {\n    this.props.onModelChange(dataSource);\n  };\n\n  render() {\n    const { plugin, dataSource } = this.props;\n\n    if (!plugin) {\n      return null;\n    }\n\n    return (\n      <div ref={element => (this.element = element)}>\n        {plugin.components.ConfigEditor &&\n          React.createElement(plugin.components.ConfigEditor, {\n            options: dataSource,\n            onOptionsChange: this.onModelChanged,\n          })}\n      </div>\n    );\n  }\n}\n\nexport default PluginSettings;\n","import React, { FC } from 'react';\nimport { FormLabel, Input, Switch } from '@grafana/ui';\n\nexport interface Props {\n  dataSourceName: string;\n  isDefault: boolean;\n  onNameChange: (name: string) => void;\n  onDefaultChange: (value: boolean) => void;\n}\n\nconst BasicSettings: FC<Props> = ({ dataSourceName, isDefault, onDefaultChange, onNameChange }) => {\n  return (\n    <div className=\"gf-form-group\" aria-label=\"Datasource settings page basic settings\">\n      <div className=\"gf-form-inline\">\n        <div className=\"gf-form max-width-30\" style={{ marginRight: '3px' }}>\n          <FormLabel\n            tooltip={\n              'The name is used when you select the data source in panels. The Default data source is ' +\n              'preselected in new panels.'\n            }\n          >\n            Name\n          </FormLabel>\n          <Input\n            className=\"gf-form-input max-width-23\"\n            type=\"text\"\n            value={dataSourceName}\n            placeholder=\"Name\"\n            onChange={event => onNameChange(event.target.value)}\n            required\n            aria-label=\"Datasource settings page name input field\"\n          />\n        </div>\n        <Switch\n          label=\"Default\"\n          checked={isDefault}\n          onChange={event => {\n            // @ts-ignore\n            onDefaultChange(event.target.checked);\n          }}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default BasicSettings;\n","// Libraries\nimport React, { PureComponent } from 'react';\nimport { hot } from 'react-hot-loader';\nimport { connect } from 'react-redux';\nimport isString from 'lodash/isString';\n// Components\nimport Page from 'app/core/components/Page/Page';\nimport { GenericDataSourcePlugin, PluginSettings } from './PluginSettings';\nimport BasicSettings from './BasicSettings';\nimport ButtonRow from './ButtonRow';\n// Services & Utils\nimport appEvents from 'app/core/app_events';\nimport { getBackendSrv } from 'app/core/services/backend_srv';\nimport { getDatasourceSrv } from 'app/features/plugins/datasource_srv';\n// Actions & selectors\nimport { getDataSource, getDataSourceMeta } from '../state/selectors';\nimport {\n  dataSourceLoaded,\n  deleteDataSource,\n  loadDataSource,\n  setDataSourceName,\n  setIsDefault,\n  updateDataSource,\n} from '../state/actions';\nimport { getNavModel } from 'app/core/selectors/navModel';\nimport { getRouteParamsId } from 'app/core/selectors/location';\n// Types\nimport { CoreEvents, StoreState } from 'app/types/';\nimport { UrlQueryMap } from '@grafana/runtime';\nimport { DataSourcePluginMeta, DataSourceSettings, NavModel } from '@grafana/data';\nimport { getDataSourceLoadingNav } from '../state/navModel';\nimport PluginStateinfo from 'app/features/plugins/PluginStateInfo';\nimport { importDataSourcePlugin } from 'app/features/plugins/plugin_loader';\n\nexport interface Props {\n  navModel: NavModel;\n  dataSource: DataSourceSettings;\n  dataSourceMeta: DataSourcePluginMeta;\n  pageId: number;\n  deleteDataSource: typeof deleteDataSource;\n  loadDataSource: typeof loadDataSource;\n  setDataSourceName: typeof setDataSourceName;\n  updateDataSource: typeof updateDataSource;\n  setIsDefault: typeof setIsDefault;\n  dataSourceLoaded: typeof dataSourceLoaded;\n  plugin?: GenericDataSourcePlugin;\n  query: UrlQueryMap;\n  page?: string;\n}\n\ninterface State {\n  plugin?: GenericDataSourcePlugin;\n  isTesting?: boolean;\n  testingMessage?: string;\n  testingStatus?: string;\n  loadError?: any;\n}\n\nexport class DataSourceSettingsPage extends PureComponent<Props, State> {\n  constructor(props: Props) {\n    super(props);\n\n    this.state = {\n      plugin: props.plugin,\n    };\n  }\n\n  async loadPlugin(pluginId?: string) {\n    const { dataSourceMeta } = this.props;\n    let importedPlugin: GenericDataSourcePlugin;\n\n    try {\n      importedPlugin = await importDataSourcePlugin(dataSourceMeta);\n    } catch (e) {\n      console.log('Failed to import plugin module', e);\n    }\n\n    this.setState({ plugin: importedPlugin });\n  }\n\n  async componentDidMount() {\n    const { loadDataSource, pageId } = this.props;\n    if (isNaN(pageId)) {\n      this.setState({ loadError: 'Invalid ID' });\n      return;\n    }\n    try {\n      await loadDataSource(pageId);\n      if (!this.state.plugin) {\n        await this.loadPlugin();\n      }\n    } catch (err) {\n      this.setState({ loadError: err });\n    }\n  }\n\n  onSubmit = async (evt: React.FormEvent<HTMLFormElement>) => {\n    evt.preventDefault();\n\n    await this.props.updateDataSource({ ...this.props.dataSource });\n\n    this.testDataSource();\n  };\n\n  onTest = async (evt: React.FormEvent<HTMLFormElement>) => {\n    evt.preventDefault();\n\n    this.testDataSource();\n  };\n\n  onDelete = () => {\n    appEvents.emit(CoreEvents.showConfirmModal, {\n      title: 'Delete',\n      text: 'Are you sure you want to delete this data source?',\n      yesText: 'Delete',\n      icon: 'fa-trash',\n      onConfirm: () => {\n        this.confirmDelete();\n      },\n    });\n  };\n\n  confirmDelete = () => {\n    this.props.deleteDataSource();\n  };\n\n  onModelChange = (dataSource: DataSourceSettings) => {\n    this.props.dataSourceLoaded(dataSource);\n  };\n\n  isReadOnly() {\n    return this.props.dataSource.readOnly === true;\n  }\n\n  renderIsReadOnlyMessage() {\n    return (\n      <div className=\"grafana-info-box span8\">\n        This datasource was added by config and cannot be modified using the UI. Please contact your server admin to\n        update this datasource.\n      </div>\n    );\n  }\n\n  async testDataSource() {\n    const dsApi = await getDatasourceSrv().get(this.props.dataSource.name);\n\n    if (!dsApi.testDatasource) {\n      return;\n    }\n\n    this.setState({ isTesting: true, testingMessage: 'Testing...', testingStatus: 'info' });\n\n    getBackendSrv().withNoBackendCache(async () => {\n      try {\n        const result = await dsApi.testDatasource();\n\n        this.setState({\n          isTesting: false,\n          testingStatus: result.status,\n          testingMessage: result.message,\n        });\n      } catch (err) {\n        let message = '';\n\n        if (err.statusText) {\n          message = 'HTTP Error ' + err.statusText;\n        } else {\n          message = err.message;\n        }\n\n        this.setState({\n          isTesting: false,\n          testingStatus: 'error',\n          testingMessage: message,\n        });\n      }\n    });\n  }\n\n  get hasDataSource() {\n    return this.props.dataSource.id > 0;\n  }\n\n  renderLoadError(loadError: any) {\n    let showDelete = false;\n    let msg = loadError.toString();\n    if (loadError.data) {\n      if (loadError.data.message) {\n        msg = loadError.data.message;\n      }\n    } else if (isString(loadError)) {\n      showDelete = true;\n    }\n\n    const node = {\n      text: msg,\n      subTitle: 'Data Source Error',\n      icon: 'fa fa-fw fa-warning',\n    };\n    const nav = {\n      node: node,\n      main: node,\n    };\n\n    return (\n      <Page navModel={nav}>\n        <Page.Contents>\n          <div>\n            <div className=\"gf-form-button-row\">\n              {showDelete && (\n                <button type=\"submit\" className=\"btn btn-danger\" onClick={this.onDelete}>\n                  Delete\n                </button>\n              )}\n              <a className=\"btn btn-inverse\" href=\"datasources\">\n                Back\n              </a>\n            </div>\n          </div>\n        </Page.Contents>\n      </Page>\n    );\n  }\n\n  renderConfigPageBody(page: string) {\n    const { plugin } = this.state;\n    if (!plugin || !plugin.configPages) {\n      return null; // still loading\n    }\n\n    for (const p of plugin.configPages) {\n      if (p.id === page) {\n        return <p.body plugin={plugin} query={this.props.query} />;\n      }\n    }\n\n    return <div>Page Not Found: {page}</div>;\n  }\n\n  renderSettings() {\n    const { dataSourceMeta, setDataSourceName, setIsDefault, dataSource } = this.props;\n    const { testingMessage, testingStatus, plugin } = this.state;\n\n    return (\n      <form onSubmit={this.onSubmit}>\n        {this.isReadOnly() && this.renderIsReadOnlyMessage()}\n        {dataSourceMeta.state && (\n          <div className=\"gf-form\">\n            <label className=\"gf-form-label width-10\">Plugin state</label>\n            <label className=\"gf-form-label gf-form-label--transparent\">\n              <PluginStateinfo state={dataSourceMeta.state} />\n            </label>\n          </div>\n        )}\n\n        <BasicSettings\n          dataSourceName={dataSource.name}\n          isDefault={dataSource.isDefault}\n          onDefaultChange={state => setIsDefault(state)}\n          onNameChange={name => setDataSourceName(name)}\n        />\n\n        {plugin && (\n          <PluginSettings\n            plugin={plugin}\n            dataSource={dataSource}\n            dataSourceMeta={dataSourceMeta}\n            onModelChange={this.onModelChange}\n          />\n        )}\n\n        <div className=\"gf-form-group\">\n          {testingMessage && (\n            <div className={`alert-${testingStatus} alert`} aria-label=\"Datasource settings page Alert\">\n              <div className=\"alert-icon\">\n                {testingStatus === 'error' ? (\n                  <i className=\"fa fa-exclamation-triangle\" />\n                ) : (\n                  <i className=\"fa fa-check\" />\n                )}\n              </div>\n              <div className=\"alert-body\">\n                <div className=\"alert-title\" aria-label=\"Datasource settings page Alert message\">\n                  {testingMessage}\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n\n        <ButtonRow\n          onSubmit={event => this.onSubmit(event)}\n          isReadOnly={this.isReadOnly()}\n          onDelete={this.onDelete}\n          onTest={event => this.onTest(event)}\n        />\n      </form>\n    );\n  }\n\n  render() {\n    const { navModel, page } = this.props;\n    const { loadError } = this.state;\n\n    if (loadError) {\n      return this.renderLoadError(loadError);\n    }\n\n    return (\n      <Page navModel={navModel}>\n        <Page.Contents isLoading={!this.hasDataSource}>\n          {this.hasDataSource && <div>{page ? this.renderConfigPageBody(page) : this.renderSettings()}</div>}\n        </Page.Contents>\n      </Page>\n    );\n  }\n}\n\nfunction mapStateToProps(state: StoreState) {\n  const pageId = getRouteParamsId(state.location);\n  const dataSource = getDataSource(state.dataSources, pageId);\n  const page = state.location.query.page as string;\n\n  return {\n    navModel: getNavModel(\n      state.navIndex,\n      page ? `datasource-page-${page}` : `datasource-settings-${pageId}`,\n      getDataSourceLoadingNav('settings')\n    ),\n    dataSource: getDataSource(state.dataSources, pageId),\n    dataSourceMeta: getDataSourceMeta(state.dataSources, dataSource.type),\n    pageId: pageId,\n    query: state.location.query,\n    page,\n  };\n}\n\nconst mapDispatchToProps = {\n  deleteDataSource,\n  loadDataSource,\n  setDataSourceName,\n  updateDataSource,\n  setIsDefault,\n  dataSourceLoaded,\n};\n\nexport default hot(module)(\n  connect(\n    mapStateToProps,\n    mapDispatchToProps\n  )(DataSourceSettingsPage)\n);\n","import { LocationState } from 'app/types';\n\nexport const getRouteParamsId = (state: LocationState) => state.routeParams.id;\nexport const getRouteParamsPage = (state: LocationState) => state.routeParams.page;\n","import { DataSourceSettings, DataSourcePluginMeta } from '@grafana/data';\nimport { DataSourcesState } from '../../../types/datasources';\nimport { UrlQueryValue } from '@grafana/runtime';\n\nexport const getDataSources = (state: DataSourcesState) => {\n  const regex = new RegExp(state.searchQuery, 'i');\n\n  return state.dataSources.filter((dataSource: DataSourceSettings) => {\n    return regex.test(dataSource.name) || regex.test(dataSource.database);\n  });\n};\n\nexport const getDataSourceTypes = (state: DataSourcesState) => {\n  const regex = new RegExp(state.dataSourceTypeSearchQuery, 'i');\n\n  return state.dataSourceTypes.filter((type: DataSourcePluginMeta) => {\n    return regex.test(type.name);\n  });\n};\n\nexport const getDataSource = (state: DataSourcesState, dataSourceId: UrlQueryValue): DataSourceSettings | null => {\n  if (state.dataSource.id === parseInt(dataSourceId as string, 10)) {\n    return state.dataSource;\n  }\n  return {} as DataSourceSettings;\n};\n\nexport const getDataSourceMeta = (state: DataSourcesState, type: string): DataSourcePluginMeta => {\n  if (state.dataSourceMeta.id === type) {\n    return state.dataSourceMeta;\n  }\n\n  return {} as DataSourcePluginMeta;\n};\n\nexport const getDataSourcesSearchQuery = (state: DataSourcesState) => state.searchQuery;\nexport const getDataSourcesLayoutMode = (state: DataSourcesState) => state.layoutMode;\nexport const getDataSourcesCount = (state: DataSourcesState) => state.dataSourcesCount;\n"],"sourceRoot":""}