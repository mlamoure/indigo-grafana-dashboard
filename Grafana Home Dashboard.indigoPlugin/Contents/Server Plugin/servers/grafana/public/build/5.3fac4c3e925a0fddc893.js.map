{"version":3,"sources":["webpack:///./public/vendor/flot/jquery.flot.selection.js","webpack:///./public/vendor/flot/jquery.flot.stack.js","webpack:///./public/vendor/flot/jquery.flot.stackpercent.js","webpack:///./public/vendor/flot/jquery.flot.fillbelow.js","webpack:///./public/vendor/flot/jquery.flot.crosshair.js","webpack:///./public/vendor/flot/jquery.flot.dashes.js","webpack:///./public/vendor/flot/jquery.flot.gauge.js","webpack:///./public/app/plugins/datasource/prometheus/mode-prometheus.js","webpack:///./public/app/plugins/datasource/prometheus/snippets/prometheus.js","webpack:///./public/vendor/flot/jquery.flot.pie.js","webpack:///./public/app/features/annotations/editor_ctrl.ts","webpack:///./public/app/features/annotations/events_processing.ts","webpack:///./public/app/features/annotations/annotations_srv.ts","webpack:///./public/app/features/annotations/event_editor.ts","webpack:///./public/app/features/annotations/event.ts","webpack:///./public/app/features/annotations/event_manager.ts","webpack:///./public/app/features/annotations/annotation_tooltip.ts","webpack:///./public/app/features/annotations/all.ts","webpack:///./public/app/features/templating/variable.ts","webpack:///./public/app/features/templating/editor_ctrl.ts","webpack:///./public/app/features/templating/template_srv.ts","webpack:///./public/app/core/utils/dag.ts","webpack:///./public/app/features/templating/variable_srv.ts","webpack:///./public/app/features/templating/interval_variable.ts","webpack:///./public/app/features/templating/query_variable.ts","webpack:///./public/app/features/templating/datasource_variable.ts","webpack:///./public/app/features/templating/custom_variable.ts","webpack:///./public/app/features/templating/constant_variable.ts","webpack:///./public/app/features/templating/adhoc_variable.ts","webpack:///./public/app/features/templating/TextBoxVariable.ts","webpack:///./public/app/features/plugins/plugin_edit_ctrl.ts","webpack:///./public/app/features/templating/all.ts","webpack:///./public/app/features/plugins/plugin_page_ctrl.ts","webpack:///./public/app/features/plugins/import_list/import_list.ts","webpack:///./public/app/features/plugins/state/navModel.ts","webpack:///./public/app/features/plugins/ds_edit_ctrl.ts","webpack:///./public/app/features/plugins/ds_dashboards_ctrl.ts","webpack:///./public/app/features/panel/panel_ctrl.ts","webpack:///./public/app/features/panel/metrics_tab.ts","webpack:///./public/app/features/panel/metrics_panel_ctrl.ts","webpack:///./public/app/features/panel/query_ctrl.ts","webpack:///./public/app/features/alerting/state/ThresholdMapper.ts","webpack:///./public/app/features/alerting/AlertTabCtrl.ts","webpack:///./public/app/plugins/sdk.ts","webpack:///./public/app/core/utils/file_export.ts","webpack:///./public/app/core/utils/flatten.ts","webpack:///./public/app/core/utils/version.ts","webpack:///./public/app/plugins/datasource/graphite/gfunc.ts","webpack:///./public/app/plugins/datasource/graphite/datasource.ts","webpack:///./public/app/plugins/datasource/graphite/add_graphite_func.ts","webpack:///./public/app/plugins/datasource/graphite/func_editor.ts","webpack:///./public/app/plugins/datasource/graphite/lexer.ts","webpack:///./public/app/plugins/datasource/graphite/parser.ts","webpack:///./public/app/plugins/datasource/graphite/graphite_query.ts","webpack:///./public/app/plugins/datasource/graphite/query_ctrl.ts","webpack:///./public/app/plugins/datasource/graphite/config_ctrl.ts","webpack:///./public/app/plugins/datasource/graphite/module.ts","webpack:///./public/app/plugins/datasource/cloudwatch/query_parameter_ctrl.ts","webpack:///./public/app/plugins/datasource/cloudwatch/datasource.ts","webpack:///./public/app/plugins/datasource/cloudwatch/config_ctrl.ts","webpack:///./public/app/plugins/datasource/cloudwatch/query_ctrl.ts","webpack:///./public/app/plugins/datasource/cloudwatch/module.ts","webpack:///./public/app/plugins/datasource/elasticsearch/query_def.ts","webpack:///./public/app/plugins/datasource/elasticsearch/query_builder.ts","webpack:///./public/app/plugins/datasource/elasticsearch/index_pattern.ts","webpack:///./public/app/plugins/datasource/elasticsearch/elastic_response.ts","webpack:///./public/app/plugins/datasource/elasticsearch/datasource.ts","webpack:///./public/app/plugins/datasource/elasticsearch/bucket_agg.ts","webpack:///./public/app/plugins/datasource/elasticsearch/metric_agg.ts","webpack:///./public/app/plugins/datasource/elasticsearch/query_ctrl.ts","webpack:///./public/app/plugins/datasource/opentsdb/datasource.ts","webpack:///./public/app/plugins/datasource/elasticsearch/config_ctrl.ts","webpack:///./public/app/plugins/datasource/elasticsearch/module.ts","webpack:///./public/app/plugins/datasource/opentsdb/query_ctrl.ts","webpack:///./public/app/plugins/datasource/opentsdb/config_ctrl.ts","webpack:///./public/app/plugins/datasource/opentsdb/module.ts","webpack:///./public/app/plugins/datasource/grafana/datasource.ts","webpack:///./public/app/plugins/datasource/grafana/module.ts","webpack:///./public/app/plugins/datasource/influxdb/influx_series.ts","webpack:///./public/app/plugins/datasource/influxdb/query_part.ts","webpack:///./public/app/plugins/datasource/influxdb/influx_query.ts","webpack:///./public/app/plugins/datasource/influxdb/response_parser.ts","webpack:///./public/app/plugins/datasource/influxdb/query_builder.ts","webpack:///./public/app/plugins/datasource/influxdb/datasource.ts","webpack:///./public/app/plugins/datasource/influxdb/query_ctrl.ts","webpack:///./public/app/plugins/datasource/logging/result_transformer.ts","webpack:///./public/app/plugins/datasource/influxdb/module.ts","webpack:///./public/app/core/logs_model.ts","webpack:///./public/app/plugins/datasource/logging/datasource.ts","webpack:///./public/app/plugins/datasource/mysql/response_parser.ts","webpack:///./public/app/plugins/datasource/logging/module.ts","webpack:///./public/app/plugins/datasource/mixed/datasource.ts","webpack:///./public/app/plugins/datasource/mixed/module.ts","webpack:///./public/app/plugins/datasource/mysql/datasource.ts","webpack:///./public/app/plugins/datasource/mysql/module.ts","webpack:///./public/app/plugins/datasource/mysql/query_ctrl.ts","webpack:///./public/app/plugins/datasource/postgres/response_parser.ts","webpack:///./public/app/plugins/datasource/postgres/postgres_query.ts","webpack:///./public/app/plugins/datasource/postgres/datasource.ts","webpack:///./public/app/plugins/datasource/postgres/meta_query.ts","webpack:///./public/app/core/components/sql_part/sql_part.ts","webpack:///./public/app/plugins/datasource/postgres/sql_part.ts","webpack:///./public/app/plugins/datasource/postgres/query_ctrl.ts","webpack:///./public/app/plugins/datasource/postgres/module.ts","webpack:///./public/app/plugins/datasource/postgres/config_ctrl.ts","webpack:///./public/app/plugins/datasource/prometheus/metric_find_query.ts","webpack:///./public/app/plugins/datasource/prometheus/result_transformer.ts","webpack:///./public/app/plugins/datasource/prometheus/add_label_to_query.ts","webpack:///./public/app/plugins/datasource/prometheus/datasource.ts","webpack:///./public/app/plugins/datasource/stackdriver/constants.ts","webpack:///./public/app/plugins/datasource/prometheus/completer.ts","webpack:///./public/app/plugins/datasource/prometheus/query_ctrl.ts","webpack:///./public/app/plugins/datasource/prometheus/config_ctrl.ts","webpack:///./public/app/plugins/datasource/prometheus/module.ts","webpack:///./public/app/plugins/datasource/mssql/response_parser.ts","webpack:///./public/app/plugins/datasource/mssql/datasource.ts","webpack:///./public/app/plugins/datasource/mssql/module.ts","webpack:///./public/app/plugins/datasource/mssql/query_ctrl.ts","webpack:///./public/app/plugins/datasource/testdata/datasource.ts","webpack:///./public/app/plugins/datasource/testdata/query_ctrl.ts","webpack:///./public/app/plugins/datasource/testdata/module.ts","webpack:///./public/app/plugins/datasource/stackdriver/datasource.ts","webpack:///./public/app/plugins/datasource/stackdriver/query_aggregation_ctrl.ts","webpack:///./public/app/plugins/datasource/stackdriver/filter_segments.ts","webpack:///./public/app/plugins/datasource/stackdriver/query_filter_ctrl.ts","webpack:///./public/app/plugins/datasource/stackdriver/config_ctrl.ts","webpack:///./public/app/plugins/datasource/stackdriver/query_ctrl.ts","webpack:///./public/app/plugins/datasource/stackdriver/annotations_query_ctrl.ts","webpack:///./public/app/plugins/datasource/stackdriver/module.ts","webpack:///./public/app/plugins/panel/text/module.ts","webpack:///./public/app/plugins/panel/graph/jquery.flot.events.ts","webpack:///./public/app/plugins/panel/graph/graph_tooltip.ts","webpack:///./public/app/plugins/panel/graph/threshold_manager.ts","webpack:///./public/app/plugins/panel/graph/align_yaxes.ts","webpack:///./public/app/plugins/panel/graph/histogram.ts","webpack:///./public/app/plugins/panel/graph/graph.ts","webpack:///./public/app/plugins/panel/graph/legend.ts","webpack:///./public/app/plugins/panel/graph/series_overrides_ctrl.ts","webpack:///./public/app/plugins/panel/graph/thresholds_form.ts","webpack:///./public/app/plugins/panel/graph/template.ts","webpack:///./public/app/plugins/panel/graph/data_processor.ts","webpack:///./public/app/plugins/panel/graph/module.ts","webpack:///./public/app/plugins/panel/graph/axes_editor.ts","webpack:///./public/app/plugins/panel/dashlist/module.ts","webpack:///./public/app/plugins/panel/pluginlist/module.ts","webpack:///./public/app/plugins/panel/alertlist/module.ts","webpack:///./public/app/plugins/panel/heatmap/color_scale.ts","webpack:///./public/app/plugins/panel/heatmap/color_legend.ts","webpack:///./public/app/plugins/panel/heatmap/display_editor.ts","webpack:///./public/app/plugins/panel/heatmap/heatmap_data_converter.ts","webpack:///./public/app/plugins/panel/heatmap/axes_editor.ts","webpack:///./public/app/plugins/panel/heatmap/heatmap_tooltip.ts","webpack:///./public/app/plugins/panel/heatmap/rendering.ts","webpack:///./public/app/plugins/panel/heatmap/heatmap_ctrl.ts","webpack:///./public/app/plugins/panel/heatmap/module.ts","webpack:///./public/app/plugins/panel/table/transformers.ts","webpack:///./public/app/plugins/panel/table/editor.ts","webpack:///./public/app/plugins/panel/table/column_options.ts","webpack:///./public/app/plugins/panel/table/renderer.ts","webpack:///./public/app/plugins/panel/table/module.ts","webpack:///./public/app/features/dashboard/panellinks/link_srv.ts","webpack:///./public/app/plugins/panel/singlestat/module.ts","webpack:///./public/app/plugins/panel/gettingstarted/module.ts","webpack:///./public/app/features/plugins/built_in_plugins.ts","webpack:///./public/app/features/plugins/plugin_loader.ts","webpack:///./public/app/features/plugins/datasource_srv.ts","webpack:///./public/app/features/plugins/plugin_component.ts","webpack:///./public/app/plugins/panel/unknown/module.ts","webpack:///./public/app/features/dashboard/dashboard_ctrl.ts","webpack:///./public/app/features/plugins/all.ts","webpack:///./public/app/features/dashboard/history/history.ts","webpack:///./public/app/features/dashboard/alerting_srv.ts","webpack:///./public/app/features/dashboard/history/history_srv.ts","webpack:///./public/app/features/dashboard/dashboard_loader_srv.ts","webpack:///./public/app/features/dashboard/dashnav/dashnav.ts","webpack:///./public/app/features/dashboard/submenu/submenu.ts","webpack:///./public/app/features/dashboard/save_as_modal.ts","webpack:///./public/app/features/dashboard/save_modal.ts","webpack:///./public/app/features/dashboard/save_provisioned_modal.ts","webpack:///./public/app/features/dashboard/shareModalCtrl.ts","webpack:///./public/app/features/dashboard/share_snapshot_ctrl.ts","webpack:///./public/app/features/dashboard/dashboard_srv.ts","webpack:///./public/app/features/dashboard/view_state_srv.ts","webpack:///./public/app/features/dashboard/validation_srv.ts","webpack:///./public/app/features/dashboard/time_srv.ts","webpack:///./public/app/features/dashboard/change_tracker.ts","webpack:///./public/app/features/dashboard/unsaved_changes_srv.ts","webpack:///./public/app/features/dashboard/unsaved_changes_modal.ts","webpack:///./public/app/features/dashboard/timepicker/input_date.ts","webpack:///./public/app/features/dashboard/timepicker/timepicker.ts","webpack:///./public/app/features/dashboard/upload.ts","webpack:///./public/app/features/dashboard/export/exporter.ts","webpack:///./public/app/features/dashboard/export_data/export_data_modal.ts","webpack:///./public/app/features/dashboard/export/export_modal.ts","webpack:///./public/app/features/dashboard/ad_hoc_filters.ts","webpack:///./public/app/features/dashboard/repeat_option/repeat_option.ts","webpack:///./public/app/features/dashboard/dashgrid/DashboardRow.tsx","webpack:///./public/app/core/components/ScrollBar/ScrollBar.tsx","webpack:///./public/app/features/dashboard/dashgrid/AddPanelPanel.tsx","webpack:///./public/app/features/dashboard/dashgrid/DashboardGrid.tsx","webpack:///./public/app/features/dashboard/dashgrid/DashboardPanel.tsx","webpack:///./public/app/features/dashboard/dashgrid/PanelLoader.ts","webpack:///./public/app/features/dashboard/dashgrid/DashboardGridDirective.ts","webpack:///./public/app/features/dashboard/folder_picker/folder_picker.ts","webpack:///./public/app/features/dashboard/dashgrid/RowOptions.ts","webpack:///./public/app/features/dashboard/move_to_folder_modal/move_to_folder.ts","webpack:///./public/app/features/dashboard/settings/settings.ts","webpack:///./public/app/features/dashboard/dashlinks/editor.ts","webpack:///./public/app/features/dashboard/panellinks/module.ts","webpack:///./public/app/features/dashboard/dashlinks/module.ts","webpack:///./public/app/features/dashboard/permissions/DashboardPermissions.tsx","webpack:///./public/app/features/dashboard/folder_page_loader.ts","webpack:///./public/app/features/dashboard/dashboard_import_ctrl.ts","webpack:///./public/app/features/dashboard/folder_dashboards_ctrl.ts","webpack:///./public/app/features/playlist/playlists_ctrl.ts","webpack:///./public/app/features/dashboard/create_folder_ctrl.ts","webpack:///./public/app/features/dashboard/all.ts","webpack:///./public/app/features/playlist/playlist_search.ts","webpack:///./public/app/features/playlist/playlist_srv.ts","webpack:///./public/app/features/playlist/playlist_edit_ctrl.ts","webpack:///./public/app/features/playlist/playlist_routes.ts","webpack:///./public/app/features/panel/panel_header.ts","webpack:///./public/app/features/playlist/all.ts","webpack:///./public/app/features/panel/panel_directive.ts","webpack:///./public/app/features/panel/solo_panel_ctrl.ts","webpack:///./public/app/features/panel/panel_editor_tab.ts","webpack:///./public/app/features/panel/query_editor_row.ts","webpack:///./public/app/features/panel/query_troubleshooter.ts","webpack:///./public/app/features/panel/all.ts","webpack:///./public/app/features/org/org_users_ctrl.ts","webpack:///./public/app/features/org/profile_ctrl.ts","webpack:///./public/app/features/org/select_org_ctrl.ts","webpack:///./public/app/features/org/change_password_ctrl.ts","webpack:///./public/app/features/org/new_org_ctrl.ts","webpack:///./public/app/features/org/user_invite_ctrl.ts","webpack:///./public/app/features/org/create_team_ctrl.ts","webpack:///./public/app/features/org/org_details_ctrl.ts","webpack:///./public/app/features/org/prefs_control.ts","webpack:///./public/app/features/org/all.ts","webpack:///./public/app/features/admin/AdminListUsersCtrl.ts","webpack:///./public/app/features/admin/AdminEditUserCtrl.ts","webpack:///./public/app/features/admin/AdminEditOrgCtrl.ts","webpack:///./public/app/features/admin/AdminListOrgsCtrl.ts","webpack:///./public/app/features/alerting/NotificationsEditCtrl.ts","webpack:///./public/app/features/admin/StyleGuideCtrl.ts","webpack:///./public/app/features/admin/index.ts","webpack:///./public/app/features/alerting/NotificationsListCtrl.ts","webpack:///./public/app/features/manage-dashboards/DashboardListCtrl.ts","webpack:///./public/app/features/manage-dashboards/SnapshotListCtrl.ts","webpack:///./public/app/features/manage-dashboards/index.ts","webpack:///./public/app/features/all.ts"],"names":["$","plot","plugins","push","init","selection","first","x","y","second","show","active","savedhandlers","mouseUpHandler","onMouseMove","e","updateSelection","getPlaceholder","trigger","getSelection","onMouseDown","which","document","body","focus","undefined","onselectstart","ondrag","setSelectionPos","selectionIsSane","triggerSelectedEvent","setTimeout","isSelecting","onMouseUp","one","r","c1","c2","axes","getAxes","each","name","axis","used","anyUsed","p1","c2p","direction","p2","from","Math","min","to","max","event","ctrlKey","metaKey","xaxis","yaxis","x1","y1","x2","y2","clamp","value","pos","o","getOptions","offset","plotOffset","getPlotOffset","pageX","left","width","pageY","top","height","mode","triggerRedrawOverlay","clearSelection","preventEvent","extractRange","ranges","coord","key","k","n","getXAxes","getYAxes","tmp","minSize","abs","setSelection","range","p2c","hooks","bindEvents","eventHolder","mousemove","mousedown","drawOverlay","ctx","save","translate","c","color","parse","strokeStyle","scale","toString","lineWidth","lineJoin","shape","fillStyle","w","h","fillRect","strokeRect","restore","shutdown","unbind","options","version","jQuery","processDatapoints","s","datapoints","stack","other","allseries","res","i","length","findMatchingSeries","getData","px","py","intery","qx","qy","bottom","l","m","ps","pointsize","points","otherps","otherpoints","newpoints","withlines","lines","horizontal","bars","withbottom","format","withsteps","steps","keyOffset","accumulateOffset","j","fromgap","series","stackBases","processed","stackSums","getStackSums","_data","data_len","sums","stackpercent","key_idx","value_idx","num","data","processRawData","percents","sum","newPoints","segmentIntersection","top_left_x","top_left_y","top_right_x","top_right_y","bottom_left_x","bottom_left_y","bottom_right_x","bottom_right_y","top_delta_x","top_delta_y","bottom_delta_x","bottom_delta_y","t","drawSeries","otherseries","openPolygon","beginPath","moveTo","findNextStart","start_i","end_i","console","assert","intersect","start","equal","intersectionPoint","topTraversal","right_i","error","bottomTraversal","lineTo","closePath","fill","fillBelowTo","id","findBelowSeries","validateInput","a","normalize","crosshair","locked","onMouseOut","setCrosshair","clearCrosshair","lockCrosshair","unlockCrosshair","mouseout","adj","indexOf","drawX","floor","drawY","stroke","dashes","draw","axisx","axisy","plotDashes","xoffset","yoffset","dashOnLength","dashOffLength","prevx","prevy","dashRemainder","dashOn","dashLength","dashOffset","ax1","ay1","ax2","ay2","lineSegmentOffset","deltaX","deltaY","remainder","distance","segmentLength","sqrt","pow","ysign","lw","sw","shadowSize","angle","PI","sin","cos","Gauge","context","placeholder","gaugeOptions","gauges","getLogger","debug","calculateAutoValues","gaugeOptionsi","cellWidth","gauge","label","margin","font","size","threshold","calculateAngle","layout","startAngle","endAngle","drawArcWithShadow","cx","cy","rd1","rd2","lc","fc","blur","drawArc","clip","shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor","drawThresholdValue","cellLayout","drawText","thresholdLabelMargin","thresholdLabelFontSize","radius","toRad","formatter","text","textOptions","span","exists","attr","css","family","background","opacity","append","parseInt","prototype","calculateLayout","canvasWidth","canvasHeight","columns","rows","ceil","hMargin","vMargin","cellHeight","square","cell","cellMargin","labelMargin","labelFontSize","valueMargin","valueFontSize","thresholdWidth","maxRadiusH","dAngle","heightRatioV","outerRadiusV","maxRadiusV","outerRadius","gaugeOuterHeight","calculateCellLayout","col","row","blank","offsetY","vAlign","drawBackground","frame","grid","borderColor","borderWidth","backgroundColor","drawCellBackground","border","drawGauge","shadow","values","getColor","a2","drawThreshold","a1","drawLable","item","drawValue","drawThresholdValues","debugOptions","Logger","arc","defaults","log","alert","processOptions","legend","sort","b","extend","ace","define","require","exports","module","oop","TextHighlightRules","PrometheusHighlightRules","keywordMapper","this","createKeywordMapper","support.function","keyword","constant.language","$rules","token","regex","next","start-label-matcher","start-label-list-matcher","normalizeRules","inherits","lang","keyWordsCompletions","map","word","caption","meta","score","Number","MAX_VALUE","functionsCompletions","def","docText","docHTML","escapeHTML","replace","convertMarkDownTags","str","len","space_index","line_start","next_line_end","line","slice","join","wrapText","convertToHTML","PrometheusCompletions","getCompletions","state","session","prefix","callback","getTokenAt","column","type","concat","call","CstyleBehaviour","Behaviour","TokenIterator","PrometheusBehaviour","inherit","add","action","editor","getSelectionRange","selected","doc","getTextRange","getWrapBehavioursEnabled","opening","closing","rowDiff","end","getWrapped","isSaneInsertion","cursor","getCursorPosition","getLine","substring","$findOpeningBracket","isAutoInsertedClosing","isMultiLine","TextMode","Mode","HighlightRules","$behaviour","$completer","completer","$id","snippets","content","scope","tabTrigger","REDRAW_ATTEMPTS","REDRAW_SHRINK","pie","innerRadius","tilt","alpha","round","percent","combine","highlight","canvas","target","maxRadius","centerLeft","centerTop","highlights","getCanvas","parent","setData","total","combined","numCombined","newdata","isArray","isNaN","parseFloat","isFinite","newCtx","legendWidth","children","filter","position","match","slices","attempts","clear","drawShadow","drawPie","prepend","setSeries","insertLegend","clearRect","remove","shadowLeft","shadowTop","globalAlpha","currentAngle","drawSlice","drawDonutHole","drawLabel","index","lf","labelFormatter","plf","halfAngle","html","labelTop","labelLeft","insertBefore","drawLabels","layer","globalCompositeOperation","isPointInPoly","poly","pt","triggerClickHoverEvent","onClick","eventname","mouseX","mouseY","isPointInPath","datapoint","dataIndex","seriesIndex","findNearbySlice","autoHighlight","auto","unhighlight","indexOfHighlight","splice","hoverable","clickable","click","octx","drawHighlight","gettingstarted_module_namespaceObject","__webpack_require__","d","module_GettingStartedPanelCtrl","angular","lodash","jquery_js_exposed","AnnotationsEditorCtrl","$scope","datasourceSrv","annotationDefaults","datasource","iconColor","enable","showIn","hide","showOptions","ctrl","datasources","getAnnotationSources","annotations","dashboard","list","reset","onColorChange","bind","$inject","datasourceChanged","_this","get","currentAnnotation","then","ds","currentDatasource","edit","annotation","currentIsNew","jquery_js_exposed_default","angular_default","copy","update","setupNew","move","dir","removeAnnotation","lodash_default","newColor","partition","regionEvents","_a","singleEvents","events","regionId","groupBy","compact","regions","head","regionObj","timeEnd","time","isRegion","isStartOfRegion","valueOf","isPanelAlert","eventType","controller","editor_ctrl_AnnotationsEditorCtrl","$rootScope","$q","backendSrv","timeSrv","onAppEvent","clearCache","getAnnotations","getGlobalAnnotations","getAlertStates","results","flattenDeep","makeRegions","eventsById","dedup","eventGroup","every","find","dedupAnnotations","panelId","source","panel","alertState","catch","err","message","appEvent","raw","alertStatesPromise","when","globalAnnotationsPromise","timeRange","this_1","translateQueryResult","snapshotData","annotationQuery","rangeRaw","snapshot","_i","state_1","_loop_1","all","promises","saveAnnotationEvent","post","updateAnnotationEvent","put","results_1","AnnotationsSrv","service","annotations_srv_AnnotationsSrv","moment","EventEditorCtrl","annotationsSrv","panelCtrl","dashboardId","tryEpochToMoment","formatDate","form","$valid","cloneDeep","saveModel","refresh","close","delete","deleteAnnotationEvent","timestamp","directive","tinycolor","AnnotationEvent","EventManager","editorClosed","editorOpen","render","editorOpened","updateTime","moment_default","editEvent","elem","addFlotEvents","flotOptions","colors","editModel","newState","types","markerSize","fillColor","markings","defaultColor","colorString","tinycolor_default","isValid","setAlpha","toRgbString","addAlphaToRGB","region","event_manager_getRegions","eventSectionHeight","levels","keys","manager","$sanitize","dashboardSrv","contextSrv","$compile","escape","element","title","getCurrent","tooltip","titleStateClass","alertId","stateModel","alertDef","getStateDisplayModel","stateClass","iconClass","getAlertAnnotationInfo","isString","header","login","avatarUrl","sanitizeString","contents","annotationTooltipDirective","model_utils","variableTypes","containsVariable","args","arguments","variableName","matches","variableRegex","varMatch","variableRegexExec","VariableEditorCtrl","variableSrv","templateSrv","_","optionsLimit","refreshOptions","variables","$watch","val","addVariable","current","emit","sameName","app_events","query","RegExp","validate","infoText","getTagKeys","updateOptions","variable","clone","getSaveModel","createVariableFromModel","runQuery","updateTemplateData","getMetricSources","mixed","datasourceTypes","uniqBy","old","oldIndex","removeVariable","showMoreOptions","editor_ctrl_VariableEditorCtrl","luceneEscape","template_srv","TemplateSrv","reduce","acc","currentValue","isNone","existsOrEmpty","variableInitialized","getAdhocFilters","datasourceName","filters","luceneFormat","Array","formatValue","kbn","regexEscape","escapedValues","distributeVariable","setGrafanaVariable","grafanaVariables","getVariableName","expression","lastIndex","exec","variableExists","highlightVariablesAsHtml","var1","var2","fmt2","var3","builtIns","getAllValue","allValue","scopedVars","systemValue","fmt","fmt3","isAllValue","replaceWithText","option","fillVariableValuesForUrl","params","skipUrlSync","getValueForUrl","Edge","_linkTo","node","inputEdges","outputEdges","edges","link","inputNode","outputNode","Error","unlink","inode","onode","Node","getEdgeFrom","getOptimizedInputEdges","toBeRemoved","forEach","edgeToRemove","getEdgeTo","Graph","nodes","createNode","createNodes","names","input","output","outputNodes","inputArr","n_1","getNode","inputNodes","outputArr","n_2","createEdge","VariableSrv","$location","$injector","$on","onDashboardRefresh","updateUrlParamsWithCurrentVariables","templating","initLock","defer","queryParams","search","processVariable","evt","payload","fromVariableValueUpdated","Promise","resolve","previousOptions","toJson","$emit","dependencies","otherVariable","dependsOn","promise","urlValue","setValueFromUrl","finally","model","ctor","instantiate","updateSubmenuVisibility","variableUpdated","emitChangeEvents","v","$broadcast","selectOptionsForCurrentValue","validateVariableSelectionState","setValue","currentOption","setOptionFromUrl","op","defaultText","defaultValue","setOptionAsCurrent","setAdhocFilter","createGraph","g","v1","v2","variable_srv_VariableSrv","IntervalVariable","auto_min","auto_count","Object","updateAutoValue","unshift","calculateInterval","interval","trim","QueryVariable","multi","includeAll","tags","useTags","tagsQuery","tagValuesQuery","updateOptionsFromMetricFindQuery","updateTags","metricFindQuery","getValuesForTag","tagKey","metricNamesToVariableValues","addAllOption","metricNames","stringToJsRegex","isNumber","sortVariableValues","sortOrder","sortType","reverseSort","sortBy","opt","toLower","reverse","query_variable_QueryVariable","description","supportsMulti","datasource_variable_DatasourceVariable","DatasourceVariable","sources","skipVariables","CustomVariable","split","custom_variable_CustomVariable","ConstantVariable","constant_variable_ConstantVariable","AdhocVariable","unescapeDelimiter","operator","escapeDelimiter","setFilters","adhoc_variable_AdhocVariable","TextBoxVariable_TextBoxVariable","TextBoxVariable","factory","remarkable","$sce","$routeParams","navModelSrv","pluginId","setNavModel","defaultTab","navModel","main","img","info","logos","large","subTitle","author","url","breadcrumbs","icon","includes","tab","result","pluginIcon","getPluginIcon","plug","initReadme","md","remarkable_default","linkify","readmeHtml","trustAsHtml","PluginEditCtrl","preUpdateHook","updateCmd","enabled","pinned","jsonData","secureJsonData","importDashboards","setPreUpdateHook","setPostUpdateHook","postUpdateHook","updateAvailable","modalScope","$new","plugin","disable","plugin_edit_ctrl_PluginEditCtrl","plugin_page_ctrl_AppPageCtrl","AppPageCtrl","initPage","pluginInfoCache","loadPluginInfo","app","appModel","page","slug","getNotFoundNav","pluginNav","getNav","DashImportListCtrl","dashboards","on","importAll","importNext","reject","import","dash","overwrite","installCmd","path","inputs","importedUri","imported","restrict","templateUrl","import_list_DashImportListCtrl","buildNavModel","currentPage","access","DataSourceEditCtrl","configureStore","getState","navIndex","getDatasourceById","initNewDatasourceModel","isNew","ds_edit_ctrl_defaults","gettingstarted","gettingStarted","isDefault","typeChanged","loadDatasourceTypes","datasourceCreated","testDatasource","userChangedType","updateNav","datasourceMeta","pluginInfo","updateFrontendSettings","settings","core_config","defaultDatasource","done","status","withNoBackendCache","testing","statusText","saveChanges","editForm","readOnly","confirmDelete","yesText","onConfirm","ds_edit_ctrl_DataSourceEditCtrl","suggestUrl","noDirectAccess","pre","attrs","showAccessOption","showAccessHelp","toggleAccessHelp","getSuggestUrls","DataSourceDashboardsCtrl","getPluginInfo","ds_dashboards_ctrl_DataSourceDashboardsCtrl","system","constants","store","panel_ctrl_PanelCtrl","PanelCtrl","$timeout","editorTabIndex","timing","panels","pluginName","panelDidMount","removeAllListeners","publishAppEvent","renderingCompleted","core","evtName","$root","changeView","fullscreen","viewPanel","editPanel","exitFullscreen","initEditMode","editorTabs","addEditorTab","editModeInitiated","urlTab","toLowerCase","changeTab","newIndex","route","updateParams","directiveFn","editorTab","getMenu","shortcut","canEdit","menu","role","apply","getAdditionalMenuItems","extendedMenu","getExtendedMenu","submenu","divider","otherPanelInFullscreenMode","calculatePanelHeight","docHeight","window","editHeight","fullscreenHeight","containerHeight","editMode","gridPos","soloMode","renderStart","Date","getTime","duplicate","duplicatePanel","removePanel","editPanelJson","editScope","object","updateHandler","replacePanel","enableCopy","src","copyPanel","set","JSON","stringify","newPanel","oldPanel","findIndex","deletedPanel","panel_model","sortPanelsByGridPos","sharePanel","getInfoMode","links","getInfoContent","markdown","sanitize","openInspector","panelInfoHtml","inspector","rangeutil","MetricsTabCtrl","panelDsValue","datasourceInstance","addQueryDropdown","fake","nextRefId","getNextQueryLetter","updateDatasourceOptions","hasQueryHelp","queryOptions","includeBuiltin","builtIn","setDatasource","addMixedQuery","addQuery","toggleHelp","optionsOpen","queryTroubleshooterOpen","helpOpen","helpHtml","toggleOptions","toggleQueryTroubleshooter","metricsTabDirective","metrics_tab_MetricsTabCtrl","_super","MetricsPanelCtrl","targets","onMetricsPanelRefresh","onInitMetricsPanelEditMode","onPanelTearDown","dataSubscription","unsubscribe","updateTimeRange","data_1","dataStream","loading","setTimeQueryStart","issueQueries","handleQueryResult","cancelled","queryStart","setTimeQueryEnd","queryEnd","maxDataPoints","resolution","intervalOverride","intervalMs","applyPanelTimeOverrides","timeInfo","timeFrom","timeFromInterpolated","timeFromInfo","invalid","timeFromDate","datemath","display","timeShift","timeShiftInterpolated","hideTimeOverride","assign","__interval","__interval_ms","metricsQuery","timezone","getTimezone","cacheTimeout","subscribe","handleDataStream","stream","complete","items","exploreEnabled","isEditor","explore","tslib_es6","sent","refId","removeQuery","moveQuery","conditions","evaluator","condition","thresholds","value1","value2","colorMode","ThresholdMapper","AlertTabCtrl","uiSegmentSrv","subTabIndex","evalFunctions","evalOperators","conditionTypes","noDataModes","executionErrorModes","appSubUrl","$onInit","newPlusButton","graphThresholdChanged","thresholdChangedEventHandler","off","editingThresholds","notifications","alertHistory","initModel","validateModel","getAlertHistory","ah","getNotificationIcon","getNotifications","newSegment","changeTabIndex","newTabIndex","notificationAdded","addNotificationSegment","removeNotification","alertNotifications","buildDefaultCondition","noDataState","alertingNoDataOrNullValues","executionErrorState","alertingErrorOrTimeout","frequency","handler","defaultName","conditionModels","memo","buildConditionModel","alertToGraphThresholds","addedNotification","_b","_c","notification","bgColor","handleIndex","evaluatorParamsChanged","firstTarget","foundTarget","alerting","targetContainsTemplate","query_part","alertQueryDef","createReducerPart","reducer","cm","handleQueryPartEvent","conditionModel","handleReducerPartEvent","reducerPart","reducerTypes","addCondition","removeCondition","text2","evaluatorTypeChanged","clearHistory","prism","prism_default","slate_es","slate_plain_serializer_es","react","react_dom","time_series2","table_model","FileSaver","QUOTE","EXPORT_FILENAME","csvEscaped","DOMParser","htmlDecoded","domParser","parseFromString","textContent","regexp","formatSpecialHeader","useExcelHeader","END_COLUMN","END_ROW","formatRow","addEndRowDelimiter","util","toLocaleString","convertSeriesListToCsv","seriesList","dateTimeFormat","excel","DEFAULT_DATETIME_FORMAT","alias","POINT_TIME_INDEX","POINT_VALUE_INDEX","exportSeriesListToCsv","convertSeriesListToCsvColumns","timestamps","seriesPoints","seriesTimestamps","p","extendedSeries","pointIndex","mergeSeriesByTime","table","opts","delimiter","maxDepth","step","prev","isarray","safe","isobject","newKey","currentDepth","utils_ticks","versionPattern","version_SemVersion","SemVersion","major","minor","patch","isGtOrEq","compared","isVersionGtOrEq","gfunc_index","addFuncDef","funcDef","defaultParams","shortName","optionalSeriesRefArgs","optional","multiple","isVersionRelatedFunction","obj","graphiteVersion","category","FuncInstance","withDefaultParams","updateText","metricExp","parameters","paramType","last","pop","_hasMultipleParamsInString","strValue","updateParam","partVal","idx","gfunc","getFuncDef","gfunc_FuncInstance","param","rawDefs","funcName","group","test","required","shift","rawParam","default","func","suggestions","funcDefs","instanceSettings","basicAuth","supportsTags","withCredentials","render_method","funcDefsPromise","getQueryOptionsInfo","translateTime","until","buildGraphiteParams","graphOptions","method","headers","Content-Type","addTracingHeaders","httpOptions","requestId","doGraphiteRequest","convertDataPointsToMs","parseTags","tagString","graphiteQuery","target_1","tags_1","what","date","roundUp","subtract","unix","optionalOptions","interpolatedQuery","expressions","exprRegex","limit","getTagValuesAutoComplete","getTagsAutoComplete","metric","expandable","tag","getTagValues","tagPrefix","expr","valuePrefix","createFuncInstance","waitForFuncDefsLoaded","getFuncDefs","supportsFunctionIndex","parseFuncDefs","Authorization","inspect","datasourceRequest","_seriesRefLetters","targetValue","hasTargets","fixIntervalFormat","nestedSeriesRegexReplacer","cleanOptions","encodeURIComponent","graphiteOptions","rst2html_min","js_drop","drop","categories","createFunctionDropDownMenu","$input","typeahead","allFunctions","minLength","updater","$apply","addFunction","toggleClass","$button","removeClass","cleanUpDrop","destroy","shortDesc","contentElement","createElement","innerHTML","rst2html_min_default","drop_default","classes","openOn","tetherOptions","attachment","targetAttachment","popoverSrv","$funcLink","scheduledRelink","paramCountAtLink","cancelBlur","clickFuncParam","paramIndex","$link","$comma","select","lookup","paramDef","switchToLink","inputElem","clearTimeout","newValue","relink","targetChanged","hasClass","addClass","inputBlur","inputKeyPress","inputKeyDown","style","toggleFuncControls","targetDiv","closest","$funcControls","addElementsAndCompile","appendTo","defParams","lastParam","paramValue","$paramLink","paramTemplate","partial","keyup","keypress","$element","process","added","$target","removeFunction","queryModel","functions","$index","classNames","template","open","graphiteAddFunc","graphiteFuncEditor","unicodeLetterTable","lexer_i","identifierStartTable","Lexer","lexer","tokenize","charAt","char","peek","scanStringLiteral","scanPunctuator","scanNumericLiteral","scanIdentifier","scanTemplateSequence","skip","isUnicodeLetter","code","isHexDigit","ch1","ch2","ch3","ch4","chr","charCodeAt","readUnicodeEscapeSequence","identifierPartTable","getIdentifierStart","getIdentifierPart","ch","isDecimalDigit","isMalformed","isIdentifierStart","base","isOctalDigit","bad","isPunctuator","quote","isUnclosed","functionCall","metricExpression","curlySegment","consumeToken","errorMark","curly","curlyBraceSegment","parts","tokens","segments","metricSegment","segment","functionParameters","numericLiteral","seriesRefExpression","boolExpression","stringLiteral","currentToken","token1","token2","matchToken","graphite_query","GraphiteQuery","parseTarget","removeTagValue","textEditor","astNode","Parser","getAst","parseTargetRecursive","checkForSeriesByTag","checkOtherSegmentsIndex","seriesByTagUsed","hidden","splitSeriesByTagParams","seriesByTagFunc","getSegmentPathUpTo","arr","innerFunc_1","addFunctionParameter","updateSegmentValue","addSelectMetricSegment","newFunc","moveAliasFuncLast","aliasFunc","startsWith","without","updateModelTarget","wrapFunction","metricPath","updateRenderedTarget","targetsByRefId","keyBy","nestedSeriesRefRegex","targetWithNestedQueries","refCount","count","countTargetRefs","updated","g1","targetFull","tagPattern","flatten","getSeriesByTagFuncIndex","getSeriesByTagFunc","seriesByTagFuncIndex","addTag","newTagParam","renderTagString","removeTag","updateTag","tagIndex","renderTagExpressions","excludeIndex","tagExpr","GRAPHITE_TAG_OPERATORS","TAG_PREFIX","GraphiteQueryCtrl","paused","buildSegments","toggleEditorMode","checkOtherSegments","fixTagSegments","newSelectMetric","fromIndex","setSegmentFocus","segmentIndex","getAltSegments","altSegments","eachRight","removeTaggedEntry","addAltTagSegments","getTagsAsSegments","tagSegments","segmentValueChanged","removeTagPrefix","pause","addSeriesByTagFunc","spliceSegments","emptySegments","targetTextChanged","oldTarget","smartlyHandleNewAliasByNode","tagParam","getAllTags","getTags","altTags","mapToDropdownOptions","tagExpressions","getTagOperators","getAllTagValues","altValues","addNewTag","newTag","addTagSegments","showDelimiter","unpause","query_ctrl_QueryCtrl","GraphiteConfigCtrl","graphiteVersions","autoDetectGraphiteVersion","loadDatasource","getVersion","AnnotationsQueryCtrl","onChange","namespace","metricName","statistics","dimensions","period","returnData","highResolution","regionSegment","getSegmentForValue","namespaceSegment","newOperator","newKeyValue","statSegments","stat","ensurePlusButton","dimSegments","removeDimSegment","removeStatSegment","isEmpty","getStatSegments","standardStatistics","statSegmentChanged","seg","lastSegment","getDimSegments","getDimensionKeys","dimensionKey","getDimensionValues","transformToSegments","dimSegmentChanged","newFake","cssClass","syncDimSegmentsWithModel","keySegment","valueSegment","dims","regionChanged","namespaceChanged","metricChanged","addTemplateVars","CloudWatchQueryParameter","query_parameter_ctrl_CloudWatchQueryParameterCtrl","cloudwatch_datasource","proxyUrl","defaultRegion","expandTemplateVariable","queries","getActualRegion","convertDimensionFormat","String","getPeriod","some","datasourceId","performTimeSeriesQuery","request","now","convertToCloudWatchTime","interval_to_seconds","daySec","periodUnit","CloudWatchDatasource","awsRequest","queryRes","unit","transformSuggestDataFromTable","suggestData","tables","doMetricQueryRequest","subtype","getRegions","getNamespaces","getMetrics","filterDimensions","getEbsVolumeIds","instanceId","getEc2InstanceAttribute","attributeName","filterJson","metricNameQuery","dimensionKeysQuery","dimensionValuesQuery","ebsVolumeIdsQuery","ec2InstanceAttributeQuery","targetAttributeName","defaultPeriod","prefixMatching","actionPrefix","alarmNamePrefix","getDefaultRegion","getExpandedVariables","allSelected","selectedVariables","currentVariables","scopedVar","btoa","chain","findKey","has","multiVariable","convertedDimensions","query_ctrl_CloudWatchQueryCtrl","CloudWatchQueryCtrl","aliasSyntax","CloudWatchConfigCtrl","accessKeyExist","secretKeyExist","authTypes","indexPatternTypes","example","timeField","authType","secureJsonFields","accessKey","secretKey","resetAccessKey","resetSecretKey","CloudWatchAnnotationsQueryCtrl","requiresField","supportsInlineScript","supportsMissing","isPipelineAgg","minVersion","query_def_bucketAggTypes","orderByOptions","orderOptions","sizeOptions","intervalOptions","query_def_pipelineOptions","derivative","movingAvgModelSettings","isCheckbox","getMetricAggTypes","esVersion","query_def_metricAggTypes","f","metricType","po","getMovingAvgSettings","filtered","filteredResult","setting","field","ElasticQueryBuilder","getRangeFilter","gte","lte","buildTermsAgg","aggDef","queryNode","metricRef","terms","orderBy","order","metrics","aggs","min_doc_count","missing","getDateHistogramAgg","esAgg","extended_bounds","getHistogramAgg","getFiltersAgg","analyze_wildcard","documentQuery","unmapped_type","fielddata_fields","docvalue_fields","addAdhocFilters","adhocFilters","queryCondition","bool","must","match_phrase","must_not","lt","gt","build","queryString","bucketAggs","query_string","precision","nestedAggs","pipelineAgg","buckets_path","metricAgg","prop","aggField","getTermsQuery","queryDef","_term","intervalMap","Hourly","startOf","amount","index_pattern_IndexPattern","IndexPattern","pattern","getIndexForToday","utc","getIndexList","intervalInfo","endEpoch","response","processMetrics","props","bucket","buckets","doc_count","newSeries","percentiles","percentileName","statName","stats","std_deviation_bounds_upper","std_deviation_bounds","upper","std_deviation_bounds_lower","lower","normalized_value","processAggregationDocs","addColumn","propKey","filterable","addMetricValue","_d","_e","propValues","_f","_g","getMetricName","processBuckets","depth","aggId","nameIndex","key_as_string","metricDef","extendedStats","getSeriesName","metricTypeCount","g2","appliedAgg","describeMetric","propName","ElasticResponse","nameSeries","uniq","processHits","hits","hit","_id","_type","_index","_source","fields","trimDatapoints","aggregations","histogram","trimEdges","getErrorFromElasticResponse","root_cause","reason","$$config","config","getTimeSeries","responses","tmpSeriesList","timeInterval","maxConcurrentShardRequests","query_builder_ElasticQueryBuilder","ElasticDatasource","indexPattern","indexList","tagsField","textField","getFieldFromSource","fieldName","fieldNames","fieldValue","titleField","setTime","getFields","dateFields","getQueryHeader","searchType","timeTo","queryHeader","queryBuilder","queryObj","sentTargets","typeMap","float","double","integer","shouldAddField","fieldNameParts","getFieldsRecursively","subObj","isObject","properties","indexName","mappings","typeName","getTerms","esQuery","fromJson","bucketAgg","objectContainsTemplate","isPrimitive","ElasticBucketAggCtrl","getBucketAggTypes","agg","isFirst","bucketAggCount","settingsLinkText","describeOrder","describeOrderBy","substr","defaultTo","removeFiltersQuery","getOrderByOptions","metricRefs","getFieldsInternal","$fieldType","getIntervalOptions","addBucketAgg","lastBucket","addIndex","removeBucketAgg","bucket_agg_ElasticBucketAggCtrl","getPipelineAggOptions","metricAggs","metricAggTypes","pipelineOptions","getPipelineOptions","precisionThreshold","precision_threshold","movingAvgModelTypes","movingAvgModelOptions","modelSettings","updateMovingAvgModelSettings","inlineScript","script","inline","updatePipelineAggOptions","onChangeInternal","modelSettingsKeys","onChangeClearInternal","minimize","onTypeChange","addMetricAgg","removeMetricAgg","toggleShowMetric","ElasticMetricAggCtrl","metric_agg_ElasticMetricAggCtrl","ElasticQueryCtrl","queryUpdated","jsonStr","handleQueryError","newJson","rawQueryOld","getCollapsedText","bucketAggTypes","ElasticConfigCtrl","esVersions","indexPatternTypeChanged","database","opentsdb_datasource","OpenTsDatasource","tsdbVersion","tsdbResolution","tagKeys","aggregatorsPromise","filterTypesPromise","convertToTSDBTime","convertTargetToQuery","qs","groupByTags","tagk","metricToTargetMapping","mapMetricsToTargets","metricData","_saveTagKeys","transformMetricData","eventList","aggregator","annotationObject","isGlobal","globalAnnotations","startTime","msResolution","reqBody","showQuery","suggestTagKeys","aggregateTags","_performSuggestQuery","_get","q","_performMetricKeyValueLookup","keysArray","keysQuery","tagvs","_performMetricKeyLookup","tagks","tagv","relativeUrl","_addCredentialOptions","interpolated","responseTransform","tagNamesQuery","tagNamesSuggestQuery","tagValuesSuggestQuery","getAggregators","getFilterTypes","createMetricLabel","dps","metricLabel","scopedVars_1","toPairs","tagData","shouldComputeRate","rate","rateOptions","isCounter","counterMax","counterResetValue","resetValue","dropResets","ResetValue","disableDownsampling","downsampleInterval","downsample","downsampleAggregator","downsampleFillPolicy","explicitTags","interpolatedTagValue","arrTagV","tagV","tagK","OpenTsQueryCtrl","errors","validateTarget","aggregators","fillPolicies","filterTypes","suggestMetrics","getTextValues","suggestTagValues","targetBlur","metricFindResult","addTagMode","currentTagKey","currentTagValue","editTag","closeAddTagMode","addFilter","currentFilterType","currentFilterGroupBy","currentFilter","currentFilterValue","currentFilterKey","addFilterMode","removeFilter","editFilter","fil","closeAddFilterMode","errs","shouldDownsample","describe_interval","OpenTsConfigCtrl","tsdbVersions","tsdbResolutions","GrafanaDatasource","tt","GrafanaQueryCtrl","GrafanaAnnotationsQueryCtrl","influx_series","seriesName","columnName","_getSeriesName","segIndex","titleCol","timeCol","tagsCol","textCol","titleColumn","tagsColumn","textColumn","InfluxSeries","getTable","reordered","hasOwnProperty","createPart","part","query_part_index","register","fieldRenderer","innerExpr","replaceAggregationAddStrategy","selectParts","partModel","query_part_categories","Aggregations","morePartsAvailable","Selectors","addTransformationStrategy","Aliasing","addStrategy","selectModels","Fields","dynamicLookup","renderer","Transformations","groupByTimeFunctions","Predictors","partCount","influxdb_query_part","InfluxQuery","policy","resultFormat","orderByTime","updateProjection","create","groupByParts","updatePersistedParts","hasGroupByTime","hasFill","addGroupBy","stringParts","arg","typePart","removeGroupByPart","getCategories","removeSelect","removeSelectPart","modelsIndex","partIndex","addSelectPart","renderTagCondition","interpolate","getMeasurementAndPolicy","measurement","interpolateQueryStr","defaultFormatFn","rawQuery","selectText","groupBySection","slimit","renderAdhocFilters","response_parser","ResponseParser","influxResults","normalizedQuery","isValueFirst","serie","addUnique","buildExploreQuery","withKey","withMeasurementFilter","whereConditions","InfluxQueryBuilder","influxdb_datasource","username","password","getTimeFilter","queryTargets","influx_query","allQueries","timeFilter","_seriesQuery","influxSeries","timeSeries","curry","responseParser","query_builder_InfluxQueryBuilder","_influxRequest","epoch","serializeParams","currentUrl","urls","u","db","req","getInfluxTime","fromIsAbsolute","InfluxDatasource","InfluxQueryCtrl","resultFormats","policySegment","measurementSegment","newSelectMeasurement","newCondition","buildSelectMenu","removeOrderByTime","selectMenu","cat","getGroupByOptions","groupByAction","groupBySegment","plusButton","subitem","handleSelectPartEvent","fieldsQuery","handleGroupByPartEvent","measurementChanged","getPolicySegments","policiesQuery","policyChanged","getMeasurements","measurementFilter","getTagsOrValues","nextValue","newOperators","removeTagFilterSegment","getFieldSegments","tagSegmentUpdated","rebuildTargetTagConditions","tagOperator","segment2","getTagValueOperator","tagValue","InfluxConfigCtrl","InfluxAnnotationsQueryCtrl","entry","labels","timeFromNow","fromNow","timeLocal","searchMatches","getSearchMatches","logLevel","level","LogLevel","getLogLevel","logging_datasource","LoggingDatasource","_request","apiUrl","prepareQueryTarget","QUERY_REGEXP","streams","combinedEntries","entries","processEntry","processStreams","metadataRequest","silent","MixedDatasource","sets","dsName","mysql_response_parser","processQueryResult","parseMetricFindQueryResult","rowCount","findColIndex","textColIndex","valueColIndex","transformToKeyValueList","transformToSimpleList","containsKey","colName","transformAnnotationResponse","textColumnIndex","tagsColumnIndex","timeColumnIndex","interpolateVariable","rawSql","MysqlDatasource","defaultQuery","query_ctrl_MysqlQueryCtrl","MysqlQueryCtrl","formats","onDataReceived","onDataError","dataList","lastQueryError","anySeriesFromQuery","lastQueryMeta","MysqlConfigCtrl","module_defaultQuery","MysqlAnnotationsQueryCtrl","postgres_response_parser","postgres_query","PostgresQuery","timeColumn","metricColumn","where","unquoteIdentifier","quoteIdentifier","quoteLiteral","escapeLiteral","hasTimeGroup","hasMetricColumn","buildQuery","hasUnixEpochTimecolumn","timeColumnType","buildTimeColumn","timeGroup","buildMetricColumn","buildValueColumns","buildValueColumn","aggregate","windows","overParts","over","curr","buildWhereClause","buildGroupClause","groupSection","PostgresDatasource","getTimescaleDBVersion","PostgresMetaQuery","getOperators","datatype","quoteIdentAsLiteral","findMetricTable","buildSchemaConstraint","buildTableConstraint","buildTableQuery","buildColumnQuery","buildValueQuery","buildDatatypeQuery","buildAggregateQuery","toUpperCase","wrapOpen","wrapClose","separator","sql_part_SqlPart","SqlPart","sql_part_index","sql_part_register","SqlPartDef","sql_part","PostgresQueryCtrl","metaBuilder","query_ctrl_defaultQuery","tableSegment","timeColumnSegment","groupAdd","whereParts","groupParts","aggregates","timescaledb","postgresVersion","resetPlusButton","button","getTableSegments","tableChanged","metricColumnSegment","task1","segment_1","timeColumnChanged","task2","getTimeColumnSegments","getMetricColumnSegments","addNone","metricColumnChanged","templateQuoter","findAggregateIndex","findWindowIndex","subItem","partType","addAlias","addGroup","aggIndex","windowIndex","aggIndex_1","handleGroupPartEvent","removeGroup","handleWherePartEvent","addWhereAction","whereAdd","getGroupOptions","addGroupAction","config_ctrl_PostgresConfigCtrl","postgresVersions","sslmode","showTimescaleDBHelp","autoDetectFeatures","trunc","toggleTimescaleDBHelp","PostgresAnnotationsQueryCtrl","postgres_module_defaultQuery","metric_find_query","labelValuesQuery","metricNamesQuery","queryResultQuery","metricNameAndLabelsQuery","PrometheusMetricFindQuery","getPrometheusTime","_labels","metricFilterPattern","matchedMetricName","performInstantQuery","__name__","self","getOriginalMetricName","result_transformer_ResultTransformer","ResultTransformer","transform","prometheusResult","transformMetricDataToTable","responseListLength","sortSeriesByLabel","prometheusResult_1","transformToHistogramOverTime","prometheusResult_2","resultType","transformInstantMetricData","dpValue","baseTimestamp","stepMs","endTimestamp","responseIndex","resultCount","metricLabels","sortedLabels","labelIndex","valueText","labelData","isUndefined","legendFormat","renderTemplate","aliasPattern","aliasData","topSeries","bottomSeries","bottomPoint","s1","s2","le1","le2","parseHistogramLabel","le","Infinity","keywords","selector","labelKey","labelValue","labelOperator","labelRegexp","parsedLabels","operatorForLabelKey","add_label_to_query","previousWord","metricNameRegexp","insideSelector","openChar","closeChar","nextSelectorStart","nextSelectorEnd","isPositionInsideChars","previousWordIsKeyWord","builtInWords","selectorRegexp","selectorWithLabel","addLabelToSelector","prometheusRegularEscape","prometheusSpecialRegexEscape","MetricKind","PrometheusDatasource","editorSrc","directUrl","queryTimeout","httpMethod","ruleMappings","loadRules","transformRequest","interpolateQueryExpr","activeTargets","createQuery","allQueryPromise","instant","responseList","hints","transformerOptions","resultTransformer","hinting","queryHints","increasing_1","dp","monotonic","fix","mapping_1","mappingForQuery","ruleName","mapping","determineQueryHints","minInterval","intervalFactor","adjustedInterval","adjustInterval","getRangeScopedVars","adjusted","alignRange","performSuggestQuery","cache","metricsNameCache","expire","interval_to_ms","msRange","diff","sRange","regularRange","secondsToHms","__range_ms","titleFormat","textFormat","useValueForTime","json","groups","rules","rule","extractRuleMappingFromGroups","modifyQuery","mapping_2","ruleNames","rulesRegex","getTimeRange","PromCompleter","wrappedCallback","completions","templateVariableCompletions","getCompletionsForLabelMatcherName","getCompletionsForLabelMatcherValue","getCompletionsForBinaryOperator","vectors","findMetricName","labelNameCache","transformToCompletions","labelNames","findToken","labelNameToken","labelValueCache","labelName","getLabelNameAndValueForExpression","labelValues","rparenToken","keywordOperatorToken","findExpressionMatchedParen","binaryOperatorToken","metricName_1","labelQueryCache","words","nameLabelValueToken","getTokens","nameLabelNameToken","metricNameToken","guard","deep","query_ctrl_PrometheusQueryCtrl","PrometheusQueryCtrl","getDefaultFormat","updateLink","refreshMetricData","isEqual","endTime","rangeDiff","linkToPrometheus","PrometheusConfigCtrl","mssql_response_parser","MssqlDatasource","MssqlQueryCtrl","mssql_query_ctrl_defaultQuery","MssqlConfigCtrl","MssqlAnnotationsQueryCtrl","mssql_module_defaultQuery","scenarioId","stringInput","TestDataDatasource","query_ctrl_TestDataQueryCtrl","TestDataQueryCtrl","scenarioList","newPointTime","selectedPoint","getPoints","point","pointSelected","deletePoint","addPoint","newPointValue","scenario","scenarioChanged","TestDataAnnotationsQueryCtrl","ValueTypes","valueTypes","INT64","DOUBLE","MONEY","DISTRIBUTION","metricKinds","CUMULATIVE","DELTA","GAUGE","STRING","VALUE_TYPE_UNSPECIFIED","BOOL","METRIC_KIND_UNSPECIFIED","ns","stackdriver_datasource","projectName","defaultProject","aggregation","crossSeriesReducer","groupBys","getLabels","interpolateGroupBys","gb","interpolatedGroupBys","resolvePanelUnitFromTargets","timeSerie","view","baseUrl","projects","projectId","getDefaultProject","error_1","getProjects","getMetricTypes","metricsApiPath","error_2","trys","doRequest","metricDescriptors","serviceShortName","displayName","maxRetries","StackdriverDatasource","alignmentPeriod","alignmentPeriods","aggOptions","alignOptions","setAggOptions","setAlignOptions","valueType","metricKind","perSeriesAligner","deselectAggregationOption","formatAlignmentText","selectedAlignment","ap","notValidOptionValue","StackdriverAggregationCtrl","StackdriverAggregation","query_aggregation_ctrl_StackdriverAggregationCtrl","filter_segments_FilterSegments","FilterSegments","getFilterKeysFunc","getFilterValuesFunc","buildSegmentModel","removeSegment","filterSegments","getFilters","hasNoFilterKeys","filterValues","getValuesForFilterKey","addNewFilterSegments","removeFilterSegment","filterSegmentUpdated","defaultDropdownValue","defaultServiceValue","hideGroupBys","StackdriverFilterCtrl","defaultRemoveGroupByValue","services","getCurrentProject","loadMetricDescriptors","initSegments","groupBySegments","getFilterKeys","getFilterValues","project","getServicesList","resourceLabels","resourceTypes","onServiceChange","getMetricsList","setMetricType","createLabelKeyElements","elements","loadLabelsPromise","removeText","resourceTypeValue","groupByChanged","filterKey","shortKey","StackdriverFilter","query_filter_ctrl_StackdriverFilterCtrl","StackdriverQueryCtrl","showAggregationOptions","aliasBy","defaultsDeep","rawQueryString","decodeURIComponent","jsonBody","StackdriverConfigCtrl","validationErrors","jwt","privateKey","private_key","tokenUri","token_uri","validateJwt","resetValidationMessages","client_email","inputDataValid","onUpload","jsonText","onPasteJwt","originalEvent","clipboardData","StackdriverAnnotationsQueryCtrl","TextPanelCtrl","onInitEditMode","onRefresh","onRender","renderMarkdown","updateContent","renderText","$applyAsync","scrollable","injector","eventManager","tmpScope","onEdit","createEditPopover","markerElementToAttachTo","invoke","$digest","constraints","pin","$destroy","DrawableEvent","drawFunc","clearFunc","moveFunc","_object","_clearFunc","_moveFunc","_position","_width","_height","_drawFunc","getObject","drawableEvent","visual","_drawableEvent","_options","getParent","_parent","isHidden","_hidden","unhide","_events","_types","_plot","eventsEnabled","EventMarkers","getEvents","setTypes","setupEvents","ve","VisualEvent","_buildDiv","vre","_buildRegDiv","ao","bo","drawEvents","_insidePlot","updateEvents","_clearEvents","markerShow","lineStyle","eventTypeId","markerTooltip","topOffset","border-left-width","border-left-color","container","marker_1","font-size","line-height","border-left","border-right","border-top","border-bottom","that","hover","createAnnotationToolip","regionWidth","right","border-left-style","background-color","xc","jquery_flot_events_EventMarkers","eventMarkers","hideEvents","getHandleHtml","valueStr","ThresholdManager","initDragging","posTop","handleElem","currentTarget","parents","lastY","dragging","clientY","stopped","graphValue","toFixed","cleanUp","renderHandle","defaultHandleTopPos","valueCanvasPos","handleTopPos","shouldDrawHandles","hasSecondYAxis","prepare","thresholdMargin","needsCleanup","addFlotOptions","gtLimit","ltLimit","lineColor","y2axis","convertToHistogramData","bucketSize","hiddenSeries","getSeriesValues","getBucketBound","maxBound","bound","bound_1","histogamSeries","convertValuesToHistogram","alignYLevel","yAxes","checkCorrectAxes","checkCorrectAxis","yLeft","yRight","moveLevelToZero","expandStuckValues","zero","oneSide","checkOneSide","checkOppositeSides","rateLeft","rateRight","checkTwoCross","absLeftMin","absLeftMax","absRightMin","absRightMax","upLeft","downLeft","upRight","downRight","getRate","restoreLevelFromZero","GraphElement","panelWidth","event_manager_EventManager","thresholdManager","threshold_manager_ThresholdManager","getSeriesFn","posX","initial","middle","renderAndShow","absoluteTime","innerHtml","xMode","place_tt","getMultiSeriesPlotHoverInfo","hoverIndex","hoverDistance","pointTime","minDistance","minTime","lastValue","hideEmpty","allIsNull","hideZero","allIsZero","hideTooltip","findHoverIndexFromData","value_type","findHoverIndexFromDataPoints","aliasEscaped","shared","detach","hoverInfo","seriesHtml","tooltipFormat","allSeriesMode","panelRelY","pointOffset","scrollTop","innerHeight","sharedCrosshairModeOnly","hasMsResolution","seriesHoverInfo","plotData","highlightClass","$tooltip","sortedSeries","onPanelteardown","onLegendRenderingComplete","onGraphHover","onGraphHoverClear","onPlotSelected","onPlotClick","onScopeDestroy","renderData","buildFlotPairs","graphHeight","sharedTooltipModeEnabled","render_panel","canMakeEditable","shouldAbortRender","drawHook","yaxes","dataWarning","processOffsetHook","gridMargin","panelOptions","processRangeHook","align","alignLevel","getMinTimeStepOfSeries","timeStep","buildFlotOptions","prepareXAxis","configureYAxisOptions","sortSeries","callPlot","getFlotPairs","nullPointMode","barWidth","addXSeriesAxis","histMin","histMax","ticks","addXHistogramAxis","addXTableAxis","addTimeAxis","incrementRenderCounter","renderError","bootData","user","lightTheme","gridColor","processOffset","processRange","percentage","translateFillOption","linewidth","steppedLine","spaceLength","pointradius","minBorderMargin","labelMarginX","sortDesc","haveSortBy","haveSortOrder","shouldSortBy","zindex","timeformat","time_format","defaultTicks","tickValues","tickStep_1","ticksNum","configureAxisMode","logBase","parseNumber","decimals","secondY","tickDecimals","applyLogScale","toNumber","MIN_VALUE","logmin","inverseTransform","generateTicksForLogScaleYAxis","minSetToZero","nextTick","maxNumTicks","numTicks","factor","valueFormats","scaledDecimals","secPerTick","graph_GraphElement","graphDirective","src_core","SeriesOverridesCtrl","overrideMenu","currentOverrides","override","addOverrideOption","propertyName","lenght","setOverride","addSeriesOverride","updateCurrentOverrides","openColorSelector","colorSelected","fakeSeries","autoClose","onClose","removeOverride","getSeriesNames","getSeriesIndexForElement","el","toggleAxis","changeSeriesColor","toggleSeries","seriesInfo","scrollPosition","legendScrollbar","scroller","sortLegend","getTableHeaderHtml","renderLegendElement","tableHeaderElem","seriesElements","hideFromLegend","avg","renderSeriesLegendElements","alignAsTable","tbodyElem","wrap","rightSide","legendRightDefaultWidth","scrollRoot","scrollbarParams","root","bar","track","barOnCls","scrollingCls","destroyScrollbar","core_default","marginRight","offsetWidth","clientWidth","scroll","addScrollbar","dispose","legendElem","empty","sideWidth","ieWidth","ThresholdFormCtrl","disabled","unbindDestroy","addThreshold","removeThreshold","onFillColorChange","onLineColorChange","DataProcessor","getSeriesList","firstItem","autoDetectMode","getAutoDetectXAxisMode","setPanelDefaultsForNewXAxisMode","timeSeriesHandler","customHandler","seriesData","colorIndex","aliasColors","isOutsideRange","validateXAxisSeriesValue","validOptions","getXAxisValueOptions","getDataFieldNames","onlyNumbers","fieldParts","getPropertiesRecursive","pluckDeep","property","propertyParts","axes_editor_AxesEditorCtrl","AxesEditorCtrl","unitFormats","getUnitFormats","logScales","linear","log (base 2)","log (base 10)","log (base 32)","setUnitFormat","xAxisModeChanged","processor","xAxisValueChanged","GraphCtrl","panelDefaults","seriesOverrides","data_processor_DataProcessor","onDataSnapshotLoad","onInitPanelActions","axesEditorComponent","alertingEnabled","alertTab","actions","annotationsPromise","zoomOut","tip","applySeriesOverrides","shiftKey","toggleSeriesExclusiveMode","removeSeriesOverride","toggleLegend","legendValuesOptionChanged","exportCsv","templateHtml","modalClass","DashListCtrl","recent","starred","headings","folderId","modes","getRecentDashboards","getStarred","getSearch","folderIds","starDashboard","isStarred","dashIds","take","impression_srv","getDashboardOpened","dashboardIds","orderId","onFolderChange","folder","PluginListCtrl","pluginList","viewModel","gotoPlugin","stopPropagation","$event","preventDefault","embedded","hasUpdate","sortOrderOptions","stateFilter","currentAlerts","onlyAlertsOnDashboard","dashboardFilter","nameFilter","AlertListPanel","sortResult","alerts","alertStateSortScore","updateStateFilter","getAlertsPromise","getCurrentAlertState","getStateChanges","al","noAlertsMessage","dashboardQuery","dashboardTags","dashboardTag","newStateDate","locale","colorScheme","maxValue","minValue","invert","colorInterpolator","domain","d3","colorScale","legendOpacityScale","exponent","drawLegendValues","rangeFrom","rangeTo","childNodes","legendValueScale","tickStepSize","isValueCloseTo","buildLegendTicks","xAxis","tickSize","LEGEND_TICK_SIZE","colorRect","posY","svgElem","baseVal","getSvgElemHeight","LEGEND_VALUE_MARGIN","getSvgElemX","clearLegend","valueTo","outerWidth","getColorScale","colorSchemes","legendHeight","valuesNumber","rangeStep","legendRects","selectAll","valuesRange","enter","drawSimpleColorLegend","colorOptions","legendOpacityScale_1","cardColor","drawSimpleOpacityLegend","cards","cardStats","widthFactor","drawColorLegend","getOpacityScale","opacityScale","drawOpacityLegend","log (base 1024)","dataFormats","Time series","Time series buckets","yBucketBoundModes","Auto","Upper","Lower","yAxis","axesEditor","heatmap_axes_editor_AxesEditorCtrl","HeatmapDisplayEditorCtrl","heatmapDisplayEditor","label2","label1","heatmap_data_converter_parseHistogramLabel","yBucket","yBounds","bounds","card","convertToHeatMap","yBucketSize","xBucketSize","heatmap","bucketBound","heatmap_data_converter_getBucketBound","TIME_INDEX","bucketNum","VALUE_INDEX","pointExt","pushToXBuckets","seriesList_1","xBucket","yBucketSplitFactor","getLogScaleBucketBounds","convertToLogScaleValueBuckets","getBucketBounds","pushToYBuckets","convertToValueBuckets","getValueBucketBound","getLogScaleBucketBound","logp","valueLog","additionalLog","additionalBucketSize","powTop","HeatmapTooltip","mouseOverBucket","originalFillColor","onMouseLeave","getBucketIndexes","xBucketIndex","yBucketIndex","boundBottom","boundTop","countValueFormatter","bucketBoundFormatter","xData","yData","bucketIndex","tooltipDecimals","tickValueFormatter","tooltipHtml","tsBuckets","tickFormatter","valIndex","tsBucketsFormatted","showHistogram","addHistogram","getXBucketIndex","getYBucketIndex","heatmapPanel","xScale","chartHeight","histogramData","histXScale","yScale","barNumberFactor","histogramDomain","histYScale","tooltipWidth","tooltipHeight","clientHeight","innerWidth","pageYOffset","DATA_RANGE_WIDING_FACTOR","HeatmapRenderer","$heatmap","heatmap_tooltip_HeatmapTooltip","padding","dataRangeWidingFactor","drawSharedCrosshair","setElementHeight","getYAxisWidth","axisText","getBBox","getXAxisHeight","axisLinePosition","addXAxis","chartWidth","timeFormat","grafanaTimeFormatter","tickFormat","tickPadding","yAxisWidth","addYAxis","tickInterval","heatmapStats","wideYAxisRange","yMin","yMax","decimalsAuto","flotTickSize","tickSizeInner","tickSizeOuter","yWiding","addLogYAxis","adjustLogRange","minLog","adjustLogMin","adjustLogMax","logScaleTickValues","addYAxisFromBuckets","valueFormatted","domainMin","domainMax","tickValue","fixYAxisTickSize","addAxes","chartTop","chartBottom","dataFormat","xAxisHeight","addHeatmapCanvas","heatmapElem","cardPadding","cardRound","addHeatmap","yBuckets","emptyBucket","nullBucket","minBucket","newBucket","mergeZeroBuckets","cardsData","maxValueAuto","setCardSize","getCardX","getCardWidth","getCardY","getCardHeight","getCardColor","getCardOpacity","highlightCard","resetCardHighLight","highlightColor","darker","strokeColor","brighter","xGridSize","yGridSize","splitFactor","cardWidth","cardHeight","cuttedWidth","getEventOffset","clientX","elemOffset","selectionRange","limitSelection","drawSelection","getEventPos","drawCrosshair","emitGraphHoverEvent","posX1","posX2","selectionX","selectionWidth","graphTooltip","yBucketBound","HeatmapCtrl","opacityScales","colorModes","selectionActivated","onCardColorChange","convertHistogramToHeatmapData","convertTimeSeriesToHeatmapData","bucketsData","xBucketNumber","xBucketSizeByNumber","interval_regex","parseSeries","yBucketNumber","convertToCards","getPanelDataSourceType","dsSupportHistogramSort","panelDatasource","heatmap_data_converter_sortSeriesByLabel","histogramToHeatmap","getDistance","calculateBucketSize","seriesHandler","flotpairs","parseHistogramSeries","rendering_HeatmapRenderer","timeKey","cells","noTableIndex","fromCharCode","columnsUnion","columnNames","columnIndexMapper","flattenedRows","mapper","alteredRow","mergedRows","compactedRows","rowIndex","otherRow","areRowsMatching","matchedRow","columnIndex","foundFieldToMatch","maxDocs","flattened","z","tableCol","TablePanelEditorCtrl","transformers","fontSizes","addColumnSegment","updateTransformHints","canSetColumns","columnsHelpMessage","getColumnOptions","dataRaw","getColumns","transformChanged","removeColumn","tablePanelEditor","editor_TablePanelEditorCtrl","ColumnOptionsCtrl","activeStyleIndex","columnTypes","dateFormats","mappingTypes","getColumnNames","addColumnStyle","styles","stylesCount","indexToInsert","removeColumnStyle","invertColorOrder","ref","styleIndex","addValueMap","valueMaps","removeValueMap","addRangeMap","rangeMaps","removeRangeMap","column_options_ColumnOptionsCtrl","isUtc","setTable","initColumns","colIndex","formatters","createColumnFormatter","getColorForValue","defaultCellFormatter","dateFormat","mappingType","setColorState","valueFormatter_1","numericValue","renderRowVariables","formatColumnValue","renderCell","addWidthHack","cellClasses","cellClass","colorState","columnHtml","preserveFormat","linkUrl","linkTooltip","linkTargetBlank","cellLink","cellTarget","cellLinkTooltip","pageSize","startPos","endPos","rowClasses","rowClass","rowStyle","cellHtml","render_values","newRow","TableRenderer","TablePanelCtrl","showHeader","fontSize","desc","pageIndex","columnOptionsTab","transformer","transformDataToTable","renderer_TableRenderer","isTimezoneUtc","toggleColumnSort","tableData","pageCount","renderPanel","panelElem","rootElem","footerElem","endPage","startPage","paginationList","activeClass","pageLinkElem","max-height","panelHeight","getTableHeight","filterData","LinkSrv","includeVars","addParamsToUrl","paramsArray","instance","appendToQueryString","stringToAppend","getAnchorInfo","href","getLinkUrl","getPanelLinkAnchorInfo","targetBlank","dashUri","slugifyForUrl","keepTime","link_srv_LinkSrv","module_SingleStatCtrl","SingleStatCtrl","linkSrv","dataType","valueNameOptions","postfix","nullText","valueName","prefixFontSize","postfixFontSize","colorBackground","colorValue","sparkline","full","thresholdMarkers","thresholdLabels","tableColumn","onSparklineColorChange","onSparklineFillChange","tableHandler","setTableValues","setValues","setTableColumnToSensibleDefault","valueRounded","decimalInfo","getDecimalsForValue","formatFunc","roundValue","setValueMapping","canModifyText","setColoring","panelColorIndex","delta","LN10","magn","dec","lastPoint","rangeMap","valueString","className","addGauge","dimension","invalidGaugeRange","plotCanvas","plotCss","colorMap","fontScale","gaugeWidthReduceRatio","gaugeWidth","thresholdMarkersWidth","getValueText","plotSeries","addSparkline","dynamicHeightMargin","strVale","applyColoringThresholds","getSpan","colorPostfix","getBigValueHtml","$panelContainer","drilldownTooltip","mouseleave","linkInfo","location","hookupDrilldownLinkTooltip","GettingStartedPanelCtrl","stepIndex","note","check","cta","passed","currentStep","nextStep","dismiss","showSuccessAlert","helpFlags1","built_in_plugins","module_namespaceObject","app/plugins/datasource/cloudwatch/module","cloudwatch_module_namespaceObject","elasticsearch_module_namespaceObject","opentsdb_module_namespaceObject","grafana_module_namespaceObject","influxdb_module_namespaceObject","logging_module_namespaceObject","mixed_module_namespaceObject","app/plugins/datasource/mysql/module","mysql_module_namespaceObject","app/plugins/datasource/postgres/module","postgres_module_namespaceObject","app/plugins/datasource/mssql/module","mssql_module_namespaceObject","prometheus_module_namespaceObject","app/plugins/datasource/testdata/module","testdata_module_namespaceObject","app/plugins/datasource/stackdriver/module","stackdriver_module_namespaceObject","app/plugins/panel/text/module","text_module_namespaceObject","app/plugins/panel/graph/module","graph_module_namespaceObject","app/plugins/panel/dashlist/module","dashlist_module_namespaceObject","app/plugins/panel/pluginlist/module","pluginlist_module_namespaceObject","app/plugins/panel/alertlist/module","alertlist_module_namespaceObject","app/plugins/panel/heatmap/module","heatmap_module_namespaceObject","app/plugins/panel/table/module","table_module_namespaceObject","app/plugins/panel/singlestat/module","singlestat_module_namespaceObject","app/plugins/panel/gettingstarted/module","Observable","Subject","bust","exposeToPlugin","component","registerDynamic","registry","system_default","newModule","locate","load","address","baseURL","defaultExtension","/*","esModule","authorization","loader","slate_react_es","react_default","react_dom_default","sdk_namespaceObject","file_export_namespaceObject","flatten_namespaceObject","plugin_loader_i","flotDeps_1","fakeDep","importPluginModule","light","dark","DatasourceSrv","deferred","pluginDef","dsConfig","Datasource","getAll","addDataSourceVariables","getExploreSources","es","metricSources","metricSource","datasource_srv_DatasourceSrv","UnknownPanelCtrl","$http","$templateCache","class","module_UnknownPanelCtrl","panelInfo","panelModule","panelCtrlPromise","componentInfo","Component","registered","templatePromise","relativeTemplateUrlToAbs","cached","getTemplate","registerPluginComponent","notFound","directiveName","$normalize","bindings","getPluginComponentDirective","core_module","child","dsModule","panel-ctrl","QueryCtrl","ConfigCtrl","dsMeta_1","model_1","appModule","appEditCtrl","app-model","app-edit-ctrl","appModel_1","loadPanelComponentInfo","getModule","pluginDirectiveLoader","dashboard_ctrl_DashboardCtrl","DashboardCtrl","keybindingSrv","alertingSrv","unsavedChangesSrv","dashboardViewStateSrv","playlistSrv","panelLoader","getPanelContainer","setupDashboard","setupDashboardInternal","onInitFailed","setCurrent","processRepeats","autoFitPanels","dashboardViewState","setupDashboardBindings","msg","fatal","loadedFallbackDashboard","templateVariableUpdated","setWindowTitleAndTheme","windowTitlePrefix","showJsonEditor","getDashboard","getPanelLoader","timezoneChanged","onRemovingPanel","getPanelInfoById","ask","confirmText","AlertingSrv","HistorySrv","getHistoryList","calculateDiff","restoreDashboard","history_srv_HistorySrv","HistoryListCtrl","$route","historySrv","appending","canCompare","onDashboardSaved","resetFromSource","switchMode","addToLog","getLog","revisionSelectionChanged","revisions","checked","formatBasicDate","getDiff","newInfo","baseInfo","isNewLatest","new","diffType","revisions_1","rev","createdDateString","created","ageString","isLastPage","basic","restoreConfirm","location_util","stripBaseFromUrl","reload","history_HistoryListCtrl","DashboardLoaderSrv","_dashboardLoadFailed","canStar","isSnapshot","canDelete","canSave","dashboardNotFound","loadDashboard","uid","_loadScriptedDashboard","getDashboardByUid","isFolder","addDashboardImpression","file","_executeScript","fromScript","scriptResult","Function","scriptFunc","isFunction","deferred_1","dashboard_loader_srv_DashboardLoaderSrv","DashNavCtrl","saveDashboard","titleTooltip","calendar","expires","editview","toggleViewMode","shareDashboard","tabIndex","showSearch","addPanel","animate","navItemClicked","navItem","clickHandler","dashnav_DashNavCtrl","bindToController","SubmenuCtrl","annotationStateChanged","openEditView","submenu_SubmenuCtrl","SaveDashboardAsModalCtrl","isValidFolderSelection","editable","hideControls","autoUpdate","keyDown","keyCode","onEnterFolderCreation","onExitFolderCreation","save_as_modal_template","controllerAs","SaveDashboardModalCtrl","saveVariables","saveTimerange","originalCurrent","timeChange","variableValueChange","isSaving","hasTimeChanged","hasVariableValuesChanged","saveForm","getSaveModelClone","postSave","resetOriginalVariables","resetOriginalTime","save_modal_template","SaveProvisionedDashboardModalCtrl","dashboardJson","blob","Blob","getJsonForClipboard","includeTemplateVars","modeSharePanel","tabs","modalTitle","buildUrl","absUrl","orgId","forCurrent","theme","shareUrl","soloUrl","iframeHtml","imageUrl","getLocalTimeZone","utcOffset","Intl","DateTimeFormat","resolvedOptions","timeZone","save_provisioned_modal_template","save_provisioned_modal_SaveProvisionedDashboardModalCtrl","ShareModalCtrl","expireOptions","accessOptions","externalUrl","sharingButtonText","externalEnabled","createSnapshot","external","originalUrl","saveSnapshot","timeoutSeconds","scrubDashboard","cmdData","postUrl","deleteUrl","snapshotUrl","saveExternalSnapshotRef","deleteKey","singlePanel","forEachPanel","deleteSnapshot","ShareSnapshotCtrl","share_snapshot_ctrl_ShareSnapshotCtrl","dashboard_model","DashboardSrv","handleSaveDashboardError","isHandled","altActionText","onAltAction","showSaveAsModal","newUrl","provisioned","showDashboardProvisionedModal","makeEditable","showSaveModal","saveJSONDashboard","dashboard_srv_DashboardSrv","urlState","getQueryStringState","needsSync","registerPanel","serializeToUrl","fromRouteUpdated","toggle","editStateChanged","toggleCollapsedPanelRow","syncState","collapsed","toggleRow","panelScopes","panelScope","getPanelScope","fullscreenPanel","leaveFullscreen","enterFullscreen","setViewMode","oldTimeRange","DashboardViewState","view_state_srv_DashboardViewState","ValidationSrv","rootName","validateNewDashboardName","validateNewFolderName","existingErrorMessage","nameLowerCased","hitTypes","hits_1","TimeSrv","timer","routeUpdated","addEventListener","autoRefreshBlocked","visibilityState","refreshDashboard","cancelAll","initTimeFromUrl","parseTime","timeAtLoad","setAutoRefresh","parseUrlParam","urlRange","timeRangeForUrl","timeHasChangedSinceLoad","cancelNextRefresh","intervalMs_1","refreshTimer","startNextRefreshTimer","afterMs","isGrafanaVisible","cancel","fromRouteUpdate","isMoment","oldRefresh","urlParams","timespan","center","time_srv_TimeSrv","ChangeTracker","originalCopyDelay","$window","originalPath","original","onbeforeunload","ignoreChanges","hasChanges","open_modal","fromFile","cleanDashboardFromIgnoredChanges","dashData","expandRows","schemaVersion","iteration","repeatPanelId","nav","originalTimepicker","discardChanges","gotoNext","baseLen","nextUrl","tracker","change_tracker_ChangeTracker","UnsavedChangesModalCtrl","discard","unsaved_changes_modal_template","TimePickerCtrl","openDropdown","timepicker","firstDayOfWeek","localeData","timeRaw","local","rangeString","absolute","fromJs","toDate","toJs","isAbsolute","zoom","isOpen","closeDropdown","refresh_intervals","applyCustom","editTimeRaw","absoluteFromChanged","getAbsoluteMomentForTimezone","absoluteToChanged","jsDate","setRelativeFilter","nowDelay","timepicker_TimePickerCtrl","$elem","ngModel","$parsers","$setValidity","parsed","$formatters","alertSrv","upload_template","btnText","isDefined","wnd","File","FileReader","FileList","files","reader","onload","readAsText","uploadDashboardDirective","DashboardExporter","makeExportable","datasourceVariable","variableLookup","requires","refName","templateizeDatasourceUsage","panelDef","processPanel","_h","_j","annotationDef","buildInfo","newObj","export_modal_DashExportCtrl","DashExportCtrl","exporter","exporter_DashboardExporter","saveDashboardAsFile","shareExternally","openSaveAsDialog","viewJson","openJsonModal","asRows","export","exportSeriesListToCsvColumns","ExportDataModalCtrl","export_data_modal_ExportDataModalCtrl","AdHocFiltersCtrl","segmentChanged","updateVariableModel","filterIndex","hasFakes","ad_hoc_filters_template","ad_hoc_filters_AdHocFiltersCtrl","optionChanged","repeat","repeatDirection","react_grid_layout","classnames_default","classnames","DashboardRow_DashboardRow","DashboardRow","panelContainer","openSettings","setState","prevState","removeRow","dashboard-row","fa","fa-chevron-down","chevronClass","components_ScrollBar_ScrollBar","ScrollBar","handleRef","componentDidMount","scrollbar","parentElement","componentDidUpdate","componentWillUnmount","setScrollTop","setScrollLeft","scrollLeft","dist_main","AddPanelPanel","onAddPanel","panelPluginInfo","handleCloseAddPanel","renderPanelItem","panelSizeChanged","panelPlugins","getPanelPlugins","copiedPanelPlugins","getCopiedPanelPlugins","small","copiedPanels","copiedPanelJson","copiedPanel","pluginCopy","filterPanels","searchWords","main_default","highlightClassName","textToHighlight","noCopiedPanelPlugins","filterChange","openCopy","openAdd","panelTab","active active--panel","","copyClass","autoFocus","onKeyPress","filterKeyPress","DashboardPanel","attachedPanel","AddPanelPanel_AddPanelPanel","lastGridWidth","SizedReactLayoutGrid","react_sizeme","react_sizeme_default","monitorWidth","onWidthChange","react_grid_layout_default","isDraggable","isResizable","measureBeforeMount","containerPadding","useCSSTransforms","cols","rowHeight","draggableHandle","onResize","onResizeStop","onDragStop","onLayoutChange","DashboardGrid_DashboardGrid","DashboardGrid","animated","triggerForceUpdate","buildLayout","panelMap","stringId","panelPos","newLayout","newLayout_1","newPos","updateGridPos","resizeDone","oldItem","newItem","renderPanels","panelClasses","panel--fullscreen","panelElements","DashboardPanel_DashboardPanel","watchDepth","wrapApply","PanelLoader","compiledElem","PanelLoader_PanelLoader","RowOptionsCtrl","onUpdated","FolderPickerCtrl","validationSrv","labelClass","loadInitialValue","permission","enableCreateNew","enableReset","initialTitle","createNewFolder","enterFolderCreation","$folder","newFolderNameChanged","newFolderNameTouched","newFolderName","hasValidationError","validationError","createFolder","closeCreateFolder","exitFolderCreation","resetFolder","rootFolder","initialFolderId","folder_picker_FolderPickerCtrl","onCreateFolder","moveDashboards","successCount","totalCount","alreadyInFolderCount","afterSave","move_to_folder_MoveToFolderCtrl","SettingsCtrl","canSaveAs","hasEditPermissionInFolders","buildSectionList","onRouteUpdated","onPostSave","sections","canAdmin","section","sectionParams","viewId","openSaveAsModal","saveDashboardJson","hideSettings","currentSection","deleteDashboard","sumBy","deleteDashboardConfirmed","folderTitle","hasUnsavedFolderChange","getFolder","folderUrl","settings_SettingsCtrl","transclude","module_PanelLinksEditorCtrl","PanelLinksEditorCtrl","addLink","queryStr","uri","cloud","editor_DashLinkEditorCtrl","DashLinkEditorCtrl","iconMap","backToList","editLink","saveLink","moveLink","deleteLink","dashLink","asDropdown","anchor","anchorSanitized","$last","DashLinksContainerCtrl","currentDashId","buildLinks","linkDef","searchDashboards","updateDashLinks","generatedLinks","searchHits","module_DashLinksContainerCtrl","permissions_DashboardPermissions","WrappedComponent","ConnectedWrappedComponent","react_redux_es","isAdding","onRemoveItem","removeDashboardPermission","onPermissionChanged","updateDashboardPermission","onAddPermission","addDashboardPermission","DashboardPermissions","permissions","Tooltip","placement","PermissionsInfo","onOpenAddPermissions","SlideDown","in","AddPermission","onCancel","onCancelAddPermission","PermissionList","isFetching","folderInfo","activeChildId","getFolderByUid","dashTab","FolderPageLoader","FolderDashboardsCtrl","DashboardImportCtrl","nameExists","uidExists","autoGenerateUid","autoGenerateUidValue","initialFolderTitle","gnetId","gnetUrl","checkGnetDashboard","__inputs","inputModel","setDatasourceOptions","inputsValid","titleChanged","uidChanged","titleTouched","hasNameValidationError","nameValidationError","hasUidValidationError","inputValueChanged","dashUrl","importedUrl","loadJsonText","parseError","gnetError","gnetInfo","back","create_folder_ctrl_CreateFolderCtrl","CreateFolderCtrl","react2angular","folder_dashboards_ctrl_FolderDashboardsCtrl","dashboard_import_ctrl_DashboardImportCtrl","PlaylistsCtrl","playlists","startUrl","removePlaylistConfirmed","playlist","removePlaylist","playlists_ctrl_PlaylistsCtrl","PlaylistSearchCtrl","tagsMode","prom","dashboardResult","tagResult","searchStarted","showStarred","queryHasNoFilters","filterByTag","PlaylistSrv","cancelPromise","filteredParams","pickBy","utils_url","playlistId","stop","isPlaying","kiosk","exit","playlist_srv_PlaylistSrv","PlaylistEditCtrl","filteredDashboards","filteredTags","searchQuery","playlistItems","dashboardresult","tagresult","filterFoundPlaylistItems","playlistItem","listPlaylistItem","term","addPlaylistItem","addTagPlaylistItem","removePlaylistItem","listedPlaylistItem","savePlaylist","isPlaylistEmpty","movePlaylistItem","newPosition","currentPosition","movePlaylistItemUp","movePlaylistItemDown","$routeProvider","playlist_edit_ctrl_PlaylistEditCtrl","grafanaRoutes","listItemClass","renderMenuItem","panel_header_template","menuScope","isDragged","menuElem","togglePanelStackPosition","parentsUntil","targetClass","menuHtml","createMenuTemplate","dropdown","togglePanelMenu","panelHeader","$document","infoDrop","panelScrollbar","lastAlertState","hasAlertRule","cornerInfoElem","transparentLastState","lastHasAlertRule","panelHeightUpdated","panelContent","updatePanelCornerInfo","cornerMode","hoverOpenDelay","transparent","__proto__","constructor","$watchGroup","$watchCollection","setPanelFocus","SoloPanelCtrl","dashboardLoaderSrv","sidemenu","initPanelScope","initDashboard","getDashboardBySlug","panelEditorTab","dynamicDirectiveSrv","fn","solo_panel_ctrl_SoloPanelCtrl","QueryRowCtrl","queryCtrl","toggleCollapse","toggleHideQuery","canCollapse","__collapsedQueryCache","collapsedText","duplicateQuery","query_editor_row_QueryRowCtrl","hasTextEditMode","query_troubleshooter_template","query_troubleshooter_QueryTroubleshooterCtrl","onRequestErrorEventListener","onRequestError","onRequestResponseEventListener","onRequestResponse","removeEventsListeners","stateChanged","toggleMocking","isMocking","hasError","isLoading","QueryTroubleshooterCtrl","getClipboardText","jsonExplorer","handleMocking","mockedData","mockedResponse","transformResponse","paramSerializer","retry","timeout","renderJsonExplorer","toggleExpand","allNodesExpanded","openAtDepth","jsonElem","animateOpen","externalUserMngLinkUrl","externalUserMngLinkName","canInvite","disableLoginForm","externalUserMngInfo","linkTarget","users","unfiltered","pendingInvites","OrgUsersCtrl","onQueryUpdated","email","updateOrgUser","userId","removeUser","removeUserConfirmed","copyInviteToClipboard","getInviteUrl","invite","org_users_ctrl_OrgUsersCtrl","profile_ctrl_ProfileCtrl","teams","orgs","showTeamsList","showOrgsList","readonlyLoginFields","getUser","getUserTeams","getUserOrgs","ProfileCtrl","setUsingOrg","org","userForm","oldTheme","select_org_ctrl_SelectOrgCtrl","SelectOrgCtrl","change_password_ctrl_ChangePasswordCtrl","ChangePasswordCtrl","command","authProxyEnabled","ldapEnabled","changePassword","newPassword","confirmNew","NewOrgCtrl","newOrg","createOrg","new_org_ctrl_NewOrgCtrl","UserInviteCtrl","sendEmail","inviteForm","CreateTeamCtrl","teamId","OrgDetailsCtrl","getOrgInfo","orgName","orgForm","addressForm","PrefsControlCtrl","prefs","updatePrefs","prefsForm","homeDashboardId","cmd","prefs_control_PrefsControlCtrl","prefs_control_template","admin_AdminListUsersCtrl","AdminListUsersCtrl","showPaging","getUsers","perPage","totalPages","pages","navigateToPage","deleteUser","admin_AdminEditUserCtrl","AdminEditUserCtrl","user_id","isGrafanaAdmin","setPassword","passwordForm","updatePermissions","orgUser","removeOrgUser","orgsSearchCache","searchOrgs","addOrgUser","addOrgForm","orgInfo","admin_AdminListOrgsCtrl","AdminListOrgsCtrl","getOrgs","deleteOrg","admin_AdminEditOrgCtrl","AdminEditOrgCtrl","getOrg","getOrgUsers","orgUsers","orgDetailsForm","admin_StyleGuideCtrl","StyleGuideCtrl","buttonNames","buttonSizes","buttonVariants","switchTheme","AdminSettingsCtrl","AdminHomeCtrl","NotificationsEditCtrl_AlertNotificationEditCtrl","AlertNotificationEditCtrl","testSeverity","sendReminder","autoResolve","uploadImage","getFrequencySuggestion","notifiers","getNotifierTemplateId","notifier","optionsTemplate","notifierTemplateId"],"mappings":"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zB,EAAA8+B,WAAAC,UAAAx/B,EAAAy/B,OAAAz/B,EAAAy/B,OAAA,GAEch/B,EAAAo9B,uBC3Tf,GAAAwB,EAAAvB,SAAA,kBACqB99B,EAAA07B,OAAA,WACrBr5B,EAAAvY,EAAAoY,KAAAzB,EAAA8+B,WAA+DC,UAAAx/B,EAAAy/B,OAAAz/B,EAAAy/B,OAAA,GAC/Dh/B,EAAAo9B,uBAIA,GAAAwB,EAAAvB,SAAA,uBAEwB,IAAG/I,EAAAt0B,EAAAN,WAAAo2B,WAAAW,EAAA/gC,IAAArX,MACtBi2C,KAAAtc,YACAmkB,EAAA7/C,MACAqtB,QAAAhtB,EAAA0d,OACAoB,SAAA,cACAwjC,WAAA,iCACAC,SAAA,+FAAA5K,EAAAj2C,KAAA,+BAAAu9C,KAAAtH,EAAAtc,aAAA,6BACA+jB,OAAA,UAIA9X,OAAAkb,KAAA,sFAAA1I,EAAA/gC,IAAArX,KAAA,aAaA8+C,QDTK9zC,EAAAyK,OAAA,sBAAwBsT,UAAA,kBAAAg4B,MCa7B/1C,EAAAyK,OAAA,sBAAAsT,UAAA,qBAAAi4B,YAYHC,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,IACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OAC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","file":"5.3fac4c3e925a0fddc893.js","sourcesContent":["/* Flot plugin for selecting regions of a plot.\n\nCopyright (c) 2007-2013 IOLA and Ole Laursen.\nLicensed under the MIT license.\n\nThe plugin supports these options:\n\nselection: {\n\tmode: null or \"x\" or \"y\" or \"xy\",\n\tcolor: color,\n\tshape: \"round\" or \"miter\" or \"bevel\",\n\tminSize: number of pixels\n}\n\nSelection support is enabled by setting the mode to one of \"x\", \"y\" or \"xy\".\nIn \"x\" mode, the user will only be able to specify the x range, similarly for\n\"y\" mode. For \"xy\", the selection becomes a rectangle where both ranges can be\nspecified. \"color\" is color of the selection (if you need to change the color\nlater on, you can get to it with plot.getOptions().selection.color). \"shape\"\nis the shape of the corners of the selection.\n\n\"minSize\" is the minimum size a selection can be in pixels. This value can\nbe customized to determine the smallest size a selection can be and still\nhave the selection rectangle be displayed. When customizing this value, the\nfact that it refers to pixels, not axis units must be taken into account.\nThus, for example, if there is a bar graph in time mode with BarWidth set to 1\nminute, setting \"minSize\" to 1 will not make the minimum selection size 1\nminute, but rather 1 pixel. Note also that setting \"minSize\" to 0 will prevent\n\"plotunselected\" events from being fired when the user clicks the mouse without\ndragging.\n\nWhen selection support is enabled, a \"plotselected\" event will be emitted on\nthe DOM element you passed into the plot function. The event handler gets a\nparameter with the ranges selected on the axes, like this:\n\n\tplaceholder.bind( \"plotselected\", function( event, ranges ) {\n\t\talert(\"You selected \" + ranges.xaxis.from + \" to \" + ranges.xaxis.to)\n\t\t// similar for yaxis - with multiple axes, the extra ones are in\n\t\t// x2axis, x3axis, ...\n\t});\n\nThe \"plotselected\" event is only fired when the user has finished making the\nselection. A \"plotselecting\" event is fired during the process with the same\nparameters as the \"plotselected\" event, in case you want to know what's\nhappening while it's happening,\n\nA \"plotunselected\" event with no arguments is emitted when the user clicks the\nmouse to remove the selection. As stated above, setting \"minSize\" to 0 will\ndestroy this behavior.\n\nThe plugin allso adds the following methods to the plot object:\n\n- setSelection( ranges, preventEvent )\n\n  Set the selection rectangle. The passed in ranges is on the same form as\n  returned in the \"plotselected\" event. If the selection mode is \"x\", you\n  should put in either an xaxis range, if the mode is \"y\" you need to put in\n  an yaxis range and both xaxis and yaxis if the selection mode is \"xy\", like\n  this:\n\n\tsetSelection({ xaxis: { from: 0, to: 10 }, yaxis: { from: 40, to: 60 } });\n\n  setSelection will trigger the \"plotselected\" event when called. If you don't\n  want that to happen, e.g. if you're inside a \"plotselected\" handler, pass\n  true as the second parameter. If you are using multiple axes, you can\n  specify the ranges on any of those, e.g. as x2axis/x3axis/... instead of\n  xaxis, the plugin picks the first one it sees.\n\n- clearSelection( preventEvent )\n\n  Clear the selection rectangle. Pass in true to avoid getting a\n  \"plotunselected\" event.\n\n- getSelection()\n\n  Returns the current selection in the same format as the \"plotselected\"\n  event. If there's currently no selection, the function returns null.\n\n*/\n\n(function ($) {\n    function init(plot) {\n        var selection = {\n                first: { x: -1, y: -1}, second: { x: -1, y: -1},\n                show: false,\n                active: false\n            };\n\n        // FIXME: The drag handling implemented here should be\n        // abstracted out, there's some similar code from a library in\n        // the navigation plugin, this should be massaged a bit to fit\n        // the Flot cases here better and reused. Doing this would\n        // make this plugin much slimmer.\n        var savedhandlers = {};\n\n        var mouseUpHandler = null;\n\n        function onMouseMove(e) {\n            if (selection.active) {\n                updateSelection(e);\n\n                plot.getPlaceholder().trigger(\"plotselecting\", [ getSelection() ]);\n            }\n        }\n\n        function onMouseDown(e) {\n            if (e.which != 1)  // only accept left-click\n                return;\n\n            // cancel out any text selections\n            document.body.focus();\n\n            // prevent text selection and drag in old-school browsers\n            if (document.onselectstart !== undefined && savedhandlers.onselectstart == null) {\n                savedhandlers.onselectstart = document.onselectstart;\n                document.onselectstart = function () { return false; };\n            }\n            if (document.ondrag !== undefined && savedhandlers.ondrag == null) {\n                savedhandlers.ondrag = document.ondrag;\n                document.ondrag = function () { return false; };\n            }\n\n            setSelectionPos(selection.first, e);\n\n            selection.active = true;\n\n            // this is a bit silly, but we have to use a closure to be\n            // able to whack the same handler again\n            mouseUpHandler = function (e) { onMouseUp(e); };\n\n            $(document).one(\"mouseup\", mouseUpHandler);\n        }\n\n        function onMouseUp(e) {\n            mouseUpHandler = null;\n\n            // revert drag stuff for old-school browsers\n            if (document.onselectstart !== undefined)\n                document.onselectstart = savedhandlers.onselectstart;\n            if (document.ondrag !== undefined)\n                document.ondrag = savedhandlers.ondrag;\n\n            // no more dragging\n            selection.active = false;\n            updateSelection(e);\n\n            if (selectionIsSane())\n                triggerSelectedEvent(e);\n            else {\n                // this counts as a clear\n                plot.getPlaceholder().trigger(\"plotunselected\", [ ]);\n                plot.getPlaceholder().trigger(\"plotselecting\", [ null ]);\n            }\n\n            setTimeout(function() {\n              plot.isSelecting = false;\n            }, 10);\n\n            return false;\n        }\n\n        function getSelection() {\n            if (!selectionIsSane())\n                return null;\n\n            if (!selection.show) return null;\n\n            var r = {}, c1 = selection.first, c2 = selection.second;\n            var axes = plot.getAxes();\n            // look if no axis is used\n            var noAxisInUse = true;\n            $.each(axes, function (name, axis) {\n              if (axis.used) {\n                anyUsed = false;\n              }\n            })\n\n            $.each(axes, function (name, axis) {\n                if (axis.used || noAxisInUse) {\n                    var p1 = axis.c2p(c1[axis.direction]), p2 = axis.c2p(c2[axis.direction]);\n                    r[name] = { from: Math.min(p1, p2), to: Math.max(p1, p2) };\n                }\n            });\n            return r;\n        }\n\n        function triggerSelectedEvent(event) {\n            var r = getSelection();\n\n            // Add ctrlKey and metaKey to event\n            r.ctrlKey = event.ctrlKey;\n            r.metaKey = event.metaKey;\n\n            plot.getPlaceholder().trigger(\"plotselected\", [ r ]);\n\n            // backwards-compat stuff, to be removed in future\n            if (r.xaxis && r.yaxis)\n                plot.getPlaceholder().trigger(\"selected\", [ { x1: r.xaxis.from, y1: r.yaxis.from, x2: r.xaxis.to, y2: r.yaxis.to } ]);\n        }\n\n        function clamp(min, value, max) {\n            return value < min ? min: (value > max ? max: value);\n        }\n\n        function setSelectionPos(pos, e) {\n            var o = plot.getOptions();\n            var offset = plot.getPlaceholder().offset();\n            var plotOffset = plot.getPlotOffset();\n            pos.x = clamp(0, e.pageX - offset.left - plotOffset.left, plot.width());\n            pos.y = clamp(0, e.pageY - offset.top - plotOffset.top, plot.height());\n\n            if (o.selection.mode == \"y\")\n                pos.x = pos == selection.first ? 0 : plot.width();\n\n            if (o.selection.mode == \"x\")\n                pos.y = pos == selection.first ? 0 : plot.height();\n        }\n\n        function updateSelection(pos) {\n            if (pos.pageX == null)\n                return;\n\n            setSelectionPos(selection.second, pos);\n            if (selectionIsSane()) {\n                plot.isSelecting = true;\n                selection.show = true;\n                plot.triggerRedrawOverlay();\n            }\n            else\n                clearSelection(true);\n        }\n\n        function clearSelection(preventEvent) {\n            if (selection.show) {\n                selection.show = false;\n                plot.triggerRedrawOverlay();\n                if (!preventEvent)\n                    plot.getPlaceholder().trigger(\"plotunselected\", [ ]);\n            }\n        }\n\n        // function taken from markings support in Flot\n        function extractRange(ranges, coord) {\n            var axis, from, to, key, axes = plot.getAxes();\n\n            for (var k in axes) {\n                axis = axes[k];\n                if (axis.direction == coord) {\n                    key = coord + axis.n + \"axis\";\n                    if (!ranges[key] && axis.n == 1)\n                        key = coord + \"axis\"; // support x1axis as xaxis\n                    if (ranges[key]) {\n                        from = ranges[key].from;\n                        to = ranges[key].to;\n                        break;\n                    }\n                }\n            }\n\n            // backwards-compat stuff - to be removed in future\n            if (!ranges[key]) {\n                axis = coord == \"x\" ? plot.getXAxes()[0] : plot.getYAxes()[0];\n                from = ranges[coord + \"1\"];\n                to = ranges[coord + \"2\"];\n            }\n\n            // auto-reverse as an added bonus\n            if (from != null && to != null && from > to) {\n                var tmp = from;\n                from = to;\n                to = tmp;\n            }\n\n            return { from: from, to: to, axis: axis };\n        }\n\n        function setSelection(ranges, preventEvent) {\n            var axis, range, o = plot.getOptions();\n\n            if (o.selection.mode == \"y\") {\n                selection.first.x = 0;\n                selection.second.x = plot.width();\n            }\n            else {\n                range = extractRange(ranges, \"x\");\n\n                selection.first.x = range.axis.p2c(range.from);\n                selection.second.x = range.axis.p2c(range.to);\n            }\n\n            if (o.selection.mode == \"x\") {\n                selection.first.y = 0;\n                selection.second.y = plot.height();\n            }\n            else {\n                range = extractRange(ranges, \"y\");\n\n                selection.first.y = range.axis.p2c(range.from);\n                selection.second.y = range.axis.p2c(range.to);\n            }\n\n            selection.show = true;\n            plot.triggerRedrawOverlay();\n            if (!preventEvent && selectionIsSane())\n                triggerSelectedEvent();\n        }\n\n        function selectionIsSane() {\n            var minSize = plot.getOptions().selection.minSize;\n            return Math.abs(selection.second.x - selection.first.x) >= minSize &&\n                Math.abs(selection.second.y - selection.first.y) >= minSize;\n        }\n\n        plot.clearSelection = clearSelection;\n        plot.setSelection = setSelection;\n        plot.getSelection = getSelection;\n\n        plot.hooks.bindEvents.push(function(plot, eventHolder) {\n            var o = plot.getOptions();\n            if (o.selection.mode != null) {\n                eventHolder.mousemove(onMouseMove);\n                eventHolder.mousedown(onMouseDown);\n            }\n        });\n\n\n        plot.hooks.drawOverlay.push(function (plot, ctx) {\n            // draw selection\n            if (selection.show && selectionIsSane()) {\n                var plotOffset = plot.getPlotOffset();\n                var o = plot.getOptions();\n\n                ctx.save();\n                ctx.translate(plotOffset.left, plotOffset.top);\n\n                var c = $.color.parse(o.selection.color);\n\n                ctx.strokeStyle = c.scale('a', 0.8).toString();\n                ctx.lineWidth = 1;\n                ctx.lineJoin = o.selection.shape;\n                ctx.fillStyle = c.scale('a', 0.4).toString();\n\n                var x = Math.min(selection.first.x, selection.second.x) + 0.5,\n                    y = Math.min(selection.first.y, selection.second.y) + 0.5,\n                    w = Math.abs(selection.second.x - selection.first.x) - 1,\n                    h = Math.abs(selection.second.y - selection.first.y) - 1;\n\n                ctx.fillRect(x, y, w, h);\n                ctx.strokeRect(x, y, w, h);\n\n                ctx.restore();\n            }\n        });\n\n        plot.hooks.shutdown.push(function (plot, eventHolder) {\n            eventHolder.unbind(\"mousemove\", onMouseMove);\n            eventHolder.unbind(\"mousedown\", onMouseDown);\n\n            if (mouseUpHandler)\n                $(document).unbind(\"mouseup\", mouseUpHandler);\n        });\n\n    }\n\n    $.plot.plugins.push({\n        init: init,\n        options: {\n            selection: {\n                mode: null, // one of null, \"x\", \"y\" or \"xy\"\n                color: \"#e8cfac\",\n                shape: \"round\", // one of \"round\", \"miter\", or \"bevel\"\n                minSize: 5 // minimum number of pixels\n            }\n        },\n        name: 'selection',\n        version: '1.1'\n    });\n})(jQuery);\n","/* Flot plugin for stacking data sets rather than overlyaing them.\n\nCopyright (c) 2007-2014 IOLA and Ole Laursen.\nLicensed under the MIT license.\n\nThe plugin assumes the data is sorted on x (or y if stacking horizontally).\nFor line charts, it is assumed that if a line has an undefined gap (from a\nnull point), then the line above it should have the same gap - insert zeros\ninstead of \"null\" if you want another behaviour. This also holds for the start\nand end of the chart. Note that stacking a mix of positive and negative values\nin most instances doesn't make sense (so it looks weird).\n\nTwo or more series are stacked when their \"stack\" attribute is set to the same\nkey (which can be any number or string or just \"true\"). To specify the default\nstack, you can set the stack option like this:\n\n    series: {\n        stack: null/false, true, or a key (number/string)\n    }\n\nYou can also specify it for a single series, like this:\n\n    $.plot( $(\"#placeholder\"), [{\n        data: [ ... ],\n        stack: true\n    }])\n\nThe stacking order is determined by the order of the data series in the array\n(later series end up on top of the previous).\n\nInternally, the plugin modifies the datapoints in each series, adding an\noffset to the y value. For line series, extra data points are inserted through\ninterpolation. If there's a second y value, it's also adjusted (e.g for bar\ncharts or filled areas).\n\n*/\n\n(function ($) {\n    var options = {\n        series: { stack: null } // or number/string\n    };\n\n    function init(plot) {\n        function findMatchingSeries(s, allseries) {\n            var res = null;\n            for (var i = 0; i < allseries.length; ++i) {\n                if (s == allseries[i])\n                    break;\n\n                if (allseries[i].stack == s.stack)\n                    res = allseries[i];\n            }\n\n            return res;\n        }\n\n        function stackData(plot, s, datapoints) {\n            if (s.stack == null || s.stack === false)\n                return;\n\n            var other = findMatchingSeries(s, plot.getData());\n            if (!other)\n                return;\n\n            var ps = datapoints.pointsize,\n                points = datapoints.points,\n                otherps = other.datapoints.pointsize,\n                otherpoints = other.datapoints.points,\n                newpoints = [],\n                px, py, intery, qx, qy, bottom,\n                withlines = s.lines.show,\n                horizontal = s.bars.horizontal,\n                withbottom = ps > 2 && (horizontal ? datapoints.format[2].x : datapoints.format[2].y),\n                withsteps = withlines && s.lines.steps,\n                keyOffset = horizontal ? 1 : 0,\n                accumulateOffset = horizontal ? 0 : 1,\n                i = 0, j = 0, l, m;\n\n            while (true) {\n                if (i >= points.length && j >= otherpoints.length)\n                    break;\n\n                l = newpoints.length;\n\n                if (i < points.length && points[i] == null) {\n                    // copy gaps\n                    for (m = 0; m < ps; ++m)\n                        newpoints.push(points[i + m]);\n                    i += ps;\n                }\n                else if (i >= points.length) {\n                    // take the remaining points from the previous series\n                    for (m = 0; m < ps; ++m)\n                        newpoints.push(otherpoints[j + m]);\n                    if (withbottom)\n                        newpoints[l + 2] = otherpoints[j + accumulateOffset];\n                    j += otherps;\n                }\n                else if (j >= otherpoints.length) {\n                    // take the remaining points from the current series\n                    for (m = 0; m < ps; ++m)\n                        newpoints.push(points[i + m]);\n                    i += ps;\n                }\n                else if (j < otherpoints.length && otherpoints[j] == null) {\n                    // ignore point\n                    j += otherps;\n                }\n                else {\n                    // cases where we actually got two points\n                    px = points[i + keyOffset];\n                    py = points[i + accumulateOffset];\n                    qx = otherpoints[j + keyOffset];\n                    qy = otherpoints[j + accumulateOffset];\n                    bottom = 0;\n\n                    if (px == qx) {\n                        for (m = 0; m < ps; ++m)\n                            newpoints.push(points[i + m]);\n\n                        newpoints[l + accumulateOffset] += qy;\n                        bottom = qy;\n\n                        i += ps;\n                        j += otherps;\n                    }\n                    else if (px > qx) {\n                        // take the point from the previous series so that next series will correctly stack\n                        if (i == 0) {\n                            for (m = 0; m < ps; ++m)\n                                newpoints.push(otherpoints[j + m]);\n                            bottom = qy;\n                        }\n                        // we got past point below, might need to\n                        // insert interpolated extra point\n                        if (i > 0 && points[i - ps] != null) {\n                            intery = py + (points[i - ps + accumulateOffset] - py) * (qx - px) / (points[i - ps + keyOffset] - px);\n                            newpoints.push(qx);\n                            newpoints.push(intery + qy);\n                            for (m = 2; m < ps; ++m)\n                                newpoints.push(points[i + m]);\n                            bottom = qy;\n                        }\n\n                        j += otherps;\n                    }\n                    else { // px < qx\n                        for (m = 0; m < ps; ++m)\n                            newpoints.push(points[i + m]);\n\n                        // we might be able to interpolate a point below,\n                        // this can give us a better y\n                        if (j > 0 && otherpoints[j - otherps] != null)\n                            bottom = qy + (otherpoints[j - otherps + accumulateOffset] - qy) * (px - qx) / (otherpoints[j - otherps + keyOffset] - qx);\n\n                        newpoints[l + accumulateOffset] += bottom;\n\n                        i += ps;\n                    }\n\n                    fromgap = false;\n\n                    if (l != newpoints.length && withbottom)\n                        newpoints[l + 2] = bottom;\n                }\n\n                // maintain the line steps invariant\n                if (withsteps && l != newpoints.length && l > 0\n                    && newpoints[l] != null\n                    && newpoints[l] != newpoints[l - ps]\n                    && newpoints[l + 1] != newpoints[l - ps + 1]) {\n                    for (m = 0; m < ps; ++m)\n                        newpoints[l + ps + m] = newpoints[l + m];\n                    newpoints[l + 1] = newpoints[l - ps + 1];\n                }\n            }\n\n            datapoints.points = newpoints;\n        }\n\n        plot.hooks.processDatapoints.push(stackData);\n    }\n\n    $.plot.plugins.push({\n        init: init,\n        options: options,\n        name: 'stack',\n        version: '1.2'\n    });\n})(jQuery);\n","(function ($) {\n    var options = {\n        series: {\n            stackpercent: null\n        } // or number/string\n    };\n\n    function init(plot) {\n\n        // will be built up dynamically as a hash from x-value, or y-value if horizontal\n        var stackBases = {};\n        var processed = false;\n        var stackSums = {};\n\n        //set percentage for stacked chart\n        function processRawData(plot, series, data, datapoints) {\n            if (!processed) {\n                processed = true;\n                stackSums = getStackSums(plot.getData());\n            }\n\t\t\tif (series.stackpercent == true) {\n\t\t\t\tvar num = data.length;\n\t\t\t\tseries.percents = [];\n\t\t\t\tvar key_idx = 0;\n\t\t\t\tvar value_idx = 1;\n\t\t\t\tif (series.bars && series.bars.horizontal && series.bars.horizontal === true) {\n\t\t\t\t\tkey_idx = 1;\n\t\t\t\t\tvalue_idx = 0;\n\t\t\t\t}\n\t\t\t\tfor (var j = 0; j < num; j++) {\n\t\t\t\t\tvar sum = stackSums[data[j][key_idx] + \"\"];\n\t\t\t\t\tif (sum > 0) {\n\t\t\t\t\t\tseries.percents.push(data[j][value_idx] * 100 / sum);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tseries.percents.push(0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n        }\n\n        //calculate summary\n        function getStackSums(_data) {\n            var data_len = _data.length;\n            var sums = {};\n            if (data_len > 0) {\n                //caculate summary\n                for (var i = 0; i < data_len; i++) {\n                    if (_data[i].stackpercent) {\n\t\t\t\t\t\tvar key_idx = 0;\n\t\t\t\t\t\tvar value_idx = 1;\n\t\t\t\t\t\tif (_data[i].bars && _data[i].bars.horizontal && _data[i].bars.horizontal === true) {\n\t\t\t\t\t\t\tkey_idx = 1;\n\t\t\t\t\t\t\tvalue_idx = 0;\n\t\t\t\t\t\t}\n                        var num = _data[i].data.length;\n                        for (var j = 0; j < num; j++) {\n                            var value = 0;\n                            if (_data[i].data[j][1] != null) {\n                                value = _data[i].data[j][value_idx];\n                            }\n                            if (sums[_data[i].data[j][key_idx] + \"\"]) {\n                                sums[_data[i].data[j][key_idx] + \"\"] += value;\n                            } else {\n                                sums[_data[i].data[j][key_idx] + \"\"] = value;\n                            }\n\n                        }\n                    }\n                }\n            }\n            return sums;\n        }\n\n        function stackData(plot, s, datapoints) {\n            if (!s.stackpercent) return;\n            if (!processed) {\n                stackSums = getStackSums(plot.getData());\n            }\n            var newPoints = [];\n\n\n\t\t\tvar key_idx = 0;\n\t\t\tvar value_idx = 1;\n\t\t\tif (s.bars && s.bars.horizontal && s.bars.horizontal === true) {\n\t\t\t\tkey_idx = 1;\n\t\t\t\tvalue_idx = 0;\n\t\t\t}\n\n\t\t\tfor (var i = 0; i < datapoints.points.length; i += 3) {\n\t\t\t\t// note that the values need to be turned into absolute y-values.\n\t\t\t\t// in other words, if you were to stack (x, y1), (x, y2), and (x, y3),\n\t\t\t\t// (each from different series, which is where stackBases comes in),\n\t\t\t\t// you'd want the new points to be (x, y1, 0), (x, y1+y2, y1), (x, y1+y2+y3, y1+y2)\n\t\t\t\t// generally, (x, thisValue + (base up to this point), + (base up to this point))\n\t\t\t\tif (!stackBases[datapoints.points[i + key_idx]]) {\n\t\t\t\t\tstackBases[datapoints.points[i + key_idx]] = 0;\n\t\t\t\t}\n\t\t\t\tnewPoints[i + key_idx] = datapoints.points[i + key_idx];\n\t\t\t\tnewPoints[i + value_idx] = datapoints.points[i + value_idx] + stackBases[datapoints.points[i + key_idx]];\n\t\t\t\tnewPoints[i + 2] = stackBases[datapoints.points[i + key_idx]];\n\t\t\t\tstackBases[datapoints.points[i + key_idx]] += datapoints.points[i + value_idx];\n\t\t\t\t// change points to percentage values\n\t\t\t\t// you may need to set yaxis:{ max = 100 }\n\t\t\t\tif ( stackSums[newPoints[i+key_idx]+\"\"] > 0 ){\n\t\t\t\t\tnewPoints[i + value_idx] = newPoints[i + value_idx] * 100 / stackSums[newPoints[i + key_idx] + \"\"];\n\t\t\t\t\tnewPoints[i + 2] = newPoints[i + 2] * 100 / stackSums[newPoints[i + key_idx] + \"\"];\n\t\t\t\t} else {\n\t\t\t\t\tnewPoints[i + value_idx] = 0;\n\t\t\t\t\tnewPoints[i + 2] = 0;\n\t\t\t\t}\n\t\t\t}\n\n            datapoints.points = newPoints;\n        }\n\n\t\tplot.hooks.processRawData.push(processRawData);\n        plot.hooks.processDatapoints.push(stackData);\n    }\n\n    $.plot.plugins.push({\n        init: init,\n        options: options,\n        name: 'stackpercent',\n        version: '0.1'\n    });\n})(jQuery);\n","(function($) {\n    \"use strict\";\n\n    var options = {\n        series: {\n            fillBelowTo: null\n        }\n    };\n\n    function init(plot) {\n        function findBelowSeries( series, allseries ) {\n\n            var i;\n\n            for ( i = 0; i < allseries.length; ++i ) {\n                if ( allseries[ i ].id === series.fillBelowTo ) {\n                    return allseries[ i ];\n                }\n            }\n\n            return null;\n        }\n\n        /* top and bottom doesn't actually matter for this, we're just using it to help make this easier to think about */\n        /* this is a vector cross product operation */\n        function segmentIntersection(top_left_x, top_left_y, top_right_x, top_right_y, bottom_left_x, bottom_left_y, bottom_right_x, bottom_right_y) {\n            var top_delta_x, top_delta_y, bottom_delta_x, bottom_delta_y,\n                s, t;\n\n            top_delta_x = top_right_x - top_left_x;\n            top_delta_y = top_right_y - top_left_y;\n            bottom_delta_x = bottom_right_x - bottom_left_x;\n            bottom_delta_y = bottom_right_y - bottom_left_y;\n\n            s = (\n                (-top_delta_y * (top_left_x - bottom_left_x)) + (top_delta_x * (top_left_y - bottom_left_y))\n            ) / (\n                -bottom_delta_x * top_delta_y + top_delta_x * bottom_delta_y\n            );\n\n            t = (\n                (bottom_delta_x * (top_left_y - bottom_left_y)) - (bottom_delta_y * (top_left_x - bottom_left_x))\n            ) / (\n                -bottom_delta_x * top_delta_y + top_delta_x * bottom_delta_y\n            );\n\n            // Collision detected\n            if (s >= 0 && s <= 1 && t >= 0 && t <= 1) {\n                return [\n                    top_left_x + (t * top_delta_x), // X\n                    top_left_y + (t * top_delta_y) // Y\n                ];\n            }\n\n            // No collision\n            return null;\n        }\n\n        function plotDifferenceArea(plot, ctx, series) {\n            if ( series.fillBelowTo === null ) {\n                return;\n            }\n\n            var otherseries,\n\n                ps,\n                points,\n\n                otherps,\n                otherpoints,\n\n                plotOffset,\n                fillStyle;\n\n            function openPolygon(x, y) {\n                ctx.beginPath();\n                ctx.moveTo(\n                    series.xaxis.p2c(x) + plotOffset.left,\n                    series.yaxis.p2c(y) + plotOffset.top\n                );\n\n            }\n\n            function closePolygon() {\n                ctx.closePath();\n                ctx.fill();\n            }\n\n            function validateInput() {\n                if (points.length/ps !== otherpoints.length/otherps) {\n                    console.error(\"Refusing to graph inconsistent number of points\");\n                    return false;\n                }\n\n                var i;\n                for (i = 0; i < (points.length / ps); i++) {\n                    if (\n                        points[i * ps] !== null &&\n                        otherpoints[i * otherps] !== null &&\n                        points[i * ps] !== otherpoints[i * otherps]\n                    ) {\n                        console.error(\"Refusing to graph points without matching value\");\n                        return false;\n                    }\n                }\n\n                return true;\n            }\n\n            function findNextStart(start_i, end_i) {\n                console.assert(end_i > start_i, \"expects the end index to be greater than the start index\");\n\n                var start = (\n                        start_i === 0 ||\n                        points[start_i - 1] === null ||\n                        otherpoints[start_i - 1] === null\n                    ),\n                    equal = false,\n                    i,\n                    intersect;\n\n                for (i = start_i; i < end_i; i++) {\n                    // Take note of null points\n                    if (\n                        points[(i * ps) + 1] === null ||\n                        otherpoints[(i * ps) + 1] === null\n                    ) {\n                        equal = false;\n                        start = true;\n                    }\n\n                    // Take note of equal points\n                    else if (points[(i * ps) + 1] === otherpoints[(i * otherps) + 1]) {\n                        equal = true;\n                        start = false;\n                    }\n\n\n                    else if (points[(i * ps) + 1] > otherpoints[(i * otherps) + 1]) {\n                        // If we begin above the desired point\n                        if (start) {\n                            openPolygon(points[i * ps], points[(i * ps) + 1]);\n                        }\n\n                        // If an equal point preceeds this, start the polygon at that equal point\n                        else if (equal) {\n                            openPolygon(points[(i - 1) * ps], points[((i - 1) * ps) + 1]);\n                        }\n\n                        // Otherwise, find the intersection point, and start it there\n                        else {\n                            intersect = intersectionPoint(i);\n                            openPolygon(intersect[0], intersect[1]);\n                        }\n\n                        topTraversal(i, end_i);\n                        return;\n                    }\n\n                    // If we go below equal, equal at any preceeding point is irrelevant\n                    else {\n                        start = false;\n                        equal = false;\n                    }\n                }\n            }\n\n            function intersectionPoint(right_i) {\n                console.assert(right_i > 0, \"expects the second point in the series line segment\");\n\n                var i, intersect;\n\n                for (i = 1; i < (otherpoints.length/otherps); i++) {\n                    intersect = segmentIntersection(\n                        points[(right_i - 1) * ps], points[((right_i - 1) * ps) + 1],\n                        points[right_i * ps], points[(right_i * ps) + 1],\n\n                        otherpoints[(i - 1) * otherps], otherpoints[((i - 1) * otherps) + 1],\n                        otherpoints[i * otherps], otherpoints[(i * otherps) + 1]\n                    );\n\n                    if (intersect !== null) {\n                        return intersect;\n                    }\n                }\n\n                console.error(\"intersectionPoint() should only be called when an intersection happens\");\n            }\n\n            function bottomTraversal(start_i, end_i) {\n                console.assert(start_i >= end_i, \"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)\");\n\n                var i;\n\n                for (i = start_i; i >= end_i; i--) {\n                    ctx.lineTo(\n                        otherseries.xaxis.p2c(otherpoints[i * otherps]) + plotOffset.left,\n                        otherseries.yaxis.p2c(otherpoints[(i * otherps) + 1]) + plotOffset.top\n                    );\n                }\n\n                closePolygon();\n            }\n\n            function topTraversal(start_i, end_i) {\n                console.assert(start_i <= end_i, \"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)\");\n\n                var i,\n                    intersect;\n\n                for (i = start_i; i < end_i; i++) {\n                    if (points[(i * ps) + 1] === null && i > start_i) {\n                        bottomTraversal(i - 1, start_i);\n                        findNextStart(i, end_i);\n                        return;\n                    }\n\n                    else if (points[(i * ps) + 1] === otherpoints[(i * otherps) + 1]) {\n                        bottomTraversal(i, start_i);\n                        findNextStart(i, end_i);\n                        return;\n                    }\n\n                    else if (points[(i * ps) + 1] < otherpoints[(i * otherps) + 1]) {\n                        intersect = intersectionPoint(i);\n                        ctx.lineTo(\n                            series.xaxis.p2c(intersect[0]) + plotOffset.left,\n                            series.yaxis.p2c(intersect[1]) + plotOffset.top\n                        );\n                        bottomTraversal(i, start_i);\n                        findNextStart(i, end_i);\n                        return;\n\n                    }\n\n                    else {\n                        ctx.lineTo(\n                            series.xaxis.p2c(points[i * ps]) + plotOffset.left,\n                            series.yaxis.p2c(points[(i * ps) + 1]) + plotOffset.top\n                        );\n                    }\n                }\n\n                bottomTraversal(end_i, start_i);\n            }\n\n\n            // Begin processing\n\n            otherseries = findBelowSeries( series, plot.getData() );\n\n            if ( !otherseries ) {\n                return;\n            }\n\n            ps = series.datapoints.pointsize;\n            points = series.datapoints.points;\n            otherps = otherseries.datapoints.pointsize;\n            otherpoints = otherseries.datapoints.points;\n            plotOffset = plot.getPlotOffset();\n\n            if (!validateInput()) {\n                return;\n            }\n\n\n            // Flot's getFillStyle() should probably be exposed somewhere\n            fillStyle = $.color.parse(series.color);\n            fillStyle.a = 0.4;\n            fillStyle.normalize();\n            ctx.fillStyle = fillStyle.toString();\n\n\n            // Begin recursive bi-directional traversal\n            findNextStart(0, points.length/ps);\n        }\n\n        plot.hooks.drawSeries.push(plotDifferenceArea);\n    }\n\n    $.plot.plugins.push({\n        init: init,\n        options: options,\n        name: \"fillbelow\",\n        version: \"0.1.0\"\n    });\n\n})(jQuery);\n","/* Flot plugin for showing crosshairs when the mouse hovers over the plot.\n\nCopyright (c) 2007-2014 IOLA and Ole Laursen.\nLicensed under the MIT license.\n\nThe plugin supports these options:\n\n\tcrosshair: {\n\t\tmode: null or \"x\" or \"y\" or \"xy\"\n\t\tcolor: color\n\t\tlineWidth: number\n\t}\n\nSet the mode to one of \"x\", \"y\" or \"xy\". The \"x\" mode enables a vertical\ncrosshair that lets you trace the values on the x axis, \"y\" enables a\nhorizontal crosshair and \"xy\" enables them both. \"color\" is the color of the\ncrosshair (default is \"rgba(170, 0, 0, 0.80)\"), \"lineWidth\" is the width of\nthe drawn lines (default is 1).\n\nThe plugin also adds four public methods:\n\n  - setCrosshair( pos )\n\n    Set the position of the crosshair. Note that this is cleared if the user\n    moves the mouse. \"pos\" is in coordinates of the plot and should be on the\n    form { x: xpos, y: ypos } (you can use x2/x3/... if you're using multiple\n    axes), which is coincidentally the same format as what you get from a\n    \"plothover\" event. If \"pos\" is null, the crosshair is cleared.\n\n  - clearCrosshair()\n\n    Clear the crosshair.\n\n  - lockCrosshair(pos)\n\n    Cause the crosshair to lock to the current location, no longer updating if\n    the user moves the mouse. Optionally supply a position (passed on to\n    setCrosshair()) to move it to.\n\n    Example usage:\n\n\tvar myFlot = $.plot( $(\"#graph\"), ..., { crosshair: { mode: \"x\" } } };\n\t$(\"#graph\").bind( \"plothover\", function ( evt, position, item ) {\n\t\tif ( item ) {\n\t\t\t// Lock the crosshair to the data point being hovered\n\t\t\tmyFlot.lockCrosshair({\n\t\t\t\tx: item.datapoint[ 0 ],\n\t\t\t\ty: item.datapoint[ 1 ]\n\t\t\t});\n\t\t} else {\n\t\t\t// Return normal crosshair operation\n\t\t\tmyFlot.unlockCrosshair();\n\t\t}\n\t});\n\n  - unlockCrosshair()\n\n    Free the crosshair to move again after locking it.\n*/\n\n(function ($) {\n    var options = {\n        crosshair: {\n            mode: null, // one of null, \"x\", \"y\" or \"xy\",\n            color: \"rgba(170, 0, 0, 0.80)\",\n            lineWidth: 1\n        }\n    };\n    \n    function init(plot) {\n        // position of crosshair in pixels\n        var crosshair = { x: -1, y: -1, locked: false };\n\n        plot.setCrosshair = function setCrosshair(pos) {\n            if (!pos)\n                crosshair.x = -1;\n            else {\n                var o = plot.p2c(pos);\n                crosshair.x = Math.max(0, Math.min(o.left, plot.width()));\n                crosshair.y = Math.max(0, Math.min(o.top, plot.height()));\n            }\n            \n            plot.triggerRedrawOverlay();\n        };\n        \n        plot.clearCrosshair = plot.setCrosshair; // passes null for pos\n        \n        plot.lockCrosshair = function lockCrosshair(pos) {\n            if (pos)\n                plot.setCrosshair(pos);\n            crosshair.locked = true;\n        };\n\n        plot.unlockCrosshair = function unlockCrosshair() {\n            crosshair.locked = false;\n        };\n\n        function onMouseOut(e) {\n            if (crosshair.locked)\n                return;\n\n            if (crosshair.x != -1) {\n                crosshair.x = -1;\n                plot.triggerRedrawOverlay();\n            }\n        }\n\n        function onMouseMove(e) {\n            if (crosshair.locked)\n                return;\n                \n            if (plot.getSelection && plot.getSelection()) {\n                crosshair.x = -1; // hide the crosshair while selecting\n                return;\n            }\n                \n            var offset = plot.offset();\n            crosshair.x = Math.max(0, Math.min(e.pageX - offset.left, plot.width()));\n            crosshair.y = Math.max(0, Math.min(e.pageY - offset.top, plot.height()));\n            plot.triggerRedrawOverlay();\n        }\n        \n        plot.hooks.bindEvents.push(function (plot, eventHolder) {\n            if (!plot.getOptions().crosshair.mode)\n                return;\n\n            eventHolder.mouseout(onMouseOut);\n            eventHolder.mousemove(onMouseMove);\n        });\n\n        plot.hooks.drawOverlay.push(function (plot, ctx) {\n            var c = plot.getOptions().crosshair;\n            if (!c.mode)\n                return;\n\n            var plotOffset = plot.getPlotOffset();\n            \n            ctx.save();\n            ctx.translate(plotOffset.left, plotOffset.top);\n\n            if (crosshair.x != -1) {\n                var adj = plot.getOptions().crosshair.lineWidth % 2 ? 0.5 : 0;\n\n                ctx.strokeStyle = c.color;\n                ctx.lineWidth = c.lineWidth;\n                ctx.lineJoin = \"round\";\n\n                ctx.beginPath();\n                if (c.mode.indexOf(\"x\") != -1) {\n                    var drawX = Math.floor(crosshair.x) + adj;\n                    ctx.moveTo(drawX, 0);\n                    ctx.lineTo(drawX, plot.height());\n                }\n                if (c.mode.indexOf(\"y\") != -1) {\n                    var drawY = Math.floor(crosshair.y) + adj;\n                    ctx.moveTo(0, drawY);\n                    ctx.lineTo(plot.width(), drawY);\n                }\n                ctx.stroke();\n            }\n            ctx.restore();\n        });\n\n        plot.hooks.shutdown.push(function (plot, eventHolder) {\n            eventHolder.unbind(\"mouseout\", onMouseOut);\n            eventHolder.unbind(\"mousemove\", onMouseMove);\n        });\n    }\n    \n    $.plot.plugins.push({\n        init: init,\n        options: options,\n        name: 'crosshair',\n        version: '1.0'\n    });\n})(jQuery);\n","/*\n * jQuery.flot.dashes\n *\n * options = {\n *   series: {\n *     dashes: {\n *\n *       // show\n *       // default: false\n *       // Whether to show dashes for the series.\n *       show: <boolean>,\n *\n *       // lineWidth\n *       // default: 2\n *       // The width of the dashed line in pixels.\n *       lineWidth: <number>,\n *\n *       // dashLength\n *       // default: 10\n *       // Controls the length of the individual dashes and the amount of\n *       // space between them.\n *       // If this is a number, the dashes and spaces will have that length.\n *       // If this is an array, it is read as [ dashLength, spaceLength ]\n *       dashLength: <number> or <array[2]>\n *     }\n *   }\n * }\n */\n(function($){\n\n  function init(plot) {\n\n    plot.hooks.processDatapoints.push(function(plot, series, datapoints) {\n\n      if (!series.dashes.show) return;\n\n      plot.hooks.draw.push(function(plot, ctx) {\n\n        var plotOffset = plot.getPlotOffset(),\n          axisx = series.xaxis,\n          axisy = series.yaxis;\n\n        function plotDashes(xoffset, yoffset) {\n\n          var points = datapoints.points,\n            ps = datapoints.pointsize,\n            prevx = null,\n            prevy = null,\n            dashRemainder = 0,\n            dashOn = true,\n            dashOnLength,\n            dashOffLength;\n\n          if (series.dashes.dashLength[0]) {\n            dashOnLength = series.dashes.dashLength[0];\n            if (series.dashes.dashLength[1]) {\n              dashOffLength = series.dashes.dashLength[1];\n            } else {\n              dashOffLength = dashOnLength;\n            }\n          } else {\n            dashOffLength = dashOnLength = series.dashes.dashLength;\n          }\n\n          ctx.beginPath();\n\n          for (var i = ps; i < points.length; i += ps) {\n\n            var x1 = points[i - ps],\n              y1 = points[i - ps + 1],\n              x2 = points[i],\n              y2 = points[i + 1];\n\n            if (x1 == null || x2 == null) continue;\n\n            // clip with ymin\n            if (y1 <= y2 && y1 < axisy.min) {\n              if (y2 < axisy.min) continue;   // line segment is outside\n              // compute new intersection point\n              x1 = (axisy.min - y1) / (y2 - y1) * (x2 - x1) + x1;\n              y1 = axisy.min;\n            } else if (y2 <= y1 && y2 < axisy.min) {\n              if (y1 < axisy.min) continue;\n              x2 = (axisy.min - y1) / (y2 - y1) * (x2 - x1) + x1;\n              y2 = axisy.min;\n            }\n\n            // clip with ymax\n            if (y1 >= y2 && y1 > axisy.max) {\n              if (y2 > axisy.max) continue;\n              x1 = (axisy.max - y1) / (y2 - y1) * (x2 - x1) + x1;\n              y1 = axisy.max;\n            } else if (y2 >= y1 && y2 > axisy.max) {\n              if (y1 > axisy.max) continue;\n              x2 = (axisy.max - y1) / (y2 - y1) * (x2 - x1) + x1;\n              y2 = axisy.max;\n            }\n\n            // clip with xmin\n            if (x1 <= x2 && x1 < axisx.min) {\n              if (x2 < axisx.min) continue;\n              y1 = (axisx.min - x1) / (x2 - x1) * (y2 - y1) + y1;\n              x1 = axisx.min;\n            } else if (x2 <= x1 && x2 < axisx.min) {\n              if (x1 < axisx.min) continue;\n              y2 = (axisx.min - x1) / (x2 - x1) * (y2 - y1) + y1;\n              x2 = axisx.min;\n            }\n\n            // clip with xmax\n            if (x1 >= x2 && x1 > axisx.max) {\n              if (x2 > axisx.max) continue;\n              y1 = (axisx.max - x1) / (x2 - x1) * (y2 - y1) + y1;\n              x1 = axisx.max;\n            } else if (x2 >= x1 && x2 > axisx.max) {\n              if (x1 > axisx.max) continue;\n              y2 = (axisx.max - x1) / (x2 - x1) * (y2 - y1) + y1;\n              x2 = axisx.max;\n            }\n\n            if (x1 != prevx || y1 != prevy) {\n              ctx.moveTo(axisx.p2c(x1) + xoffset, axisy.p2c(y1) + yoffset);\n            }\n\n            var ax1 = axisx.p2c(x1) + xoffset,\n              ay1 = axisy.p2c(y1) + yoffset,\n              ax2 = axisx.p2c(x2) + xoffset,\n              ay2 = axisy.p2c(y2) + yoffset,\n              dashOffset;\n\n            function lineSegmentOffset(segmentLength) {\n\n              var c = Math.sqrt(Math.pow(ax2 - ax1, 2) + Math.pow(ay2 - ay1, 2));\n\n              if (c <= segmentLength) {\n                return {\n                  deltaX: ax2 - ax1,\n                  deltaY: ay2 - ay1,\n                  distance: c,\n                  remainder: segmentLength - c\n                }\n              } else {\n                var xsign = ax2 > ax1 ? 1 : -1,\n                  ysign = ay2 > ay1 ? 1 : -1;\n                return {\n                  deltaX: xsign * Math.sqrt(Math.pow(segmentLength, 2) / (1 + Math.pow((ay2 - ay1)/(ax2 - ax1), 2))),\n                  deltaY: ysign * Math.sqrt(Math.pow(segmentLength, 2) - Math.pow(segmentLength, 2) / (1 + Math.pow((ay2 - ay1)/(ax2 - ax1), 2))),\n                  distance: segmentLength,\n                  remainder: 0\n                };\n              }\n            }\n            //-end lineSegmentOffset\n\n            do {\n\n              dashOffset = lineSegmentOffset(\n                dashRemainder > 0 ? dashRemainder :\n                  dashOn ? dashOnLength : dashOffLength);\n\n              if (dashOffset.deltaX != 0 || dashOffset.deltaY != 0) {\n                if (dashOn) {\n                  ctx.lineTo(ax1 + dashOffset.deltaX, ay1 + dashOffset.deltaY);\n                } else {\n                  ctx.moveTo(ax1 + dashOffset.deltaX, ay1 + dashOffset.deltaY);\n                }\n              }\n\n              dashOn = !dashOn;\n              dashRemainder = dashOffset.remainder;\n              ax1 += dashOffset.deltaX;\n              ay1 += dashOffset.deltaY;\n\n            } while (dashOffset.distance > 0);\n\n            prevx = x2;\n            prevy = y2;\n          }\n\n          ctx.stroke();\n        }\n        //-end plotDashes\n\n        ctx.save();\n        ctx.translate(plotOffset.left, plotOffset.top);\n        ctx.lineJoin = 'round';\n\n        var lw = series.dashes.lineWidth,\n          sw = series.shadowSize;\n\n        // FIXME: consider another form of shadow when filling is turned on\n        if (lw > 0 && sw > 0) {\n          // draw shadow as a thick and thin line with transparency\n          ctx.lineWidth = sw;\n          ctx.strokeStyle = \"rgba(0,0,0,0.1)\";\n          // position shadow at angle from the mid of line\n          var angle = Math.PI/18;\n          plotDashes(Math.sin(angle) * (lw/2 + sw/2), Math.cos(angle) * (lw/2 + sw/2));\n          ctx.lineWidth = sw/2;\n          plotDashes(Math.sin(angle) * (lw/2 + sw/4), Math.cos(angle) * (lw/2 + sw/4));\n        }\n\n        ctx.lineWidth = lw;\n        ctx.strokeStyle = series.color;\n\n        if (lw > 0) {\n          plotDashes(0, 0);\n        }\n\n        ctx.restore();\n\n      });\n      //-end draw hook\n\n    });\n    //-end processDatapoints hook\n\n  }\n  //-end init\n\n  $.plot.plugins.push({\n    init: init,\n    options: {\n      series: {\n        dashes: {\n          show: false,\n          lineWidth: 2,\n          dashLength: 10\n        }\n      }\n    },\n    name: 'dashes',\n    version: '0.1'\n  });\n\n})(jQuery)\n","/*!\n * jquery.flot.gauge v1.1.0 *\n *\n * Flot plugin for rendering gauge charts.\n *\n * Copyright (c) 2015 @toyoty99.\n * Licensed under the MIT license.\n */\n\n/**\n * @module flot.gauge\n */\n(function($) {\n\n\n    /**\n     * Gauge class\n     *\n     * @class Gauge\n     */\n    var Gauge = (function() {\n        /**\n         * context of canvas\n         *\n         * @property context\n         * @type Object\n         */\n        var context;\n        /**\n         * placeholder of canvas\n         *\n         * @property placeholder\n         * @type Object\n         */\n        var placeholder;\n        /**\n         * options of plot\n         *\n         * @property options\n         * @type Object\n         */\n        var options;\n        /**\n         * options of gauge\n         *\n         * @property gaugeOptions\n         * @type Object\n         */\n        var gaugeOptions;\n        /**\n         * data series\n         *\n         * @property series\n         * @type Array\n         */\n        var series;\n        /**\n         * logger\n         *\n         * @property logger\n         * @type Object\n         */\n        var logger;\n\n        /**\n         * constructor\n         *\n         * @class Gauge\n         * @constructor\n         * @param  {Object} gaugeOptions gauge options\n         */\n        var Gauge = function(plot, ctx) {\n            context = ctx;\n            placeholder = plot.getPlaceholder();\n            options = plot.getOptions();\n            gaugeOptions = options.series.gauges;\n            series = plot.getData();\n            logger = getLogger(gaugeOptions.debug);\n        }\n\n        /**\n         * calculate layout\n         *\n         * @method calculateLayout\n         * @return the calculated layout properties\n         */\n        Gauge.prototype.calculateLayout = function() {\n\n            var canvasWidth = placeholder.width();\n            var canvasHeight = placeholder.height();\n\n\n\n            // calculate cell size\n            var columns = Math.min(series.length, gaugeOptions.layout.columns);\n            var rows = Math.ceil(series.length / columns);\n\n\n\n            var margin = gaugeOptions.layout.margin;\n            var hMargin = gaugeOptions.layout.hMargin;\n            var vMargin = gaugeOptions.layout.vMargin;\n            var cellWidth = (canvasWidth - (margin * 2) - (hMargin * (columns - 1))) / columns;\n            var cellHeight = (canvasHeight - (margin * 2) - (vMargin * (rows - 1))) / rows;\n            if (gaugeOptions.layout.square) {\n                var cell = Math.min(cellWidth, cellHeight);\n                cellWidth = cell;\n                cellHeight = cell;\n            }\n\n\n\n            // calculate 'auto' values\n            calculateAutoValues(gaugeOptions, cellWidth);\n\n            // calculate maximum radius\n            var cellMargin = gaugeOptions.cell.margin;\n            var labelMargin = 0;\n            var labelFontSize = 0;\n            if (gaugeOptions.label.show) {\n                labelMargin = gaugeOptions.label.margin;\n                labelFontSize = gaugeOptions.label.font.size;\n            }\n            var valueMargin = 0;\n            var valueFontSize = 0;\n            if (gaugeOptions.value.show) {\n                valueMargin = gaugeOptions.value.margin;\n                valueFontSize = gaugeOptions.value.font.size;\n            }\n            var thresholdWidth = 0;\n            if (gaugeOptions.threshold.show) {\n                thresholdWidth = gaugeOptions.threshold.width;\n            }\n            var thresholdLabelMargin = 0;\n            var thresholdLabelFontSize = 0;\n            if (gaugeOptions.threshold.label.show) {\n                thresholdLabelMargin = gaugeOptions.threshold.label.margin;\n                thresholdLabelFontSize = gaugeOptions.threshold.label.font.size;\n            }\n\n            var maxRadiusH = (cellWidth / 2) - cellMargin - thresholdWidth - (thresholdLabelMargin * 2) - thresholdLabelFontSize;\n\n            var startAngle = gaugeOptions.gauge.startAngle;\n            var endAngle = gaugeOptions.gauge.endAngle;\n            var dAngle = (endAngle - startAngle) / 100;\n            var heightRatioV = -1;\n            for (var a = startAngle; a < endAngle; a += dAngle) {\n                heightRatioV = Math.max(heightRatioV, Math.sin(toRad(a)));\n            }\n            heightRatioV = Math.max(heightRatioV, Math.sin(toRad(endAngle)));\n            var outerRadiusV = (cellHeight - (cellMargin * 2) - (labelMargin * 2) - labelFontSize) / (1 + heightRatioV);\n            if (outerRadiusV * heightRatioV < valueMargin + (valueFontSize / 2)) {\n                outerRadiusV = cellHeight - (cellMargin * 2) - (labelMargin * 2) - labelFontSize - valueMargin - (valueFontSize / 2);\n            }\n            var maxRadiusV = outerRadiusV - (thresholdLabelMargin * 2) - thresholdLabelFontSize - thresholdWidth;\n\n            var radius = Math.min(maxRadiusH, maxRadiusV);\n\n\n            var width = gaugeOptions.gauge.width;\n            if (width >= radius) {\n                width = Math.max(3, radius / 3);\n            }\n\n\n            var outerRadius = (thresholdLabelMargin * 2) + thresholdLabelFontSize + thresholdWidth + radius;\n            var gaugeOuterHeight = Math.max(outerRadius * (1 + heightRatioV), outerRadius + valueMargin + (valueFontSize / 2));\n\n            return {\n                canvasWidth: canvasWidth,\n                canvasHeight: canvasHeight,\n                margin: margin,\n                hMargin: hMargin,\n                vMargin: vMargin,\n                columns: columns,\n                rows: rows,\n                cellWidth: cellWidth,\n                cellHeight: cellHeight,\n                cellMargin: cellMargin,\n                labelMargin: labelMargin,\n                labelFontSize: labelFontSize,\n                valueMargin: valueMargin,\n                valueFontSize: valueFontSize,\n                width: width,\n                radius: radius,\n                thresholdWidth: thresholdWidth,\n                thresholdLabelMargin: thresholdLabelMargin,\n                thresholdLabelFontSize: thresholdLabelFontSize,\n                gaugeOuterHeight: gaugeOuterHeight\n            };\n        }\n\n        /**\n         * calculate the values which are set as 'auto'\n         *\n         * @method calculateAutoValues\n         * @param  {Object} gaugeOptionsi the options of the gauge\n         * @param  {Number} cellWidth the width of cell\n         */\n        function calculateAutoValues(gaugeOptionsi, cellWidth) {\n\n            if (gaugeOptionsi.gauge.width === \"auto\") {\n                gaugeOptionsi.gauge.width = Math.max(5, cellWidth / 8);\n            }\n            if (gaugeOptionsi.label.margin === \"auto\") {\n                gaugeOptionsi.label.margin = Math.max(1, cellWidth / 20);\n            }\n            if (gaugeOptionsi.label.font.size === \"auto\") {\n                gaugeOptionsi.label.font.size = Math.max(5, cellWidth / 8);\n            }\n            if (gaugeOptionsi.value.margin === \"auto\") {\n                gaugeOptionsi.value.margin = Math.max(1, cellWidth / 30);\n            }\n            if (gaugeOptionsi.value.font.size === \"auto\") {\n                gaugeOptionsi.value.font.size = Math.max(5, cellWidth / 9);\n            }\n            if (gaugeOptionsi.threshold.width === \"auto\") {\n                gaugeOptionsi.threshold.width = Math.max(3, cellWidth / 100);\n            }\n            if (gaugeOptionsi.threshold.label.margin === \"auto\") {\n                gaugeOptionsi.threshold.label.margin = Math.max(3, cellWidth / 40);\n            }\n            if (gaugeOptionsi.threshold.label.font.size === \"auto\") {\n                gaugeOptionsi.threshold.label.font.size = Math.max(5, cellWidth / 15);\n            }\n\n        }\n        Gauge.prototype.calculateAutoValues = calculateAutoValues;\n\n        /**\n         * calculate the layout of the cell inside\n         *\n         * @method calculateCellLayout\n         * @param  {Object} gaugeOptionsi the options of the gauge\n         * @param  {Number} cellWidth the width of cell\n         * @param  {Number} i the index of the series\n         * @return the calculated cell layout properties\n         */\n        Gauge.prototype.calculateCellLayout = function(gaugeOptionsi, layout, i) {\n\n            // calculate top, left and center\n            var c = col(layout.columns, i);\n            var r = row(layout.columns, i);\n            var x = layout.margin + (layout.cellWidth + layout.hMargin) * c;\n            var y = layout.margin + (layout.cellHeight + layout.vMargin) * r;\n            var cx = x + (layout.cellWidth / 2);\n            var cy = y + layout.cellMargin + (layout.labelMargin * 2) + layout.labelFontSize + layout.thresholdWidth\n                        + layout.thresholdLabelFontSize + (layout.thresholdLabelMargin * 2) + layout.radius;\n            var blank = layout.cellHeight - (layout.cellMargin * 2) - (layout.labelMargin * 2) - layout.labelFontSize - layout.gaugeOuterHeight;\n            var offsetY = 0;\n            if (gaugeOptionsi.cell.vAlign === \"middle\") {\n                offsetY = (blank / 2);\n            } else if (gaugeOptionsi.cell.vAlign === \"bottom\") {\n                offsetY = blank;\n            }\n            cy += offsetY;\n\n            return {\n                col: c,\n                row: r,\n                x: x,\n                y: y,\n                offsetY: offsetY,\n                cellWidth: layout.cellWidth,\n                cellHeight: layout.cellHeight,\n                cellMargin: layout.cellMargin,\n                cx: cx,\n                cy: cy\n            }\n        }\n\n        /**\n         * draw the background of chart\n         *\n         * @method drawBackground\n         * @param  {Object} layout the layout properties\n         */\n        Gauge.prototype.drawBackground = function(layout) {\n\n            if (!gaugeOptions.frame.show) {\n                return;\n            }\n            context.save();\n            context.strokeStyle = options.grid.borderColor;\n            context.lineWidth = options.grid.borderWidth;\n            context.strokeRect(0, 0, layout.canvasWidth, layout.canvasHeight);\n            if (options.grid.backgroundColor) {\n                context.fillStyle = options.grid.backgroundColor;\n                context.fillRect(0, 0, layout.canvasWidth, layout.canvasHeight);\n            }\n            context.restore();\n        }\n\n        /**\n         * draw the background of cell\n         *\n         * @method drawCellBackground\n         * @param  {Object} gaugeOptionsi the options of the gauge\n         * @param  {Object} cellLayout the cell layout properties\n         */\n        Gauge.prototype.drawCellBackground = function(gaugeOptionsi, cellLayout) {\n\n            context.save();\n            if (gaugeOptionsi.cell.border && gaugeOptionsi.cell.border.show && gaugeOptionsi.cell.border.color && gaugeOptionsi.cell.border.width) {\n                context.strokeStyle = gaugeOptionsi.cell.border.color;\n                context.lineWidth = gaugeOptionsi.cell.border.width;\n                context.strokeRect(cellLayout.x, cellLayout.y, cellLayout.cellWidth, cellLayout.cellHeight);\n            }\n            if (gaugeOptionsi.cell.background && gaugeOptionsi.cell.background.color) {\n                context.fillStyle = gaugeOptionsi.cell.background.color;\n                context.fillRect(cellLayout.x, cellLayout.y, cellLayout.cellWidth, cellLayout.cellHeight);\n            }\n            context.restore();\n        }\n\n        /**\n         * draw the gauge\n         *\n         * @method drawGauge\n         * @param  {Object} gaugeOptionsi the options of the gauge\n         * @param  {Object} layout the layout properties\n         * @param  {Object} cellLayout the cell layout properties\n         * @param  {String} label the label of data\n         * @param  {Number} data the value of the gauge\n         */\n        Gauge.prototype.drawGauge = function(gaugeOptionsi, layout, cellLayout, label, data) {\n\n\n            var blur = gaugeOptionsi.gauge.shadow.show ? gaugeOptionsi.gauge.shadow.blur : 0;\n\n\n            // draw gauge frame\n            drawArcWithShadow(\n                cellLayout.cx, // center x\n                cellLayout.cy, // center y\n                layout.radius,\n                layout.width,\n                toRad(gaugeOptionsi.gauge.startAngle),\n                toRad(gaugeOptionsi.gauge.endAngle),\n                gaugeOptionsi.gauge.border.color,      // line color\n                gaugeOptionsi.gauge.border.width,      // line width\n                gaugeOptionsi.gauge.background.color,  // fill color\n                blur);\n\n            // draw gauge\n            var c1 = getColor(gaugeOptionsi, data);\n            var a2 = calculateAngle(gaugeOptionsi, layout, data);\n            drawArcWithShadow(\n                cellLayout.cx, // center x\n                cellLayout.cy, // center y\n                layout.radius - 1,\n                layout.width - 2,\n                toRad(gaugeOptionsi.gauge.startAngle),\n                toRad(a2),\n                c1,           // line color\n                1,            // line width\n                c1,           // fill color\n                blur);\n        }\n\n        /**\n         * decide the color of the data from the threshold options\n         *\n         * @method getColor\n         * @private\n         * @param  {Object} gaugeOptionsi the options of the gauge\n         * @param  {Number} data the value of the gauge\n         */\n        function getColor(gaugeOptionsi, data) {\n            var color;\n            for (var i = 0; i < gaugeOptionsi.threshold.values.length; i++) {\n                var threshold = gaugeOptionsi.threshold.values[i];\n                color = threshold.color;\n                if (data < threshold.value) {\n                    break;\n                }\n            }\n            return color;\n        }\n\n        /**\n         * calculate the angle of the data\n         *\n         * @method calculateAngle\n         * @private\n         * @param  {Object} gaugeOptionsi the options of the gauge\n         * @param  {Object} layout the layout properties\n         * @param  {Number} data the value of the gauge\n         */\n        function calculateAngle(gaugeOptionsi, layout, data) {\n            var a =\n                gaugeOptionsi.gauge.startAngle\n                    + (gaugeOptionsi.gauge.endAngle - gaugeOptionsi.gauge.startAngle)\n                        * ((data - gaugeOptionsi.gauge.min) / (gaugeOptionsi.gauge.max - gaugeOptionsi.gauge.min));\n\n            if (a < gaugeOptionsi.gauge.startAngle) {\n                a = gaugeOptionsi.gauge.startAngle;\n            } else if (a > gaugeOptionsi.gauge.endAngle) {\n                a = gaugeOptionsi.gauge.endAngle;\n            }\n            return a;\n        }\n\n        /**\n         * draw the arc of the threshold\n         *\n         * @method drawThreshold\n         * @param  {Object} gaugeOptionsi the options of the gauge\n         * @param  {Object} layout the layout properties\n         * @param  {Object} cellLayout the cell layout properties\n         */\n        Gauge.prototype.drawThreshold = function(gaugeOptionsi, layout, cellLayout) {\n\n            var a1 = gaugeOptionsi.gauge.startAngle;\n            for (var i = 0; i < gaugeOptionsi.threshold.values.length; i++) {\n                var threshold = gaugeOptionsi.threshold.values[i];\n                c1 = threshold.color;\n                a2 = calculateAngle(gaugeOptionsi, layout, threshold.value);\n                drawArc(\n                    context,\n                    cellLayout.cx, // center x\n                    cellLayout.cy, // center y\n                    layout.radius + layout.thresholdWidth,\n                    layout.thresholdWidth - 2,\n                    toRad(a1),\n                    toRad(a2),\n                    c1,           // line color\n                    1,            // line width\n                    c1);          // fill color\n                a1 = a2;\n            }\n        }\n\n        /**\n         * draw an arc with a shadow\n         *\n         * @method drawArcWithShadow\n         * @private\n         * @param  {Number} cx the x position of the center\n         * @param  {Number} cy the y position of the center\n         * @param  {Number} r the radius of an arc\n         * @param  {Number} w the width of an arc\n         * @param  {Number} rd1 the start angle of an arc in radians\n         * @param  {Number} rd2 the end angle of an arc in radians\n         * @param  {String} lc the color of a line\n         * @param  {Number} lw the widht of a line\n         * @param  {String} fc the fill color  of an arc\n         * @param  {Number} blur the shdow blur\n         */\n        function drawArcWithShadow(cx, cy, r, w, rd1, rd2, lc, lw, fc, blur) {\n            if (rd1 === rd2) {\n                return;\n            }\n            context.save();\n\n            drawArc(context, cx, cy, r, w, rd1, rd2, lc, lw, fc);\n\n            if (blur) {\n                drawArc(context, cx, cy, r, w, rd1, rd2);\n                context.clip();\n                context.shadowOffsetX = 0;\n                context.shadowOffsetY = 0;\n                context.shadowBlur = 10;\n                context.shadowColor = \"gray\";\n                drawArc(context, cx, cy, r + 1, w + 2, rd1, rd2, lc, 1);\n            }\n            context.restore();\n        }\n\n        /**\n         * draw the label of the gauge\n         *\n         * @method drawLable\n         * @param  {Object} gaugeOptionsi the options of the gauge\n         * @param  {Object} layout the layout properties\n         * @param  {Object} cellLayout the cell layout properties\n         * @param  {Number} i the index of the series\n         * @param  {Object} item the item of the series\n         */\n        Gauge.prototype.drawLable = function(gaugeOptionsi, layout, cellLayout, i, item) {\n\n            drawText(\n                cellLayout.cx,\n                cellLayout.y + cellLayout.cellMargin + layout.labelMargin + cellLayout.offsetY,\n                \"flotGagueLabel\" + i,\n                gaugeOptionsi.label.formatter ? gaugeOptionsi.label.formatter(item.label, item.data[0][1]) : text,\n                gaugeOptionsi.label);\n        }\n\n        /**\n         * draw the value of the gauge\n         *\n         * @method drawValue\n         * @param  {Object} gaugeOptionsi the options of the gauge\n         * @param  {Object} layout the layout properties\n         * @param  {Object} cellLayout the cell layout properties\n         * @param  {Number} i the index of the series\n         * @param  {Object} item the item of the series\n         */\n        Gauge.prototype.drawValue = function(gaugeOptionsi, layout, cellLayout, i, item) {\n\n            drawText(\n                cellLayout.cx,\n                cellLayout.cy - (gaugeOptionsi.value.font.size / 2),\n                \"flotGagueValue\" + i,\n                gaugeOptionsi.value.formatter ? gaugeOptionsi.value.formatter(item.label, item.data[0][1]) : text,\n                gaugeOptionsi.value);\n        }\n\n        /**\n         * draw the values of the threshold\n         *\n         * @method drawThresholdValues\n         * @param  {Object} gaugeOptionsi the options of the gauge\n         * @param  {Object} layout the layout properties\n         * @param  {Object} cellLayout the cell layout properties\n         * @param  {Number} i the index of the series\n         */\n        Gauge.prototype.drawThresholdValues = function(gaugeOptionsi, layout, cellLayout, i) {\n\n            // min, max\n            drawThresholdValue(gaugeOptionsi, layout, cellLayout, \"Min\" + i, gaugeOptionsi.gauge.min, gaugeOptionsi.gauge.startAngle);\n            drawThresholdValue(gaugeOptionsi, layout, cellLayout, \"Max\" + i, gaugeOptionsi.gauge.max, gaugeOptionsi.gauge.endAngle);\n            // threshold values\n            for (var j = 0; j < gaugeOptionsi.threshold.values.length; j++) {\n                var threshold = gaugeOptionsi.threshold.values[j];\n                if (threshold.value > gaugeOptionsi.gauge.min && threshold.value < gaugeOptionsi.gauge.max) {\n                    var a = calculateAngle(gaugeOptionsi, layout, threshold.value);\n                    drawThresholdValue(gaugeOptionsi, layout, cellLayout, i + \"_\" + j, threshold.value, a);\n                }\n            }\n        }\n\n        /**\n         * draw the value of the threshold\n         *\n         * @method drawThresholdValue\n         * @param  {Object} gaugeOptionsi the options of the gauge\n         * @param  {Object} layout the layout properties\n         * @param  {Object} cellLayout the cell layout properties\n         * @param  {Number} i the index of the series\n         * @param  {Number} value the value of the threshold\n         * @param  {Number} a the angle of the value drawn\n         */\n        function drawThresholdValue(gaugeOptionsi, layout, cellLayout, i, value, a) {\n            drawText(\n                cellLayout.cx\n                    + ((layout.thresholdLabelMargin + (layout.thresholdLabelFontSize / 2) + layout.radius)\n                        * Math.cos(toRad(a))),\n                cellLayout.cy\n                    + ((layout.thresholdLabelMargin + (layout.thresholdLabelFontSize / 2) + layout.radius)\n                        * Math.sin(toRad(a))),\n                \"flotGagueThresholdValue\" + i,\n                gaugeOptionsi.threshold.label.formatter ? gaugeOptionsi.threshold.label.formatter(value) : value,\n                gaugeOptionsi.threshold.label,\n                a);\n        }\n\n        /**\n         * draw a text\n         *\n         * the textOptions is assumed as follows:\n         *\n         *   textOptions: {\n         *       background: {\n         *           color: null,\n         *           opacity: 0\n         *       },\n         *       font: {\n         *           size: \"auto\"\n         *           family: \"\\\"ＭＳ ゴシック\\\",sans-serif\"\n         *       },\n         *       color: null\n         *   }\n         *\n         * @method drawText\n         * @private\n         * @param  {Number} x the x position of the text drawn (left top)\n         * @param  {Number} y the y position of the text drawn (left top)\n         * @param  {String} id the id of the dom element\n         * @param  {String} text the text drawn\n         * @param  {Object} textOptions the option of the text\n         * @param  {Number} [a] the angle of the value drawn\n         */\n        function drawText(x, y, id, text, textOptions, a) {\n            var span = $(\".\" + id, placeholder);\n            var exists = span.length;\n            if (!exists) {\n                span = $(\"<span></span>\")\n                span.attr(\"id\", id);\n                span.css(\"position\", \"absolute\");\n                span.css(\"top\", y + \"px\");\n                if (textOptions.font.size) {\n                    span.css(\"font-size\", textOptions.font.size + \"px\");\n                }\n                if (textOptions.font.family) {\n                    span.css(\"font-family\", textOptions.font.family);\n                }\n                if (textOptions.color) {\n                    span.css(\"color\", textOptions.color);\n                }\n                if (textOptions.background.color) {\n                    span.css(\"background-color\", textOptions.background.color);\n                }\n                if (textOptions.background.opacity) {\n                    span.css(\"opacity\", textOptions.background.opacity);\n                }\n                placeholder.append(span);\n            }\n            span.text(text);\n            // after append, readjust the left position\n            span.css(\"left\", x + \"px\"); // for redraw, resetting the left position is needed here\n            span.css(\"left\", (parseInt(span.css(\"left\")) - (span.width()/ 2)) + \"px\");\n\n            // at last, set angle\n            if (!exists && a) {\n                span.css(\"top\", (parseInt(span.css(\"top\")) - (span.height()/ 2)) + \"px\");\n                span.css(\"transform\", \"rotate(\" + ((180 * a) + 90) + \"deg)\"); // not supported for ie8\n            }\n        }\n\n        return Gauge;\n    })();\n    /**\n     * get a instance of Logger\n     *\n     * @method  getLogger\n     * @for flot.gauge\n     * @private\n     * @param  {Object} debugOptions the options of debug\n     */\n    function getLogger(debugOptions) {\n        return typeof Logger !== \"undefined\" ? new Logger(debugOptions) : null;\n    }\n\n    /**\n     * calculate the index of columns for the specified data\n     *\n     * @method col\n     * @for flot.gauge\n     * @param  {Number} columns the number of columns\n     * @param  {Number} i       the index of the series\n     * @return the index of columns\n     */\n    function col(columns, i) {\n        return i % columns;\n    }\n\n    /**\n     * calculate the index of rows for the specified data\n     *\n     * @method row\n     * @for flot.gauge\n     * @param  {Number} columns the number of rows\n     * @param  {Number} i       the index of the series\n     * @return the index of rows\n     */\n    function row(columns, i) {\n        return Math.floor(i / columns);\n    }\n\n    /**\n     * calculate the angle in radians\n     *\n     * internally, use a number without PI (0 - 2).\n     * so, in this function, multiply PI\n     *\n     * @method toRad\n     * @for flot.gauge\n     * @param  {Number} a the number of angle without PI\n     * @return the angle in radians\n     */\n    function toRad(a) {\n        return a * Math.PI;\n    }\n\n    /**\n     * draw an arc\n     *\n     * @method drawArc\n     * @for flot.gauge\n     * @param  {Object} context the context of canvas\n     * @param  {Number} cx the x position of the center\n     * @param  {Number} cy the y position of the center\n     * @param  {Number} r the radius of an arc\n     * @param  {Number} w the width of an arc\n     * @param  {Number} rd1 the start angle of an arc in radians\n     * @param  {Number} rd2 the end angle of an arc in radians\n     * @param  {String} lc the color of a line\n     * @param  {Number} lw the widht of a line\n     * @param  {String} fc the fill color  of an arc\n     */\n    function drawArc(context, cx, cy, r, w, rd1, rd2, lc, lw, fc) {\n        if (rd1 === rd2) {\n            return;\n        }\n        var counterClockwise = false;\n        context.save();\n        context.beginPath();\n        context.arc(cx, cy, r, rd1, rd2, counterClockwise);\n        context.lineTo(cx + (r - w) * Math.cos(rd2),\n                       cy + (r - w) * Math.sin(rd2));\n        context.arc(cx, cy, r - w, rd2, rd1, !counterClockwise);\n        context.closePath();\n        if (lw) {\n            context.lineWidth = lw;\n        }\n        if (lc) {\n            context.strokeStyle = lc;\n            context.stroke();\n        }\n        if (fc) {\n            context.fillStyle = fc;\n            context.fill();\n        }\n        context.restore();\n    }\n\n    /**\n     * initialize plugin\n     *\n     * @method init\n     * @for flot.gauge\n     * @private\n     * @param  {Object} plot a instance of plot\n     */\n    function init (plot) {\n        // add processOptions hook\n        plot.hooks.processOptions.push(function(plot, options) {\n            var logger = getLogger(options.series.gauges.debug);\n\n\n\n\n            // turn 'grid' and 'legend' off\n            if (options.series.gauges.show) {\n                options.grid.show = false;\n                options.legend.show = false;\n            }\n\n            // sort threshold\n            var thresholds = options.series.gauges.threshold.values;\n\n            thresholds.sort(function(a, b) {\n                if (a.value < b.value) {\n                    return -1;\n                } else if (a.value > b.value) {\n                    return 1;\n                } else {\n                    return 0;\n                }\n            });\n\n\n\n        });\n\n        // add draw hook\n        plot.hooks.draw.push(function(plot, context) {\n            var options = plot.getOptions();\n            var gaugeOptions = options.series.gauges;\n\n            var logger = getLogger(gaugeOptions.debug);\n\n\n            if (!gaugeOptions.show) {\n                return;\n            }\n\n            var series = plot.getData();\n\n            if (!series || !series.length) {\n                return; // if no series were passed\n            }\n\n            var gauge = new Gauge(plot, context);\n\n            // calculate layout\n            var layout = gauge.calculateLayout();\n\n            // debug layout\n            if (gaugeOptions.debug.layout) {\n\n            }\n\n            // draw background\n            gauge.drawBackground(layout)\n\n            // draw cells (label, gauge, value, threshold)\n            for (var i = 0; i < series.length; i++) {\n                var item = series[i];\n\n                var gaugeOptionsi = $.extend({}, gaugeOptions, item.gauges);\n                if (item.gauges) {\n                    // re-calculate 'auto' values\n                    gauge.calculateAutoValues(gaugeOptionsi, layout.cellWidth);\n                }\n\n                // calculate cell layout\n                var cellLayout = gauge.calculateCellLayout(gaugeOptionsi, layout, i);\n\n                // draw cell background\n                gauge.drawCellBackground(gaugeOptionsi, cellLayout)\n                // debug layout\n                if (gaugeOptionsi.debug.layout) {\n\n                }\n                // draw label\n                if (gaugeOptionsi.label.show) {\n                    gauge.drawLable(gaugeOptionsi, layout, cellLayout, i, item);\n                }\n                // draw gauge\n                gauge.drawGauge(gaugeOptionsi, layout, cellLayout, item.label, item.data[0][1]);\n                // draw threshold\n                if (gaugeOptionsi.threshold.show) {\n                    gauge.drawThreshold(gaugeOptionsi, layout, cellLayout);\n                }\n                if (gaugeOptionsi.threshold.label.show) {\n                    gauge.drawThresholdValues(gaugeOptionsi, layout, cellLayout, i)\n                }\n                // draw value\n                if (gaugeOptionsi.value.show) {\n                    gauge.drawValue(gaugeOptionsi, layout, cellLayout, i, item);\n                }\n            }\n        });\n    }\n\n    /**\n     * [defaults description]\n     *\n     * @property defaults\n     * @type {Object}\n     */\n    var defaults = {\n        series: {\n            gauges: {\n                debug: {\n                    log: false,\n                    layout: false,\n                    alert: false\n                },\n                show: false,\n                layout: {\n                    margin: 5,\n                    columns: 3,\n                    hMargin: 5,\n                    vMargin: 5,\n                    square: false\n                },\n                frame: {\n                    show: true\n                },\n                cell: {\n                    background: {\n                        color: null\n                    },\n                    border: {\n                        show: true,\n                        color: \"black\",\n                        width: 1\n                    },\n                    margin: 5,\n                    vAlign: \"middle\" // 'top' or 'middle' or 'bottom'\n                },\n                gauge: {\n                    width: \"auto\", // a specified number, or 'auto'\n                    startAngle: 0.9, // 0 - 2 factor of the radians\n                    endAngle: 2.1, // 0 - 2 factor of the radians\n                    min: 0,\n                    max: 100,\n                    background: {\n                        color: \"white\"\n                    },\n                    border: {\n                        color: \"lightgray\",\n                        width: 2\n                    },\n                    shadow: {\n                        show: true,\n                        blur: 5\n                    }\n                },\n                label: {\n                    show: true,\n                    margin: \"auto\", // a specified number, or 'auto'\n                    background: {\n                        color: null,\n                        opacity: 0\n                    },\n                    font: {\n                        size: \"auto\", // a specified number, or 'auto'\n                        family: \"sans-serif\"\n                    },\n                    color: null,\n                    formatter: function(label, value) {\n                        return label;\n                    }\n                },\n                value: {\n                    show: true,\n                    margin: \"auto\", // a specified number, or 'auto'\n                    background: {\n                        color: null,\n                        opacity: 0\n                    },\n                    font: {\n                        size: \"auto\", // a specified number, or 'auto'\n                        family: \"sans-serif\"\n                    },\n                    color: null,\n                    formatter: function(label, value) {\n                        return parseInt(value);\n                    }\n                },\n                threshold: {\n                    show: true,\n                    width: \"auto\", // a specified number, or 'auto'\n                    label: {\n                        show: true,\n                        margin: \"auto\", // a specified number, or 'auto'\n                        background: {\n                            color: null,\n                            opacity: 0\n                        },\n                        font: {\n                            size: \"auto\", // a specified number, or 'auto'\n                            family: \",sans-serif\"\n                        },\n                        color: null,\n                        formatter: function(value) {\n                            return value;\n                        }\n                    },\n                    values: [\n                        {\n                            value: 50,\n                            color: \"lightgreen\"\n                        }, {\n                            value: 80,\n                            color: \"yellow\"\n                        }, {\n                            value: 100,\n                            color: \"red\"\n                        }\n                    ]\n                }\n            }\n        }\n    };\n\n    // register the gauge plugin\n    $.plot.plugins.push({\n        init: init,\n        options: defaults,\n        name: \"gauge\",\n        version: \"1.1.0\"\n    });\n\n})(jQuery);\n","// jshint ignore: start\n// jscs: disable\nace.define(\"ace/mode/prometheus_highlight_rules\",[\"require\",\"exports\",\"module\",\"ace/lib/oop\",\"ace/mode/text_highlight_rules\"], function(require, exports, module) {\n\"use strict\";\n\nvar oop = require(\"../lib/oop\");\nvar TextHighlightRules = require(\"./text_highlight_rules\").TextHighlightRules;\n\nvar PrometheusHighlightRules = function() {\n  var keywords = (\n    \"count|count_values|min|max|avg|sum|stddev|stdvar|bottomk|topk|quantile\"\n  );\n\n  var builtinConstants = (\n    \"true|false|null|__name__|job\"\n  );\n\n  var builtinFunctions = (\n    \"abs|absent|ceil|changes|clamp_max|clamp_min|count_scalar|day_of_month|day_of_week|days_in_month|delta|deriv|\" + \"drop_common_labels|exp|floor|histogram_quantile|holt_winters|hour|idelta|increase|irate|label_replace|ln|log2|\" +\n    \"log10|minute|month|predict_linear|rate|resets|round|scalar|sort|sort_desc|sqrt|time|vector|year|avg_over_time|\" +\n    \"min_over_time|max_over_time|sum_over_time|count_over_time|quantile_over_time|stddev_over_time|stdvar_over_time\"\n  );\n\n  var keywordMapper = this.createKeywordMapper({\n    \"support.function\": builtinFunctions,\n    \"keyword\": keywords,\n    \"constant.language\": builtinConstants\n  }, \"identifier\", true);\n\n  this.$rules = {\n    \"start\" : [ {\n      token : \"string\", // single line\n      regex : /\"(?:[^\"\\\\]|\\\\.)*?\"/\n    }, {\n      token : \"string\", // string\n      regex : \"'.*?'\"\n    }, {\n      token : \"constant.numeric\", // float\n      regex : \"[-]?\\\\d+(?:(?:\\\\.\\\\d*)?(?:[eE][+-]?\\\\d+)?)?\\\\b\"\n    }, {\n      token : \"constant.language\", // time\n      regex : \"\\\\d+[smhdwy]\"\n    }, {\n      token : \"keyword.operator.binary\",\n      regex : \"\\\\+|\\\\-|\\\\*|\\\\/|%|\\\\^|==|!=|<=|>=|<|>|and|or|unless\"\n    }, {\n      token : \"keyword.other\",\n      regex : \"keep_common|offset|bool\"\n    }, {\n      token : \"keyword.control\",\n      regex : \"by|without|on|ignoring|group_left|group_right\",\n      next  : \"start-label-list-matcher\"\n    }, {\n      token : \"variable\",\n      regex : \"\\\\$[A-Za-z0-9_]+\"\n    }, {\n      token : keywordMapper,\n      regex : \"[a-zA-Z_:][a-zA-Z0-9_:]*\"\n    }, {\n      token : \"paren.lparen\",\n      regex : \"[[(]\"\n    }, {\n      token : \"paren.lparen.label-matcher\",\n      regex : \"{\",\n      next  : \"start-label-matcher\"\n    }, {\n      token : \"paren.rparen\",\n      regex : \"[\\\\])]\"\n    }, {\n      token : \"paren.rparen.label-matcher\",\n      regex : \"}\"\n    }, {\n      token : \"text\",\n      regex : \"\\\\s+\"\n    } ],\n    \"start-label-matcher\" : [ {\n      token : \"entity.name.tag.label-matcher\",\n      regex : '[a-zA-Z_][a-zA-Z0-9_]*'\n    }, {\n      token : \"keyword.operator.label-matcher\",\n      regex : '=~|=|!~|!='\n    }, {\n      token : \"string.quoted.label-matcher\",\n      regex : '\"[^\"]*\"|\\'[^\\']*\\''\n    }, {\n      token : \"punctuation.operator.label-matcher\",\n      regex : \",\"\n    }, {\n      token : \"paren.rparen.label-matcher\",\n      regex : \"}\",\n      next  : \"start\"\n    } ],\n    \"start-label-list-matcher\" : [ {\n      token : \"paren.lparen.label-list-matcher\",\n      regex : \"[(]\"\n    }, {\n      token : \"entity.name.tag.label-list-matcher\",\n      regex : '[a-zA-Z_][a-zA-Z0-9_]*'\n    }, {\n      token : \"punctuation.operator.label-list-matcher\",\n      regex : \",\"\n    }, {\n      token : \"paren.rparen.label-list-matcher\",\n      regex : \"[)]\",\n      next  : \"start\"\n    } ]\n  };\n\n  this.normalizeRules();\n};\n\noop.inherits(PrometheusHighlightRules, TextHighlightRules);\n\nexports.PrometheusHighlightRules = PrometheusHighlightRules;\n});\n\nace.define(\"ace/mode/prometheus_completions\",[\"require\",\"exports\",\"module\",\"ace/token_iterator\", \"ace/lib/lang\"], function(require, exports, module) {\n\"use strict\";\n\nvar lang = require(\"../lib/lang\");\n\nvar prometheusKeyWords = [\n  \"by\", \"without\", \"keep_common\", \"offset\", \"bool\", \"and\", \"or\", \"unless\", \"ignoring\", \"on\", \"group_left\",\n  \"group_right\", \"count\", \"count_values\", \"min\", \"max\", \"avg\", \"sum\", \"stddev\", \"stdvar\", \"bottomk\", \"topk\", \"quantile\"\n];\n\nvar keyWordsCompletions = prometheusKeyWords.map(function(word) {\n  return {\n    caption: word,\n    value: word,\n    meta: \"keyword\",\n    score: Number.MAX_VALUE\n  }\n});\n\nvar prometheusFunctions = [\n  {\n    name: 'abs()', value: 'abs',\n    def: 'abs(v instant-vector)',\n    docText: 'Returns the input vector with all sample values converted to their absolute value.'\n  },\n  {\n    name: 'absent()', value: 'absent',\n    def: 'absent(v instant-vector)',\n    docText: 'Returns an empty vector if the vector passed to it has any elements and a 1-element vector with the value 1 if the vector passed to it has no elements. This is useful for alerting on when no time series exist for a given metric name and label combination.'\n  },\n  {\n    name: 'ceil()', value: 'ceil',\n    def: 'ceil(v instant-vector)',\n    docText: 'Rounds the sample values of all elements in `v` up to the nearest integer.'\n  },\n  {\n    name: 'changes()', value: 'changes',\n    def: 'changes(v range-vector)',\n    docText: 'For each input time series, `changes(v range-vector)` returns the number of times its value has changed within the provided time range as an instant vector.'\n  },\n  {\n    name: 'clamp_max()', value: 'clamp_max',\n    def: 'clamp_max(v instant-vector, max scalar)',\n    docText: 'Clamps the sample values of all elements in `v` to have an upper limit of `max`.'\n  },\n  {\n    name: 'clamp_min()', value: 'clamp_min',\n    def: 'clamp_min(v instant-vector, min scalar)',\n    docText: 'Clamps the sample values of all elements in `v` to have a lower limit of `min`.'\n  },\n  {\n    name: 'count_scalar()', value: 'count_scalar',\n    def: 'count_scalar(v instant-vector)',\n    docText: 'Returns the number of elements in a time series vector as a scalar. This is in contrast to the `count()` aggregation operator, which always returns a vector (an empty one if the input vector is empty) and allows grouping by labels via a `by` clause.'\n  },\n  {\n    name: 'day_of_month()', value: 'day_of_month',\n    def: 'day_of_month(v=vector(time()) instant-vector)',\n    docText: 'Returns the day of the month for each of the given times in UTC. Returned values are from 1 to 31.'\n  },\n  {\n    name: 'day_of_week()', value: 'day_of_week',\n    def: 'day_of_week(v=vector(time()) instant-vector)',\n    docText: 'Returns the day of the week for each of the given times in UTC. Returned values are from 0 to 6, where 0 means Sunday etc.'\n  },\n  {\n    name: 'days_in_month()', value: 'days_in_month',\n    def: 'days_in_month(v=vector(time()) instant-vector)',\n    docText: 'Returns number of days in the month for each of the given times in UTC. Returned values are from 28 to 31.'\n  },\n  {\n    name: 'delta()', value: 'delta',\n    def: 'delta(v range-vector)',\n    docText: 'Calculates the difference between the first and last value of each time series element in a range vector `v`, returning an instant vector with the given deltas and equivalent labels. The delta is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if the sample values are all integers.'\n  },\n  {\n    name: 'deriv()', value: 'deriv',\n    def: 'deriv(v range-vector)',\n    docText: 'Calculates the per-second derivative of the time series in a range vector `v`, using simple linear regression.'\n  },\n  {\n    name: 'drop_common_labels()', value: 'drop_common_labels',\n    def: 'drop_common_labels(instant-vector)',\n    docText: 'Drops all labels that have the same name and value across all series in the input vector.'\n  },\n  {\n    name: 'exp()', value: 'exp',\n    def: 'exp(v instant-vector)',\n    docText: 'Calculates the exponential function for all elements in `v`.\\nSpecial cases are:\\n* `Exp(+Inf) = +Inf` \\n* `Exp(NaN) = NaN`'\n  },\n  {\n    name: 'floor()', value: 'floor',\n    def: 'floor(v instant-vector)',\n    docText: 'Rounds the sample values of all elements in `v` down to the nearest integer.'\n  },\n  {\n    name: 'histogram_quantile()', value: 'histogram_quantile',\n    def: 'histogram_quantile(φ float, b instant-vector)',\n    docText: 'Calculates the φ-quantile (0 ≤ φ ≤ 1) from the buckets `b` of a histogram. The samples in `b` are the counts of observations in each bucket. Each sample must have a label `le` where the label value denotes the inclusive upper bound of the bucket. (Samples without such a label are silently ignored.) The histogram metric type automatically provides time series with the `_bucket` suffix and the appropriate labels.'\n  },\n  {\n    name: 'holt_winters()', value: 'holt_winters',\n    def: 'holt_winters(v range-vector, sf scalar, tf scalar)',\n    docText: 'Produces a smoothed value for time series based on the range in `v`. The lower the smoothing factor `sf`, the more importance is given to old data. The higher the trend factor `tf`, the more trends in the data is considered. Both `sf` and `tf` must be between 0 and 1.'\n  },\n  {\n    name: 'hour()', value: 'hour',\n    def: 'hour(v=vector(time()) instant-vector)',\n    docText: 'Returns the hour of the day for each of the given times in UTC. Returned values are from 0 to 23.'\n  },\n  {\n    name: 'idelta()', value: 'idelta',\n    def: 'idelta(v range-vector)',\n    docText: 'Calculates the difference between the last two samples in the range vector `v`, returning an instant vector with the given deltas and equivalent labels.'\n  },\n  {\n    name: 'increase()', value: 'increase',\n    def: 'increase(v range-vector)',\n    docText: 'Calculates the increase in the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. The increase is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if a counter increases only by integer increments.'\n  },\n  {\n    name: 'irate()', value: 'irate',\n    def: 'irate(v range-vector)',\n    docText: 'Calculates the per-second instant rate of increase of the time series in the range vector. This is based on the last two data points. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for.'\n  },\n  {\n    name: 'label_replace()', value: 'label_replace',\n    def: 'label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)',\n    docText: 'For each timeseries in `v`, `label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)`  matches the regular expression `regex` against the label `src_label`.  If it matches, then the timeseries is returned with the label `dst_label` replaced by the expansion of `replacement`. `$1` is replaced with the first matching subgroup, `$2` with the second etc. If the regular expression doesn\\'t match then the timeseries is returned unchanged.'\n  },\n  {\n    name: 'ln()', value: 'ln',\n    def: 'ln(v instant-vector)',\n    docText: 'calculates the natural logarithm for all elements in `v`.\\nSpecial cases are:\\n * `ln(+Inf) = +Inf`\\n * `ln(0) = -Inf`\\n * `ln(x < 0) = NaN`\\n * `ln(NaN) = NaN`'\n  },\n  {\n    name: 'log2()', value: 'log2',\n    def: 'log2(v instant-vector)',\n    docText: 'Calculates the binary logarithm for all elements in `v`. The special cases are equivalent to those in `ln`.'\n  },\n  {\n    name: 'log10()', value: 'log10',\n    def: 'log10(v instant-vector)',\n    docText: 'Calculates the decimal logarithm for all elements in `v`. The special cases are equivalent to those in `ln`.'\n  },\n  {\n    name: 'minute()', value: 'minute',\n    def: 'minute(v=vector(time()) instant-vector)',\n    docText: 'Returns the minute of the hour for each of the given times in UTC. Returned values are from 0 to 59.'\n  },\n  {\n    name: 'month()', value: 'month',\n    def: 'month(v=vector(time()) instant-vector)',\n    docText: 'Returns the month of the year for each of the given times in UTC. Returned values are from 1 to 12, where 1 means January etc.'\n  },\n  {\n    name: 'predict_linear()', value: 'predict_linear',\n    def: 'predict_linear(v range-vector, t scalar)',\n    docText: 'Predicts the value of time series `t` seconds from now, based on the range vector `v`, using simple linear regression.'\n  },\n  {\n    name: 'rate()', value: 'rate',\n    def: 'rate(v range-vector)',\n    docText: \"Calculates the per-second average rate of increase of the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. Also, the calculation extrapolates to the ends of the time range, allowing for missed scrapes or imperfect alignment of scrape cycles with the range's time period.\"\n  },\n  {\n    name: 'resets()', value: 'resets',\n    def: 'resets(v range-vector)',\n    docText: 'For each input time series, `resets(v range-vector)` returns the number of counter resets within the provided time range as an instant vector. Any decrease in the value between two consecutive samples is interpreted as a counter reset.'\n  },\n  {\n    name: 'round()', value: 'round',\n    def: 'round(v instant-vector, to_nearest=1 scalar)',\n    docText: 'Rounds the sample values of all elements in `v` to the nearest integer. Ties are resolved by rounding up. The optional `to_nearest` argument allows specifying the nearest multiple to which the sample values should be rounded. This multiple may also be a fraction.'\n  },\n  {\n    name: 'scalar()', value: 'scalar',\n    def: 'scalar(v instant-vector)',\n    docText: 'Given a single-element input vector, `scalar(v instant-vector)` returns the sample value of that single element as a scalar. If the input vector does not have exactly one element, `scalar` will return `NaN`.'\n  },\n  {\n    name: 'sort()', value: 'sort',\n    def: 'sort(v instant-vector)',\n    docText: 'Returns vector elements sorted by their sample values, in ascending order.'\n  },\n  {\n    name: 'sort_desc()', value: 'sort_desc',\n    def: 'sort_desc(v instant-vector)',\n    docText: 'Returns vector elements sorted by their sample values, in descending order.'\n  },\n  {\n    name: 'sqrt()', value: 'sqrt',\n    def: 'sqrt(v instant-vector)',\n    docText: 'Calculates the square root of all elements in `v`.'\n  },\n  {\n    name: 'time()', value: 'time',\n    def: 'time()',\n    docText: 'Returns the number of seconds since January 1, 1970 UTC. Note that this does not actually return the current time, but the time at which the expression is to be evaluated.'\n  },\n  {\n    name: 'vector()', value: 'vector',\n    def: 'vector(s scalar)',\n    docText: 'Returns the scalar `s` as a vector with no labels.'\n  },\n  {\n    name: 'year()', value: 'year',\n    def: 'year(v=vector(time()) instant-vector)',\n    docText: 'Returns the year for each of the given times in UTC.'\n  },\n  {\n    name: 'avg_over_time()', value: 'avg_over_time',\n    def: 'avg_over_time(range-vector)',\n    docText: 'The average value of all points in the specified interval.'\n  },\n  {\n    name: 'min_over_time()', value: 'min_over_time',\n    def: 'min_over_time(range-vector)',\n    docText: 'The minimum value of all points in the specified interval.'\n  },\n  {\n    name: 'max_over_time()', value: 'max_over_time',\n    def: 'max_over_time(range-vector)',\n    docText: 'The maximum value of all points in the specified interval.'\n  },\n  {\n    name: 'sum_over_time()', value: 'sum_over_time',\n    def: 'sum_over_time(range-vector)',\n    docText: 'The sum of all values in the specified interval.'\n  },\n  {\n    name: 'count_over_time()', value: 'count_over_time',\n    def: 'count_over_time(range-vector)',\n    docText: 'The count of all values in the specified interval.'\n  },\n  {\n    name: 'quantile_over_time()', value: 'quantile_over_time',\n    def: 'quantile_over_time(scalar, range-vector)',\n    docText: 'The φ-quantile (0 ≤ φ ≤ 1) of the values in the specified interval.'\n  },\n  {\n    name: 'stddev_over_time()', value: 'stddev_over_time',\n    def: 'stddev_over_time(range-vector)',\n    docText: 'The population standard deviation of the values in the specified interval.'\n  },\n  {\n    name: 'stdvar_over_time()', value: 'stdvar_over_time',\n    def: 'stdvar_over_time(range-vector)',\n    docText: 'The population standard variance of the values in the specified interval.'\n  },\n];\n\nfunction wrapText(str, len) {\n  len = len || 60;\n  var lines = [];\n  var space_index = 0;\n  var line_start = 0;\n  var next_line_end = len;\n  var line = \"\";\n  for (var i = 0; i < str.length; i++) {\n    if (str[i] === ' ') {\n      space_index = i;\n    } else if (i >= next_line_end  && space_index != 0) {\n      line = str.slice(line_start, space_index);\n      lines.push(line);\n      line_start = space_index + 1;\n      next_line_end = i + len;\n      space_index = 0;\n    }\n  }\n  line = str.slice(line_start);\n  lines.push(line);\n  return lines.join(\"&nbsp<br>\");\n}\n\nfunction convertMarkDownTags(text) {\n  text = text.replace(/```(.+)```/, \"<pre>$1</pre>\");\n  text = text.replace(/`([^`]+)`/, \"<code>$1</code>\");\n  return text;\n}\n\nfunction convertToHTML(item) {\n  var docText = lang.escapeHTML(item.docText);\n  docText = convertMarkDownTags(wrapText(docText, 40));\n  return [\n    \"<b>\", lang.escapeHTML(item.def), \"</b>\", \"<hr></hr>\", docText, \"<br>&nbsp\"\n  ].join(\"\");\n}\n\nvar functionsCompletions = prometheusFunctions.map(function(item) {\n  return {\n    caption: item.name,\n    value: item.value,\n    docHTML: convertToHTML(item),\n    meta: \"function\",\n    score: Number.MAX_VALUE\n  };\n});\n\nvar PrometheusCompletions = function() {};\n\n(function() {\n  this.getCompletions = function(state, session, pos, prefix, callback) {\n    var token = session.getTokenAt(pos.row, pos.column);\n    if (token.type === 'entity.name.tag.label-matcher'\n      || token.type === 'string.quoted.label-matcher'\n      || token.type === 'entity.name.tag.label-list-matcher') {\n      return callback(null, []);\n    }\n\n    var completions = keyWordsCompletions.concat(functionsCompletions);\n    callback(null, completions);\n  };\n\n}).call(PrometheusCompletions.prototype);\n\nexports.PrometheusCompletions = PrometheusCompletions;\n});\n\nace.define(\"ace/mode/behaviour/prometheus\",[\"require\",\"exports\",\"module\",\"ace/lib/oop\",\"ace/mode/behaviour\",\"ace/mode/behaviour/cstyle\",\"ace/token_iterator\"], function(require, exports, module) {\n\"use strict\";\n\nvar oop = require(\"../../lib/oop\");\nvar Behaviour = require(\"../behaviour\").Behaviour;\nvar CstyleBehaviour = require(\"./cstyle\").CstyleBehaviour;\nvar TokenIterator = require(\"../../token_iterator\").TokenIterator;\n\nfunction getWrapped(selection, selected, opening, closing) {\n  var rowDiff = selection.end.row - selection.start.row;\n  return {\n    text: opening + selected + closing,\n    selection: [\n      0,\n      selection.start.column + 1,\n      rowDiff,\n      selection.end.column + (rowDiff ? 0 : 1)\n    ]\n  };\n};\n\nvar PrometheusBehaviour = function () {\n  this.inherit(CstyleBehaviour);\n\n  // Rewrite default CstyleBehaviour for {} braces\n  this.add(\"braces\", \"insertion\", function(state, action, editor, session, text) {\n    if (text == '{') {\n      var selection = editor.getSelectionRange();\n      var selected = session.doc.getTextRange(selection);\n      if (selected !== \"\" && editor.getWrapBehavioursEnabled()) {\n        return getWrapped(selection, selected, '{', '}');\n      } else if (CstyleBehaviour.isSaneInsertion(editor, session)) {\n        return {\n          text: '{}',\n          selection: [1, 1]\n        };\n      }\n    } else if (text == '}') {\n      var cursor = editor.getCursorPosition();\n      var line = session.doc.getLine(cursor.row);\n      var rightChar = line.substring(cursor.column, cursor.column + 1);\n      if (rightChar == '}') {\n        var matching = session.$findOpeningBracket('}', {column: cursor.column + 1, row: cursor.row});\n        if (matching !== null && CstyleBehaviour.isAutoInsertedClosing(cursor, line, text)) {\n          return {\n            text: '',\n            selection: [1, 1]\n          };\n        }\n      }\n    }\n  });\n\n  this.add(\"braces\", \"deletion\", function(state, action, editor, session, range) {\n    var selected = session.doc.getTextRange(range);\n    if (!range.isMultiLine() && selected == '{') {\n      var line = session.doc.getLine(range.start.row);\n      var rightChar = line.substring(range.start.column + 1, range.start.column + 2);\n      if (rightChar == '}') {\n        range.end.column++;\n        return range;\n      }\n    }\n  });\n\n}\noop.inherits(PrometheusBehaviour, CstyleBehaviour);\n\nexports.PrometheusBehaviour = PrometheusBehaviour;\n});\n\nace.define(\"ace/mode/prometheus\",[\"require\",\"exports\",\"module\",\"ace/lib/oop\",\"ace/mode/text\",\"ace/mode/prometheus_highlight_rules\"], function(require, exports, module) {\n\"use strict\";\n\nvar oop = require(\"../lib/oop\");\nvar TextMode = require(\"./text\").Mode;\nvar PrometheusHighlightRules = require(\"./prometheus_highlight_rules\").PrometheusHighlightRules;\nvar PrometheusCompletions = require(\"./prometheus_completions\").PrometheusCompletions;\nvar PrometheusBehaviour = require(\"./behaviour/prometheus\").PrometheusBehaviour;\n\nvar Mode = function() {\n  this.HighlightRules = PrometheusHighlightRules;\n  this.$behaviour = new PrometheusBehaviour();\n  this.$completer = new PrometheusCompletions();\n  // replace keyWordCompleter\n  this.completer = this.$completer;\n};\noop.inherits(Mode, TextMode);\n\n(function() {\n\n  this.$id = \"ace/mode/prometheus\";\n}).call(Mode.prototype);\n\nexports.Mode = Mode;\n\n});\n","// jshint ignore: start\n// jscs: disable\nace.define(\"ace/snippets/prometheus\",[\"require\",\"exports\",\"module\"], function(require, exports, module) {\n\"use strict\";\n\n// exports.snippetText = \"# rate\\n\\\n// snippet r\\n\\\n//   rate(${1:metric}[${2:range}])\\n\\\n// \";\n\nexports.snippets = [\n  {\n    \"content\": \"rate(${1:metric}[${2:range}])\",\n    \"name\": \"rate()\",\n    \"scope\": \"prometheus\",\n    \"tabTrigger\": \"r\"\n  }\n];\n\nexports.scope = \"prometheus\";\n});\n","/* Flot plugin for rendering pie charts.\n\nCopyright (c) 2007-2013 IOLA and Ole Laursen.\nLicensed under the MIT license.\n\nThe plugin assumes that each series has a single data value, and that each\nvalue is a positive integer or zero.  Negative numbers don't make sense for a\npie chart, and have unpredictable results.  The values do NOT need to be\npassed in as percentages; the plugin will calculate the total and per-slice\npercentages internally.\n\n* Created by Brian Medendorp\n\n* Updated with contributions from btburnett3, Anthony Aragues and Xavi Ivars\n\nThe plugin supports these options:\n\n\tseries: {\n\t\tpie: {\n\t\t\tshow: true/false\n\t\t\tradius: 0-1 for percentage of fullsize, or a specified pixel length, or 'auto'\n\t\t\tinnerRadius: 0-1 for percentage of fullsize or a specified pixel length, for creating a donut effect\n\t\t\tstartAngle: 0-2 factor of PI used for starting angle (in radians) i.e 3/2 starts at the top, 0 and 2 have the same result\n\t\t\ttilt: 0-1 for percentage to tilt the pie, where 1 is no tilt, and 0 is completely flat (nothing will show)\n\t\t\toffset: {\n\t\t\t\ttop: integer value to move the pie up or down\n\t\t\t\tleft: integer value to move the pie left or right, or 'auto'\n\t\t\t},\n\t\t\tstroke: {\n\t\t\t\tcolor: any hexidecimal color value (other formats may or may not work, so best to stick with something like '#FFF')\n\t\t\t\twidth: integer pixel width of the stroke\n\t\t\t},\n\t\t\tlabel: {\n\t\t\t\tshow: true/false, or 'auto'\n\t\t\t\tformatter:  a user-defined function that modifies the text/style of the label text\n\t\t\t\tradius: 0-1 for percentage of fullsize, or a specified pixel length\n\t\t\t\tbackground: {\n\t\t\t\t\tcolor: any hexidecimal color value (other formats may or may not work, so best to stick with something like '#000')\n\t\t\t\t\topacity: 0-1\n\t\t\t\t},\n\t\t\t\tthreshold: 0-1 for the percentage value at which to hide labels (if they're too small)\n\t\t\t},\n\t\t\tcombine: {\n\t\t\t\tthreshold: 0-1 for the percentage value at which to combine slices (if they're too small)\n\t\t\t\tcolor: any hexidecimal color value (other formats may or may not work, so best to stick with something like '#CCC'), if null, the plugin will automatically use the color of the first slice to be combined\n\t\t\t\tlabel: any text value of what the combined slice should be labeled\n\t\t\t}\n\t\t\thighlight: {\n\t\t\t\topacity: 0-1\n\t\t\t}\n\t\t}\n\t}\n\nMore detail and specific examples can be found in the included HTML file.\n\n*/\n\n(function($) {\n\n\t// Maximum redraw attempts when fitting labels within the plot\n\n\tvar REDRAW_ATTEMPTS = 10;\n\n\t// Factor by which to shrink the pie when fitting labels within the plot\n\n\tvar REDRAW_SHRINK = 0.95;\n\n\tfunction init(plot) {\n\n\t\tvar canvas = null,\n\t\t\ttarget = null,\n\t\t\tmaxRadius = null,\n\t\t\tcenterLeft = null,\n\t\t\tcenterTop = null,\n\t\t\tprocessed = false,\n\t\t\tctx = null;\n\n\t\t// interactive variables\n\n\t\tvar highlights = [];\n\n\t\t// add hook to determine if pie plugin in enabled, and then perform necessary operations\n\n\t\tplot.hooks.processOptions.push(function(plot, options) {\n\t\t\tif (options.series.pie.show) {\n\n\t\t\t\toptions.grid.show = false;\n\n\t\t\t\t// set labels.show\n\n\t\t\t\tif (options.series.pie.label.show == \"auto\") {\n\t\t\t\t\tif (options.legend.show) {\n\t\t\t\t\t\toptions.series.pie.label.show = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\toptions.series.pie.label.show = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// set radius\n\n\t\t\t\tif (options.series.pie.radius == \"auto\") {\n\t\t\t\t\tif (options.series.pie.label.show) {\n\t\t\t\t\t\toptions.series.pie.radius = 3/4;\n\t\t\t\t\t} else {\n\t\t\t\t\t\toptions.series.pie.radius = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// ensure sane tilt\n\n\t\t\t\tif (options.series.pie.tilt > 1) {\n\t\t\t\t\toptions.series.pie.tilt = 1;\n\t\t\t\t} else if (options.series.pie.tilt < 0) {\n\t\t\t\t\toptions.series.pie.tilt = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tplot.hooks.bindEvents.push(function(plot, eventHolder) {\n\t\t\tvar options = plot.getOptions();\n\t\t\tif (options.series.pie.show) {\n\t\t\t\tif (options.grid.hoverable) {\n\t\t\t\t\teventHolder.unbind(\"mousemove\").mousemove(onMouseMove);\n\t\t\t\t}\n\t\t\t\tif (options.grid.clickable) {\n\t\t\t\t\teventHolder.unbind(\"click\").click(onClick);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tplot.hooks.processDatapoints.push(function(plot, series, data, datapoints) {\n\t\t\tvar options = plot.getOptions();\n\t\t\tif (options.series.pie.show) {\n\t\t\t\tprocessDatapoints(plot, series, data, datapoints);\n\t\t\t}\n\t\t});\n\n\t\tplot.hooks.drawOverlay.push(function(plot, octx) {\n\t\t\tvar options = plot.getOptions();\n\t\t\tif (options.series.pie.show) {\n\t\t\t\tdrawOverlay(plot, octx);\n\t\t\t}\n\t\t});\n\n\t\tplot.hooks.draw.push(function(plot, newCtx) {\n\t\t\tvar options = plot.getOptions();\n\t\t\tif (options.series.pie.show) {\n\t\t\t\tdraw(plot, newCtx);\n\t\t\t}\n\t\t});\n\n\t\tfunction processDatapoints(plot, series, datapoints) {\n\t\t\tif (!processed)\t{\n\t\t\t\tprocessed = true;\n\t\t\t\tcanvas = plot.getCanvas();\n\t\t\t\ttarget = $(canvas).parent();\n\t\t\t\toptions = plot.getOptions();\n\t\t\t\tplot.setData(combine(plot.getData()));\n\t\t\t}\n\t\t}\n\n\t\tfunction combine(data) {\n\n\t\t\tvar total = 0,\n\t\t\t\tcombined = 0,\n\t\t\t\tnumCombined = 0,\n\t\t\t\tcolor = options.series.pie.combine.color,\n\t\t\t\tnewdata = [];\n\n\t\t\t// Fix up the raw data from Flot, ensuring the data is numeric\n\n\t\t\tfor (var i = 0; i < data.length; ++i) {\n\n\t\t\t\tvar value = data[i].data;\n\n\t\t\t\t// If the data is an array, we'll assume that it's a standard\n\t\t\t\t// Flot x-y pair, and are concerned only with the second value.\n\n\t\t\t\t// Note how we use the original array, rather than creating a\n\t\t\t\t// new one; this is more efficient and preserves any extra data\n\t\t\t\t// that the user may have stored in higher indexes.\n\n\t\t\t\tif ($.isArray(value) && value.length == 1) {\n    \t\t\t\tvalue = value[0];\n\t\t\t\t}\n\n\t\t\t\tif ($.isArray(value)) {\n\t\t\t\t\t// Equivalent to $.isNumeric() but compatible with jQuery < 1.7\n\t\t\t\t\tif (!isNaN(parseFloat(value[1])) && isFinite(value[1])) {\n\t\t\t\t\t\tvalue[1] = +value[1];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalue[1] = 0;\n\t\t\t\t\t}\n\t\t\t\t} else if (!isNaN(parseFloat(value)) && isFinite(value)) {\n\t\t\t\t\tvalue = [1, +value];\n\t\t\t\t} else {\n\t\t\t\t\tvalue = [1, 0];\n\t\t\t\t}\n\n\t\t\t\tdata[i].data = [value];\n\t\t\t}\n\n\t\t\t// Sum up all the slices, so we can calculate percentages for each\n\n\t\t\tfor (var i = 0; i < data.length; ++i) {\n\t\t\t\ttotal += data[i].data[0][1];\n\t\t\t}\n\n\t\t\t// Count the number of slices with percentages below the combine\n\t\t\t// threshold; if it turns out to be just one, we won't combine.\n\n\t\t\tfor (var i = 0; i < data.length; ++i) {\n\t\t\t\tvar value = data[i].data[0][1];\n\t\t\t\tif (value / total <= options.series.pie.combine.threshold) {\n\t\t\t\t\tcombined += value;\n\t\t\t\t\tnumCombined++;\n\t\t\t\t\tif (!color) {\n\t\t\t\t\t\tcolor = data[i].color;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (var i = 0; i < data.length; ++i) {\n\t\t\t\tvar value = data[i].data[0][1];\n\t\t\t\tif (numCombined < 2 || value / total > options.series.pie.combine.threshold) {\n\t\t\t\t\tnewdata.push({\n\t\t\t\t\t\tdata: [[1, value]],\n\t\t\t\t\t\tcolor: data[i].color,\n\t\t\t\t\t\tlabel: data[i].label,\n\t\t\t\t\t\tangle: value * Math.PI * 2 / total,\n\t\t\t\t\t\tpercent: value / (total / 100)\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (numCombined > 1) {\n\t\t\t\tnewdata.push({\n\t\t\t\t\tdata: [[1, combined]],\n\t\t\t\t\tcolor: color,\n\t\t\t\t\tlabel: options.series.pie.combine.label,\n\t\t\t\t\tangle: combined * Math.PI * 2 / total,\n\t\t\t\t\tpercent: combined / (total / 100)\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn newdata;\n\t\t}\n\n\t\tfunction draw(plot, newCtx) {\n\n\t\t\tif (!target) {\n\t\t\t\treturn; // if no series were passed\n\t\t\t}\n\n\t\t\tvar canvasWidth = plot.getPlaceholder().width(),\n\t\t\t\tcanvasHeight = plot.getPlaceholder().height(),\n\t\t\t\tlegendWidth = target.children().filter(\".legend\").children().width() || 0;\n\n\t\t\tctx = newCtx;\n\n\t\t\t// WARNING: HACK! REWRITE THIS CODE AS SOON AS POSSIBLE!\n\n\t\t\t// When combining smaller slices into an 'other' slice, we need to\n\t\t\t// add a new series.  Since Flot gives plugins no way to modify the\n\t\t\t// list of series, the pie plugin uses a hack where the first call\n\t\t\t// to processDatapoints results in a call to setData with the new\n\t\t\t// list of series, then subsequent processDatapoints do nothing.\n\n\t\t\t// The plugin-global 'processed' flag is used to control this hack;\n\t\t\t// it starts out false, and is set to true after the first call to\n\t\t\t// processDatapoints.\n\n\t\t\t// Unfortunately this turns future setData calls into no-ops; they\n\t\t\t// call processDatapoints, the flag is true, and nothing happens.\n\n\t\t\t// To fix this we'll set the flag back to false here in draw, when\n\t\t\t// all series have been processed, so the next sequence of calls to\n\t\t\t// processDatapoints once again starts out with a slice-combine.\n\t\t\t// This is really a hack; in 0.9 we need to give plugins a proper\n\t\t\t// way to modify series before any processing begins.\n\n\t\t\tprocessed = false;\n\n\t\t\t// calculate maximum radius and center point\n\n\t\t\tmaxRadius =  Math.min(canvasWidth, canvasHeight / options.series.pie.tilt) / 2;\n\t\t\tcenterTop = canvasHeight / 2 + options.series.pie.offset.top;\n\t\t\tcenterLeft = canvasWidth / 2;\n\n\t\t\tif (options.series.pie.offset.left == \"auto\") {\n\t\t\t\tif (options.legend.position.match(\"w\")) {\n\t\t\t\t\tcenterLeft += legendWidth / 2;\n\t\t\t\t} else {\n\t\t\t\t\tcenterLeft -= legendWidth / 2;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcenterLeft += options.series.pie.offset.left;\n\t\t\t}\n\n\t\t\tif (centerLeft < maxRadius) {\n\t\t\t\tcenterLeft = maxRadius;\n\t\t\t} else if (centerLeft > canvasWidth - maxRadius) {\n\t\t\t\tcenterLeft = canvasWidth - maxRadius;\n\t\t\t}\n\n\t\t\tvar slices = plot.getData(),\n\t\t\t\tattempts = 0;\n\n\t\t\t// Keep shrinking the pie's radius until drawPie returns true,\n\t\t\t// indicating that all the labels fit, or we try too many times.\n\n\t\t\tdo {\n\t\t\t\tif (attempts > 0) {\n\t\t\t\t\tmaxRadius *= REDRAW_SHRINK;\n\t\t\t\t}\n\t\t\t\tattempts += 1;\n\t\t\t\tclear();\n\t\t\t\tif (options.series.pie.tilt <= 0.8) {\n\t\t\t\t\tdrawShadow();\n\t\t\t\t}\n\t\t\t} while (!drawPie() && attempts < REDRAW_ATTEMPTS)\n\n\t\t\tif (attempts >= REDRAW_ATTEMPTS) {\n\t\t\t\tclear();\n\t\t\t\ttarget.prepend(\"<div class='error'>Could not draw pie with labels contained inside canvas</div>\");\n\t\t\t}\n\n\t\t\tif (plot.setSeries && plot.insertLegend) {\n\t\t\t\tplot.setSeries(slices);\n\t\t\t\tplot.insertLegend();\n\t\t\t}\n\n\t\t\t// we're actually done at this point, just defining internal functions at this point\n\n\t\t\tfunction clear() {\n\t\t\t\tctx.clearRect(0, 0, canvasWidth, canvasHeight);\n\t\t\t\ttarget.children().filter(\".pieLabel, .pieLabelBackground\").remove();\n\t\t\t}\n\n\t\t\tfunction drawShadow() {\n\n\t\t\t\tvar shadowLeft = options.series.pie.shadow.left;\n\t\t\t\tvar shadowTop = options.series.pie.shadow.top;\n\t\t\t\tvar edge = 10;\n\t\t\t\tvar alpha = options.series.pie.shadow.alpha;\n\t\t\t\tvar radius = options.series.pie.radius > 1 ? options.series.pie.radius : maxRadius * options.series.pie.radius;\n\n\t\t\t\tif (radius >= canvasWidth / 2 - shadowLeft || radius * options.series.pie.tilt >= canvasHeight / 2 - shadowTop || radius <= edge) {\n\t\t\t\t\treturn;\t// shadow would be outside canvas, so don't draw it\n\t\t\t\t}\n\n\t\t\t\tctx.save();\n\t\t\t\tctx.translate(shadowLeft,shadowTop);\n\t\t\t\tctx.globalAlpha = alpha;\n\t\t\t\tctx.fillStyle = \"#000\";\n\n\t\t\t\t// center and rotate to starting position\n\n\t\t\t\tctx.translate(centerLeft,centerTop);\n\t\t\t\tctx.scale(1, options.series.pie.tilt);\n\n\t\t\t\t//radius -= edge;\n\n\t\t\t\tfor (var i = 1; i <= edge; i++) {\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.arc(0, 0, radius, 0, Math.PI * 2, false);\n\t\t\t\t\tctx.fill();\n\t\t\t\t\tradius -= i;\n\t\t\t\t}\n\n\t\t\t\tctx.restore();\n\t\t\t}\n\n\t\t\tfunction drawPie() {\n\n\t\t\t\tvar startAngle = Math.PI * options.series.pie.startAngle;\n\t\t\t\tvar radius = options.series.pie.radius > 1 ? options.series.pie.radius : maxRadius * options.series.pie.radius;\n\n\t\t\t\t// center and rotate to starting position\n\n\t\t\t\tctx.save();\n\t\t\t\tctx.translate(centerLeft,centerTop);\n\t\t\t\tctx.scale(1, options.series.pie.tilt);\n\t\t\t\t//ctx.rotate(startAngle); // start at top; -- This doesn't work properly in Opera\n\n\t\t\t\t// draw slices\n\n\t\t\t\tctx.save();\n\t\t\t\tvar currentAngle = startAngle;\n\t\t\t\tfor (var i = 0; i < slices.length; ++i) {\n\t\t\t\t\tslices[i].startAngle = currentAngle;\n\t\t\t\t\tdrawSlice(slices[i].angle, slices[i].color, true);\n\t\t\t\t}\n\t\t\t\tctx.restore();\n\n\t\t\t\t// draw slice outlines\n\n\t\t\t\tif (options.series.pie.stroke.width > 0) {\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.lineWidth = options.series.pie.stroke.width;\n\t\t\t\t\tcurrentAngle = startAngle;\n\t\t\t\t\tfor (var i = 0; i < slices.length; ++i) {\n\t\t\t\t\t\tdrawSlice(slices[i].angle, options.series.pie.stroke.color, false);\n\t\t\t\t\t}\n\t\t\t\t\tctx.restore();\n\t\t\t\t}\n\n\t\t\t\t// draw donut hole\n\n\t\t\t\tdrawDonutHole(ctx);\n\n\t\t\t\tctx.restore();\n\n\t\t\t\t// Draw the labels, returning true if they fit within the plot\n\n\t\t\t\tif (options.series.pie.label.show) {\n\t\t\t\t\treturn drawLabels();\n\t\t\t\t} else return true;\n\n\t\t\t\tfunction drawSlice(angle, color, fill) {\n\n\t\t\t\t\tif (angle <= 0 || isNaN(angle)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (fill) {\n\t\t\t\t\t\tctx.fillStyle = color;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tctx.strokeStyle = color;\n\t\t\t\t\t\tctx.lineJoin = \"round\";\n\t\t\t\t\t}\n\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tif (Math.abs(angle - Math.PI * 2) > 0.000000001) {\n\t\t\t\t\t\tctx.moveTo(0, 0); // Center of the pie\n\t\t\t\t\t}\n\n\t\t\t\t\t//ctx.arc(0, 0, radius, 0, angle, false); // This doesn't work properly in Opera\n\t\t\t\t\tctx.arc(0, 0, radius,currentAngle, currentAngle + angle / 2, false);\n\t\t\t\t\tctx.arc(0, 0, radius,currentAngle + angle / 2, currentAngle + angle, false);\n\t\t\t\t\tctx.closePath();\n\t\t\t\t\t//ctx.rotate(angle); // This doesn't work properly in Opera\n\t\t\t\t\tcurrentAngle += angle;\n\n\t\t\t\t\tif (fill) {\n\t\t\t\t\t\tctx.fill();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tctx.stroke();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction drawLabels() {\n\n\t\t\t\t\tvar currentAngle = startAngle;\n\t\t\t\t\tvar radius = options.series.pie.label.radius > 1 ? options.series.pie.label.radius : maxRadius * options.series.pie.label.radius;\n\n\t\t\t\t\tfor (var i = 0; i < slices.length; ++i) {\n\t\t\t\t\t\tif (slices[i].percent >= options.series.pie.label.threshold * 100) {\n\t\t\t\t\t\t\tif (!drawLabel(slices[i], currentAngle, i)) {\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurrentAngle += slices[i].angle;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\n\t\t\t\t\tfunction drawLabel(slice, startAngle, index) {\n\n\t\t\t\t\t\tif (slice.data[0][1] == 0) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// format label text\n\n\t\t\t\t\t\tvar lf = options.legend.labelFormatter, text, plf = options.series.pie.label.formatter;\n\n\t\t\t\t\t\tif (lf) {\n\t\t\t\t\t\t\ttext = lf(slice.label, slice);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttext = slice.label;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (plf) {\n\t\t\t\t\t\t\ttext = plf(text, slice);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar halfAngle = ((startAngle + slice.angle) + startAngle) / 2;\n\t\t\t\t\t\tvar x = centerLeft + Math.round(Math.cos(halfAngle) * radius);\n\t\t\t\t\t\tvar y = centerTop + Math.round(Math.sin(halfAngle) * radius) * options.series.pie.tilt;\n\n\t\t\t\t\t\tvar html = \"<span class='pieLabel' id='pieLabel\" + index + \"' style='position:absolute;top:\" + y + \"px;left:\" + x + \"px;'>\" + text + \"</span>\";\n\t\t\t\t\t\ttarget.append(html);\n\n\t\t\t\t\t\tvar label = target.children(\"#pieLabel\" + index);\n\t\t\t\t\t\tvar labelTop = (y - label.height() / 2);\n\t\t\t\t\t\tvar labelLeft = (x - label.width() / 2);\n\n\t\t\t\t\t\tlabel.css(\"top\", labelTop);\n\t\t\t\t\t\tlabel.css(\"left\", labelLeft);\n\n\t\t\t\t\t\t// check to make sure that the label is not outside the canvas\n\n\t\t\t\t\t\tif (0 - labelTop > 0 || 0 - labelLeft > 0 || canvasHeight - (labelTop + label.height()) < 0 || canvasWidth - (labelLeft + label.width()) < 0) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (options.series.pie.label.background.opacity != 0) {\n\n\t\t\t\t\t\t\t// put in the transparent background separately to avoid blended labels and label boxes\n\n\t\t\t\t\t\t\tvar c = options.series.pie.label.background.color;\n\n\t\t\t\t\t\t\tif (c == null) {\n\t\t\t\t\t\t\t\tc = slice.color;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvar pos = \"top:\" + labelTop + \"px;left:\" + labelLeft + \"px;\";\n\t\t\t\t\t\t\t$(\"<div class='pieLabelBackground' style='position:absolute;width:\" + label.width() + \"px;height:\" + label.height() + \"px;\" + pos + \"background-color:\" + c + \";'></div>\")\n\t\t\t\t\t\t\t\t.css(\"opacity\", options.series.pie.label.background.opacity)\n\t\t\t\t\t\t\t\t.insertBefore(label);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} // end individual label function\n\t\t\t\t} // end drawLabels function\n\t\t\t} // end drawPie function\n\t\t} // end draw function\n\n\t\t// Placed here because it needs to be accessed from multiple locations\n\n\t\tfunction drawDonutHole(layer) {\n\t\t\tif (options.series.pie.innerRadius > 0) {\n\n\t\t\t\t// subtract the center\n\n\t\t\t\tlayer.save();\n\t\t\t\tvar innerRadius = options.series.pie.innerRadius > 1 ? options.series.pie.innerRadius : maxRadius * options.series.pie.innerRadius;\n\t\t\t\tlayer.globalCompositeOperation = \"destination-out\"; // this does not work with excanvas, but it will fall back to using the stroke color\n\t\t\t\tlayer.beginPath();\n\t\t\t\tlayer.fillStyle = options.series.pie.stroke.color;\n\t\t\t\tlayer.arc(0, 0, innerRadius, 0, Math.PI * 2, false);\n\t\t\t\tlayer.fill();\n\t\t\t\tlayer.closePath();\n\t\t\t\tlayer.restore();\n\n\t\t\t\t// add inner stroke\n\n\t\t\t\tlayer.save();\n\t\t\t\tlayer.beginPath();\n\t\t\t\tlayer.strokeStyle = options.series.pie.stroke.color;\n\t\t\t\tlayer.arc(0, 0, innerRadius, 0, Math.PI * 2, false);\n\t\t\t\tlayer.stroke();\n\t\t\t\tlayer.closePath();\n\t\t\t\tlayer.restore();\n\n\t\t\t\t// TODO: add extra shadow inside hole (with a mask) if the pie is tilted.\n\t\t\t}\n\t\t}\n\n\t\t//-- Additional Interactive related functions --\n\n\t\tfunction isPointInPoly(poly, pt) {\n\t\t\tfor(var c = false, i = -1, l = poly.length, j = l - 1; ++i < l; j = i)\n\t\t\t\t((poly[i][1] <= pt[1] && pt[1] < poly[j][1]) || (poly[j][1] <= pt[1] && pt[1]< poly[i][1]))\n\t\t\t\t&& (pt[0] < (poly[j][0] - poly[i][0]) * (pt[1] - poly[i][1]) / (poly[j][1] - poly[i][1]) + poly[i][0])\n\t\t\t\t&& (c = !c);\n\t\t\treturn c;\n\t\t}\n\n\t\tfunction findNearbySlice(mouseX, mouseY) {\n\n\t\t\tvar slices = plot.getData(),\n\t\t\t\toptions = plot.getOptions(),\n\t\t\t\tradius = options.series.pie.radius > 1 ? options.series.pie.radius : maxRadius * options.series.pie.radius,\n\t\t\t\tx, y;\n\n\t\t\tfor (var i = 0; i < slices.length; ++i) {\n\n\t\t\t\tvar s = slices[i];\n\n\t\t\t\tif (s.pie.show) {\n\n\t\t\t\t\tctx.save();\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.moveTo(0, 0); // Center of the pie\n\t\t\t\t\t//ctx.scale(1, options.series.pie.tilt);\t// this actually seems to break everything when here.\n\t\t\t\t\tctx.arc(0, 0, radius, s.startAngle, s.startAngle + s.angle / 2, false);\n\t\t\t\t\tctx.arc(0, 0, radius, s.startAngle + s.angle / 2, s.startAngle + s.angle, false);\n\t\t\t\t\tctx.closePath();\n\t\t\t\t\tx = mouseX - centerLeft;\n\t\t\t\t\ty = mouseY - centerTop;\n\n\t\t\t\t\tif (ctx.isPointInPath) {\n\t\t\t\t\t\tif (ctx.isPointInPath(mouseX - centerLeft, mouseY - centerTop)) {\n\t\t\t\t\t\t\tctx.restore();\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tdatapoint: [s.percent, s.data],\n\t\t\t\t\t\t\t\tdataIndex: 0,\n\t\t\t\t\t\t\t\tseries: s,\n\t\t\t\t\t\t\t\tseriesIndex: i\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// excanvas for IE doesn;t support isPointInPath, this is a workaround.\n\n\t\t\t\t\t\tvar p1X = radius * Math.cos(s.startAngle),\n\t\t\t\t\t\t\tp1Y = radius * Math.sin(s.startAngle),\n\t\t\t\t\t\t\tp2X = radius * Math.cos(s.startAngle + s.angle / 4),\n\t\t\t\t\t\t\tp2Y = radius * Math.sin(s.startAngle + s.angle / 4),\n\t\t\t\t\t\t\tp3X = radius * Math.cos(s.startAngle + s.angle / 2),\n\t\t\t\t\t\t\tp3Y = radius * Math.sin(s.startAngle + s.angle / 2),\n\t\t\t\t\t\t\tp4X = radius * Math.cos(s.startAngle + s.angle / 1.5),\n\t\t\t\t\t\t\tp4Y = radius * Math.sin(s.startAngle + s.angle / 1.5),\n\t\t\t\t\t\t\tp5X = radius * Math.cos(s.startAngle + s.angle),\n\t\t\t\t\t\t\tp5Y = radius * Math.sin(s.startAngle + s.angle),\n\t\t\t\t\t\t\tarrPoly = [[0, 0], [p1X, p1Y], [p2X, p2Y], [p3X, p3Y], [p4X, p4Y], [p5X, p5Y]],\n\t\t\t\t\t\t\tarrPoint = [x, y];\n\n\t\t\t\t\t\t// TODO: perhaps do some mathmatical trickery here with the Y-coordinate to compensate for pie tilt?\n\n\t\t\t\t\t\tif (isPointInPoly(arrPoly, arrPoint)) {\n\t\t\t\t\t\t\tctx.restore();\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tdatapoint: [s.percent, s.data],\n\t\t\t\t\t\t\t\tdataIndex: 0,\n\t\t\t\t\t\t\t\tseries: s,\n\t\t\t\t\t\t\t\tseriesIndex: i\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tctx.restore();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\n\t\tfunction onMouseMove(e) {\n\t\t\ttriggerClickHoverEvent(\"plothover\", e);\n\t\t}\n\n\t\tfunction onClick(e) {\n\t\t\ttriggerClickHoverEvent(\"plotclick\", e);\n\t\t}\n\n\t\t// trigger click or hover event (they send the same parameters so we share their code)\n\n\t\tfunction triggerClickHoverEvent(eventname, e) {\n\n\t\t\tvar offset = plot.offset();\n\t\t\tvar canvasX = parseInt(e.pageX - offset.left);\n\t\t\tvar canvasY =  parseInt(e.pageY - offset.top);\n\t\t\tvar item = findNearbySlice(canvasX, canvasY);\n\n\t\t\tif (options.grid.autoHighlight) {\n\n\t\t\t\t// clear auto-highlights\n\n\t\t\t\tfor (var i = 0; i < highlights.length; ++i) {\n\t\t\t\t\tvar h = highlights[i];\n\t\t\t\t\tif (h.auto == eventname && !(item && h.series == item.series)) {\n\t\t\t\t\t\tunhighlight(h.series);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// highlight the slice\n\n\t\t\tif (item) {\n\t\t\t\thighlight(item.series, eventname);\n\t\t\t}\n\n\t\t\t// trigger any hover bind events\n\n\t\t\tvar pos = { pageX: e.pageX, pageY: e.pageY };\n\t\t\ttarget.trigger(eventname, [pos, item]);\n\t\t}\n\n\t\tfunction highlight(s, auto) {\n\t\t\t//if (typeof s == \"number\") {\n\t\t\t//\ts = series[s];\n\t\t\t//}\n\n\t\t\tvar i = indexOfHighlight(s);\n\n\t\t\tif (i == -1) {\n\t\t\t\thighlights.push({ series: s, auto: auto });\n\t\t\t\tplot.triggerRedrawOverlay();\n\t\t\t} else if (!auto) {\n\t\t\t\thighlights[i].auto = false;\n\t\t\t}\n\t\t}\n\n\t\tfunction unhighlight(s) {\n\t\t\tif (s == null) {\n\t\t\t\thighlights = [];\n\t\t\t\tplot.triggerRedrawOverlay();\n\t\t\t}\n\n\t\t\t//if (typeof s == \"number\") {\n\t\t\t//\ts = series[s];\n\t\t\t//}\n\n\t\t\tvar i = indexOfHighlight(s);\n\n\t\t\tif (i != -1) {\n\t\t\t\thighlights.splice(i, 1);\n\t\t\t\tplot.triggerRedrawOverlay();\n\t\t\t}\n\t\t}\n\n\t\tfunction indexOfHighlight(s) {\n\t\t\tfor (var i = 0; i < highlights.length; ++i) {\n\t\t\t\tvar h = highlights[i];\n\t\t\t\tif (h.series == s)\n\t\t\t\t\treturn i;\n\t\t\t}\n\t\t\treturn -1;\n\t\t}\n\n\t\tfunction drawOverlay(plot, octx) {\n\n\t\t\tvar options = plot.getOptions();\n\n\t\t\tvar radius = options.series.pie.radius > 1 ? options.series.pie.radius : maxRadius * options.series.pie.radius;\n\n\t\t\toctx.save();\n\t\t\toctx.translate(centerLeft, centerTop);\n\t\t\toctx.scale(1, options.series.pie.tilt);\n\n\t\t\tfor (var i = 0; i < highlights.length; ++i) {\n\t\t\t\tdrawHighlight(highlights[i].series);\n\t\t\t}\n\n\t\t\tdrawDonutHole(octx);\n\n\t\t\toctx.restore();\n\n\t\t\tfunction drawHighlight(series) {\n\n\t\t\t\tif (series.angle <= 0 || isNaN(series.angle)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t//octx.fillStyle = parseColor(options.series.pie.highlight.color).scale(null, null, null, options.series.pie.highlight.opacity).toString();\n\t\t\t\toctx.fillStyle = \"rgba(255, 255, 255, \" + options.series.pie.highlight.opacity + \")\"; // this is temporary until we have access to parseColor\n\t\t\t\toctx.beginPath();\n\t\t\t\tif (Math.abs(series.angle - Math.PI * 2) > 0.000000001) {\n\t\t\t\t\toctx.moveTo(0, 0); // Center of the pie\n\t\t\t\t}\n\t\t\t\toctx.arc(0, 0, radius, series.startAngle, series.startAngle + series.angle / 2, false);\n\t\t\t\toctx.arc(0, 0, radius, series.startAngle + series.angle / 2, series.startAngle + series.angle, false);\n\t\t\t\toctx.closePath();\n\t\t\t\toctx.fill();\n\t\t\t}\n\t\t}\n\t} // end init (plugin body)\n\n\t// define pie specific options and their default values\n\n\tvar options = {\n\t\tseries: {\n\t\t\tpie: {\n\t\t\t\tshow: false,\n\t\t\t\tradius: \"auto\",\t// actual radius of the visible pie (based on full calculated radius if <=1, or hard pixel value)\n\t\t\t\tinnerRadius: 0, /* for donut */\n\t\t\t\tstartAngle: 3/2,\n\t\t\t\ttilt: 1,\n\t\t\t\tshadow: {\n\t\t\t\t\tleft: 5,\t// shadow left offset\n\t\t\t\t\ttop: 15,\t// shadow top offset\n\t\t\t\t\talpha: 0.02\t// shadow alpha\n\t\t\t\t},\n\t\t\t\toffset: {\n\t\t\t\t\ttop: 0,\n\t\t\t\t\tleft: \"auto\"\n\t\t\t\t},\n\t\t\t\tstroke: {\n\t\t\t\t\tcolor: \"#fff\",\n\t\t\t\t\twidth: 1\n\t\t\t\t},\n\t\t\t\tlabel: {\n\t\t\t\t\tshow: \"auto\",\n\t\t\t\t\tformatter: function(label, slice) {\n\t\t\t\t\t\treturn \"<div style='font-size:x-small;text-align:center;padding:2px;color:\" + slice.color + \";'>\" + label + \"<br/>\" + Math.round(slice.percent) + \"%</div>\";\n\t\t\t\t\t},\t// formatter function\n\t\t\t\t\tradius: 1,\t// radius at which to place the labels (based on full calculated radius if <=1, or hard pixel value)\n\t\t\t\t\tbackground: {\n\t\t\t\t\t\tcolor: null,\n\t\t\t\t\t\topacity: 0\n\t\t\t\t\t},\n\t\t\t\t\tthreshold: 0\t// percentage at which to hide the label (i.e. the slice is too narrow)\n\t\t\t\t},\n\t\t\t\tcombine: {\n\t\t\t\t\tthreshold: -1,\t// percentage at which to combine little slices into one larger slice\n\t\t\t\t\tcolor: null,\t// color to give the new slice (auto-generated if null)\n\t\t\t\t\tlabel: \"Other\"\t// label to give the new slice\n\t\t\t\t},\n\t\t\t\thighlight: {\n\t\t\t\t\t//color: \"#fff\",\t\t// will add this functionality once parseColor is available\n\t\t\t\t\topacity: 0.5\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\t$.plot.plugins.push({\n\t\tinit: init,\n\t\toptions: options,\n\t\tname: \"pie\",\n\t\tversion: \"1.1\"\n\t});\n\n})(jQuery);\n","import angular from 'angular';\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport coreModule from 'app/core/core_module';\n\nexport class AnnotationsEditorCtrl {\n  mode: any;\n  datasources: any;\n  annotations: any;\n  currentAnnotation: any;\n  currentDatasource: any;\n  currentIsNew: any;\n\n  annotationDefaults: any = {\n    name: '',\n    datasource: null,\n    iconColor: 'rgba(255, 96, 96, 1)',\n    enable: true,\n    showIn: 0,\n    hide: false,\n  };\n\n  showOptions: any = [{ text: 'All Panels', value: 0 }, { text: 'Specific Panels', value: 1 }];\n\n  /** @ngInject */\n  constructor($scope, private datasourceSrv) {\n    $scope.ctrl = this;\n\n    this.mode = 'list';\n    this.datasources = datasourceSrv.getAnnotationSources();\n    this.annotations = $scope.dashboard.annotations.list;\n    this.reset();\n\n    this.onColorChange = this.onColorChange.bind(this);\n  }\n\n  datasourceChanged() {\n    return this.datasourceSrv.get(this.currentAnnotation.datasource).then(ds => {\n      this.currentDatasource = ds;\n    });\n  }\n\n  edit(annotation) {\n    this.currentAnnotation = annotation;\n    this.currentAnnotation.showIn = this.currentAnnotation.showIn || 0;\n    this.currentIsNew = false;\n    this.datasourceChanged();\n    this.mode = 'edit';\n    $('.tooltip.in').remove();\n  }\n\n  reset() {\n    this.currentAnnotation = angular.copy(this.annotationDefaults);\n    this.currentAnnotation.datasource = this.datasources[0].name;\n    this.currentIsNew = true;\n    this.datasourceChanged();\n  }\n\n  update() {\n    this.reset();\n    this.mode = 'list';\n  }\n\n  setupNew() {\n    this.mode = 'new';\n    this.reset();\n  }\n\n  backToList() {\n    this.mode = 'list';\n  }\n\n  move(index, dir) {\n    _.move(this.annotations, index, index + dir);\n  }\n\n  add() {\n    this.annotations.push(this.currentAnnotation);\n    this.reset();\n    this.mode = 'list';\n  }\n\n  removeAnnotation(annotation) {\n    const index = _.indexOf(this.annotations, annotation);\n    this.annotations.splice(index, 1);\n  }\n\n  onColorChange(newColor) {\n    this.currentAnnotation.iconColor = newColor;\n  }\n}\n\ncoreModule.controller('AnnotationsEditorCtrl', AnnotationsEditorCtrl);\n","import _ from 'lodash';\n\n/**\n * This function converts annotation events into set\n * of single events and regions (event consist of two)\n * @param annotations\n * @param options\n */\nexport function makeRegions(annotations, options) {\n  const [regionEvents, singleEvents] = _.partition(annotations, 'regionId');\n  const regions = getRegions(regionEvents, options.range);\n  annotations = _.concat(regions, singleEvents);\n  return annotations;\n}\n\nfunction getRegions(events, range) {\n  const regionEvents = _.filter(events, event => {\n    return event.regionId;\n  });\n  let regions = _.groupBy(regionEvents, 'regionId');\n  regions = _.compact(\n    _.map(regions, regionEvents => {\n      const regionObj = _.head(regionEvents);\n      if (regionEvents && regionEvents.length > 1) {\n        regionObj.timeEnd = regionEvents[1].time;\n        regionObj.isRegion = true;\n        return regionObj;\n      } else {\n        if (regionEvents && regionEvents.length) {\n          // Don't change proper region object\n          if (!regionObj.time || !regionObj.timeEnd) {\n            // This is cut region\n            if (isStartOfRegion(regionObj)) {\n              regionObj.timeEnd = range.to.valueOf() - 1;\n            } else {\n              // Start time = null\n              regionObj.timeEnd = regionObj.time;\n              regionObj.time = range.from.valueOf() + 1;\n            }\n            regionObj.isRegion = true;\n          }\n\n          return regionObj;\n        }\n      }\n    })\n  );\n\n  return regions;\n}\n\nfunction isStartOfRegion(event): boolean {\n  return event.id && event.id === event.regionId;\n}\n\nexport function dedupAnnotations(annotations) {\n  let dedup = [];\n\n  // Split events by annotationId property existence\n  const events = _.partition(annotations, 'id');\n\n  const eventsById = _.groupBy(events[0], 'id');\n  dedup = _.map(eventsById, eventGroup => {\n    if (eventGroup.length > 1 && !_.every(eventGroup, isPanelAlert)) {\n      // Get first non-panel alert\n      return _.find(eventGroup, event => {\n        return event.eventType !== 'panel-alert';\n      });\n    } else {\n      return _.head(eventGroup);\n    }\n  });\n\n  dedup = _.concat(dedup, events[1]);\n  return dedup;\n}\n\nfunction isPanelAlert(event) {\n  return event.eventType === 'panel-alert';\n}\n","import './editor_ctrl';\n\nimport angular from 'angular';\nimport _ from 'lodash';\nimport coreModule from 'app/core/core_module';\nimport { makeRegions, dedupAnnotations } from './events_processing';\n\nexport class AnnotationsSrv {\n  globalAnnotationsPromise: any;\n  alertStatesPromise: any;\n\n  /** @ngInject */\n  constructor(private $rootScope, private $q, private datasourceSrv, private backendSrv, private timeSrv) {\n    $rootScope.onAppEvent('refresh', this.clearCache.bind(this), $rootScope);\n    $rootScope.onAppEvent('dashboard-initialized', this.clearCache.bind(this), $rootScope);\n  }\n\n  clearCache() {\n    this.globalAnnotationsPromise = null;\n    this.alertStatesPromise = null;\n  }\n\n  getAnnotations(options) {\n    return this.$q\n      .all([this.getGlobalAnnotations(options), this.getAlertStates(options)])\n      .then(results => {\n        // combine the annotations and flatten results\n        let annotations = _.flattenDeep(results[0]);\n\n        // filter out annotations that do not belong to requesting panel\n        annotations = _.filter(annotations, item => {\n          // if event has panel id and query is of type dashboard then panel and requesting panel id must match\n          if (item.panelId && item.source.type === 'dashboard') {\n            return item.panelId === options.panel.id;\n          }\n          return true;\n        });\n\n        annotations = dedupAnnotations(annotations);\n        annotations = makeRegions(annotations, options);\n\n        // look for alert state for this panel\n        const alertState = _.find(results[1], { panelId: options.panel.id });\n\n        return {\n          annotations: annotations,\n          alertState: alertState,\n        };\n      })\n      .catch(err => {\n        if (!err.message && err.data && err.data.message) {\n          err.message = err.data.message;\n        }\n        console.log('AnnotationSrv.query error', err);\n        this.$rootScope.appEvent('alert-error', ['Annotation Query Failed', err.message || err]);\n        return [];\n      });\n  }\n\n  getAlertStates(options) {\n    if (!options.dashboard.id) {\n      return this.$q.when([]);\n    }\n\n    // ignore if no alerts\n    if (options.panel && !options.panel.alert) {\n      return this.$q.when([]);\n    }\n\n    if (options.range.raw.to !== 'now') {\n      return this.$q.when([]);\n    }\n\n    if (this.alertStatesPromise) {\n      return this.alertStatesPromise;\n    }\n\n    this.alertStatesPromise = this.backendSrv.get('/api/alerts/states-for-dashboard', {\n      dashboardId: options.dashboard.id,\n    });\n    return this.alertStatesPromise;\n  }\n\n  getGlobalAnnotations(options) {\n    const dashboard = options.dashboard;\n\n    if (this.globalAnnotationsPromise) {\n      return this.globalAnnotationsPromise;\n    }\n\n    const range = this.timeSrv.timeRange();\n    const promises = [];\n\n    for (const annotation of dashboard.annotations.list) {\n      if (!annotation.enable) {\n        continue;\n      }\n\n      if (annotation.snapshotData) {\n        return this.translateQueryResult(annotation, annotation.snapshotData);\n      }\n\n      promises.push(\n        this.datasourceSrv\n          .get(annotation.datasource)\n          .then(datasource => {\n            // issue query against data source\n            return datasource.annotationQuery({\n              range: range,\n              rangeRaw: range.raw,\n              annotation: annotation,\n              dashboard: dashboard,\n            });\n          })\n          .then(results => {\n            // store response in annotation object if this is a snapshot call\n            if (dashboard.snapshot) {\n              annotation.snapshotData = angular.copy(results);\n            }\n            // translate result\n            return this.translateQueryResult(annotation, results);\n          })\n      );\n    }\n\n    this.globalAnnotationsPromise = this.$q.all(promises);\n    return this.globalAnnotationsPromise;\n  }\n\n  saveAnnotationEvent(annotation) {\n    this.globalAnnotationsPromise = null;\n    return this.backendSrv.post('/api/annotations', annotation);\n  }\n\n  updateAnnotationEvent(annotation) {\n    this.globalAnnotationsPromise = null;\n    return this.backendSrv.put(`/api/annotations/${annotation.id}`, annotation);\n  }\n\n  deleteAnnotationEvent(annotation) {\n    this.globalAnnotationsPromise = null;\n    let deleteUrl = `/api/annotations/${annotation.id}`;\n    if (annotation.isRegion) {\n      deleteUrl = `/api/annotations/region/${annotation.regionId}`;\n    }\n\n    return this.backendSrv.delete(deleteUrl);\n  }\n\n  translateQueryResult(annotation, results) {\n    // if annotation has snapshotData\n    // make clone and remove it\n    if (annotation.snapshotData) {\n      annotation = angular.copy(annotation);\n      delete annotation.snapshotData;\n    }\n\n    for (const item of results) {\n      item.source = annotation;\n    }\n    return results;\n  }\n}\n\ncoreModule.service('annotationsSrv', AnnotationsSrv);\n","import _ from 'lodash';\nimport moment from 'moment';\nimport { coreModule } from 'app/core/core';\nimport { MetricsPanelCtrl } from 'app/plugins/sdk';\nimport { AnnotationEvent } from './event';\n\nexport class EventEditorCtrl {\n  panelCtrl: MetricsPanelCtrl;\n  event: AnnotationEvent;\n  timeRange: { from: number; to: number };\n  form: any;\n  close: any;\n  timeFormated: string;\n\n  /** @ngInject */\n  constructor(private annotationsSrv) {\n    this.event.panelId = this.panelCtrl.panel.id;\n    this.event.dashboardId = this.panelCtrl.dashboard.id;\n\n    // Annotations query returns time as Unix timestamp in milliseconds\n    this.event.time = tryEpochToMoment(this.event.time);\n    if (this.event.isRegion) {\n      this.event.timeEnd = tryEpochToMoment(this.event.timeEnd);\n    }\n\n    this.timeFormated = this.panelCtrl.dashboard.formatDate(this.event.time);\n  }\n\n  save() {\n    if (!this.form.$valid) {\n      return;\n    }\n\n    const saveModel = _.cloneDeep(this.event);\n    saveModel.time = saveModel.time.valueOf();\n    saveModel.timeEnd = 0;\n\n    if (saveModel.isRegion) {\n      saveModel.timeEnd = this.event.timeEnd.valueOf();\n\n      if (saveModel.timeEnd < saveModel.time) {\n        console.log('invalid time');\n        return;\n      }\n    }\n\n    if (saveModel.id) {\n      this.annotationsSrv\n        .updateAnnotationEvent(saveModel)\n        .then(() => {\n          this.panelCtrl.refresh();\n          this.close();\n        })\n        .catch(() => {\n          this.panelCtrl.refresh();\n          this.close();\n        });\n    } else {\n      this.annotationsSrv\n        .saveAnnotationEvent(saveModel)\n        .then(() => {\n          this.panelCtrl.refresh();\n          this.close();\n        })\n        .catch(() => {\n          this.panelCtrl.refresh();\n          this.close();\n        });\n    }\n  }\n\n  delete() {\n    return this.annotationsSrv\n      .deleteAnnotationEvent(this.event)\n      .then(() => {\n        this.panelCtrl.refresh();\n        this.close();\n      })\n      .catch(() => {\n        this.panelCtrl.refresh();\n        this.close();\n      });\n  }\n}\n\nfunction tryEpochToMoment(timestamp) {\n  if (timestamp && _.isNumber(timestamp)) {\n    const epoch = Number(timestamp);\n    return moment(epoch);\n  } else {\n    return timestamp;\n  }\n}\n\nexport function eventEditor() {\n  return {\n    restrict: 'E',\n    controller: EventEditorCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    templateUrl: 'public/app/features/annotations/partials/event_editor.html',\n    scope: {\n      panelCtrl: '=',\n      event: '=',\n      close: '&',\n    },\n  };\n}\n\ncoreModule.directive('eventEditor', eventEditor);\n","export class AnnotationEvent {\n  dashboardId: number;\n  panelId: number;\n  userId: number;\n  time: any;\n  timeEnd: any;\n  isRegion: boolean;\n  text: string;\n  type: string;\n  tags: string;\n}\n","import _ from 'lodash';\nimport moment from 'moment';\nimport tinycolor from 'tinycolor2';\nimport { MetricsPanelCtrl } from 'app/plugins/sdk';\nimport { AnnotationEvent } from './event';\nimport {\n  OK_COLOR,\n  ALERTING_COLOR,\n  NO_DATA_COLOR,\n  DEFAULT_ANNOTATION_COLOR,\n  REGION_FILL_ALPHA,\n} from 'app/core/utils/colors';\n\nexport class EventManager {\n  event: AnnotationEvent;\n  editorOpen: boolean;\n\n  constructor(private panelCtrl: MetricsPanelCtrl) {}\n\n  editorClosed() {\n    this.event = null;\n    this.editorOpen = false;\n    this.panelCtrl.render();\n  }\n\n  editorOpened() {\n    this.editorOpen = true;\n  }\n\n  updateTime(range) {\n    if (!this.event) {\n      this.event = new AnnotationEvent();\n      this.event.dashboardId = this.panelCtrl.dashboard.id;\n      this.event.panelId = this.panelCtrl.panel.id;\n    }\n\n    // update time\n    this.event.time = moment(range.from);\n    this.event.isRegion = false;\n    if (range.to) {\n      this.event.timeEnd = moment(range.to);\n      this.event.isRegion = true;\n    }\n\n    this.panelCtrl.render();\n  }\n\n  editEvent(event, elem?) {\n    this.event = event;\n    this.panelCtrl.render();\n  }\n\n  addFlotEvents(annotations, flotOptions) {\n    if (!this.event && annotations.length === 0) {\n      return;\n    }\n\n    const types = {\n      $__alerting: {\n        color: ALERTING_COLOR,\n        position: 'BOTTOM',\n        markerSize: 5,\n      },\n      $__ok: {\n        color: OK_COLOR,\n        position: 'BOTTOM',\n        markerSize: 5,\n      },\n      $__no_data: {\n        color: NO_DATA_COLOR,\n        position: 'BOTTOM',\n        markerSize: 5,\n      },\n      $__editing: {\n        color: DEFAULT_ANNOTATION_COLOR,\n        position: 'BOTTOM',\n        markerSize: 5,\n      },\n    };\n\n    if (this.event) {\n      if (this.event.isRegion) {\n        annotations = [\n          {\n            isRegion: true,\n            min: this.event.time.valueOf(),\n            timeEnd: this.event.timeEnd.valueOf(),\n            text: this.event.text,\n            eventType: '$__editing',\n            editModel: this.event,\n          },\n        ];\n      } else {\n        annotations = [\n          {\n            min: this.event.time.valueOf(),\n            text: this.event.text,\n            editModel: this.event,\n            eventType: '$__editing',\n          },\n        ];\n      }\n    } else {\n      // annotations from query\n      for (let i = 0; i < annotations.length; i++) {\n        const item = annotations[i];\n\n        // add properties used by jquery flot events\n        item.min = item.time;\n        item.max = item.time;\n        item.eventType = item.source.name;\n\n        if (item.newState) {\n          item.eventType = '$__' + item.newState;\n          continue;\n        }\n\n        if (!types[item.source.name]) {\n          types[item.source.name] = {\n            color: item.source.iconColor,\n            position: 'BOTTOM',\n            markerSize: 5,\n          };\n        }\n      }\n    }\n\n    const regions = getRegions(annotations);\n    addRegionMarking(regions, flotOptions);\n\n    const eventSectionHeight = 20;\n    const eventSectionMargin = 7;\n    flotOptions.grid.eventSectionHeight = eventSectionMargin;\n    flotOptions.xaxis.eventSectionHeight = eventSectionHeight;\n\n    flotOptions.events = {\n      levels: _.keys(types).length + 1,\n      data: annotations,\n      types: types,\n      manager: this,\n    };\n  }\n}\n\nfunction getRegions(events) {\n  return _.filter(events, 'isRegion');\n}\n\nfunction addRegionMarking(regions, flotOptions) {\n  const markings = flotOptions.grid.markings;\n  const defaultColor = DEFAULT_ANNOTATION_COLOR;\n  let fillColor;\n\n  _.each(regions, region => {\n    if (region.source) {\n      fillColor = region.source.iconColor || defaultColor;\n    } else {\n      fillColor = defaultColor;\n    }\n\n    fillColor = addAlphaToRGB(fillColor, REGION_FILL_ALPHA);\n    markings.push({\n      xaxis: { from: region.min, to: region.timeEnd },\n      color: fillColor,\n    });\n  });\n}\n\nfunction addAlphaToRGB(colorString: string, alpha: number): string {\n  const color = tinycolor(colorString);\n  if (color.isValid()) {\n    color.setAlpha(alpha);\n    return color.toRgbString();\n  } else {\n    return colorString;\n  }\n}\n","import _ from 'lodash';\nimport $ from 'jquery';\nimport coreModule from 'app/core/core_module';\nimport alertDef from '../alerting/state/alertDef';\n\n/** @ngInject */\nexport function annotationTooltipDirective($sanitize, dashboardSrv, contextSrv, $compile) {\n  function sanitizeString(str) {\n    try {\n      return $sanitize(str);\n    } catch (err) {\n      console.log('Could not sanitize annotation string, html escaping instead');\n      return _.escape(str);\n    }\n  }\n\n  return {\n    restrict: 'E',\n    scope: {\n      event: '=',\n      onEdit: '&',\n    },\n    link: (scope, element) => {\n      const event = scope.event;\n      let title = event.title;\n      let text = event.text;\n      const dashboard = dashboardSrv.getCurrent();\n\n      let tooltip = '<div class=\"graph-annotation\">';\n      let titleStateClass = '';\n\n      if (event.alertId) {\n        const stateModel = alertDef.getStateDisplayModel(event.newState);\n        titleStateClass = stateModel.stateClass;\n        title = `<i class=\"icon-gf ${stateModel.iconClass}\"></i> ${stateModel.text}`;\n        text = alertDef.getAlertAnnotationInfo(event);\n        if (event.text) {\n          text = text + '<br />' + event.text;\n        }\n      } else if (title) {\n        text = title + '<br />' + (_.isString(text) ? text : '');\n        title = '';\n      }\n\n      let header = `<div class=\"graph-annotation__header\">`;\n      if (event.login) {\n        header += `<div class=\"graph-annotation__user\" bs-tooltip=\"'Created by ${event.login}'\"><img src=\"${\n          event.avatarUrl\n        }\" /></div>`;\n      }\n      header += `\n          <span class=\"graph-annotation__title ${titleStateClass}\">${sanitizeString(title)}</span>\n          <span class=\"graph-annotation__time\">${dashboard.formatDate(event.min)}</span>\n      `;\n\n      // Show edit icon only for users with at least Editor role\n      if (event.id && dashboard.meta.canEdit) {\n        header += `\n          <span class=\"pointer graph-annotation__edit-icon\" ng-click=\"onEdit()\">\n            <i class=\"fa fa-pencil-square\"></i>\n          </span>\n        `;\n      }\n\n      header += `</div>`;\n      tooltip += header;\n      tooltip += '<div class=\"graph-annotation__body\">';\n\n      if (text) {\n        tooltip += '<div>' + sanitizeString(text.replace(/\\n/g, '<br>')) + '</div>';\n      }\n\n      const tags = event.tags;\n\n      if (tags && tags.length) {\n        scope.tags = tags;\n        tooltip +=\n          '<span class=\"label label-tag small\" ng-repeat=\"tag in tags\" tag-color-from-name=\"tag\">{{tag}}</span><br/>';\n      }\n\n      tooltip += '</div>';\n      tooltip += '</div>';\n\n      const $tooltip = $(tooltip);\n      $tooltip.appendTo(element);\n\n      $compile(element.contents())(scope);\n    },\n  };\n}\n\ncoreModule.directive('annotationTooltip', annotationTooltipDirective);\n","import { AnnotationsSrv } from './annotations_srv';\nimport { eventEditor } from './event_editor';\nimport { EventManager } from './event_manager';\nimport { AnnotationEvent } from './event';\nimport { annotationTooltipDirective } from './annotation_tooltip';\n\nexport { AnnotationsSrv, eventEditor, EventManager, AnnotationEvent, annotationTooltipDirective };\n","import { assignModelProperties } from 'app/core/utils/model_utils';\n\n/*\n * This regex matches 3 types of variable reference with an optional format specifier\n * \\$(\\w+)                          $var1\n * \\[\\[([\\s\\S]+?)(?::(\\w+))?\\]\\]    [[var2]] or [[var2:fmt2]]\n * \\${(\\w+)(?::(\\w+))?}             ${var3} or ${var3:fmt3}\n */\nexport const variableRegex = /\\$(\\w+)|\\[\\[([\\s\\S]+?)(?::(\\w+))?\\]\\]|\\${(\\w+)(?::(\\w+))?}/g;\n\n// Helper function since lastIndex is not reset\nexport const variableRegexExec = (variableString: string) => {\n  variableRegex.lastIndex = 0;\n  return variableRegex.exec(variableString);\n};\n\nexport interface Variable {\n  setValue(option);\n  updateOptions();\n  dependsOn(variable);\n  setValueFromUrl(urlValue);\n  getValueForUrl();\n  getSaveModel();\n}\n\nexport let variableTypes = {};\nexport { assignModelProperties };\n\nexport function containsVariable(...args: any[]) {\n  const variableName = args[args.length - 1];\n  const variableString = args.slice(0, -1).join(' ');\n  const matches = variableString.match(variableRegex);\n  const isMatchingVariable =\n    matches !== null\n      ? matches.find(match => {\n          const varMatch = variableRegexExec(match);\n          return varMatch !== null && varMatch.indexOf(variableName) > -1;\n        })\n      : false;\n\n  return !!isMatchingVariable;\n}\n","import _ from 'lodash';\nimport coreModule from 'app/core/core_module';\nimport { variableTypes } from './variable';\nimport appEvents from 'app/core/app_events';\n\nexport class VariableEditorCtrl {\n  /** @ngInject */\n  constructor($scope, datasourceSrv, variableSrv, templateSrv) {\n    $scope.variableTypes = variableTypes;\n    $scope.ctrl = {};\n    $scope.namePattern = /^(?!__).*$/;\n    $scope._ = _;\n    $scope.optionsLimit = 20;\n\n    $scope.refreshOptions = [\n      { value: 0, text: 'Never' },\n      { value: 1, text: 'On Dashboard Load' },\n      { value: 2, text: 'On Time Range Change' },\n    ];\n\n    $scope.sortOptions = [\n      { value: 0, text: 'Disabled' },\n      { value: 1, text: 'Alphabetical (asc)' },\n      { value: 2, text: 'Alphabetical (desc)' },\n      { value: 3, text: 'Numerical (asc)' },\n      { value: 4, text: 'Numerical (desc)' },\n      { value: 5, text: 'Alphabetical (case-insensitive, asc)' },\n      { value: 6, text: 'Alphabetical (case-insensitive, desc)' },\n    ];\n\n    $scope.hideOptions = [{ value: 0, text: '' }, { value: 1, text: 'Label' }, { value: 2, text: 'Variable' }];\n\n    $scope.init = () => {\n      $scope.mode = 'list';\n\n      $scope.variables = variableSrv.variables;\n      $scope.reset();\n\n      $scope.$watch('mode', val => {\n        if (val === 'new') {\n          $scope.reset();\n        }\n      });\n    };\n\n    $scope.setMode = mode => {\n      $scope.mode = mode;\n    };\n\n    $scope.add = () => {\n      if ($scope.isValid()) {\n        variableSrv.addVariable($scope.current);\n        $scope.update();\n      }\n    };\n\n    $scope.isValid = () => {\n      if (!$scope.ctrl.form.$valid) {\n        return false;\n      }\n\n      if (!$scope.current.name.match(/^\\w+$/)) {\n        appEvents.emit('alert-warning', ['Validation', 'Only word and digit characters are allowed in variable names']);\n        return false;\n      }\n\n      const sameName = _.find($scope.variables, { name: $scope.current.name });\n      if (sameName && sameName !== $scope.current) {\n        appEvents.emit('alert-warning', ['Validation', 'Variable with the same name already exists']);\n        return false;\n      }\n\n      if (\n        $scope.current.type === 'query' &&\n        $scope.current.query.match(new RegExp('\\\\$' + $scope.current.name + '(/| |$)'))\n      ) {\n        appEvents.emit('alert-warning', [\n          'Validation',\n          'Query cannot contain a reference to itself. Variable: $' + $scope.current.name,\n        ]);\n        return false;\n      }\n\n      return true;\n    };\n\n    $scope.validate = () => {\n      $scope.infoText = '';\n      if ($scope.current.type === 'adhoc' && $scope.current.datasource !== null) {\n        $scope.infoText = 'Adhoc filters are applied automatically to all queries that target this datasource';\n        datasourceSrv.get($scope.current.datasource).then(ds => {\n          if (!ds.getTagKeys) {\n            $scope.infoText = 'This datasource does not support adhoc filters yet.';\n          }\n        });\n      }\n    };\n\n    $scope.runQuery = () => {\n      $scope.optionsLimit = 20;\n      return variableSrv.updateOptions($scope.current).catch(err => {\n        if (err.data && err.data.message) {\n          err.message = err.data.message;\n        }\n        appEvents.emit('alert-error', ['Templating', 'Template variables could not be initialized: ' + err.message]);\n      });\n    };\n\n    $scope.edit = variable => {\n      $scope.current = variable;\n      $scope.currentIsNew = false;\n      $scope.mode = 'edit';\n      $scope.validate();\n    };\n\n    $scope.duplicate = variable => {\n      const clone = _.cloneDeep(variable.getSaveModel());\n      $scope.current = variableSrv.createVariableFromModel(clone);\n      $scope.current.name = 'copy_of_' + variable.name;\n      variableSrv.addVariable($scope.current);\n    };\n\n    $scope.update = () => {\n      if ($scope.isValid()) {\n        $scope.runQuery().then(() => {\n          $scope.reset();\n          $scope.mode = 'list';\n          templateSrv.updateTemplateData();\n        });\n      }\n    };\n\n    $scope.reset = () => {\n      $scope.currentIsNew = true;\n      $scope.current = variableSrv.createVariableFromModel({ type: 'query' });\n\n      // this is done here in case a new data source type variable was added\n      $scope.datasources = _.filter(datasourceSrv.getMetricSources(), ds => {\n        return !ds.meta.mixed && ds.value !== null;\n      });\n\n      $scope.datasourceTypes = _($scope.datasources)\n        .uniqBy('meta.id')\n        .map(ds => {\n          return { text: ds.meta.name, value: ds.meta.id };\n        })\n        .value();\n    };\n\n    $scope.typeChanged = function() {\n      const old = $scope.current;\n      $scope.current = variableSrv.createVariableFromModel({\n        type: $scope.current.type,\n      });\n      $scope.current.name = old.name;\n      $scope.current.hide = old.hide;\n      $scope.current.label = old.label;\n\n      const oldIndex = _.indexOf(this.variables, old);\n      if (oldIndex !== -1) {\n        this.variables[oldIndex] = $scope.current;\n      }\n\n      $scope.validate();\n    };\n\n    $scope.removeVariable = variable => {\n      variableSrv.removeVariable(variable);\n    };\n\n    $scope.showMoreOptions = () => {\n      $scope.optionsLimit += 20;\n    };\n  }\n}\n\ncoreModule.controller('VariableEditorCtrl', VariableEditorCtrl);\n","import kbn from 'app/core/utils/kbn';\nimport _ from 'lodash';\nimport { variableRegex } from 'app/features/templating/variable';\n\nfunction luceneEscape(value) {\n  return value.replace(/([\\!\\*\\+\\-\\=<>\\s\\&\\|\\(\\)\\[\\]\\{\\}\\^\\~\\?\\:\\\\/\"])/g, '\\\\$1');\n}\n\nexport class TemplateSrv {\n  variables: any[];\n\n  private regex = variableRegex;\n  private index = {};\n  private grafanaVariables = {};\n  private builtIns = {};\n\n  constructor() {\n    this.builtIns['__interval'] = { text: '1s', value: '1s' };\n    this.builtIns['__interval_ms'] = { text: '100', value: '100' };\n  }\n\n  init(variables) {\n    this.variables = variables;\n    this.updateTemplateData();\n  }\n\n  updateTemplateData() {\n    const existsOrEmpty = value => value || value === '';\n\n    this.index = this.variables.reduce((acc, currentValue) => {\n      if (currentValue.current && (currentValue.current.isNone || existsOrEmpty(currentValue.current.value))) {\n        acc[currentValue.name] = currentValue;\n      }\n      return acc;\n    }, {});\n  }\n\n  variableInitialized(variable) {\n    this.index[variable.name] = variable;\n  }\n\n  getAdhocFilters(datasourceName) {\n    let filters = [];\n\n    if (this.variables) {\n      for (let i = 0; i < this.variables.length; i++) {\n        const variable = this.variables[i];\n        if (variable.type !== 'adhoc') {\n          continue;\n        }\n\n        // null is the \"default\" datasource\n        if (variable.datasource === null || variable.datasource === datasourceName) {\n          filters = filters.concat(variable.filters);\n        } else if (variable.datasource.indexOf('$') === 0) {\n          if (this.replace(variable.datasource) === datasourceName) {\n            filters = filters.concat(variable.filters);\n          }\n        }\n      }\n    }\n\n    return filters;\n  }\n\n  luceneFormat(value) {\n    if (typeof value === 'string') {\n      return luceneEscape(value);\n    }\n    if (value instanceof Array && value.length === 0) {\n      return '__empty__';\n    }\n    const quotedValues = _.map(value, val => {\n      return '\"' + luceneEscape(val) + '\"';\n    });\n    return '(' + quotedValues.join(' OR ') + ')';\n  }\n\n  formatValue(value, format, variable) {\n    // for some scopedVars there is no variable\n    variable = variable || {};\n\n    if (typeof format === 'function') {\n      return format(value, variable, this.formatValue);\n    }\n\n    switch (format) {\n      case 'regex': {\n        if (typeof value === 'string') {\n          return kbn.regexEscape(value);\n        }\n\n        const escapedValues = _.map(value, kbn.regexEscape);\n        if (escapedValues.length === 1) {\n          return escapedValues[0];\n        }\n        return '(' + escapedValues.join('|') + ')';\n      }\n      case 'lucene': {\n        return this.luceneFormat(value);\n      }\n      case 'pipe': {\n        if (typeof value === 'string') {\n          return value;\n        }\n        return value.join('|');\n      }\n      case 'distributed': {\n        if (typeof value === 'string') {\n          return value;\n        }\n        return this.distributeVariable(value, variable.name);\n      }\n      case 'csv': {\n        if (_.isArray(value)) {\n          return value.join(',');\n        }\n        return value;\n      }\n      default: {\n        if (_.isArray(value)) {\n          return '{' + value.join(',') + '}';\n        }\n        return value;\n      }\n    }\n  }\n\n  setGrafanaVariable(name, value) {\n    this.grafanaVariables[name] = value;\n  }\n\n  getVariableName(expression) {\n    this.regex.lastIndex = 0;\n    const match = this.regex.exec(expression);\n    if (!match) {\n      return null;\n    }\n    return match[1] || match[2];\n  }\n\n  variableExists(expression) {\n    const name = this.getVariableName(expression);\n    return name && this.index[name] !== void 0;\n  }\n\n  highlightVariablesAsHtml(str) {\n    if (!str || !_.isString(str)) {\n      return str;\n    }\n\n    str = _.escape(str);\n    this.regex.lastIndex = 0;\n    return str.replace(this.regex, (match, var1, var2, fmt2, var3) => {\n      if (this.index[var1 || var2 || var3] || this.builtIns[var1 || var2 || var3]) {\n        return '<span class=\"template-variable\">' + match + '</span>';\n      }\n      return match;\n    });\n  }\n\n  getAllValue(variable) {\n    if (variable.allValue) {\n      return variable.allValue;\n    }\n    const values = [];\n    for (let i = 1; i < variable.options.length; i++) {\n      values.push(variable.options[i].value);\n    }\n    return values;\n  }\n\n  replace(target, scopedVars?, format?) {\n    if (!target) {\n      return target;\n    }\n\n    let variable, systemValue, value, fmt;\n    this.regex.lastIndex = 0;\n\n    return target.replace(this.regex, (match, var1, var2, fmt2, var3, fmt3) => {\n      variable = this.index[var1 || var2 || var3];\n      fmt = fmt2 || fmt3 || format;\n      if (scopedVars) {\n        value = scopedVars[var1 || var2 || var3];\n        if (value) {\n          return this.formatValue(value.value, fmt, variable);\n        }\n      }\n\n      if (!variable) {\n        return match;\n      }\n\n      systemValue = this.grafanaVariables[variable.current.value];\n      if (systemValue) {\n        return this.formatValue(systemValue, fmt, variable);\n      }\n\n      value = variable.current.value;\n      if (this.isAllValue(value)) {\n        value = this.getAllValue(variable);\n        // skip formatting of custom all values\n        if (variable.allValue) {\n          return this.replace(value);\n        }\n      }\n\n      const res = this.formatValue(value, fmt, variable);\n      return res;\n    });\n  }\n\n  isAllValue(value) {\n    return value === '$__all' || (Array.isArray(value) && value[0] === '$__all');\n  }\n\n  replaceWithText(target, scopedVars) {\n    if (!target) {\n      return target;\n    }\n\n    let variable;\n    this.regex.lastIndex = 0;\n\n    return target.replace(this.regex, (match, var1, var2, fmt2, var3) => {\n      if (scopedVars) {\n        const option = scopedVars[var1 || var2 || var3];\n        if (option) {\n          return option.text;\n        }\n      }\n\n      variable = this.index[var1 || var2 || var3];\n      if (!variable) {\n        return match;\n      }\n\n      return this.grafanaVariables[variable.current.value] || variable.current.text;\n    });\n  }\n\n  fillVariableValuesForUrl(params, scopedVars) {\n    _.each(this.variables, variable => {\n      if (scopedVars && scopedVars[variable.name] !== void 0) {\n        if (scopedVars[variable.name].skipUrlSync) {\n          return;\n        }\n        params['var-' + variable.name] = scopedVars[variable.name].value;\n      } else {\n        if (variable.skipUrlSync) {\n          return;\n        }\n        params['var-' + variable.name] = variable.getValueForUrl();\n      }\n    });\n  }\n\n  distributeVariable(value, variable) {\n    value = _.map(value, (val, index) => {\n      if (index !== 0) {\n        return variable + '=' + val;\n      } else {\n        return val;\n      }\n    });\n    return value.join(',');\n  }\n}\n\nexport default new TemplateSrv();\n","export class Edge {\n  inputNode: Node;\n  outputNode: Node;\n\n  _linkTo(node, direction) {\n    if (direction <= 0) {\n      node.inputEdges.push(this);\n    }\n\n    if (direction >= 0) {\n      node.outputEdges.push(this);\n    }\n\n    node.edges.push(this);\n  }\n\n  link(inputNode: Node, outputNode: Node) {\n    if (!inputNode) {\n      throw Error('inputNode is required');\n    }\n\n    if (!outputNode) {\n      throw Error('outputNode is required');\n    }\n\n    this.unlink();\n    this.inputNode = inputNode;\n    this.outputNode = outputNode;\n\n    this._linkTo(inputNode, 1);\n    this._linkTo(outputNode, -1);\n    return this;\n  }\n\n  unlink() {\n    let pos;\n    const inode = this.inputNode;\n    const onode = this.outputNode;\n\n    if (!(inode && onode)) {\n      return;\n    }\n\n    pos = inode.edges.indexOf(this);\n    if (pos > -1) {\n      inode.edges.splice(pos, 1);\n    }\n\n    pos = onode.edges.indexOf(this);\n    if (pos > -1) {\n      onode.edges.splice(pos, 1);\n    }\n\n    pos = inode.outputEdges.indexOf(this);\n    if (pos > -1) {\n      inode.outputEdges.splice(pos, 1);\n    }\n\n    pos = onode.inputEdges.indexOf(this);\n    if (pos > -1) {\n      onode.inputEdges.splice(pos, 1);\n    }\n\n    this.inputNode = null;\n    this.outputNode = null;\n  }\n}\n\nexport class Node {\n  name: string;\n  edges: Edge[];\n  inputEdges: Edge[];\n  outputEdges: Edge[];\n\n  constructor(name: string) {\n    this.name = name;\n    this.edges = [];\n    this.inputEdges = [];\n    this.outputEdges = [];\n  }\n\n  getEdgeFrom(from: string | Node): Edge {\n    if (!from) {\n      return null;\n    }\n\n    if (typeof from === 'object') {\n      return this.inputEdges.find(e => e.inputNode.name === from.name);\n    }\n\n    return this.inputEdges.find(e => e.inputNode.name === from);\n  }\n\n  getEdgeTo(to: string | Node): Edge {\n    if (!to) {\n      return null;\n    }\n\n    if (typeof to === 'object') {\n      return this.outputEdges.find(e => e.outputNode.name === to.name);\n    }\n\n    return this.outputEdges.find(e => e.outputNode.name === to);\n  }\n\n  getOptimizedInputEdges(): Edge[] {\n    const toBeRemoved = [];\n    this.inputEdges.forEach(e => {\n      const inputEdgesNodes = e.inputNode.inputEdges.map(e => e.inputNode);\n\n      inputEdgesNodes.forEach(n => {\n        const edgeToRemove = n.getEdgeTo(this.name);\n        if (edgeToRemove) {\n          toBeRemoved.push(edgeToRemove);\n        }\n      });\n    });\n\n    return this.inputEdges.filter(e => toBeRemoved.indexOf(e) === -1);\n  }\n}\n\nexport class Graph {\n  nodes = {};\n\n  constructor() {}\n\n  createNode(name: string): Node {\n    const n = new Node(name);\n    this.nodes[name] = n;\n    return n;\n  }\n\n  createNodes(names: string[]): Node[] {\n    const nodes = [];\n    names.forEach(name => {\n      nodes.push(this.createNode(name));\n    });\n    return nodes;\n  }\n\n  link(input: string | string[] | Node | Node[], output: string | string[] | Node | Node[]): Edge[] {\n    let inputArr = [];\n    let outputArr = [];\n    const inputNodes = [];\n    const outputNodes = [];\n\n    if (input instanceof Array) {\n      inputArr = input;\n    } else {\n      inputArr = [input];\n    }\n\n    if (output instanceof Array) {\n      outputArr = output;\n    } else {\n      outputArr = [output];\n    }\n\n    for (let n = 0; n < inputArr.length; n++) {\n      const i = inputArr[n];\n      if (typeof i === 'string') {\n        const n = this.getNode(i);\n        if (!n) {\n          throw Error(`cannot link input node named ${i} since it doesn't exist in graph`);\n        }\n        inputNodes.push(n);\n      } else {\n        inputNodes.push(i);\n      }\n    }\n\n    for (let n = 0; n < outputArr.length; n++) {\n      const i = outputArr[n];\n      if (typeof i === 'string') {\n        const n = this.getNode(i);\n        if (!n) {\n          throw Error(`cannot link output node named ${i} since it doesn't exist in graph`);\n        }\n        outputNodes.push(n);\n      } else {\n        outputNodes.push(i);\n      }\n    }\n\n    const edges = [];\n    inputNodes.forEach(input => {\n      outputNodes.forEach(output => {\n        edges.push(this.createEdge().link(input, output));\n      });\n    });\n    return edges;\n  }\n\n  createEdge(): Edge {\n    return new Edge();\n  }\n\n  getNode(name: string): Node {\n    return this.nodes[name];\n  }\n}\n\nexport const printGraph = (g: Graph) => {\n  Object.keys(g.nodes).forEach(name => {\n    const n = g.nodes[name];\n    let outputEdges = n.outputEdges.map(e => e.outputNode.name).join(', ');\n    if (!outputEdges) {\n      outputEdges = '<none>';\n    }\n    let inputEdges = n.inputEdges.map(e => e.inputNode.name).join(', ');\n    if (!inputEdges) {\n      inputEdges = '<none>';\n    }\n    console.log(`${n.name}:\\n - links to:   ${outputEdges}\\n - links from: ${inputEdges}`);\n  });\n};\n","import angular from 'angular';\nimport _ from 'lodash';\nimport coreModule from 'app/core/core_module';\nimport { variableTypes } from './variable';\nimport { Graph } from 'app/core/utils/dag';\n\nexport class VariableSrv {\n  dashboard: any;\n  variables: any;\n\n  /** @ngInject */\n  constructor(private $rootScope, private $q, private $location, private $injector, private templateSrv) {\n    // update time variant variables\n    $rootScope.$on('refresh', this.onDashboardRefresh.bind(this), $rootScope);\n    $rootScope.$on('template-variable-value-updated', this.updateUrlParamsWithCurrentVariables.bind(this), $rootScope);\n  }\n\n  init(dashboard) {\n    this.dashboard = dashboard;\n\n    // create working class models representing variables\n    this.variables = dashboard.templating.list = dashboard.templating.list.map(this.createVariableFromModel.bind(this));\n    this.templateSrv.init(this.variables);\n\n    // init variables\n    for (const variable of this.variables) {\n      variable.initLock = this.$q.defer();\n    }\n\n    const queryParams = this.$location.search();\n    return this.$q\n      .all(\n        this.variables.map(variable => {\n          return this.processVariable(variable, queryParams);\n        })\n      )\n      .then(() => {\n        this.templateSrv.updateTemplateData();\n      });\n  }\n\n  onDashboardRefresh(evt, payload) {\n    if (payload && payload.fromVariableValueUpdated) {\n      return Promise.resolve({});\n    }\n\n    const promises = this.variables.filter(variable => variable.refresh === 2).map(variable => {\n      const previousOptions = variable.options.slice();\n\n      return variable.updateOptions().then(() => {\n        if (angular.toJson(previousOptions) !== angular.toJson(variable.options)) {\n          this.$rootScope.$emit('template-variable-value-updated');\n        }\n      });\n    });\n\n    return this.$q.all(promises);\n  }\n\n  processVariable(variable, queryParams) {\n    const dependencies = [];\n\n    for (const otherVariable of this.variables) {\n      if (variable.dependsOn(otherVariable)) {\n        dependencies.push(otherVariable.initLock.promise);\n      }\n    }\n\n    return this.$q\n      .all(dependencies)\n      .then(() => {\n        const urlValue = queryParams['var-' + variable.name];\n        if (urlValue !== void 0) {\n          return variable.setValueFromUrl(urlValue).then(variable.initLock.resolve);\n        }\n\n        if (variable.refresh === 1 || variable.refresh === 2) {\n          return variable.updateOptions().then(variable.initLock.resolve);\n        }\n\n        variable.initLock.resolve();\n      })\n      .finally(() => {\n        this.templateSrv.variableInitialized(variable);\n        delete variable.initLock;\n      });\n  }\n\n  createVariableFromModel(model) {\n    const ctor = variableTypes[model.type].ctor;\n    if (!ctor) {\n      throw {\n        message: 'Unable to find variable constructor for ' + model.type,\n      };\n    }\n\n    const variable = this.$injector.instantiate(ctor, { model: model });\n    return variable;\n  }\n\n  addVariable(variable) {\n    this.variables.push(variable);\n    this.templateSrv.updateTemplateData();\n    this.dashboard.updateSubmenuVisibility();\n  }\n\n  removeVariable(variable) {\n    const index = _.indexOf(this.variables, variable);\n    this.variables.splice(index, 1);\n    this.templateSrv.updateTemplateData();\n    this.dashboard.updateSubmenuVisibility();\n  }\n\n  updateOptions(variable) {\n    return variable.updateOptions();\n  }\n\n  variableUpdated(variable, emitChangeEvents?) {\n    // if there is a variable lock ignore cascading update because we are in a boot up scenario\n    if (variable.initLock) {\n      return this.$q.when();\n    }\n\n    const g = this.createGraph();\n    const node = g.getNode(variable.name);\n    let promises = [];\n    if (node) {\n      promises = node.getOptimizedInputEdges().map(e => {\n        return this.updateOptions(this.variables.find(v => v.name === e.inputNode.name));\n      });\n    }\n\n    return this.$q.all(promises).then(() => {\n      if (emitChangeEvents) {\n        this.$rootScope.$emit('template-variable-value-updated');\n        this.$rootScope.$broadcast('refresh', { fromVariableValueUpdated: true });\n      }\n    });\n  }\n\n  selectOptionsForCurrentValue(variable) {\n    let i, y, value, option;\n    const selected: any = [];\n\n    for (i = 0; i < variable.options.length; i++) {\n      option = variable.options[i];\n      option.selected = false;\n      if (_.isArray(variable.current.value)) {\n        for (y = 0; y < variable.current.value.length; y++) {\n          value = variable.current.value[y];\n          if (option.value === value) {\n            option.selected = true;\n            selected.push(option);\n          }\n        }\n      } else if (option.value === variable.current.value) {\n        option.selected = true;\n        selected.push(option);\n      }\n    }\n\n    return selected;\n  }\n\n  validateVariableSelectionState(variable) {\n    if (!variable.current) {\n      variable.current = {};\n    }\n\n    if (_.isArray(variable.current.value)) {\n      let selected = this.selectOptionsForCurrentValue(variable);\n\n      // if none pick first\n      if (selected.length === 0) {\n        selected = variable.options[0];\n      } else {\n        selected = {\n          value: _.map(selected, val => {\n            return val.value;\n          }),\n          text: _.map(selected, val => {\n            return val.text;\n          }).join(' + '),\n        };\n      }\n\n      return variable.setValue(selected);\n    } else {\n      const currentOption = _.find(variable.options, {\n        text: variable.current.text,\n      });\n      if (currentOption) {\n        return variable.setValue(currentOption);\n      } else {\n        if (!variable.options.length) {\n          return Promise.resolve();\n        }\n        return variable.setValue(variable.options[0]);\n      }\n    }\n  }\n\n  setOptionFromUrl(variable, urlValue) {\n    let promise = this.$q.when();\n\n    if (variable.refresh) {\n      promise = variable.updateOptions();\n    }\n\n    return promise.then(() => {\n      let option = _.find(variable.options, op => {\n        return op.text === urlValue || op.value === urlValue;\n      });\n\n      let defaultText = urlValue;\n      const defaultValue = urlValue;\n\n      if (!option && _.isArray(urlValue)) {\n        defaultText = [];\n\n        for (let n = 0; n < urlValue.length; n++) {\n          const t = _.find(variable.options, op => {\n            return op.value === urlValue[n];\n          });\n\n          if (t) {\n            defaultText.push(t.text);\n          }\n        }\n      }\n\n      option = option || { text: defaultText, value: defaultValue };\n      return variable.setValue(option);\n    });\n  }\n\n  setOptionAsCurrent(variable, option) {\n    variable.current = _.cloneDeep(option);\n\n    if (_.isArray(variable.current.text)) {\n      variable.current.text = variable.current.text.join(' + ');\n    }\n\n    this.selectOptionsForCurrentValue(variable);\n    return this.variableUpdated(variable);\n  }\n\n  updateUrlParamsWithCurrentVariables() {\n    // update url\n    const params = this.$location.search();\n\n    // remove variable params\n    _.each(params, (value, key) => {\n      if (key.indexOf('var-') === 0) {\n        delete params[key];\n      }\n    });\n\n    // add new values\n    this.templateSrv.fillVariableValuesForUrl(params);\n    // update url\n    this.$location.search(params);\n  }\n\n  setAdhocFilter(options) {\n    let variable = _.find(this.variables, {\n      type: 'adhoc',\n      datasource: options.datasource,\n    });\n    if (!variable) {\n      variable = this.createVariableFromModel({\n        name: 'Filters',\n        type: 'adhoc',\n        datasource: options.datasource,\n      });\n      this.addVariable(variable);\n    }\n\n    const filters = variable.filters;\n    let filter = _.find(filters, { key: options.key, value: options.value });\n\n    if (!filter) {\n      filter = { key: options.key, value: options.value };\n      filters.push(filter);\n    }\n\n    filter.operator = options.operator;\n    this.variableUpdated(variable, true);\n  }\n\n  createGraph() {\n    const g = new Graph();\n\n    this.variables.forEach(v => {\n      g.createNode(v.name);\n    });\n\n    this.variables.forEach(v1 => {\n      this.variables.forEach(v2 => {\n        if (v1 === v2) {\n          return;\n        }\n\n        if (v1.dependsOn(v2)) {\n          g.link(v1.name, v2.name);\n        }\n      });\n    });\n\n    return g;\n  }\n}\n\ncoreModule.service('variableSrv', VariableSrv);\n","import _ from 'lodash';\nimport kbn from 'app/core/utils/kbn';\nimport { Variable, assignModelProperties, variableTypes } from './variable';\n\nexport class IntervalVariable implements Variable {\n  name: string;\n  auto_count: number; // tslint:disable-line variable-name\n  auto_min: number; // tslint:disable-line variable-name\n  options: any;\n  auto: boolean;\n  query: string;\n  refresh: number;\n  current: any;\n  skipUrlSync: boolean;\n\n  defaults = {\n    type: 'interval',\n    name: '',\n    hide: 0,\n    label: '',\n    refresh: 2,\n    options: [],\n    current: {},\n    query: '1m,10m,30m,1h,6h,12h,1d,7d,14d,30d',\n    auto: false,\n    auto_min: '10s',\n    auto_count: 30,\n    skipUrlSync: false,\n  };\n\n  /** @ngInject */\n  constructor(private model, private timeSrv, private templateSrv, private variableSrv) {\n    assignModelProperties(this, model, this.defaults);\n    this.refresh = 2;\n  }\n\n  getSaveModel() {\n    assignModelProperties(this.model, this, this.defaults);\n    return this.model;\n  }\n\n  setValue(option) {\n    this.updateAutoValue();\n    return this.variableSrv.setOptionAsCurrent(this, option);\n  }\n\n  updateAutoValue() {\n    if (!this.auto) {\n      return;\n    }\n\n    // add auto option if missing\n    if (this.options.length && this.options[0].text !== 'auto') {\n      this.options.unshift({\n        text: 'auto',\n        value: '$__auto_interval_' + this.name,\n      });\n    }\n\n    const res = kbn.calculateInterval(this.timeSrv.timeRange(), this.auto_count, this.auto_min);\n    this.templateSrv.setGrafanaVariable('$__auto_interval_' + this.name, res.interval);\n    // for backward compatibility, to be removed eventually\n    this.templateSrv.setGrafanaVariable('$__auto_interval', res.interval);\n  }\n\n  updateOptions() {\n    // extract options between quotes and/or comma\n    this.options = _.map(this.query.match(/([\"'])(.*?)\\1|\\w+/g), text => {\n      text = text.replace(/[\"']+/g, '');\n      return { text: text.trim(), value: text.trim() };\n    });\n\n    this.updateAutoValue();\n    return this.variableSrv.validateVariableSelectionState(this);\n  }\n\n  dependsOn(variable) {\n    return false;\n  }\n\n  setValueFromUrl(urlValue) {\n    this.updateAutoValue();\n    return this.variableSrv.setOptionFromUrl(this, urlValue);\n  }\n\n  getValueForUrl() {\n    return this.current.value;\n  }\n}\n\nvariableTypes['interval'] = {\n  name: 'Interval',\n  ctor: IntervalVariable,\n  description: 'Define a timespan interval (ex 1m, 1h, 1d)',\n};\n","import _ from 'lodash';\nimport kbn from 'app/core/utils/kbn';\nimport { Variable, containsVariable, assignModelProperties, variableTypes } from './variable';\n\nfunction getNoneOption() {\n  return { text: 'None', value: '', isNone: true };\n}\n\nexport class QueryVariable implements Variable {\n  datasource: any;\n  query: any;\n  regex: any;\n  sort: any;\n  options: any;\n  current: any;\n  refresh: number;\n  hide: number;\n  name: string;\n  multi: boolean;\n  includeAll: boolean;\n  useTags: boolean;\n  tagsQuery: string;\n  tagValuesQuery: string;\n  tags: any[];\n  skipUrlSync: boolean;\n\n  defaults = {\n    type: 'query',\n    label: null,\n    query: '',\n    regex: '',\n    sort: 0,\n    datasource: null,\n    refresh: 0,\n    hide: 0,\n    name: '',\n    multi: false,\n    includeAll: false,\n    allValue: null,\n    options: [],\n    current: {},\n    tags: [],\n    useTags: false,\n    tagsQuery: '',\n    tagValuesQuery: '',\n    skipUrlSync: false,\n  };\n\n  /** @ngInject */\n  constructor(private model, private datasourceSrv, private templateSrv, private variableSrv, private timeSrv) {\n    // copy model properties to this instance\n    assignModelProperties(this, model, this.defaults);\n  }\n\n  getSaveModel() {\n    // copy back model properties to model\n    assignModelProperties(this.model, this, this.defaults);\n\n    // remove options\n    if (this.refresh !== 0) {\n      this.model.options = [];\n    }\n\n    return this.model;\n  }\n\n  setValue(option) {\n    return this.variableSrv.setOptionAsCurrent(this, option);\n  }\n\n  setValueFromUrl(urlValue) {\n    return this.variableSrv.setOptionFromUrl(this, urlValue);\n  }\n\n  getValueForUrl() {\n    if (this.current.text === 'All') {\n      return 'All';\n    }\n    return this.current.value;\n  }\n\n  updateOptions() {\n    return this.datasourceSrv\n      .get(this.datasource)\n      .then(this.updateOptionsFromMetricFindQuery.bind(this))\n      .then(this.updateTags.bind(this))\n      .then(this.variableSrv.validateVariableSelectionState.bind(this.variableSrv, this));\n  }\n\n  updateTags(datasource) {\n    if (this.useTags) {\n      return this.metricFindQuery(datasource, this.tagsQuery).then(results => {\n        this.tags = [];\n        for (let i = 0; i < results.length; i++) {\n          this.tags.push(results[i].text);\n        }\n        return datasource;\n      });\n    } else {\n      delete this.tags;\n    }\n\n    return datasource;\n  }\n\n  getValuesForTag(tagKey) {\n    return this.datasourceSrv.get(this.datasource).then(datasource => {\n      const query = this.tagValuesQuery.replace('$tag', tagKey);\n      return this.metricFindQuery(datasource, query).then(results => {\n        return _.map(results, value => {\n          return value.text;\n        });\n      });\n    });\n  }\n\n  updateOptionsFromMetricFindQuery(datasource) {\n    return this.metricFindQuery(datasource, this.query).then(results => {\n      this.options = this.metricNamesToVariableValues(results);\n      if (this.includeAll) {\n        this.addAllOption();\n      }\n      if (!this.options.length) {\n        this.options.push(getNoneOption());\n      }\n      return datasource;\n    });\n  }\n\n  metricFindQuery(datasource, query) {\n    const options = { range: undefined, variable: this };\n\n    if (this.refresh === 2) {\n      options.range = this.timeSrv.timeRange();\n    }\n\n    return datasource.metricFindQuery(query, options);\n  }\n\n  addAllOption() {\n    this.options.unshift({ text: 'All', value: '$__all' });\n  }\n\n  metricNamesToVariableValues(metricNames) {\n    let regex, options, i, matches;\n    options = [];\n\n    if (this.regex) {\n      regex = kbn.stringToJsRegex(this.templateSrv.replace(this.regex, {}, 'regex'));\n    }\n    for (i = 0; i < metricNames.length; i++) {\n      const item = metricNames[i];\n      let text = item.text === undefined || item.text === null ? item.value : item.text;\n\n      let value = item.value === undefined || item.value === null ? item.text : item.value;\n\n      if (_.isNumber(value)) {\n        value = value.toString();\n      }\n\n      if (_.isNumber(text)) {\n        text = text.toString();\n      }\n\n      if (regex) {\n        matches = regex.exec(value);\n        if (!matches) {\n          continue;\n        }\n        if (matches.length > 1) {\n          value = matches[1];\n          text = matches[1];\n        }\n      }\n\n      options.push({ text: text, value: value });\n    }\n\n    options = _.uniqBy(options, 'value');\n    return this.sortVariableValues(options, this.sort);\n  }\n\n  sortVariableValues(options, sortOrder) {\n    if (sortOrder === 0) {\n      return options;\n    }\n\n    const sortType = Math.ceil(sortOrder / 2);\n    const reverseSort = sortOrder % 2 === 0;\n\n    if (sortType === 1) {\n      options = _.sortBy(options, 'text');\n    } else if (sortType === 2) {\n      options = _.sortBy(options, opt => {\n        const matches = opt.text.match(/.*?(\\d+).*/);\n        if (!matches || matches.length < 2) {\n          return -1;\n        } else {\n          return parseInt(matches[1], 10);\n        }\n      });\n    } else if (sortType === 3) {\n      options = _.sortBy(options, opt => {\n        return _.toLower(opt.text);\n      });\n    }\n\n    if (reverseSort) {\n      options = options.reverse();\n    }\n\n    return options;\n  }\n\n  dependsOn(variable) {\n    return containsVariable(this.query, this.datasource, this.regex, variable.name);\n  }\n}\n\nvariableTypes['query'] = {\n  name: 'Query',\n  ctor: QueryVariable,\n  description: 'Variable values are fetched from a datasource query',\n  supportsMulti: true,\n};\n","import kbn from 'app/core/utils/kbn';\nimport { Variable, containsVariable, assignModelProperties, variableTypes } from './variable';\n\nexport class DatasourceVariable implements Variable {\n  regex: any;\n  query: string;\n  options: any;\n  current: any;\n  refresh: any;\n  skipUrlSync: boolean;\n\n  defaults = {\n    type: 'datasource',\n    name: '',\n    hide: 0,\n    label: '',\n    current: {},\n    regex: '',\n    options: [],\n    query: '',\n    refresh: 1,\n    skipUrlSync: false,\n  };\n\n  /** @ngInject */\n  constructor(private model, private datasourceSrv, private variableSrv, private templateSrv) {\n    assignModelProperties(this, model, this.defaults);\n    this.refresh = 1;\n  }\n\n  getSaveModel() {\n    assignModelProperties(this.model, this, this.defaults);\n\n    // don't persist options\n    this.model.options = [];\n    return this.model;\n  }\n\n  setValue(option) {\n    return this.variableSrv.setOptionAsCurrent(this, option);\n  }\n\n  updateOptions() {\n    const options = [];\n    const sources = this.datasourceSrv.getMetricSources({ skipVariables: true });\n    let regex;\n\n    if (this.regex) {\n      regex = this.templateSrv.replace(this.regex, null, 'regex');\n      regex = kbn.stringToJsRegex(regex);\n    }\n\n    for (let i = 0; i < sources.length; i++) {\n      const source = sources[i];\n      // must match on type\n      if (source.meta.id !== this.query) {\n        continue;\n      }\n\n      if (regex && !regex.exec(source.name)) {\n        continue;\n      }\n\n      options.push({ text: source.name, value: source.name });\n    }\n\n    if (options.length === 0) {\n      options.push({ text: 'No data sources found', value: '' });\n    }\n\n    this.options = options;\n    return this.variableSrv.validateVariableSelectionState(this);\n  }\n\n  dependsOn(variable) {\n    if (this.regex) {\n      return containsVariable(this.regex, variable.name);\n    }\n    return false;\n  }\n\n  setValueFromUrl(urlValue) {\n    return this.variableSrv.setOptionFromUrl(this, urlValue);\n  }\n\n  getValueForUrl() {\n    return this.current.value;\n  }\n}\n\nvariableTypes['datasource'] = {\n  name: 'Datasource',\n  ctor: DatasourceVariable,\n  description: 'Enabled you to dynamically switch the datasource for multiple panels',\n};\n","import _ from 'lodash';\nimport { Variable, assignModelProperties, variableTypes } from './variable';\n\nexport class CustomVariable implements Variable {\n  query: string;\n  options: any;\n  includeAll: boolean;\n  multi: boolean;\n  current: any;\n  skipUrlSync: boolean;\n\n  defaults = {\n    type: 'custom',\n    name: '',\n    label: '',\n    hide: 0,\n    options: [],\n    current: {},\n    query: '',\n    includeAll: false,\n    multi: false,\n    allValue: null,\n    skipUrlSync: false,\n  };\n\n  /** @ngInject */\n  constructor(private model, private variableSrv) {\n    assignModelProperties(this, model, this.defaults);\n  }\n\n  setValue(option) {\n    return this.variableSrv.setOptionAsCurrent(this, option);\n  }\n\n  getSaveModel() {\n    assignModelProperties(this.model, this, this.defaults);\n    return this.model;\n  }\n\n  updateOptions() {\n    // extract options in comma separated string\n    this.options = _.map(this.query.split(/[,]+/), text => {\n      return { text: text.trim(), value: text.trim() };\n    });\n\n    if (this.includeAll) {\n      this.addAllOption();\n    }\n\n    return this.variableSrv.validateVariableSelectionState(this);\n  }\n\n  addAllOption() {\n    this.options.unshift({ text: 'All', value: '$__all' });\n  }\n\n  dependsOn(variable) {\n    return false;\n  }\n\n  setValueFromUrl(urlValue) {\n    return this.variableSrv.setOptionFromUrl(this, urlValue);\n  }\n\n  getValueForUrl() {\n    if (this.current.text === 'All') {\n      return 'All';\n    }\n    return this.current.value;\n  }\n}\n\nvariableTypes['custom'] = {\n  name: 'Custom',\n  ctor: CustomVariable,\n  description: 'Define variable values manually',\n  supportsMulti: true,\n};\n","import { Variable, assignModelProperties, variableTypes } from './variable';\n\nexport class ConstantVariable implements Variable {\n  query: string;\n  options: any[];\n  current: any;\n  skipUrlSync: boolean;\n\n  defaults = {\n    type: 'constant',\n    name: '',\n    hide: 2,\n    label: '',\n    query: '',\n    current: {},\n    options: [],\n    skipUrlSync: false,\n  };\n\n  /** @ngInject */\n  constructor(private model, private variableSrv) {\n    assignModelProperties(this, model, this.defaults);\n  }\n\n  getSaveModel() {\n    assignModelProperties(this.model, this, this.defaults);\n    return this.model;\n  }\n\n  setValue(option) {\n    this.variableSrv.setOptionAsCurrent(this, option);\n  }\n\n  updateOptions() {\n    this.options = [{ text: this.query.trim(), value: this.query.trim() }];\n    this.setValue(this.options[0]);\n    return Promise.resolve();\n  }\n\n  dependsOn(variable) {\n    return false;\n  }\n\n  setValueFromUrl(urlValue) {\n    return this.variableSrv.setOptionFromUrl(this, urlValue);\n  }\n\n  getValueForUrl() {\n    return this.current.value;\n  }\n}\n\nvariableTypes['constant'] = {\n  name: 'Constant',\n  ctor: ConstantVariable,\n  description: 'Define a hidden constant variable, useful for metric prefixes in dashboards you want to share',\n};\n","import _ from 'lodash';\nimport { Variable, assignModelProperties, variableTypes } from './variable';\n\nexport class AdhocVariable implements Variable {\n  filters: any[];\n  skipUrlSync: boolean;\n\n  defaults = {\n    type: 'adhoc',\n    name: '',\n    label: '',\n    hide: 0,\n    datasource: null,\n    filters: [],\n    skipUrlSync: false,\n  };\n\n  /** @ngInject */\n  constructor(private model) {\n    assignModelProperties(this, model, this.defaults);\n  }\n\n  setValue(option) {\n    return Promise.resolve();\n  }\n\n  getSaveModel() {\n    assignModelProperties(this.model, this, this.defaults);\n    return this.model;\n  }\n\n  updateOptions() {\n    return Promise.resolve();\n  }\n\n  dependsOn(variable) {\n    return false;\n  }\n\n  setValueFromUrl(urlValue) {\n    if (!_.isArray(urlValue)) {\n      urlValue = [urlValue];\n    }\n\n    this.filters = urlValue.map(item => {\n      const values = item.split('|').map(value => {\n        return this.unescapeDelimiter(value);\n      });\n      return {\n        key: values[0],\n        operator: values[1],\n        value: values[2],\n      };\n    });\n\n    return Promise.resolve();\n  }\n\n  getValueForUrl() {\n    return this.filters.map(filter => {\n      return [filter.key, filter.operator, filter.value]\n        .map(value => {\n          return this.escapeDelimiter(value);\n        })\n        .join('|');\n    });\n  }\n\n  escapeDelimiter(value) {\n    return value.replace(/\\|/g, '__gfp__');\n  }\n\n  unescapeDelimiter(value) {\n    return value.replace(/__gfp__/g, '|');\n  }\n\n  setFilters(filters: any[]) {\n    this.filters = filters;\n  }\n}\n\nvariableTypes['adhoc'] = {\n  name: 'Ad hoc filters',\n  ctor: AdhocVariable,\n  description: 'Add key/value filters on the fly',\n};\n","import { Variable, assignModelProperties, variableTypes } from './variable';\n\nexport class TextBoxVariable implements Variable {\n  query: string;\n  current: any;\n  options: any[];\n  skipUrlSync: boolean;\n\n  defaults = {\n    type: 'textbox',\n    name: '',\n    hide: 2,\n    label: '',\n    query: '',\n    current: {},\n    options: [],\n    skipUrlSync: false,\n  };\n\n  /** @ngInject */\n  constructor(private model, private variableSrv) {\n    assignModelProperties(this, model, this.defaults);\n  }\n\n  getSaveModel() {\n    assignModelProperties(this.model, this, this.defaults);\n    return this.model;\n  }\n\n  setValue(option) {\n    this.variableSrv.setOptionAsCurrent(this, option);\n  }\n\n  updateOptions() {\n    this.options = [{ text: this.query.trim(), value: this.query.trim() }];\n    this.current = this.options[0];\n    return Promise.resolve();\n  }\n\n  dependsOn(variable) {\n    return false;\n  }\n\n  setValueFromUrl(urlValue) {\n    this.query = urlValue;\n    return this.variableSrv.setOptionFromUrl(this, urlValue);\n  }\n\n  getValueForUrl() {\n    return this.current.value;\n  }\n}\n\nvariableTypes['textbox'] = {\n  name: 'Text box',\n  ctor: TextBoxVariable,\n  description: 'Define a textbox variable, where users can enter any arbitrary string',\n};\n","import angular from 'angular';\nimport _ from 'lodash';\nimport Remarkable from 'remarkable';\n\nexport class PluginEditCtrl {\n  model: any;\n  pluginIcon: string;\n  pluginId: any;\n  includes: any;\n  readmeHtml: any;\n  includedDatasources: any;\n  tab: string;\n  navModel: any;\n  hasDashboards: any;\n  preUpdateHook: () => any;\n  postUpdateHook: () => any;\n\n  /** @ngInject */\n  constructor(private $scope, private $rootScope, private backendSrv, private $sce, private $routeParams, navModelSrv) {\n    this.pluginId = $routeParams.pluginId;\n    this.preUpdateHook = () => Promise.resolve();\n    this.postUpdateHook = () => Promise.resolve();\n\n    this.init();\n  }\n\n  setNavModel(model) {\n    let defaultTab = 'readme';\n\n    this.navModel = {\n      main: {\n        img: model.info.logos.large,\n        subTitle: model.info.author.name,\n        url: '',\n        text: model.name,\n        breadcrumbs: [{ title: 'Plugins', url: 'plugins' }],\n        children: [\n          {\n            icon: 'fa fa-fw fa-file-text-o',\n            id: 'readme',\n            text: 'Readme',\n            url: `plugins/${this.model.id}/edit?tab=readme`,\n          },\n        ],\n      },\n    };\n\n    if (model.type === 'app') {\n      this.navModel.main.children.push({\n        icon: 'gicon gicon-cog',\n        id: 'config',\n        text: 'Config',\n        url: `plugins/${this.model.id}/edit?tab=config`,\n      });\n\n      const hasDashboards = _.find(model.includes, { type: 'dashboard' });\n\n      if (hasDashboards) {\n        this.navModel.main.children.push({\n          icon: 'gicon gicon-dashboard',\n          id: 'dashboards',\n          text: 'Dashboards',\n          url: `plugins/${this.model.id}/edit?tab=dashboards`,\n        });\n      }\n\n      defaultTab = 'config';\n    }\n\n    this.tab = this.$routeParams.tab || defaultTab;\n\n    for (const tab of this.navModel.main.children) {\n      if (tab.id === this.tab) {\n        tab.active = true;\n      }\n    }\n  }\n\n  init() {\n    return this.backendSrv.get(`/api/plugins/${this.pluginId}/settings`).then(result => {\n      this.model = result;\n      this.pluginIcon = this.getPluginIcon(this.model.type);\n\n      this.model.dependencies.plugins.forEach(plug => {\n        plug.icon = this.getPluginIcon(plug.type);\n      });\n\n      this.includes = _.map(result.includes, plug => {\n        plug.icon = this.getPluginIcon(plug.type);\n        return plug;\n      });\n\n      this.setNavModel(this.model);\n      return this.initReadme();\n    });\n  }\n\n  initReadme() {\n    return this.backendSrv.get(`/api/plugins/${this.pluginId}/markdown/readme`).then(res => {\n      const md = new Remarkable({\n        linkify: true,\n      });\n      this.readmeHtml = this.$sce.trustAsHtml(md.render(res));\n    });\n  }\n\n  getPluginIcon(type) {\n    switch (type) {\n      case 'datasource':\n        return 'icon-gf icon-gf-datasources';\n      case 'panel':\n        return 'icon-gf icon-gf-panel';\n      case 'app':\n        return 'icon-gf icon-gf-apps';\n      case 'page':\n        return 'icon-gf icon-gf-endpoint-tiny';\n      case 'dashboard':\n        return 'icon-gf icon-gf-dashboard';\n      default:\n        return 'icon-gf icon-gf-apps';\n    }\n  }\n\n  update() {\n    this.preUpdateHook()\n      .then(() => {\n        const updateCmd = _.extend(\n          {\n            enabled: this.model.enabled,\n            pinned: this.model.pinned,\n            jsonData: this.model.jsonData,\n            secureJsonData: this.model.secureJsonData,\n          },\n          {}\n        );\n        return this.backendSrv.post(`/api/plugins/${this.pluginId}/settings`, updateCmd);\n      })\n      .then(this.postUpdateHook)\n      .then(res => {\n        window.location.href = window.location.href;\n      });\n  }\n\n  importDashboards() {\n    return Promise.resolve();\n  }\n\n  setPreUpdateHook(callback: () => any) {\n    this.preUpdateHook = callback;\n  }\n\n  setPostUpdateHook(callback: () => any) {\n    this.postUpdateHook = callback;\n  }\n\n  updateAvailable() {\n    const modalScope = this.$scope.$new(true);\n    modalScope.plugin = this.model;\n\n    this.$rootScope.appEvent('show-modal', {\n      src: 'public/app/features/plugins/partials/update_instructions.html',\n      scope: modalScope,\n    });\n  }\n\n  enable() {\n    this.model.enabled = true;\n    this.model.pinned = true;\n    this.update();\n  }\n\n  disable() {\n    this.model.enabled = false;\n    this.model.pinned = false;\n    this.update();\n  }\n}\n\nangular.module('grafana.controllers').controller('PluginEditCtrl', PluginEditCtrl);\n","import './editor_ctrl';\nimport coreModule from 'app/core/core_module';\n\nimport templateSrv from './template_srv';\nimport { VariableSrv } from './variable_srv';\nimport { IntervalVariable } from './interval_variable';\nimport { QueryVariable } from './query_variable';\nimport { DatasourceVariable } from './datasource_variable';\nimport { CustomVariable } from './custom_variable';\nimport { ConstantVariable } from './constant_variable';\nimport { AdhocVariable } from './adhoc_variable';\nimport { TextBoxVariable } from './TextBoxVariable';\n\ncoreModule.factory('templateSrv', () => {\n  return templateSrv;\n});\n\nexport {\n  VariableSrv,\n  IntervalVariable,\n  QueryVariable,\n  DatasourceVariable,\n  CustomVariable,\n  ConstantVariable,\n  AdhocVariable,\n  TextBoxVariable,\n};\n","import angular from 'angular';\nimport _ from 'lodash';\n\nconst pluginInfoCache = {};\n\nexport class AppPageCtrl {\n  page: any;\n  pluginId: any;\n  appModel: any;\n  navModel: any;\n\n  /** @ngInject */\n  constructor(private backendSrv, private $routeParams: any, private $rootScope, private navModelSrv) {\n    this.pluginId = $routeParams.pluginId;\n\n    if (pluginInfoCache[this.pluginId]) {\n      this.initPage(pluginInfoCache[this.pluginId]);\n    } else {\n      this.loadPluginInfo();\n    }\n  }\n\n  initPage(app) {\n    this.appModel = app;\n    this.page = _.find(app.includes, { slug: this.$routeParams.slug });\n\n    pluginInfoCache[this.pluginId] = app;\n\n    if (!this.page) {\n      this.$rootScope.appEvent('alert-error', ['App Page Not Found', '']);\n\n      this.navModel = this.navModelSrv.getNotFoundNav();\n      return;\n    }\n\n    const pluginNav = this.navModelSrv.getNav('plugin-page-' + app.id);\n\n    this.navModel = {\n      main: {\n        img: app.info.logos.large,\n        subTitle: app.name,\n        url: '',\n        text: this.page.name,\n        breadcrumbs: [{ title: app.name, url: pluginNav.main.url }],\n      },\n    };\n  }\n\n  loadPluginInfo() {\n    this.backendSrv.get(`/api/plugins/${this.pluginId}/settings`).then(app => {\n      this.initPage(app);\n    });\n  }\n}\n\nangular.module('grafana.controllers').controller('AppPageCtrl', AppPageCtrl);\n","import _ from 'lodash';\nimport coreModule from 'app/core/core_module';\nimport appEvents from 'app/core/app_events';\n\nexport class DashImportListCtrl {\n  dashboards: any[];\n  plugin: any;\n  datasource: any;\n\n  /** @ngInject */\n  constructor($scope, private backendSrv, private $rootScope) {\n    this.dashboards = [];\n\n    backendSrv.get(`/api/plugins/${this.plugin.id}/dashboards`).then(dashboards => {\n      this.dashboards = dashboards;\n    });\n\n    appEvents.on('dashboard-list-import-all', this.importAll.bind(this), $scope);\n  }\n\n  importAll(payload) {\n    return this.importNext(0)\n      .then(() => {\n        payload.resolve('All dashboards imported');\n      })\n      .catch(err => {\n        payload.reject(err);\n      });\n  }\n\n  importNext(index) {\n    return this.import(this.dashboards[index], true).then(() => {\n      if (index + 1 < this.dashboards.length) {\n        return new Promise(resolve => {\n          setTimeout(() => {\n            this.importNext(index + 1).then(() => {\n              resolve();\n            });\n          }, 500);\n        });\n      } else {\n        return Promise.resolve();\n      }\n    });\n  }\n\n  import(dash, overwrite) {\n    const installCmd = {\n      pluginId: this.plugin.id,\n      path: dash.path,\n      overwrite: overwrite,\n      inputs: [],\n    };\n\n    if (this.datasource) {\n      installCmd.inputs.push({\n        name: '*',\n        type: 'datasource',\n        pluginId: this.datasource.type,\n        value: this.datasource.name,\n      });\n    }\n\n    return this.backendSrv.post(`/api/dashboards/import`, installCmd).then(res => {\n      this.$rootScope.appEvent('alert-success', ['Dashboard Imported', dash.title]);\n      _.extend(dash, res);\n    });\n  }\n\n  remove(dash) {\n    this.backendSrv.delete('/api/dashboards/' + dash.importedUri).then(() => {\n      this.$rootScope.appEvent('alert-success', ['Dashboard Deleted', dash.title]);\n      dash.imported = false;\n    });\n  }\n}\n\nexport function dashboardImportList() {\n  return {\n    restrict: 'E',\n    templateUrl: 'public/app/features/plugins/import_list/import_list.html',\n    controller: DashImportListCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: {\n      plugin: '=',\n      datasource: '=',\n    },\n  };\n}\n\ncoreModule.directive('dashboardImportList', dashboardImportList);\n","import _ from 'lodash';\nimport { DataSource, PluginMeta, NavModel } from 'app/types';\n\nexport function buildNavModel(ds: DataSource, plugin: PluginMeta, currentPage: string): NavModel {\n  let title = 'New';\n  const subTitle = `Type: ${plugin.name}`;\n\n  if (ds.id) {\n    title = ds.name;\n  }\n\n  const main = {\n    img: plugin.info.logos.large,\n    id: 'ds-edit-' + plugin.id,\n    subTitle: subTitle,\n    url: '',\n    text: title,\n    breadcrumbs: [{ title: 'Data Sources', url: 'datasources' }],\n    children: [\n      {\n        active: currentPage === 'datasource-settings',\n        icon: 'fa fa-fw fa-sliders',\n        id: 'datasource-settings',\n        text: 'Settings',\n        url: `datasources/edit/${ds.id}`,\n      },\n    ],\n  };\n\n  const hasDashboards = _.find(plugin.includes, { type: 'dashboard' }) !== undefined;\n  if (hasDashboards && ds.id) {\n    main.children.push({\n      active: currentPage === 'datasource-dashboards',\n      icon: 'fa fa-fw fa-th-large',\n      id: 'datasource-dashboards',\n      text: 'Dashboards',\n      url: `datasources/edit/${ds.id}/dashboards`,\n    });\n  }\n\n  return {\n    main: main,\n    node: _.find(main.children, { active: true }),\n  };\n}\n","import _ from 'lodash';\nimport config from 'app/core/config';\nimport { coreModule, appEvents } from 'app/core/core';\nimport { store } from 'app/store/configureStore';\nimport { getNavModel } from 'app/core/selectors/navModel';\nimport { buildNavModel } from './state/navModel';\n\nlet datasourceTypes = [];\n\nconst defaults = {\n  name: '',\n  type: 'graphite',\n  url: '',\n  access: 'proxy',\n  jsonData: {},\n  secureJsonFields: {},\n  secureJsonData: {},\n};\n\nlet datasourceCreated = false;\n\nexport class DataSourceEditCtrl {\n  isNew: boolean;\n  datasources: any[];\n  current: any;\n  types: any;\n  testing: any;\n  datasourceMeta: any;\n  editForm: any;\n  gettingStarted: boolean;\n  navModel: any;\n\n  /** @ngInject */\n  constructor(private $q, private backendSrv, private $routeParams, private $location, private datasourceSrv) {\n    const state = store.getState();\n    this.navModel = getNavModel(state.navIndex, 'datasources');\n    this.datasources = [];\n\n    this.loadDatasourceTypes().then(() => {\n      if (this.$routeParams.id) {\n        this.getDatasourceById(this.$routeParams.id);\n      } else {\n        this.initNewDatasourceModel();\n      }\n    });\n  }\n\n  initNewDatasourceModel() {\n    this.isNew = true;\n    this.current = _.cloneDeep(defaults);\n\n    // We are coming from getting started\n    if (this.$location.search().gettingstarted) {\n      this.gettingStarted = true;\n      this.current.isDefault = true;\n    }\n\n    this.typeChanged();\n  }\n\n  loadDatasourceTypes() {\n    if (datasourceTypes.length > 0) {\n      this.types = datasourceTypes;\n      return this.$q.when(null);\n    }\n\n    return this.backendSrv.get('/api/plugins', { enabled: 1, type: 'datasource' }).then(plugins => {\n      datasourceTypes = plugins;\n      this.types = plugins;\n    });\n  }\n\n  getDatasourceById(id) {\n    this.backendSrv.get('/api/datasources/' + id).then(ds => {\n      this.isNew = false;\n      this.current = ds;\n\n      if (datasourceCreated) {\n        datasourceCreated = false;\n        this.testDatasource();\n      }\n\n      return this.typeChanged();\n    });\n  }\n\n  userChangedType() {\n    // reset model but keep name & default flag\n    this.current = _.defaults(\n      {\n        id: this.current.id,\n        name: this.current.name,\n        isDefault: this.current.isDefault,\n        type: this.current.type,\n      },\n      _.cloneDeep(defaults)\n    );\n    this.typeChanged();\n  }\n\n  updateNav() {\n    this.navModel = buildNavModel(this.current, this.datasourceMeta, 'datasource-settings');\n  }\n\n  typeChanged() {\n    return this.backendSrv.get('/api/plugins/' + this.current.type + '/settings').then(pluginInfo => {\n      this.datasourceMeta = pluginInfo;\n      this.updateNav();\n    });\n  }\n\n  updateFrontendSettings() {\n    return this.backendSrv.get('/api/frontend/settings').then(settings => {\n      config.datasources = settings.datasources;\n      config.defaultDatasource = settings.defaultDatasource;\n      this.datasourceSrv.init();\n    });\n  }\n\n  testDatasource() {\n    this.datasourceSrv.get(this.current.name).then(datasource => {\n      if (!datasource.testDatasource) {\n        return;\n      }\n\n      this.testing = { done: false, status: 'error' };\n\n      // make test call in no backend cache context\n      this.backendSrv\n        .withNoBackendCache(() => {\n          return datasource\n            .testDatasource()\n            .then(result => {\n              this.testing.message = result.message;\n              this.testing.status = result.status;\n            })\n            .catch(err => {\n              if (err.statusText) {\n                this.testing.message = 'HTTP Error ' + err.statusText;\n              } else {\n                this.testing.message = err.message;\n              }\n            });\n        })\n        .finally(() => {\n          this.testing.done = true;\n        });\n    });\n  }\n\n  saveChanges() {\n    if (!this.editForm.$valid) {\n      return;\n    }\n\n    if (this.current.readOnly) {\n      return;\n    }\n\n    if (this.current.id) {\n      return this.backendSrv.put('/api/datasources/' + this.current.id, this.current).then(result => {\n        this.current = result.datasource;\n        this.updateNav();\n        this.updateFrontendSettings().then(() => {\n          this.testDatasource();\n        });\n      });\n    } else {\n      return this.backendSrv.post('/api/datasources', this.current).then(result => {\n        this.current = result.datasource;\n        this.updateFrontendSettings();\n\n        datasourceCreated = true;\n        this.$location.path('datasources/edit/' + result.id);\n      });\n    }\n  }\n\n  confirmDelete() {\n    this.backendSrv.delete('/api/datasources/' + this.current.id).then(() => {\n      this.$location.path('datasources');\n    });\n  }\n\n  delete(s) {\n    appEvents.emit('confirm-modal', {\n      title: 'Delete',\n      text: 'Are you sure you want to delete this datasource?',\n      yesText: 'Delete',\n      icon: 'fa-trash',\n      onConfirm: () => {\n        this.confirmDelete();\n      },\n    });\n  }\n}\n\ncoreModule.controller('DataSourceEditCtrl', DataSourceEditCtrl);\n\ncoreModule.directive('datasourceHttpSettings', () => {\n  return {\n    scope: {\n      current: '=',\n      suggestUrl: '@',\n      noDirectAccess: '@',\n    },\n    templateUrl: 'public/app/features/plugins/partials/ds_http_settings.html',\n    link: {\n      pre: ($scope, elem, attrs) => {\n        // do not show access option if direct access is disabled\n        $scope.showAccessOption = $scope.noDirectAccess !== 'true';\n        $scope.showAccessHelp = false;\n        $scope.toggleAccessHelp = () => {\n          $scope.showAccessHelp = !$scope.showAccessHelp;\n        };\n\n        $scope.getSuggestUrls = () => {\n          return [$scope.suggestUrl];\n        };\n      },\n    },\n  };\n});\n","import { coreModule } from 'app/core/core';\nimport { store } from 'app/store/configureStore';\nimport { getNavModel } from 'app/core/selectors/navModel';\nimport { buildNavModel } from './state/navModel';\n\nexport class DataSourceDashboardsCtrl {\n  datasourceMeta: any;\n  navModel: any;\n  current: any;\n\n  /** @ngInject */\n  constructor(private backendSrv, private $routeParams) {\n    const state = store.getState();\n    this.navModel = getNavModel(state.navIndex, 'datasources');\n\n    if (this.$routeParams.id) {\n      this.getDatasourceById(this.$routeParams.id);\n    }\n  }\n\n  getDatasourceById(id) {\n    this.backendSrv\n      .get('/api/datasources/' + id)\n      .then(ds => {\n        this.current = ds;\n      })\n      .then(this.getPluginInfo.bind(this));\n  }\n\n  updateNav() {\n    this.navModel = buildNavModel(this.current, this.datasourceMeta, 'datasource-dashboards');\n  }\n\n  getPluginInfo() {\n    return this.backendSrv.get('/api/plugins/' + this.current.type + '/settings').then(pluginInfo => {\n      this.datasourceMeta = pluginInfo;\n      this.updateNav();\n    });\n  }\n}\n\ncoreModule.controller('DataSourceDashboardsCtrl', DataSourceDashboardsCtrl);\n","import config from 'app/core/config';\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport { appEvents, profiler } from 'app/core/core';\nimport { PanelModel } from 'app/features/dashboard/panel_model';\nimport Remarkable from 'remarkable';\nimport { GRID_CELL_HEIGHT, GRID_CELL_VMARGIN, LS_PANEL_COPY_KEY } from 'app/core/constants';\nimport store from 'app/core/store';\n\nconst TITLE_HEIGHT = 27;\nconst PANEL_BORDER = 2;\n\nimport { Emitter } from 'app/core/core';\n\nexport class PanelCtrl {\n  panel: any;\n  error: any;\n  dashboard: any;\n  editorTabIndex: number;\n  pluginName: string;\n  pluginId: string;\n  editorTabs: any;\n  $scope: any;\n  $injector: any;\n  $location: any;\n  $timeout: any;\n  fullscreen: boolean;\n  inspector: any;\n  editModeInitiated: boolean;\n  editMode: any;\n  height: any;\n  containerHeight: any;\n  events: Emitter;\n  timing: any;\n  loading: boolean;\n\n  constructor($scope, $injector) {\n    this.$injector = $injector;\n    this.$location = $injector.get('$location');\n    this.$scope = $scope;\n    this.$timeout = $injector.get('$timeout');\n    this.editorTabIndex = 0;\n    this.events = this.panel.events;\n    this.timing = {};\n\n    const plugin = config.panels[this.panel.type];\n    if (plugin) {\n      this.pluginId = plugin.id;\n      this.pluginName = plugin.name;\n    }\n\n    $scope.$on('refresh', () => this.refresh());\n    $scope.$on('component-did-mount', () => this.panelDidMount());\n\n    $scope.$on('$destroy', () => {\n      this.events.emit('panel-teardown');\n      this.events.removeAllListeners();\n    });\n  }\n\n  init() {\n    this.events.emit('panel-initialized');\n    this.publishAppEvent('panel-initialized', { scope: this.$scope });\n  }\n\n  panelDidMount() {\n    this.events.emit('component-did-mount');\n  }\n\n  renderingCompleted() {\n    profiler.renderingCompleted(this.panel.id, this.timing);\n  }\n\n  refresh() {\n    this.events.emit('refresh', null);\n  }\n\n  publishAppEvent(evtName, evt) {\n    this.$scope.$root.appEvent(evtName, evt);\n  }\n\n  changeView(fullscreen, edit) {\n    this.publishAppEvent('panel-change-view', {\n      fullscreen: fullscreen,\n      edit: edit,\n      panelId: this.panel.id,\n    });\n  }\n\n  viewPanel() {\n    this.changeView(true, false);\n  }\n\n  editPanel() {\n    this.changeView(true, true);\n  }\n\n  exitFullscreen() {\n    this.changeView(false, false);\n  }\n\n  initEditMode() {\n    this.editorTabs = [];\n    this.addEditorTab('General', 'public/app/partials/panelgeneral.html');\n    this.editModeInitiated = true;\n    this.events.emit('init-edit-mode', null);\n\n    const urlTab = (this.$injector.get('$routeParams').tab || '').toLowerCase();\n    if (urlTab) {\n      this.editorTabs.forEach((tab, i) => {\n        if (tab.title.toLowerCase() === urlTab) {\n          this.editorTabIndex = i;\n        }\n      });\n    }\n  }\n\n  changeTab(newIndex) {\n    this.editorTabIndex = newIndex;\n    const route = this.$injector.get('$route');\n    route.current.params.tab = this.editorTabs[newIndex].title.toLowerCase();\n    route.updateParams();\n  }\n\n  addEditorTab(title, directiveFn, index?) {\n    const editorTab = { title, directiveFn };\n\n    if (_.isString(directiveFn)) {\n      editorTab.directiveFn = () => {\n        return { templateUrl: directiveFn };\n      };\n    }\n    if (index) {\n      this.editorTabs.splice(index, 0, editorTab);\n    } else {\n      this.editorTabs.push(editorTab);\n    }\n  }\n\n  getMenu() {\n    const menu = [];\n    menu.push({\n      text: 'View',\n      click: 'ctrl.viewPanel();',\n      icon: 'fa fa-fw fa-eye',\n      shortcut: 'v',\n    });\n\n    if (this.dashboard.meta.canEdit) {\n      menu.push({\n        text: 'Edit',\n        click: 'ctrl.editPanel();',\n        role: 'Editor',\n        icon: 'fa fa-fw fa-edit',\n        shortcut: 'e',\n      });\n    }\n\n    menu.push({\n      text: 'Share',\n      click: 'ctrl.sharePanel();',\n      icon: 'fa fa-fw fa-share',\n      shortcut: 'p s',\n    });\n\n    // Additional items from sub-class\n    menu.push(...this.getAdditionalMenuItems());\n\n    const extendedMenu = this.getExtendedMenu();\n    menu.push({\n      text: 'More ...',\n      click: '',\n      icon: 'fa fa-fw fa-cube',\n      submenu: extendedMenu,\n    });\n\n    if (this.dashboard.meta.canEdit) {\n      menu.push({ divider: true, role: 'Editor' });\n      menu.push({\n        text: 'Remove',\n        click: 'ctrl.removePanel();',\n        role: 'Editor',\n        icon: 'fa fa-fw fa-trash',\n        shortcut: 'p r',\n      });\n    }\n\n    return menu;\n  }\n\n  getExtendedMenu() {\n    const menu = [];\n    if (!this.fullscreen && this.dashboard.meta.canEdit) {\n      menu.push({\n        text: 'Duplicate',\n        click: 'ctrl.duplicate()',\n        role: 'Editor',\n        shortcut: 'p d',\n      });\n\n      menu.push({\n        text: 'Copy',\n        click: 'ctrl.copyPanel()',\n        role: 'Editor',\n      });\n    }\n\n    menu.push({\n      text: 'Panel JSON',\n      click: 'ctrl.editPanelJson(); dismiss();',\n    });\n\n    this.events.emit('init-panel-actions', menu);\n    return menu;\n  }\n\n  // Override in sub-class to add items before extended menu\n  getAdditionalMenuItems() {\n    return [];\n  }\n\n  otherPanelInFullscreenMode() {\n    return this.dashboard.meta.fullscreen && !this.fullscreen;\n  }\n\n  calculatePanelHeight() {\n    if (this.fullscreen) {\n      const docHeight = $(window).height();\n      const editHeight = Math.floor(docHeight * 0.4);\n      const fullscreenHeight = Math.floor(docHeight * 0.8);\n      this.containerHeight = this.editMode ? editHeight : fullscreenHeight;\n    } else {\n      this.containerHeight = this.panel.gridPos.h * GRID_CELL_HEIGHT + (this.panel.gridPos.h - 1) * GRID_CELL_VMARGIN;\n    }\n\n    if (this.panel.soloMode) {\n      this.containerHeight = $(window).height();\n    }\n\n    this.height = this.containerHeight - (PANEL_BORDER + TITLE_HEIGHT);\n  }\n\n  render(payload?) {\n    this.timing.renderStart = new Date().getTime();\n    this.events.emit('render', payload);\n  }\n\n  duplicate() {\n    this.dashboard.duplicatePanel(this.panel);\n    this.$timeout(() => {\n      this.$scope.$root.$broadcast('render');\n    });\n  }\n\n  removePanel() {\n    this.publishAppEvent('panel-remove', {\n      panelId: this.panel.id,\n    });\n  }\n\n  editPanelJson() {\n    const editScope = this.$scope.$root.$new();\n    editScope.object = this.panel.getSaveModel();\n    editScope.updateHandler = this.replacePanel.bind(this);\n    editScope.enableCopy = true;\n\n    this.publishAppEvent('show-modal', {\n      src: 'public/app/partials/edit_json.html',\n      scope: editScope,\n    });\n  }\n\n  copyPanel() {\n    store.set(LS_PANEL_COPY_KEY, JSON.stringify(this.panel.getSaveModel()));\n    appEvents.emit('alert-success', ['Panel copied. Open Add Panel to paste']);\n  }\n\n  replacePanel(newPanel, oldPanel) {\n    const dashboard = this.dashboard;\n    const index = _.findIndex(dashboard.panels, panel => {\n      return panel.id === oldPanel.id;\n    });\n\n    const deletedPanel = dashboard.panels.splice(index, 1);\n    this.dashboard.events.emit('panel-removed', deletedPanel);\n\n    newPanel = new PanelModel(newPanel);\n    newPanel.id = oldPanel.id;\n\n    dashboard.panels.splice(index, 0, newPanel);\n    dashboard.sortPanelsByGridPos();\n    dashboard.events.emit('panel-added', newPanel);\n  }\n\n  sharePanel() {\n    const shareScope = this.$scope.$new();\n    shareScope.panel = this.panel;\n    shareScope.dashboard = this.dashboard;\n\n    this.publishAppEvent('show-modal', {\n      src: 'public/app/features/dashboard/partials/shareModal.html',\n      scope: shareScope,\n    });\n  }\n\n  getInfoMode() {\n    if (this.error) {\n      return 'error';\n    }\n    if (!!this.panel.description) {\n      return 'info';\n    }\n    if (this.panel.links && this.panel.links.length) {\n      return 'links';\n    }\n    return '';\n  }\n\n  getInfoContent(options) {\n    let markdown = this.panel.description;\n\n    if (options.mode === 'tooltip') {\n      markdown = this.error || this.panel.description;\n    }\n\n    const linkSrv = this.$injector.get('linkSrv');\n    const sanitize = this.$injector.get('$sanitize');\n    const templateSrv = this.$injector.get('templateSrv');\n    const interpolatedMarkdown = templateSrv.replace(markdown, this.panel.scopedVars);\n    let html = '<div class=\"markdown-html\">';\n\n    html += new Remarkable().render(interpolatedMarkdown);\n\n    if (this.panel.links && this.panel.links.length > 0) {\n      html += '<ul>';\n      for (const link of this.panel.links) {\n        const info = linkSrv.getPanelLinkAnchorInfo(link, this.panel.scopedVars);\n        html +=\n          '<li><a class=\"panel-menu-link\" href=\"' +\n          info.href +\n          '\" target=\"' +\n          info.target +\n          '\">' +\n          info.title +\n          '</a></li>';\n      }\n      html += '</ul>';\n    }\n\n    html += '</div>';\n    return sanitize(html);\n  }\n\n  openInspector() {\n    const modalScope = this.$scope.$new();\n    modalScope.panel = this.panel;\n    modalScope.dashboard = this.dashboard;\n    modalScope.panelInfoHtml = this.getInfoContent({ mode: 'inspector' });\n\n    modalScope.inspector = $.extend(true, {}, this.inspector);\n    this.publishAppEvent('show-modal', {\n      src: 'public/app/features/dashboard/partials/inspector.html',\n      scope: modalScope,\n    });\n  }\n}\n","import { DashboardModel } from '../dashboard/dashboard_model';\nimport Remarkable from 'remarkable';\n\nexport class MetricsTabCtrl {\n  dsName: string;\n  panel: any;\n  panelCtrl: any;\n  datasources: any[];\n  datasourceInstance: any;\n  nextRefId: string;\n  dashboard: DashboardModel;\n  panelDsValue: any;\n  addQueryDropdown: any;\n  queryTroubleshooterOpen: boolean;\n  helpOpen: boolean;\n  optionsOpen: boolean;\n  hasQueryHelp: boolean;\n  helpHtml: string;\n  queryOptions: any;\n\n  /** @ngInject */\n  constructor($scope, private $sce, datasourceSrv, private backendSrv) {\n    this.panelCtrl = $scope.ctrl;\n    $scope.ctrl = this;\n\n    this.panel = this.panelCtrl.panel;\n    this.dashboard = this.panelCtrl.dashboard;\n    this.datasources = datasourceSrv.getMetricSources();\n    this.panelDsValue = this.panelCtrl.panel.datasource;\n\n    for (const ds of this.datasources) {\n      if (ds.value === this.panelDsValue) {\n        this.datasourceInstance = ds;\n      }\n    }\n\n    this.addQueryDropdown = { text: 'Add Query', value: null, fake: true };\n\n    // update next ref id\n    this.panelCtrl.nextRefId = this.dashboard.getNextQueryLetter(this.panel);\n    this.updateDatasourceOptions();\n  }\n\n  updateDatasourceOptions() {\n    if (this.datasourceInstance) {\n      this.hasQueryHelp = this.datasourceInstance.meta.hasQueryHelp;\n      this.queryOptions = this.datasourceInstance.meta.queryOptions;\n    }\n  }\n\n  getOptions(includeBuiltin) {\n    return Promise.resolve(\n      this.datasources\n        .filter(value => {\n          return includeBuiltin || !value.meta.builtIn;\n        })\n        .map(ds => {\n          return { value: ds.value, text: ds.name, datasource: ds };\n        })\n    );\n  }\n\n  datasourceChanged(option) {\n    if (!option) {\n      return;\n    }\n\n    this.datasourceInstance = option.datasource;\n    this.panelCtrl.setDatasource(option.datasource);\n    this.updateDatasourceOptions();\n  }\n\n  addMixedQuery(option) {\n    if (!option) {\n      return;\n    }\n\n    this.panelCtrl.addQuery({\n      isNew: true,\n      datasource: option.datasource.name,\n    });\n    this.addQueryDropdown = { text: 'Add Query', value: null, fake: true };\n  }\n\n  addQuery() {\n    this.panelCtrl.addQuery({ isNew: true });\n  }\n\n  toggleHelp() {\n    this.optionsOpen = false;\n    this.queryTroubleshooterOpen = false;\n    this.helpOpen = !this.helpOpen;\n\n    this.backendSrv.get(`/api/plugins/${this.datasourceInstance.meta.id}/markdown/query_help`).then(res => {\n      const md = new Remarkable();\n      this.helpHtml = this.$sce.trustAsHtml(md.render(res));\n    });\n  }\n\n  toggleOptions() {\n    this.helpOpen = false;\n    this.queryTroubleshooterOpen = false;\n    this.optionsOpen = !this.optionsOpen;\n  }\n\n  toggleQueryTroubleshooter() {\n    this.helpOpen = false;\n    this.optionsOpen = false;\n    this.queryTroubleshooterOpen = !this.queryTroubleshooterOpen;\n  }\n}\n\n/** @ngInject */\nexport function metricsTabDirective() {\n  'use strict';\n  return {\n    restrict: 'E',\n    scope: true,\n    templateUrl: 'public/app/features/panel/partials/metrics_tab.html',\n    controller: MetricsTabCtrl,\n  };\n}\n","import $ from 'jquery';\nimport _ from 'lodash';\n\nimport config from 'app/core/config';\nimport kbn from 'app/core/utils/kbn';\nimport { PanelCtrl } from 'app/features/panel/panel_ctrl';\nimport * as rangeUtil from 'app/core/utils/rangeutil';\nimport * as dateMath from 'app/core/utils/datemath';\nimport { getExploreUrl } from 'app/core/utils/explore';\n\nimport { metricsTabDirective } from './metrics_tab';\n\nclass MetricsPanelCtrl extends PanelCtrl {\n  scope: any;\n  datasource: any;\n  datasourceName: any;\n  $q: any;\n  $timeout: any;\n  contextSrv: any;\n  datasourceSrv: any;\n  timeSrv: any;\n  templateSrv: any;\n  timing: any;\n  range: any;\n  interval: any;\n  intervalMs: any;\n  resolution: any;\n  timeInfo: any;\n  skipDataOnInit: boolean;\n  dataStream: any;\n  dataSubscription: any;\n  dataList: any;\n  nextRefId: string;\n\n  constructor($scope, $injector) {\n    super($scope, $injector);\n\n    // make metrics tab the default\n    this.editorTabIndex = 1;\n    this.$q = $injector.get('$q');\n    this.contextSrv = $injector.get('contextSrv');\n    this.datasourceSrv = $injector.get('datasourceSrv');\n    this.timeSrv = $injector.get('timeSrv');\n    this.templateSrv = $injector.get('templateSrv');\n    this.scope = $scope;\n    this.panel.datasource = this.panel.datasource || null;\n\n    if (!this.panel.targets) {\n      this.panel.targets = [{}];\n    }\n\n    this.events.on('refresh', this.onMetricsPanelRefresh.bind(this));\n    this.events.on('init-edit-mode', this.onInitMetricsPanelEditMode.bind(this));\n    this.events.on('panel-teardown', this.onPanelTearDown.bind(this));\n  }\n\n  private onPanelTearDown() {\n    if (this.dataSubscription) {\n      this.dataSubscription.unsubscribe();\n      this.dataSubscription = null;\n    }\n  }\n\n  private onInitMetricsPanelEditMode() {\n    this.addEditorTab('Metrics', metricsTabDirective);\n    this.addEditorTab('Time range', 'public/app/features/panel/partials/panelTime.html');\n  }\n\n  private onMetricsPanelRefresh() {\n    // ignore fetching data if another panel is in fullscreen\n    if (this.otherPanelInFullscreenMode()) {\n      return;\n    }\n\n    // if we have snapshot data use that\n    if (this.panel.snapshotData) {\n      this.updateTimeRange();\n      let data = this.panel.snapshotData;\n      // backward compatibility\n      if (!_.isArray(data)) {\n        data = data.data;\n      }\n\n      // Defer panel rendering till the next digest cycle.\n      // For some reason snapshot panels don't init at this time, so this helps to avoid rendering issues.\n      return this.$timeout(() => {\n        this.events.emit('data-snapshot-load', data);\n      });\n    }\n\n    // // ignore if we have data stream\n    if (this.dataStream) {\n      return;\n    }\n\n    // clear loading/error state\n    delete this.error;\n    this.loading = true;\n\n    // load datasource service\n    this.setTimeQueryStart();\n    this.datasourceSrv\n      .get(this.panel.datasource)\n      .then(this.updateTimeRange.bind(this))\n      .then(this.issueQueries.bind(this))\n      .then(this.handleQueryResult.bind(this))\n      .catch(err => {\n        // if cancelled  keep loading set to true\n        if (err.cancelled) {\n          console.log('Panel request cancelled', err);\n          return;\n        }\n\n        this.loading = false;\n        this.error = err.message || 'Request Error';\n        this.inspector = { error: err };\n\n        if (err.data) {\n          if (err.data.message) {\n            this.error = err.data.message;\n          }\n          if (err.data.error) {\n            this.error = err.data.error;\n          }\n        }\n\n        this.events.emit('data-error', err);\n        console.log('Panel data error:', err);\n      });\n  }\n\n  setTimeQueryStart() {\n    this.timing.queryStart = new Date().getTime();\n  }\n\n  setTimeQueryEnd() {\n    this.timing.queryEnd = new Date().getTime();\n  }\n\n  updateTimeRange(datasource?) {\n    this.datasource = datasource || this.datasource;\n    this.range = this.timeSrv.timeRange();\n\n    this.applyPanelTimeOverrides();\n\n    if (this.panel.maxDataPoints) {\n      this.resolution = this.panel.maxDataPoints;\n    } else {\n      this.resolution = Math.ceil($(window).width() * (this.panel.gridPos.w / 24));\n    }\n\n    this.calculateInterval();\n\n    return this.datasource;\n  }\n\n  calculateInterval() {\n    let intervalOverride = this.panel.interval;\n\n    // if no panel interval check datasource\n    if (intervalOverride) {\n      intervalOverride = this.templateSrv.replace(intervalOverride, this.panel.scopedVars);\n    } else if (this.datasource && this.datasource.interval) {\n      intervalOverride = this.datasource.interval;\n    }\n\n    const res = kbn.calculateInterval(this.range, this.resolution, intervalOverride);\n    this.interval = res.interval;\n    this.intervalMs = res.intervalMs;\n  }\n\n  applyPanelTimeOverrides() {\n    this.timeInfo = '';\n\n    // check panel time overrrides\n    if (this.panel.timeFrom) {\n      const timeFromInterpolated = this.templateSrv.replace(this.panel.timeFrom, this.panel.scopedVars);\n      const timeFromInfo = rangeUtil.describeTextRange(timeFromInterpolated);\n      if (timeFromInfo.invalid) {\n        this.timeInfo = 'invalid time override';\n        return;\n      }\n\n      if (_.isString(this.range.raw.from)) {\n        const timeFromDate = dateMath.parse(timeFromInfo.from);\n        this.timeInfo = timeFromInfo.display;\n        this.range.from = timeFromDate;\n        this.range.to = dateMath.parse(timeFromInfo.to);\n        this.range.raw.from = timeFromInfo.from;\n        this.range.raw.to = timeFromInfo.to;\n      }\n    }\n\n    if (this.panel.timeShift) {\n      const timeShiftInterpolated = this.templateSrv.replace(this.panel.timeShift, this.panel.scopedVars);\n      const timeShiftInfo = rangeUtil.describeTextRange(timeShiftInterpolated);\n      if (timeShiftInfo.invalid) {\n        this.timeInfo = 'invalid timeshift';\n        return;\n      }\n\n      const timeShift = '-' + timeShiftInterpolated;\n      this.timeInfo += ' timeshift ' + timeShift;\n      this.range.from = dateMath.parseDateMath(timeShift, this.range.from, false);\n      this.range.to = dateMath.parseDateMath(timeShift, this.range.to, true);\n      this.range.raw = { from: this.range.from, to: this.range.to };\n    }\n\n    if (this.panel.hideTimeOverride) {\n      this.timeInfo = '';\n    }\n  }\n\n  issueQueries(datasource) {\n    this.datasource = datasource;\n\n    if (!this.panel.targets || this.panel.targets.length === 0) {\n      return this.$q.when([]);\n    }\n\n    // make shallow copy of scoped vars,\n    // and add built in variables interval and interval_ms\n    const scopedVars = Object.assign({}, this.panel.scopedVars, {\n      __interval: { text: this.interval, value: this.interval },\n      __interval_ms: { text: this.intervalMs, value: this.intervalMs },\n    });\n\n    const metricsQuery = {\n      timezone: this.dashboard.getTimezone(),\n      panelId: this.panel.id,\n      dashboardId: this.dashboard.id,\n      range: this.range,\n      rangeRaw: this.range.raw,\n      interval: this.interval,\n      intervalMs: this.intervalMs,\n      targets: this.panel.targets,\n      maxDataPoints: this.resolution,\n      scopedVars: scopedVars,\n      cacheTimeout: this.panel.cacheTimeout,\n    };\n\n    return datasource.query(metricsQuery);\n  }\n\n  handleQueryResult(result) {\n    this.setTimeQueryEnd();\n    this.loading = false;\n\n    // check for if data source returns subject\n    if (result && result.subscribe) {\n      this.handleDataStream(result);\n      return;\n    }\n\n    if (this.dashboard.snapshot) {\n      this.panel.snapshotData = result.data;\n    }\n\n    if (!result || !result.data) {\n      console.log('Data source query result invalid, missing data field:', result);\n      result = { data: [] };\n    }\n\n    this.events.emit('data-received', result.data);\n  }\n\n  handleDataStream(stream) {\n    // if we already have a connection\n    if (this.dataStream) {\n      console.log('two stream observables!');\n      return;\n    }\n\n    this.dataStream = stream;\n    this.dataSubscription = stream.subscribe({\n      next: data => {\n        console.log('dataSubject next!');\n        if (data.range) {\n          this.range = data.range;\n        }\n        this.events.emit('data-received', data.data);\n      },\n      error: error => {\n        this.events.emit('data-error', error);\n        console.log('panel: observer got error');\n      },\n      complete: () => {\n        console.log('panel: observer got complete');\n        this.dataStream = null;\n      },\n    });\n  }\n\n  setDatasource(datasource) {\n    // switching to mixed\n    if (datasource.meta.mixed) {\n      _.each(this.panel.targets, target => {\n        target.datasource = this.panel.datasource;\n        if (!target.datasource) {\n          target.datasource = config.defaultDatasource;\n        }\n      });\n    } else if (this.datasource && this.datasource.meta.mixed) {\n      _.each(this.panel.targets, target => {\n        delete target.datasource;\n      });\n    }\n\n    this.panel.datasource = datasource.value;\n    this.datasourceName = datasource.name;\n    this.datasource = null;\n    this.refresh();\n  }\n\n  getAdditionalMenuItems() {\n    const items = [];\n    if (\n      config.exploreEnabled &&\n      this.contextSrv.isEditor &&\n      this.datasource &&\n      (this.datasource.meta.explore || this.datasource.meta.id === 'mixed')\n    ) {\n      items.push({\n        text: 'Explore',\n        click: 'ctrl.explore();',\n        icon: 'fa fa-fw fa-rocket',\n        shortcut: 'x',\n      });\n    }\n    return items;\n  }\n\n  async explore() {\n    const url = await getExploreUrl(this.panel, this.panel.targets, this.datasource, this.datasourceSrv, this.timeSrv);\n    if (url) {\n      this.$timeout(() => this.$location.url(url));\n    }\n  }\n\n  addQuery(target) {\n    target.refId = this.dashboard.getNextQueryLetter(this.panel);\n\n    this.panel.targets.push(target);\n    this.nextRefId = this.dashboard.getNextQueryLetter(this.panel);\n  }\n\n  removeQuery(target) {\n    const index = _.indexOf(this.panel.targets, target);\n    this.panel.targets.splice(index, 1);\n    this.nextRefId = this.dashboard.getNextQueryLetter(this.panel);\n    this.refresh();\n  }\n\n  moveQuery(target, direction) {\n    const index = _.indexOf(this.panel.targets, target);\n    _.move(this.panel.targets, index, index + direction);\n  }\n}\n\nexport { MetricsPanelCtrl };\n","import _ from 'lodash';\n\nexport class QueryCtrl {\n  target: any;\n  datasource: any;\n  panelCtrl: any;\n  panel: any;\n  hasRawMode: boolean;\n  error: string;\n  isLastQuery: boolean;\n\n  constructor(public $scope, public $injector) {\n    this.panel = this.panelCtrl.panel;\n    this.isLastQuery = _.indexOf(this.panel.targets, this.target) === this.panel.targets.length - 1;\n  }\n\n  refresh() {\n    this.panelCtrl.refresh();\n  }\n}\n","export class ThresholdMapper {\n  static alertToGraphThresholds(panel) {\n    for (let i = 0; i < panel.alert.conditions.length; i++) {\n      const condition = panel.alert.conditions[i];\n      if (condition.type !== 'query') {\n        continue;\n      }\n\n      const evaluator = condition.evaluator;\n      const thresholds = (panel.thresholds = []);\n\n      switch (evaluator.type) {\n        case 'gt': {\n          const value = evaluator.params[0];\n          thresholds.push({ value: value, op: 'gt' });\n          break;\n        }\n        case 'lt': {\n          const value = evaluator.params[0];\n          thresholds.push({ value: value, op: 'lt' });\n          break;\n        }\n        case 'outside_range': {\n          const value1 = evaluator.params[0];\n          const value2 = evaluator.params[1];\n\n          if (value1 > value2) {\n            thresholds.push({ value: value1, op: 'gt' });\n            thresholds.push({ value: value2, op: 'lt' });\n          } else {\n            thresholds.push({ value: value1, op: 'lt' });\n            thresholds.push({ value: value2, op: 'gt' });\n          }\n\n          break;\n        }\n        case 'within_range': {\n          const value1 = evaluator.params[0];\n          const value2 = evaluator.params[1];\n\n          if (value1 > value2) {\n            thresholds.push({ value: value1, op: 'lt' });\n            thresholds.push({ value: value2, op: 'gt' });\n          } else {\n            thresholds.push({ value: value1, op: 'gt' });\n            thresholds.push({ value: value2, op: 'lt' });\n          }\n          break;\n        }\n      }\n      break;\n    }\n\n    for (const t of panel.thresholds) {\n      t.fill = true;\n      t.line = true;\n      t.colorMode = 'critical';\n    }\n\n    const updated = true;\n    return updated;\n  }\n}\n","import _ from 'lodash';\nimport { ThresholdMapper } from './state/ThresholdMapper';\nimport { QueryPart } from 'app/core/components/query_part/query_part';\nimport alertDef from './state/alertDef';\nimport config from 'app/core/config';\nimport appEvents from 'app/core/app_events';\n\nexport class AlertTabCtrl {\n  panel: any;\n  panelCtrl: any;\n  testing: boolean;\n  testResult: any;\n  subTabIndex: number;\n  conditionTypes: any;\n  alert: any;\n  conditionModels: any;\n  evalFunctions: any;\n  evalOperators: any;\n  noDataModes: any;\n  executionErrorModes: any;\n  addNotificationSegment;\n  notifications;\n  alertNotifications;\n  error: string;\n  appSubUrl: string;\n  alertHistory: any;\n\n  /** @ngInject */\n  constructor(\n    private $scope,\n    private backendSrv,\n    private dashboardSrv,\n    private uiSegmentSrv,\n    private $q,\n    private datasourceSrv\n  ) {\n    this.panelCtrl = $scope.ctrl;\n    this.panel = this.panelCtrl.panel;\n    this.$scope.ctrl = this;\n    this.subTabIndex = 0;\n    this.evalFunctions = alertDef.evalFunctions;\n    this.evalOperators = alertDef.evalOperators;\n    this.conditionTypes = alertDef.conditionTypes;\n    this.noDataModes = alertDef.noDataModes;\n    this.executionErrorModes = alertDef.executionErrorModes;\n    this.appSubUrl = config.appSubUrl;\n  }\n\n  $onInit() {\n    this.addNotificationSegment = this.uiSegmentSrv.newPlusButton();\n\n    // subscribe to graph threshold handle changes\n    const thresholdChangedEventHandler = this.graphThresholdChanged.bind(this);\n    this.panelCtrl.events.on('threshold-changed', thresholdChangedEventHandler);\n\n    // set panel alert edit mode\n    this.$scope.$on('$destroy', () => {\n      this.panelCtrl.events.off('threshold-changed', thresholdChangedEventHandler);\n      this.panelCtrl.editingThresholds = false;\n      this.panelCtrl.render();\n    });\n\n    // build notification model\n    this.notifications = [];\n    this.alertNotifications = [];\n    this.alertHistory = [];\n\n    return this.backendSrv.get('/api/alert-notifications').then(res => {\n      this.notifications = res;\n\n      this.initModel();\n      this.validateModel();\n    });\n  }\n\n  getAlertHistory() {\n    this.backendSrv\n      .get(`/api/annotations?dashboardId=${this.panelCtrl.dashboard.id}&panelId=${this.panel.id}&limit=50&type=alert`)\n      .then(res => {\n        this.alertHistory = _.map(res, ah => {\n          ah.time = this.dashboardSrv.getCurrent().formatDate(ah.time, 'MMM D, YYYY HH:mm:ss');\n          ah.stateModel = alertDef.getStateDisplayModel(ah.newState);\n          ah.info = alertDef.getAlertAnnotationInfo(ah);\n          return ah;\n        });\n      });\n  }\n\n  getNotificationIcon(type): string {\n    switch (type) {\n      case 'email':\n        return 'fa fa-envelope';\n      case 'slack':\n        return 'fa fa-slack';\n      case 'victorops':\n        return 'fa fa-pagelines';\n      case 'webhook':\n        return 'fa fa-cubes';\n      case 'pagerduty':\n        return 'fa fa-bullhorn';\n      case 'opsgenie':\n        return 'fa fa-bell';\n      case 'hipchat':\n        return 'fa fa-mail-forward';\n      case 'pushover':\n        return 'fa fa-mobile';\n      case 'kafka':\n        return 'fa fa-random';\n      case 'teams':\n        return 'fa fa-windows';\n    }\n    return 'fa fa-bell';\n  }\n\n  getNotifications() {\n    return Promise.resolve(\n      this.notifications.map(item => {\n        return this.uiSegmentSrv.newSegment(item.name);\n      })\n    );\n  }\n\n  changeTabIndex(newTabIndex) {\n    this.subTabIndex = newTabIndex;\n\n    if (this.subTabIndex === 2) {\n      this.getAlertHistory();\n    }\n  }\n\n  notificationAdded() {\n    const model = _.find(this.notifications, {\n      name: this.addNotificationSegment.value,\n    });\n    if (!model) {\n      return;\n    }\n\n    this.alertNotifications.push({\n      name: model.name,\n      iconClass: this.getNotificationIcon(model.type),\n      isDefault: false,\n    });\n    this.alert.notifications.push({ id: model.id });\n\n    // reset plus button\n    this.addNotificationSegment.value = this.uiSegmentSrv.newPlusButton().value;\n    this.addNotificationSegment.html = this.uiSegmentSrv.newPlusButton().html;\n  }\n\n  removeNotification(index) {\n    this.alert.notifications.splice(index, 1);\n    this.alertNotifications.splice(index, 1);\n  }\n\n  initModel() {\n    const alert = (this.alert = this.panel.alert);\n    if (!alert) {\n      return;\n    }\n\n    alert.conditions = alert.conditions || [];\n    if (alert.conditions.length === 0) {\n      alert.conditions.push(this.buildDefaultCondition());\n    }\n\n    alert.noDataState = alert.noDataState || config.alertingNoDataOrNullValues;\n    alert.executionErrorState = alert.executionErrorState || config.alertingErrorOrTimeout;\n    alert.frequency = alert.frequency || '60s';\n    alert.handler = alert.handler || 1;\n    alert.notifications = alert.notifications || [];\n\n    const defaultName = this.panel.title + ' alert';\n    alert.name = alert.name || defaultName;\n\n    this.conditionModels = _.reduce(\n      alert.conditions,\n      (memo, value) => {\n        memo.push(this.buildConditionModel(value));\n        return memo;\n      },\n      []\n    );\n\n    ThresholdMapper.alertToGraphThresholds(this.panel);\n\n    for (const addedNotification of alert.notifications) {\n      const model = _.find(this.notifications, { id: addedNotification.id });\n      if (model && model.isDefault === false) {\n        model.iconClass = this.getNotificationIcon(model.type);\n        this.alertNotifications.push(model);\n      }\n    }\n\n    for (const notification of this.notifications) {\n      if (notification.isDefault) {\n        notification.iconClass = this.getNotificationIcon(notification.type);\n        notification.bgColor = '#00678b';\n        this.alertNotifications.push(notification);\n      }\n    }\n\n    this.panelCtrl.editingThresholds = true;\n    this.panelCtrl.render();\n  }\n\n  graphThresholdChanged(evt) {\n    for (const condition of this.alert.conditions) {\n      if (condition.type === 'query') {\n        condition.evaluator.params[evt.handleIndex] = evt.threshold.value;\n        this.evaluatorParamsChanged();\n        break;\n      }\n    }\n  }\n\n  buildDefaultCondition() {\n    return {\n      type: 'query',\n      query: { params: ['A', '5m', 'now'] },\n      reducer: { type: 'avg', params: [] },\n      evaluator: { type: 'gt', params: [null] },\n      operator: { type: 'and' },\n    };\n  }\n\n  validateModel() {\n    if (!this.alert) {\n      return;\n    }\n\n    let firstTarget;\n    let foundTarget = null;\n\n    for (const condition of this.alert.conditions) {\n      if (condition.type !== 'query') {\n        continue;\n      }\n\n      for (const target of this.panel.targets) {\n        if (!firstTarget) {\n          firstTarget = target;\n        }\n        if (condition.query.params[0] === target.refId) {\n          foundTarget = target;\n          break;\n        }\n      }\n\n      if (!foundTarget) {\n        if (firstTarget) {\n          condition.query.params[0] = firstTarget.refId;\n          foundTarget = firstTarget;\n        } else {\n          this.error = 'Could not find any metric queries';\n        }\n      }\n\n      const datasourceName = foundTarget.datasource || this.panel.datasource;\n      this.datasourceSrv.get(datasourceName).then(ds => {\n        if (!ds.meta.alerting) {\n          this.error = 'The datasource does not support alerting queries';\n        } else if (ds.targetContainsTemplate(foundTarget)) {\n          this.error = 'Template variables are not supported in alert queries';\n        } else {\n          this.error = '';\n        }\n      });\n    }\n  }\n\n  buildConditionModel(source) {\n    const cm: any = { source: source, type: source.type };\n\n    cm.queryPart = new QueryPart(source.query, alertDef.alertQueryDef);\n    cm.reducerPart = alertDef.createReducerPart(source.reducer);\n    cm.evaluator = source.evaluator;\n    cm.operator = source.operator;\n\n    return cm;\n  }\n\n  handleQueryPartEvent(conditionModel, evt) {\n    switch (evt.name) {\n      case 'action-remove-part': {\n        break;\n      }\n      case 'get-part-actions': {\n        return this.$q.when([]);\n      }\n      case 'part-param-changed': {\n        this.validateModel();\n      }\n      case 'get-param-options': {\n        const result = this.panel.targets.map(target => {\n          return this.uiSegmentSrv.newSegment({ value: target.refId });\n        });\n\n        return this.$q.when(result);\n      }\n    }\n  }\n\n  handleReducerPartEvent(conditionModel, evt) {\n    switch (evt.name) {\n      case 'action': {\n        conditionModel.source.reducer.type = evt.action.value;\n        conditionModel.reducerPart = alertDef.createReducerPart(conditionModel.source.reducer);\n        break;\n      }\n      case 'get-part-actions': {\n        const result = [];\n        for (const type of alertDef.reducerTypes) {\n          if (type.value !== conditionModel.source.reducer.type) {\n            result.push(type);\n          }\n        }\n        return this.$q.when(result);\n      }\n    }\n  }\n\n  addCondition(type) {\n    const condition = this.buildDefaultCondition();\n    // add to persited model\n    this.alert.conditions.push(condition);\n    // add to view model\n    this.conditionModels.push(this.buildConditionModel(condition));\n  }\n\n  removeCondition(index) {\n    this.alert.conditions.splice(index, 1);\n    this.conditionModels.splice(index, 1);\n  }\n\n  delete() {\n    appEvents.emit('confirm-modal', {\n      title: 'Delete Alert',\n      text: 'Are you sure you want to delete this alert rule?',\n      text2: 'You need to save dashboard for the delete to take effect',\n      icon: 'fa-trash',\n      yesText: 'Delete',\n      onConfirm: () => {\n        delete this.panel.alert;\n        this.alert = null;\n        this.panel.thresholds = [];\n        this.conditionModels = [];\n        this.panelCtrl.alertState = null;\n        this.panelCtrl.render();\n      },\n    });\n  }\n\n  enable() {\n    this.panel.alert = {};\n    this.initModel();\n  }\n\n  evaluatorParamsChanged() {\n    ThresholdMapper.alertToGraphThresholds(this.panel);\n    this.panelCtrl.render();\n  }\n\n  evaluatorTypeChanged(evaluator) {\n    // ensure params array is correct length\n    switch (evaluator.type) {\n      case 'lt':\n      case 'gt': {\n        evaluator.params = [evaluator.params[0]];\n        break;\n      }\n      case 'within_range':\n      case 'outside_range': {\n        evaluator.params = [evaluator.params[0], evaluator.params[1]];\n        break;\n      }\n      case 'no_value': {\n        evaluator.params = [];\n      }\n    }\n\n    this.evaluatorParamsChanged();\n  }\n\n  clearHistory() {\n    appEvents.emit('confirm-modal', {\n      title: 'Delete Alert History',\n      text: 'Are you sure you want to remove all history & annotations for this alert?',\n      icon: 'fa-trash',\n      yesText: 'Yes',\n      onConfirm: () => {\n        this.backendSrv\n          .post('/api/annotations/mass-delete', {\n            dashboardId: this.panelCtrl.dashboard.id,\n            panelId: this.panel.id,\n          })\n          .then(res => {\n            this.alertHistory = [];\n            this.panelCtrl.refresh();\n          });\n      },\n    });\n  }\n\n  test() {\n    this.testing = true;\n    this.testResult = false;\n\n    const payload = {\n      dashboard: this.dashboardSrv.getCurrent().getSaveModelClone(),\n      panelId: this.panelCtrl.panel.id,\n    };\n\n    return this.backendSrv.post('/api/alerts/test', payload).then(res => {\n      this.testResult = res;\n      this.testing = false;\n    });\n  }\n}\n\n/** @ngInject */\nexport function alertTab() {\n  'use strict';\n  return {\n    restrict: 'E',\n    scope: true,\n    templateUrl: 'public/app/features/alerting/partials/alert_tab.html',\n    controller: AlertTabCtrl,\n  };\n}\n","import { PanelCtrl } from 'app/features/panel/panel_ctrl';\nimport { MetricsPanelCtrl } from 'app/features/panel/metrics_panel_ctrl';\nimport { QueryCtrl } from 'app/features/panel/query_ctrl';\nimport { alertTab } from 'app/features/alerting/AlertTabCtrl';\nimport { loadPluginCss } from 'app/features/plugins/plugin_loader';\n\nexport { PanelCtrl, MetricsPanelCtrl, QueryCtrl, alertTab, loadPluginCss };\n","import { isBoolean, isNumber, sortedUniq, sortedIndexOf, unescape as htmlUnescaped } from 'lodash';\nimport moment from 'moment';\nimport { saveAs } from 'file-saver';\nimport { isNullOrUndefined } from 'util';\n\nconst DEFAULT_DATETIME_FORMAT = 'YYYY-MM-DDTHH:mm:ssZ';\nconst POINT_TIME_INDEX = 1;\nconst POINT_VALUE_INDEX = 0;\n\nconst END_COLUMN = ';';\nconst END_ROW = '\\r\\n';\nconst QUOTE = '\"';\nconst EXPORT_FILENAME = 'grafana_data_export.csv';\n\nfunction csvEscaped(text) {\n  if (!text) {\n    return text;\n  }\n\n  return text.split(QUOTE).join(QUOTE + QUOTE);\n}\n\nconst domParser = new DOMParser();\nfunction htmlDecoded(text) {\n  if (!text) {\n    return text;\n  }\n\n  const regexp = /&[^;]+;/g;\n  function htmlDecoded(value) {\n    const parsedDom = domParser.parseFromString(value, 'text/html');\n    return parsedDom.body.textContent;\n  }\n  return text.replace(regexp, htmlDecoded).replace(regexp, htmlDecoded);\n}\n\nfunction formatSpecialHeader(useExcelHeader) {\n  return useExcelHeader ? `sep=${END_COLUMN}${END_ROW}` : '';\n}\n\nfunction formatRow(row, addEndRowDelimiter = true) {\n  let text = '';\n  for (let i = 0; i < row.length; i += 1) {\n    if (isBoolean(row[i]) || isNullOrUndefined(row[i])) {\n      text += row[i];\n    } else if (isNumber(row[i])) {\n      text += row[i].toLocaleString();\n    } else {\n      text += `${QUOTE}${csvEscaped(htmlUnescaped(htmlDecoded(row[i])))}${QUOTE}`;\n    }\n\n    if (i < row.length - 1) {\n      text += END_COLUMN;\n    }\n  }\n  return addEndRowDelimiter ? text + END_ROW : text;\n}\n\nexport function convertSeriesListToCsv(seriesList, dateTimeFormat = DEFAULT_DATETIME_FORMAT, excel = false) {\n  let text = formatSpecialHeader(excel) + formatRow(['Series', 'Time', 'Value']);\n  for (let seriesIndex = 0; seriesIndex < seriesList.length; seriesIndex += 1) {\n    for (let i = 0; i < seriesList[seriesIndex].datapoints.length; i += 1) {\n      text += formatRow(\n        [\n          seriesList[seriesIndex].alias,\n          moment(seriesList[seriesIndex].datapoints[i][POINT_TIME_INDEX]).format(dateTimeFormat),\n          seriesList[seriesIndex].datapoints[i][POINT_VALUE_INDEX],\n        ],\n        i < seriesList[seriesIndex].datapoints.length - 1 || seriesIndex < seriesList.length - 1\n      );\n    }\n  }\n  return text;\n}\n\nexport function exportSeriesListToCsv(seriesList, dateTimeFormat = DEFAULT_DATETIME_FORMAT, excel = false) {\n  const text = convertSeriesListToCsv(seriesList, dateTimeFormat, excel);\n  saveSaveBlob(text, EXPORT_FILENAME);\n}\n\nexport function convertSeriesListToCsvColumns(seriesList, dateTimeFormat = DEFAULT_DATETIME_FORMAT, excel = false) {\n  // add header\n  let text =\n    formatSpecialHeader(excel) +\n    formatRow(\n      ['Time'].concat(\n        seriesList.map(val => {\n          return val.alias;\n        })\n      )\n    );\n  // process data\n  seriesList = mergeSeriesByTime(seriesList);\n\n  // make text\n  for (let i = 0; i < seriesList[0].datapoints.length; i += 1) {\n    const timestamp = moment(seriesList[0].datapoints[i][POINT_TIME_INDEX]).format(dateTimeFormat);\n    text += formatRow(\n      [timestamp].concat(\n        seriesList.map(series => {\n          return series.datapoints[i][POINT_VALUE_INDEX];\n        })\n      ),\n      i < seriesList[0].datapoints.length - 1\n    );\n  }\n\n  return text;\n}\n\n/**\n * Collect all unique timestamps from series list and use it to fill\n * missing points by null.\n */\nfunction mergeSeriesByTime(seriesList) {\n  let timestamps = [];\n  for (let i = 0; i < seriesList.length; i++) {\n    const seriesPoints = seriesList[i].datapoints;\n    for (let j = 0; j < seriesPoints.length; j++) {\n      timestamps.push(seriesPoints[j][POINT_TIME_INDEX]);\n    }\n  }\n  timestamps = sortedUniq(timestamps.sort());\n\n  for (let i = 0; i < seriesList.length; i++) {\n    const seriesPoints = seriesList[i].datapoints;\n    const seriesTimestamps = seriesPoints.map(p => p[POINT_TIME_INDEX]);\n    const extendedSeries = [];\n    let pointIndex;\n    for (let j = 0; j < timestamps.length; j++) {\n      pointIndex = sortedIndexOf(seriesTimestamps, timestamps[j]);\n      if (pointIndex !== -1) {\n        extendedSeries.push(seriesPoints[pointIndex]);\n      } else {\n        extendedSeries.push([null, timestamps[j]]);\n      }\n    }\n    seriesList[i].datapoints = extendedSeries;\n  }\n  return seriesList;\n}\n\nexport function exportSeriesListToCsvColumns(seriesList, dateTimeFormat = DEFAULT_DATETIME_FORMAT, excel = false) {\n  const text = convertSeriesListToCsvColumns(seriesList, dateTimeFormat, excel);\n  saveSaveBlob(text, EXPORT_FILENAME);\n}\n\nexport function convertTableDataToCsv(table, excel = false) {\n  let text = formatSpecialHeader(excel);\n  // add headline\n  text += formatRow(table.columns.map(val => val.title || val.text));\n  // process data\n  for (let i = 0; i < table.rows.length; i += 1) {\n    text += formatRow(table.rows[i], i < table.rows.length - 1);\n  }\n  return text;\n}\n\nexport function exportTableDataToCsv(table, excel = false) {\n  const text = convertTableDataToCsv(table, excel);\n  saveSaveBlob(text, EXPORT_FILENAME);\n}\n\nexport function saveSaveBlob(payload, fname) {\n  const blob = new Blob([payload], { type: 'text/csv;charset=utf-8;header=present;' });\n  saveAs(blob, fname);\n}\n","// Copyright (c) 2014, Hugh Kennedy\n// Based on code from https://github.com/hughsk/flat/blob/master/index.js\n//\nexport default function flatten(target, opts): any {\n  opts = opts || {};\n\n  const delimiter = opts.delimiter || '.';\n  let maxDepth = opts.maxDepth || 3;\n  let currentDepth = 1;\n  const output = {};\n\n  function step(object, prev) {\n    Object.keys(object).forEach(key => {\n      const value = object[key];\n      const isarray = opts.safe && Array.isArray(value);\n      const type = Object.prototype.toString.call(value);\n      const isobject = type === '[object Object]';\n\n      const newKey = prev ? prev + delimiter + key : key;\n\n      if (!opts.maxDepth) {\n        maxDepth = currentDepth + 1;\n      }\n\n      if (!isarray && isobject && Object.keys(value).length && currentDepth < maxDepth) {\n        ++currentDepth;\n        return step(value, newKey);\n      }\n\n      output[newKey] = value;\n    });\n  }\n\n  step(target, null);\n\n  return output;\n}\n","import _ from 'lodash';\n\nconst versionPattern = /^(\\d+)(?:\\.(\\d+))?(?:\\.(\\d+))?(?:-([0-9A-Za-z\\.]+))?/;\n\nexport class SemVersion {\n  major: number;\n  minor: number;\n  patch: number;\n  meta: string;\n\n  constructor(version: string) {\n    const match = versionPattern.exec(version);\n    if (match) {\n      this.major = Number(match[1]);\n      this.minor = Number(match[2] || 0);\n      this.patch = Number(match[3] || 0);\n      this.meta = match[4];\n    }\n  }\n\n  isGtOrEq(version: string): boolean {\n    const compared = new SemVersion(version);\n    return !(this.major < compared.major || this.minor < compared.minor || this.patch < compared.patch);\n  }\n\n  isValid(): boolean {\n    return _.isNumber(this.major);\n  }\n}\n\nexport function isVersionGtOrEq(a: string, b: string): boolean {\n  const aSemver = new SemVersion(a);\n  return aSemver.isGtOrEq(b);\n}\n","import _ from 'lodash';\nimport { isVersionGtOrEq } from 'app/core/utils/version';\n\nconst index = {};\n\nfunction addFuncDef(funcDef) {\n  funcDef.params = funcDef.params || [];\n  funcDef.defaultParams = funcDef.defaultParams || [];\n\n  index[funcDef.name] = funcDef;\n  if (funcDef.shortName) {\n    index[funcDef.shortName] = funcDef;\n  }\n}\n\nconst optionalSeriesRefArgs = [{ name: 'other', type: 'value_or_series', optional: true, multiple: true }];\n\naddFuncDef({\n  name: 'scaleToSeconds',\n  category: 'Transform',\n  params: [{ name: 'seconds', type: 'int' }],\n  defaultParams: [1],\n});\n\naddFuncDef({\n  name: 'perSecond',\n  category: 'Transform',\n  params: [{ name: 'max value', type: 'int', optional: true }],\n  defaultParams: [],\n});\n\naddFuncDef({\n  name: 'holtWintersForecast',\n  category: 'Calculate',\n});\n\naddFuncDef({\n  name: 'holtWintersConfidenceBands',\n  category: 'Calculate',\n  params: [{ name: 'delta', type: 'int' }],\n  defaultParams: [3],\n});\n\naddFuncDef({\n  name: 'holtWintersAberration',\n  category: 'Calculate',\n  params: [{ name: 'delta', type: 'int' }],\n  defaultParams: [3],\n});\n\naddFuncDef({\n  name: 'nPercentile',\n  category: 'Calculate',\n  params: [{ name: 'Nth percentile', type: 'int' }],\n  defaultParams: [95],\n});\n\naddFuncDef({\n  name: 'diffSeries',\n  params: optionalSeriesRefArgs,\n  defaultParams: ['#A'],\n  category: 'Combine',\n});\n\naddFuncDef({\n  name: 'stddevSeries',\n  params: optionalSeriesRefArgs,\n  defaultParams: [''],\n  category: 'Combine',\n});\n\naddFuncDef({\n  name: 'divideSeries',\n  params: optionalSeriesRefArgs,\n  defaultParams: ['#A'],\n  category: 'Combine',\n});\n\naddFuncDef({\n  name: 'multiplySeries',\n  params: optionalSeriesRefArgs,\n  defaultParams: ['#A'],\n  category: 'Combine',\n});\n\naddFuncDef({\n  name: 'asPercent',\n  params: optionalSeriesRefArgs,\n  defaultParams: ['#A'],\n  category: 'Combine',\n});\n\naddFuncDef({\n  name: 'group',\n  params: optionalSeriesRefArgs,\n  defaultParams: ['#A', '#B'],\n  category: 'Combine',\n});\n\naddFuncDef({\n  name: 'sumSeries',\n  shortName: 'sum',\n  category: 'Combine',\n  params: optionalSeriesRefArgs,\n  defaultParams: [''],\n});\n\naddFuncDef({\n  name: 'averageSeries',\n  shortName: 'avg',\n  category: 'Combine',\n  params: optionalSeriesRefArgs,\n  defaultParams: [''],\n});\n\naddFuncDef({\n  name: 'rangeOfSeries',\n  category: 'Combine',\n});\n\naddFuncDef({\n  name: 'percentileOfSeries',\n  category: 'Combine',\n  params: [{ name: 'n', type: 'int' }, { name: 'interpolate', type: 'boolean', options: ['true', 'false'] }],\n  defaultParams: [95, 'false'],\n});\n\naddFuncDef({\n  name: 'sumSeriesWithWildcards',\n  category: 'Combine',\n  params: [{ name: 'node', type: 'int', multiple: true }],\n  defaultParams: [3],\n});\n\naddFuncDef({\n  name: 'maxSeries',\n  shortName: 'max',\n  category: 'Combine',\n});\n\naddFuncDef({\n  name: 'minSeries',\n  shortName: 'min',\n  category: 'Combine',\n});\n\naddFuncDef({\n  name: 'averageSeriesWithWildcards',\n  category: 'Combine',\n  params: [{ name: 'node', type: 'int', multiple: true }],\n  defaultParams: [3],\n});\n\naddFuncDef({\n  name: 'alias',\n  category: 'Alias',\n  params: [{ name: 'alias', type: 'string' }],\n  defaultParams: ['alias'],\n});\n\naddFuncDef({\n  name: 'aliasSub',\n  category: 'Alias',\n  params: [{ name: 'search', type: 'string' }, { name: 'replace', type: 'string' }],\n  defaultParams: ['', '\\\\1'],\n});\n\naddFuncDef({\n  name: 'consolidateBy',\n  category: 'Special',\n  params: [\n    {\n      name: 'function',\n      type: 'string',\n      options: ['sum', 'average', 'min', 'max'],\n    },\n  ],\n  defaultParams: ['max'],\n});\n\naddFuncDef({\n  name: 'cumulative',\n  category: 'Special',\n  params: [],\n  defaultParams: [],\n});\n\naddFuncDef({\n  name: 'groupByNode',\n  category: 'Combine',\n  params: [\n    {\n      name: 'node',\n      type: 'int',\n      options: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12],\n    },\n    {\n      name: 'function',\n      type: 'string',\n      options: ['sum', 'avg', 'maxSeries'],\n    },\n  ],\n  defaultParams: [3, 'sum'],\n});\n\naddFuncDef({\n  name: 'aliasByNode',\n  category: 'Alias',\n  params: [\n    {\n      name: 'node',\n      type: 'int',\n      options: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12],\n      multiple: true,\n    },\n  ],\n  defaultParams: [3],\n});\n\naddFuncDef({\n  name: 'substr',\n  category: 'Special',\n  params: [\n    {\n      name: 'start',\n      type: 'int',\n      options: [-6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12],\n    },\n    {\n      name: 'stop',\n      type: 'int',\n      options: [-6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12],\n    },\n  ],\n  defaultParams: [0, 0],\n});\n\naddFuncDef({\n  name: 'sortByName',\n  category: 'Sorting',\n  params: [\n    {\n      name: 'natural',\n      type: 'boolean',\n      options: ['true', 'false'],\n      optional: true,\n    },\n  ],\n  defaultParams: ['false'],\n});\n\naddFuncDef({\n  name: 'sortByMaxima',\n  category: 'Sorting',\n});\n\naddFuncDef({\n  name: 'sortByMinima',\n  category: 'Sorting',\n});\n\naddFuncDef({\n  name: 'sortByTotal',\n  category: 'Sorting',\n});\n\naddFuncDef({\n  name: 'aliasByMetric',\n  category: 'Alias',\n});\n\naddFuncDef({\n  name: 'randomWalk',\n  fake: true,\n  category: 'Special',\n  params: [{ name: 'name', type: 'string' }],\n  defaultParams: ['randomWalk'],\n});\n\naddFuncDef({\n  name: 'countSeries',\n  category: 'Combine',\n});\n\naddFuncDef({\n  name: 'constantLine',\n  category: 'Special',\n  params: [{ name: 'value', type: 'int' }],\n  defaultParams: [10],\n});\n\naddFuncDef({\n  name: 'cactiStyle',\n  category: 'Special',\n});\n\naddFuncDef({\n  name: 'keepLastValue',\n  category: 'Transform',\n  params: [{ name: 'n', type: 'int' }],\n  defaultParams: [100],\n});\n\naddFuncDef({\n  name: 'changed',\n  category: 'Special',\n  params: [],\n  defaultParams: [],\n});\n\naddFuncDef({\n  name: 'scale',\n  category: 'Transform',\n  params: [{ name: 'factor', type: 'int' }],\n  defaultParams: [1],\n});\n\naddFuncDef({\n  name: 'offset',\n  category: 'Transform',\n  params: [{ name: 'amount', type: 'int' }],\n  defaultParams: [10],\n});\n\naddFuncDef({\n  name: 'transformNull',\n  category: 'Transform',\n  params: [{ name: 'amount', type: 'int' }],\n  defaultParams: [0],\n});\n\naddFuncDef({\n  name: 'integral',\n  category: 'Transform',\n});\n\naddFuncDef({\n  name: 'derivative',\n  category: 'Transform',\n});\n\naddFuncDef({\n  name: 'nonNegativeDerivative',\n  category: 'Transform',\n  params: [{ name: 'max value or 0', type: 'int', optional: true }],\n  defaultParams: [''],\n});\n\naddFuncDef({\n  name: 'timeShift',\n  category: 'Transform',\n  params: [\n    {\n      name: 'amount',\n      type: 'select',\n      options: ['1h', '6h', '12h', '1d', '2d', '7d', '14d', '30d'],\n    },\n  ],\n  defaultParams: ['1d'],\n});\n\naddFuncDef({\n  name: 'timeStack',\n  category: 'Transform',\n  params: [\n    {\n      name: 'timeShiftUnit',\n      type: 'select',\n      options: ['1h', '6h', '12h', '1d', '2d', '7d', '14d', '30d'],\n    },\n    { name: 'timeShiftStart', type: 'int' },\n    { name: 'timeShiftEnd', type: 'int' },\n  ],\n  defaultParams: ['1d', 0, 7],\n});\n\naddFuncDef({\n  name: 'summarize',\n  category: 'Transform',\n  params: [\n    { name: 'interval', type: 'string' },\n    {\n      name: 'func',\n      type: 'select',\n      options: ['sum', 'avg', 'min', 'max', 'last'],\n    },\n    {\n      name: 'alignToFrom',\n      type: 'boolean',\n      optional: true,\n      options: ['false', 'true'],\n    },\n  ],\n  defaultParams: ['1h', 'sum', 'false'],\n});\n\naddFuncDef({\n  name: 'smartSummarize',\n  category: 'Transform',\n  params: [\n    { name: 'interval', type: 'string' },\n    {\n      name: 'func',\n      type: 'select',\n      options: ['sum', 'avg', 'min', 'max', 'last'],\n    },\n  ],\n  defaultParams: ['1h', 'sum'],\n});\n\naddFuncDef({\n  name: 'absolute',\n  category: 'Transform',\n});\n\naddFuncDef({\n  name: 'hitcount',\n  category: 'Transform',\n  params: [{ name: 'interval', type: 'string' }],\n  defaultParams: ['10s'],\n});\n\naddFuncDef({\n  name: 'log',\n  category: 'Transform',\n  params: [{ name: 'base', type: 'int' }],\n  defaultParams: ['10'],\n});\n\naddFuncDef({\n  name: 'averageAbove',\n  category: 'Filter Series',\n  params: [{ name: 'n', type: 'int' }],\n  defaultParams: [25],\n});\n\naddFuncDef({\n  name: 'averageBelow',\n  category: 'Filter Series',\n  params: [{ name: 'n', type: 'int' }],\n  defaultParams: [25],\n});\n\naddFuncDef({\n  name: 'currentAbove',\n  category: 'Filter Series',\n  params: [{ name: 'n', type: 'int' }],\n  defaultParams: [25],\n});\n\naddFuncDef({\n  name: 'currentBelow',\n  category: 'Filter Series',\n  params: [{ name: 'n', type: 'int' }],\n  defaultParams: [25],\n});\n\naddFuncDef({\n  name: 'maximumAbove',\n  category: 'Filter Series',\n  params: [{ name: 'value', type: 'int' }],\n  defaultParams: [0],\n});\n\naddFuncDef({\n  name: 'maximumBelow',\n  category: 'Filter Series',\n  params: [{ name: 'value', type: 'int' }],\n  defaultParams: [0],\n});\n\naddFuncDef({\n  name: 'minimumAbove',\n  category: 'Filter Series',\n  params: [{ name: 'value', type: 'int' }],\n  defaultParams: [0],\n});\n\naddFuncDef({\n  name: 'minimumBelow',\n  category: 'Filter Series',\n  params: [{ name: 'value', type: 'int' }],\n  defaultParams: [0],\n});\n\naddFuncDef({\n  name: 'limit',\n  category: 'Filter Series',\n  params: [{ name: 'n', type: 'int' }],\n  defaultParams: [5],\n});\n\naddFuncDef({\n  name: 'mostDeviant',\n  category: 'Filter Series',\n  params: [{ name: 'n', type: 'int' }],\n  defaultParams: [10],\n});\n\naddFuncDef({\n  name: 'exclude',\n  category: 'Filter Series',\n  params: [{ name: 'exclude', type: 'string' }],\n  defaultParams: ['exclude'],\n});\n\naddFuncDef({\n  name: 'highestCurrent',\n  category: 'Filter Series',\n  params: [{ name: 'count', type: 'int' }],\n  defaultParams: [5],\n});\n\naddFuncDef({\n  name: 'highestMax',\n  category: 'Filter Series',\n  params: [{ name: 'count', type: 'int' }],\n  defaultParams: [5],\n});\n\naddFuncDef({\n  name: 'lowestCurrent',\n  category: 'Filter Series',\n  params: [{ name: 'count', type: 'int' }],\n  defaultParams: [5],\n});\n\naddFuncDef({\n  name: 'movingAverage',\n  category: 'Calculate',\n  params: [\n    {\n      name: 'windowSize',\n      type: 'int_or_interval',\n      options: ['5', '7', '10', '5min', '10min', '30min', '1hour'],\n    },\n  ],\n  defaultParams: [10],\n});\n\naddFuncDef({\n  name: 'movingMedian',\n  category: 'Calculate',\n  params: [\n    {\n      name: 'windowSize',\n      type: 'int_or_interval',\n      options: ['5', '7', '10', '5min', '10min', '30min', '1hour'],\n    },\n  ],\n  defaultParams: ['5'],\n});\n\naddFuncDef({\n  name: 'stdev',\n  category: 'Calculate',\n  params: [{ name: 'n', type: 'int' }, { name: 'tolerance', type: 'int' }],\n  defaultParams: [5, 0.1],\n});\n\naddFuncDef({\n  name: 'highestAverage',\n  category: 'Filter Series',\n  params: [{ name: 'count', type: 'int' }],\n  defaultParams: [5],\n});\n\naddFuncDef({\n  name: 'lowestAverage',\n  category: 'Filter Series',\n  params: [{ name: 'count', type: 'int' }],\n  defaultParams: [5],\n});\n\naddFuncDef({\n  name: 'removeAbovePercentile',\n  category: 'Filter Data',\n  params: [{ name: 'n', type: 'int' }],\n  defaultParams: [5],\n});\n\naddFuncDef({\n  name: 'removeAboveValue',\n  category: 'Filter Data',\n  params: [{ name: 'n', type: 'int' }],\n  defaultParams: [5],\n});\n\naddFuncDef({\n  name: 'removeBelowPercentile',\n  category: 'Filter Data',\n  params: [{ name: 'n', type: 'int' }],\n  defaultParams: [5],\n});\n\naddFuncDef({\n  name: 'removeBelowValue',\n  category: 'Filter Data',\n  params: [{ name: 'n', type: 'int' }],\n  defaultParams: [5],\n});\n\naddFuncDef({\n  name: 'useSeriesAbove',\n  category: 'Filter Series',\n  params: [{ name: 'value', type: 'int' }, { name: 'search', type: 'string' }, { name: 'replace', type: 'string' }],\n  defaultParams: [0, 'search', 'replace'],\n});\n\n////////////////////\n// Graphite 1.0.x //\n////////////////////\n\naddFuncDef({\n  name: 'aggregateLine',\n  category: 'Calculate',\n  params: [\n    {\n      name: 'func',\n      type: 'select',\n      options: ['sum', 'avg', 'min', 'max', 'last'],\n    },\n  ],\n  defaultParams: ['avg'],\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'averageOutsidePercentile',\n  category: 'Filter Series',\n  params: [{ name: 'n', type: 'int' }],\n  defaultParams: [95],\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'delay',\n  category: 'Transform',\n  params: [{ name: 'steps', type: 'int' }],\n  defaultParams: [1],\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'exponentialMovingAverage',\n  category: 'Calculate',\n  params: [\n    {\n      name: 'windowSize',\n      type: 'int_or_interval',\n      options: ['5', '7', '10', '5min', '10min', '30min', '1hour'],\n    },\n  ],\n  defaultParams: [10],\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'fallbackSeries',\n  category: 'Special',\n  params: [{ name: 'fallback', type: 'string' }],\n  defaultParams: ['constantLine(0)'],\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'grep',\n  category: 'Filter Series',\n  params: [{ name: 'grep', type: 'string' }],\n  defaultParams: ['grep'],\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'groupByNodes',\n  category: 'Combine',\n  params: [\n    {\n      name: 'function',\n      type: 'string',\n      options: ['sum', 'avg', 'maxSeries'],\n    },\n    {\n      name: 'node',\n      type: 'int',\n      options: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12],\n      multiple: true,\n    },\n  ],\n  defaultParams: ['sum', 3],\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'integralByInterval',\n  category: 'Transform',\n  params: [\n    {\n      name: 'intervalUnit',\n      type: 'select',\n      options: ['1h', '6h', '12h', '1d', '2d', '7d', '14d', '30d'],\n    },\n  ],\n  defaultParams: ['1d'],\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'interpolate',\n  category: 'Transform',\n  params: [{ name: 'limit', type: 'int', optional: true }],\n  defaultParams: [],\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'invert',\n  category: 'Transform',\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'isNonNull',\n  category: 'Combine',\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'linearRegression',\n  category: 'Calculate',\n  params: [\n    {\n      name: 'startSourceAt',\n      type: 'select',\n      options: ['-1h', '-6h', '-12h', '-1d', '-2d', '-7d', '-14d', '-30d'],\n      optional: true,\n    },\n    {\n      name: 'endSourceAt',\n      type: 'select',\n      options: ['-1h', '-6h', '-12h', '-1d', '-2d', '-7d', '-14d', '-30d'],\n      optional: true,\n    },\n  ],\n  defaultParams: [],\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'mapSeries',\n  shortName: 'map',\n  params: [{ name: 'node', type: 'int' }],\n  defaultParams: [3],\n  category: 'Combine',\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'movingMin',\n  category: 'Calculate',\n  params: [\n    {\n      name: 'windowSize',\n      type: 'int_or_interval',\n      options: ['5', '7', '10', '5min', '10min', '30min', '1hour'],\n    },\n  ],\n  defaultParams: [10],\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'movingMax',\n  category: 'Calculate',\n  params: [\n    {\n      name: 'windowSize',\n      type: 'int_or_interval',\n      options: ['5', '7', '10', '5min', '10min', '30min', '1hour'],\n    },\n  ],\n  defaultParams: [10],\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'movingSum',\n  category: 'Calculate',\n  params: [\n    {\n      name: 'windowSize',\n      type: 'int_or_interval',\n      options: ['5', '7', '10', '5min', '10min', '30min', '1hour'],\n    },\n  ],\n  defaultParams: [10],\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'multiplySeriesWithWildcards',\n  category: 'Combine',\n  params: [\n    {\n      name: 'position',\n      type: 'int',\n      options: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12],\n      multiple: true,\n    },\n  ],\n  defaultParams: [2],\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'offsetToZero',\n  category: 'Transform',\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'pow',\n  category: 'Transform',\n  params: [{ name: 'factor', type: 'int' }],\n  defaultParams: [10],\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'powSeries',\n  category: 'Transform',\n  params: optionalSeriesRefArgs,\n  defaultParams: [''],\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'reduceSeries',\n  shortName: 'reduce',\n  params: [\n    {\n      name: 'function',\n      type: 'string',\n      options: ['asPercent', 'diffSeries', 'divideSeries'],\n    },\n    {\n      name: 'reduceNode',\n      type: 'int',\n      options: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13],\n    },\n    { name: 'reduceMatchers', type: 'string', multiple: true },\n  ],\n  defaultParams: ['asPercent', 2, 'used_bytes'],\n  category: 'Combine',\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'removeBetweenPercentile',\n  category: 'Filter Series',\n  params: [{ name: 'n', type: 'int' }],\n  defaultParams: [95],\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'removeEmptySeries',\n  category: 'Filter Series',\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'squareRoot',\n  category: 'Transform',\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'timeSlice',\n  category: 'Transform',\n  params: [\n    {\n      name: 'startSliceAt',\n      type: 'select',\n      options: ['-1h', '-6h', '-12h', '-1d', '-2d', '-7d', '-14d', '-30d'],\n    },\n    {\n      name: 'endSliceAt',\n      type: 'select',\n      options: ['-1h', '-6h', '-12h', '-1d', '-2d', '-7d', '-14d', '-30d'],\n      optional: true,\n    },\n  ],\n  defaultParams: ['-1h'],\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'weightedAverage',\n  category: 'Combine',\n  params: [\n    { name: 'other', type: 'value_or_series', optional: true },\n    {\n      name: 'node',\n      type: 'int',\n      options: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12],\n    },\n  ],\n  defaultParams: ['#A', 4],\n  version: '1.0',\n});\n\naddFuncDef({\n  name: 'seriesByTag',\n  category: 'Special',\n  params: [{ name: 'tagExpression', type: 'string', multiple: true }],\n  version: '1.1',\n});\n\naddFuncDef({\n  name: 'groupByTags',\n  category: 'Combine',\n  params: [\n    {\n      name: 'function',\n      type: 'string',\n      options: ['sum', 'avg', 'maxSeries'],\n    },\n    { name: 'tag', type: 'string', multiple: true },\n  ],\n  defaultParams: ['sum', 'tag'],\n  version: '1.1',\n});\n\naddFuncDef({\n  name: 'aliasByTags',\n  category: 'Alias',\n  params: [{ name: 'tag', type: 'string', multiple: true }],\n  defaultParams: ['tag'],\n  version: '1.1',\n});\n\nfunction isVersionRelatedFunction(obj, graphiteVersion) {\n  return !obj.version || isVersionGtOrEq(graphiteVersion, obj.version);\n}\n\nexport class FuncInstance {\n  def: any;\n  params: any;\n  text: any;\n  added: boolean;\n\n  constructor(funcDef, options) {\n    this.def = funcDef;\n    this.params = [];\n\n    if (options && options.withDefaultParams) {\n      this.params = funcDef.defaultParams.slice(0);\n    }\n\n    this.updateText();\n  }\n\n  render(metricExp) {\n    const str = this.def.name + '(';\n\n    const parameters = _.map(this.params, (value, index) => {\n      let paramType;\n      if (index < this.def.params.length) {\n        paramType = this.def.params[index].type;\n      } else if (_.get(_.last(this.def.params), 'multiple')) {\n        paramType = _.get(_.last(this.def.params), 'type');\n      }\n      // param types that should never be quoted\n      if (_.includes(['value_or_series', 'boolean', 'int', 'float', 'node'], paramType)) {\n        return value;\n      }\n      // param types that might be quoted\n      if (_.includes(['int_or_interval', 'node_or_tag'], paramType) && _.isFinite(+value)) {\n        return _.toString(+value);\n      }\n      return \"'\" + value + \"'\";\n    });\n\n    // don't send any blank parameters to graphite\n    while (parameters[parameters.length - 1] === '') {\n      parameters.pop();\n    }\n\n    if (metricExp) {\n      parameters.unshift(metricExp);\n    }\n\n    return str + parameters.join(', ') + ')';\n  }\n\n  _hasMultipleParamsInString(strValue, index) {\n    if (strValue.indexOf(',') === -1) {\n      return false;\n    }\n\n    if (this.def.params[index + 1] && this.def.params[index + 1].optional) {\n      return true;\n    }\n\n    if (index + 1 >= this.def.params.length && _.get(_.last(this.def.params), 'multiple')) {\n      return true;\n    }\n\n    return false;\n  }\n\n  updateParam(strValue, index) {\n    // handle optional parameters\n    // if string contains ',' and next param is optional, split and update both\n    if (this._hasMultipleParamsInString(strValue, index)) {\n      _.each(strValue.split(','), (partVal, idx) => {\n        this.updateParam(partVal.trim(), index + idx);\n      });\n      return;\n    }\n\n    if (strValue === '' && (index >= this.def.params.length || this.def.params[index].optional)) {\n      this.params.splice(index, 1);\n    } else {\n      this.params[index] = strValue;\n    }\n\n    this.updateText();\n  }\n\n  updateText() {\n    if (this.params.length === 0) {\n      this.text = this.def.name + '()';\n      return;\n    }\n\n    let text = this.def.name + '(';\n    text += this.params.join(', ');\n    text += ')';\n    this.text = text;\n  }\n}\n\nfunction createFuncInstance(funcDef, options?, idx?) {\n  if (_.isString(funcDef)) {\n    funcDef = getFuncDef(funcDef, idx);\n  }\n  return new FuncInstance(funcDef, options);\n}\n\nfunction getFuncDef(name, idx?) {\n  if (!(idx || index)[name]) {\n    throw { message: 'Method not found ' + name };\n  }\n  return (idx || index)[name];\n}\n\nfunction getFuncDefs(graphiteVersion, idx?) {\n  const funcs = {};\n  _.forEach(idx || index, funcDef => {\n    if (isVersionRelatedFunction(funcDef, graphiteVersion)) {\n      funcs[funcDef.name] = _.assign({}, funcDef, {\n        params: _.filter(funcDef.params, param => {\n          return isVersionRelatedFunction(param, graphiteVersion);\n        }),\n      });\n    }\n  });\n  return funcs;\n}\n\n// parse response from graphite /functions endpoint into internal format\nfunction parseFuncDefs(rawDefs) {\n  const funcDefs = {};\n\n  _.forEach(rawDefs || {}, (funcDef, funcName) => {\n    // skip graphite graph functions\n    if (funcDef.group === 'Graph') {\n      return;\n    }\n\n    let description = funcDef.description;\n    if (description) {\n      // tidy up some pydoc syntax that rst2html can't handle\n      description = description\n        .replace(/:py:func:`(.+)( <[^>]*>)?`/g, '``$1``')\n        .replace(/.. seealso:: /g, 'See also: ')\n        .replace(/.. code-block *:: *none/g, '.. code-block::');\n    }\n\n    const func = {\n      name: funcDef.name,\n      description: description,\n      category: funcDef.group,\n      params: [],\n      defaultParams: [],\n      fake: false,\n    };\n\n    // get rid of the first \"seriesList\" param\n    if (/^seriesLists?$/.test(_.get(funcDef, 'params[0].type', ''))) {\n      // handle functions that accept multiple seriesLists\n      // we leave the param in place but mark it optional, so users can add more series if they wish\n      if (funcDef.params[0].multiple) {\n        funcDef.params[0].required = false;\n        // otherwise chop off the first param, it'll be handled separately\n      } else {\n        funcDef.params.shift();\n      }\n      // tag function as fake\n    } else {\n      func.fake = true;\n    }\n\n    _.forEach(funcDef.params, rawParam => {\n      const param = {\n        name: rawParam.name,\n        type: 'string',\n        optional: !rawParam.required,\n        multiple: !!rawParam.multiple,\n        options: undefined,\n      };\n\n      if (rawParam.default !== undefined) {\n        func.defaultParams.push(_.toString(rawParam.default));\n      } else if (rawParam.suggestions) {\n        func.defaultParams.push(_.toString(rawParam.suggestions[0]));\n      } else {\n        func.defaultParams.push('');\n      }\n\n      if (rawParam.type === 'boolean') {\n        param.type = 'boolean';\n        param.options = ['true', 'false'];\n      } else if (rawParam.type === 'integer') {\n        param.type = 'int';\n      } else if (rawParam.type === 'float') {\n        param.type = 'float';\n      } else if (rawParam.type === 'node') {\n        param.type = 'node';\n        param.options = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'];\n      } else if (rawParam.type === 'nodeOrTag') {\n        param.type = 'node_or_tag';\n        param.options = ['name', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'];\n      } else if (rawParam.type === 'intOrInterval') {\n        param.type = 'int_or_interval';\n      } else if (rawParam.type === 'seriesList') {\n        param.type = 'value_or_series';\n      }\n\n      if (rawParam.options) {\n        param.options = _.map(rawParam.options, _.toString);\n      } else if (rawParam.suggestions) {\n        param.options = _.map(rawParam.suggestions, _.toString);\n      }\n\n      func.params.push(param);\n    });\n\n    funcDefs[funcName] = func;\n  });\n\n  return funcDefs;\n}\n\nexport default {\n  createFuncInstance: createFuncInstance,\n  getFuncDef: getFuncDef,\n  getFuncDefs: getFuncDefs,\n  parseFuncDefs: parseFuncDefs,\n};\n","import _ from 'lodash';\nimport * as dateMath from 'app/core/utils/datemath';\nimport { isVersionGtOrEq, SemVersion } from 'app/core/utils/version';\nimport gfunc from './gfunc';\n\n/** @ngInject */\nexport function GraphiteDatasource(this: any, instanceSettings, $q, backendSrv, templateSrv) {\n  this.basicAuth = instanceSettings.basicAuth;\n  this.url = instanceSettings.url;\n  this.name = instanceSettings.name;\n  this.graphiteVersion = instanceSettings.jsonData.graphiteVersion || '0.9';\n  this.supportsTags = supportsTags(this.graphiteVersion);\n  this.cacheTimeout = instanceSettings.cacheTimeout;\n  this.withCredentials = instanceSettings.withCredentials;\n  this.render_method = instanceSettings.render_method || 'POST';\n  this.funcDefs = null;\n  this.funcDefsPromise = null;\n\n  this.getQueryOptionsInfo = () => {\n    return {\n      maxDataPoints: true,\n      cacheTimeout: true,\n      links: [\n        {\n          text: 'Help',\n          url: 'http://docs.grafana.org/features/datasources/graphite/#using-graphite-in-grafana',\n        },\n      ],\n    };\n  };\n\n  this.query = function(options) {\n    const graphOptions = {\n      from: this.translateTime(options.rangeRaw.from, false),\n      until: this.translateTime(options.rangeRaw.to, true),\n      targets: options.targets,\n      format: options.format,\n      cacheTimeout: options.cacheTimeout || this.cacheTimeout,\n      maxDataPoints: options.maxDataPoints,\n    };\n\n    const params = this.buildGraphiteParams(graphOptions, options.scopedVars);\n    if (params.length === 0) {\n      return $q.when({ data: [] });\n    }\n\n    const httpOptions: any = {\n      method: 'POST',\n      url: '/render',\n      data: params.join('&'),\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n    };\n\n    this.addTracingHeaders(httpOptions, options);\n\n    if (options.panelId) {\n      httpOptions.requestId = this.name + '.panelId.' + options.panelId;\n    }\n\n    return this.doGraphiteRequest(httpOptions).then(this.convertDataPointsToMs);\n  };\n\n  this.addTracingHeaders = function(httpOptions, options) {\n    const proxyMode = !this.url.match(/^http/);\n    if (proxyMode) {\n      httpOptions.headers['X-Dashboard-Id'] = options.dashboardId;\n      httpOptions.headers['X-Panel-Id'] = options.panelId;\n    }\n  };\n\n  this.convertDataPointsToMs = result => {\n    if (!result || !result.data) {\n      return [];\n    }\n    for (let i = 0; i < result.data.length; i++) {\n      const series = result.data[i];\n      for (let y = 0; y < series.datapoints.length; y++) {\n        series.datapoints[y][1] *= 1000;\n      }\n    }\n    return result;\n  };\n\n  this.parseTags = tagString => {\n    let tags = [];\n    tags = tagString.split(',');\n    if (tags.length === 1) {\n      tags = tagString.split(' ');\n      if (tags[0] === '') {\n        tags = [];\n      }\n    }\n    return tags;\n  };\n\n  this.annotationQuery = function(options) {\n    // Graphite metric as annotation\n    if (options.annotation.target) {\n      const target = templateSrv.replace(options.annotation.target, {}, 'glob');\n      const graphiteQuery = {\n        rangeRaw: options.rangeRaw,\n        targets: [{ target: target }],\n        format: 'json',\n        maxDataPoints: 100,\n      };\n\n      return this.query(graphiteQuery).then(result => {\n        const list = [];\n\n        for (let i = 0; i < result.data.length; i++) {\n          const target = result.data[i];\n\n          for (let y = 0; y < target.datapoints.length; y++) {\n            const datapoint = target.datapoints[y];\n            if (!datapoint[0]) {\n              continue;\n            }\n\n            list.push({\n              annotation: options.annotation,\n              time: datapoint[1],\n              title: target.target,\n            });\n          }\n        }\n\n        return list;\n      });\n    } else {\n      // Graphite event as annotation\n      const tags = templateSrv.replace(options.annotation.tags);\n      return this.events({ range: options.rangeRaw, tags: tags }).then(results => {\n        const list = [];\n        for (let i = 0; i < results.data.length; i++) {\n          const e = results.data[i];\n\n          let tags = e.tags;\n          if (_.isString(e.tags)) {\n            tags = this.parseTags(e.tags);\n          }\n\n          list.push({\n            annotation: options.annotation,\n            time: e.when * 1000,\n            title: e.what,\n            tags: tags,\n            text: e.data,\n          });\n        }\n\n        return list;\n      });\n    }\n  };\n\n  this.events = function(options) {\n    try {\n      let tags = '';\n      if (options.tags) {\n        tags = '&tags=' + options.tags;\n      }\n      return this.doGraphiteRequest({\n        method: 'GET',\n        url:\n          '/events/get_data?from=' +\n          this.translateTime(options.range.from, false) +\n          '&until=' +\n          this.translateTime(options.range.to, true) +\n          tags,\n      });\n    } catch (err) {\n      return $q.reject(err);\n    }\n  };\n\n  this.targetContainsTemplate = target => {\n    return templateSrv.variableExists(target.target);\n  };\n\n  this.translateTime = (date, roundUp) => {\n    if (_.isString(date)) {\n      if (date === 'now') {\n        return 'now';\n      } else if (date.indexOf('now-') >= 0 && date.indexOf('/') === -1) {\n        date = date.substring(3);\n        date = date.replace('m', 'min');\n        date = date.replace('M', 'mon');\n        return date;\n      }\n      date = dateMath.parse(date, roundUp);\n    }\n\n    // graphite' s from filter is exclusive\n    // here we step back one minute in order\n    // to guarantee that we get all the data that\n    // exists for the specified range\n    if (roundUp) {\n      if (date.get('s')) {\n        date.add(1, 'm');\n      }\n    } else if (roundUp === false) {\n      if (date.get('s')) {\n        date.subtract(1, 'm');\n      }\n    }\n\n    return date.unix();\n  };\n\n  this.metricFindQuery = function(query, optionalOptions) {\n    const options = optionalOptions || {};\n    const interpolatedQuery = templateSrv.replace(query);\n\n    // special handling for tag_values(<tag>[,<expression>]*), this is used for template variables\n    let matches = interpolatedQuery.match(/^tag_values\\(([^,]+)((, *[^,]+)*)\\)$/);\n    if (matches) {\n      const expressions = [];\n      const exprRegex = /, *([^,]+)/g;\n      let match = exprRegex.exec(matches[2]);\n      while (match !== null) {\n        expressions.push(match[1]);\n        match = exprRegex.exec(matches[2]);\n      }\n      options.limit = 10000;\n      return this.getTagValuesAutoComplete(expressions, matches[1], undefined, options);\n    }\n\n    // special handling for tags(<expression>[,<expression>]*), this is used for template variables\n    matches = interpolatedQuery.match(/^tags\\(([^,]*)((, *[^,]+)*)\\)$/);\n    if (matches) {\n      const expressions = [];\n      if (matches[1]) {\n        expressions.push(matches[1]);\n        const exprRegex = /, *([^,]+)/g;\n        let match = exprRegex.exec(matches[2]);\n        while (match !== null) {\n          expressions.push(match[1]);\n          match = exprRegex.exec(matches[2]);\n        }\n      }\n      options.limit = 10000;\n      return this.getTagsAutoComplete(expressions, undefined, options);\n    }\n\n    const httpOptions: any = {\n      method: 'GET',\n      url: '/metrics/find',\n      params: {\n        query: interpolatedQuery,\n      },\n      // for cancellations\n      requestId: options.requestId,\n    };\n\n    if (options.range) {\n      httpOptions.params.from = this.translateTime(options.range.from, false);\n      httpOptions.params.until = this.translateTime(options.range.to, true);\n    }\n\n    return this.doGraphiteRequest(httpOptions).then(results => {\n      return _.map(results.data, metric => {\n        return {\n          text: metric.text,\n          expandable: metric.expandable ? true : false,\n        };\n      });\n    });\n  };\n\n  this.getTags = function(optionalOptions) {\n    const options = optionalOptions || {};\n\n    const httpOptions: any = {\n      method: 'GET',\n      url: '/tags',\n      // for cancellations\n      requestId: options.requestId,\n    };\n\n    if (options.range) {\n      httpOptions.params.from = this.translateTime(options.range.from, false);\n      httpOptions.params.until = this.translateTime(options.range.to, true);\n    }\n\n    return this.doGraphiteRequest(httpOptions).then(results => {\n      return _.map(results.data, tag => {\n        return {\n          text: tag.tag,\n          id: tag.id,\n        };\n      });\n    });\n  };\n\n  this.getTagValues = function(tag, optionalOptions) {\n    const options = optionalOptions || {};\n\n    const httpOptions: any = {\n      method: 'GET',\n      url: '/tags/' + templateSrv.replace(tag),\n      // for cancellations\n      requestId: options.requestId,\n    };\n\n    if (options.range) {\n      httpOptions.params.from = this.translateTime(options.range.from, false);\n      httpOptions.params.until = this.translateTime(options.range.to, true);\n    }\n\n    return this.doGraphiteRequest(httpOptions).then(results => {\n      if (results.data && results.data.values) {\n        return _.map(results.data.values, value => {\n          return {\n            text: value.value,\n            id: value.id,\n          };\n        });\n      } else {\n        return [];\n      }\n    });\n  };\n\n  this.getTagsAutoComplete = (expressions, tagPrefix, optionalOptions) => {\n    const options = optionalOptions || {};\n\n    const httpOptions: any = {\n      method: 'GET',\n      url: '/tags/autoComplete/tags',\n      params: {\n        expr: _.map(expressions, expression => templateSrv.replace((expression || '').trim())),\n      },\n      // for cancellations\n      requestId: options.requestId,\n    };\n\n    if (tagPrefix) {\n      httpOptions.params.tagPrefix = tagPrefix;\n    }\n    if (options.limit) {\n      httpOptions.params.limit = options.limit;\n    }\n    if (options.range) {\n      httpOptions.params.from = this.translateTime(options.range.from, false);\n      httpOptions.params.until = this.translateTime(options.range.to, true);\n    }\n\n    return this.doGraphiteRequest(httpOptions).then(results => {\n      if (results.data) {\n        return _.map(results.data, tag => {\n          return { text: tag };\n        });\n      } else {\n        return [];\n      }\n    });\n  };\n\n  this.getTagValuesAutoComplete = (expressions, tag, valuePrefix, optionalOptions) => {\n    const options = optionalOptions || {};\n\n    const httpOptions: any = {\n      method: 'GET',\n      url: '/tags/autoComplete/values',\n      params: {\n        expr: _.map(expressions, expression => templateSrv.replace((expression || '').trim())),\n        tag: templateSrv.replace((tag || '').trim()),\n      },\n      // for cancellations\n      requestId: options.requestId,\n    };\n\n    if (valuePrefix) {\n      httpOptions.params.valuePrefix = valuePrefix;\n    }\n    if (options.limit) {\n      httpOptions.params.limit = options.limit;\n    }\n    if (options.range) {\n      httpOptions.params.from = this.translateTime(options.range.from, false);\n      httpOptions.params.until = this.translateTime(options.range.to, true);\n    }\n\n    return this.doGraphiteRequest(httpOptions).then(results => {\n      if (results.data) {\n        return _.map(results.data, value => {\n          return { text: value };\n        });\n      } else {\n        return [];\n      }\n    });\n  };\n\n  this.getVersion = function(optionalOptions) {\n    const options = optionalOptions || {};\n\n    const httpOptions = {\n      method: 'GET',\n      url: '/version',\n      requestId: options.requestId,\n    };\n\n    return this.doGraphiteRequest(httpOptions)\n      .then(results => {\n        if (results.data) {\n          const semver = new SemVersion(results.data);\n          return semver.isValid() ? results.data : '';\n        }\n        return '';\n      })\n      .catch(() => {\n        return '';\n      });\n  };\n\n  this.createFuncInstance = function(funcDef, options?) {\n    return gfunc.createFuncInstance(funcDef, options, this.funcDefs);\n  };\n\n  this.getFuncDef = function(name) {\n    return gfunc.getFuncDef(name, this.funcDefs);\n  };\n\n  this.waitForFuncDefsLoaded = function() {\n    return this.getFuncDefs();\n  };\n\n  this.getFuncDefs = function() {\n    if (this.funcDefsPromise !== null) {\n      return this.funcDefsPromise;\n    }\n\n    if (!supportsFunctionIndex(this.graphiteVersion)) {\n      this.funcDefs = gfunc.getFuncDefs(this.graphiteVersion);\n      this.funcDefsPromise = Promise.resolve(this.funcDefs);\n      return this.funcDefsPromise;\n    }\n\n    const httpOptions = {\n      method: 'GET',\n      url: '/functions',\n    };\n\n    this.funcDefsPromise = this.doGraphiteRequest(httpOptions)\n      .then(results => {\n        if (results.status !== 200 || typeof results.data !== 'object') {\n          this.funcDefs = gfunc.getFuncDefs(this.graphiteVersion);\n        } else {\n          this.funcDefs = gfunc.parseFuncDefs(results.data);\n        }\n        return this.funcDefs;\n      })\n      .catch(err => {\n        console.log('Fetching graphite functions error', err);\n        this.funcDefs = gfunc.getFuncDefs(this.graphiteVersion);\n        return this.funcDefs;\n      });\n\n    return this.funcDefsPromise;\n  };\n\n  this.testDatasource = function() {\n    const query = {\n      panelId: 3,\n      rangeRaw: { from: 'now-1h', to: 'now' },\n      targets: [{ target: 'constantLine(100)' }],\n      maxDataPoints: 300,\n    };\n    return this.query(query).then(() => {\n      return { status: 'success', message: 'Data source is working' };\n    });\n  };\n\n  this.doGraphiteRequest = function(options) {\n    if (this.basicAuth || this.withCredentials) {\n      options.withCredentials = true;\n    }\n    if (this.basicAuth) {\n      options.headers = options.headers || {};\n      options.headers.Authorization = this.basicAuth;\n    }\n\n    options.url = this.url + options.url;\n    options.inspect = { type: 'graphite' };\n\n    return backendSrv.datasourceRequest(options);\n  };\n\n  this._seriesRefLetters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\n\n  this.buildGraphiteParams = function(options, scopedVars) {\n    const graphiteOptions = ['from', 'until', 'rawData', 'format', 'maxDataPoints', 'cacheTimeout'];\n    const cleanOptions = [],\n      targets = {};\n    let target, targetValue, i;\n    const regex = /\\#([A-Z])/g;\n    const intervalFormatFixRegex = /'(\\d+)m'/gi;\n    let hasTargets = false;\n\n    options['format'] = 'json';\n\n    function fixIntervalFormat(match) {\n      return match.replace('m', 'min').replace('M', 'mon');\n    }\n\n    for (i = 0; i < options.targets.length; i++) {\n      target = options.targets[i];\n      if (!target.target) {\n        continue;\n      }\n\n      if (!target.refId) {\n        target.refId = this._seriesRefLetters[i];\n      }\n\n      targetValue = templateSrv.replace(target.target, scopedVars);\n      targetValue = targetValue.replace(intervalFormatFixRegex, fixIntervalFormat);\n      targets[target.refId] = targetValue;\n    }\n\n    function nestedSeriesRegexReplacer(match, g1) {\n      return targets[g1] || match;\n    }\n\n    for (i = 0; i < options.targets.length; i++) {\n      target = options.targets[i];\n      if (!target.target) {\n        continue;\n      }\n\n      targetValue = targets[target.refId];\n      targetValue = targetValue.replace(regex, nestedSeriesRegexReplacer);\n      targets[target.refId] = targetValue;\n\n      if (!target.hide) {\n        hasTargets = true;\n        cleanOptions.push('target=' + encodeURIComponent(targetValue));\n      }\n    }\n\n    _.each(options, (value, key) => {\n      if (_.indexOf(graphiteOptions, key) === -1) {\n        return;\n      }\n      if (value) {\n        cleanOptions.push(key + '=' + encodeURIComponent(value));\n      }\n    });\n\n    if (!hasTargets) {\n      return [];\n    }\n\n    return cleanOptions;\n  };\n}\n\nfunction supportsTags(version: string): boolean {\n  return isVersionGtOrEq(version, '1.1');\n}\n\nfunction supportsFunctionIndex(version: string): boolean {\n  return isVersionGtOrEq(version, '1.1');\n}\n","import angular from 'angular';\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport rst2html from 'rst2html';\nimport Drop from 'tether-drop';\n\n/** @ngInject */\nexport function graphiteAddFunc($compile) {\n  const inputTemplate =\n    '<input type=\"text\"' + ' class=\"gf-form-input\"' + ' spellcheck=\"false\" style=\"display:none\"></input>';\n\n  const buttonTemplate =\n    '<a class=\"gf-form-label query-part dropdown-toggle\"' +\n    ' tabindex=\"1\" gf-dropdown=\"functionMenu\" data-toggle=\"dropdown\">' +\n    '<i class=\"fa fa-plus\"></i></a>';\n\n  return {\n    link: function($scope, elem) {\n      const ctrl = $scope.ctrl;\n\n      const $input = $(inputTemplate);\n      const $button = $(buttonTemplate);\n\n      $input.appendTo(elem);\n      $button.appendTo(elem);\n\n      ctrl.datasource.getFuncDefs().then(funcDefs => {\n        const allFunctions = _.map(funcDefs, 'name').sort();\n\n        $scope.functionMenu = createFunctionDropDownMenu(funcDefs);\n\n        $input.attr('data-provide', 'typeahead');\n        $input.typeahead({\n          source: allFunctions,\n          minLength: 1,\n          items: 10,\n          updater: value => {\n            let funcDef = ctrl.datasource.getFuncDef(value);\n            if (!funcDef) {\n              // try find close match\n              value = value.toLowerCase();\n              funcDef = _.find(allFunctions, funcName => {\n                return funcName.toLowerCase().indexOf(value) === 0;\n              });\n\n              if (!funcDef) {\n                return '';\n              }\n            }\n\n            $scope.$apply(() => {\n              ctrl.addFunction(funcDef);\n            });\n\n            $input.trigger('blur');\n            return '';\n          },\n        });\n\n        $button.click(() => {\n          $button.hide();\n          $input.show();\n          $input.focus();\n        });\n\n        $input.keyup(() => {\n          elem.toggleClass('open', $input.val() === '');\n        });\n\n        $input.blur(() => {\n          // clicking the function dropdown menu won't\n          // work if you remove class at once\n          setTimeout(() => {\n            $input.val('');\n            $input.hide();\n            $button.show();\n            elem.removeClass('open');\n          }, 200);\n        });\n\n        $compile(elem.contents())($scope);\n      });\n\n      let drop;\n      const cleanUpDrop = () => {\n        if (drop) {\n          drop.destroy();\n          drop = null;\n        }\n      };\n\n      $(elem)\n        .on('mouseenter', 'ul.dropdown-menu li', () => {\n          cleanUpDrop();\n\n          let funcDef;\n          try {\n            funcDef = ctrl.datasource.getFuncDef($('a', this).text());\n          } catch (e) {\n            // ignore\n          }\n\n          if (funcDef && funcDef.description) {\n            let shortDesc = funcDef.description;\n            if (shortDesc.length > 500) {\n              shortDesc = shortDesc.substring(0, 497) + '...';\n            }\n\n            const contentElement = document.createElement('div');\n            contentElement.innerHTML = '<h4>' + funcDef.name + '</h4>' + rst2html(shortDesc);\n\n            drop = new Drop({\n              target: this,\n              content: contentElement,\n              classes: 'drop-popover',\n              openOn: 'always',\n              tetherOptions: {\n                attachment: 'bottom left',\n                targetAttachment: 'bottom right',\n              },\n            });\n          }\n        })\n        .on('mouseout', 'ul.dropdown-menu li', () => {\n          cleanUpDrop();\n        });\n\n      $scope.$on('$destroy', cleanUpDrop);\n    },\n  };\n}\n\nangular.module('grafana.directives').directive('graphiteAddFunc', graphiteAddFunc);\n\nfunction createFunctionDropDownMenu(funcDefs) {\n  const categories = {};\n\n  _.forEach(funcDefs, funcDef => {\n    if (!funcDef.category) {\n      return;\n    }\n    if (!categories[funcDef.category]) {\n      categories[funcDef.category] = [];\n    }\n    categories[funcDef.category].push({\n      text: funcDef.name,\n      click: \"ctrl.addFunction('\" + funcDef.name + \"')\",\n    });\n  });\n\n  return _.sortBy(\n    _.map(categories, (submenu, category) => {\n      return {\n        text: category,\n        submenu: _.sortBy(submenu, 'text'),\n      };\n    }),\n    'text'\n  );\n}\n","import angular from 'angular';\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport rst2html from 'rst2html';\n\n/** @ngInject */\nexport function graphiteFuncEditor($compile, templateSrv, popoverSrv) {\n  const funcSpanTemplate = '<a ng-click=\"\">{{func.def.name}}</a><span>(</span>';\n  const paramTemplate =\n    '<input type=\"text\" style=\"display:none\"' + ' class=\"input-small tight-form-func-param\"></input>';\n\n  const funcControlsTemplate = `\n    <div class=\"tight-form-func-controls\">\n      <span class=\"pointer fa fa-arrow-left\"></span>\n      <span class=\"pointer fa fa-question-circle\"></span>\n      <span class=\"pointer fa fa-remove\" ></span>\n      <span class=\"pointer fa fa-arrow-right\"></span>\n    </div>`;\n\n  return {\n    restrict: 'A',\n    link: function postLink($scope, elem) {\n      const $funcLink = $(funcSpanTemplate);\n      const $funcControls = $(funcControlsTemplate);\n      const ctrl = $scope.ctrl;\n      const func = $scope.func;\n      let scheduledRelink = false;\n      let paramCountAtLink = 0;\n      let cancelBlur = null;\n\n      function clickFuncParam(this: any, paramIndex) {\n        /*jshint validthis:true */\n\n        const $link = $(this);\n        const $comma = $link.prev('.comma');\n        const $input = $link.next();\n\n        $input.val(func.params[paramIndex]);\n\n        $comma.removeClass('query-part__last');\n        $link.hide();\n        $input.show();\n        $input.focus();\n        $input.select();\n\n        const typeahead = $input.data('typeahead');\n        if (typeahead) {\n          $input.val('');\n          typeahead.lookup();\n        }\n      }\n\n      function scheduledRelinkIfNeeded() {\n        if (paramCountAtLink === func.params.length) {\n          return;\n        }\n\n        if (!scheduledRelink) {\n          scheduledRelink = true;\n          setTimeout(() => {\n            relink();\n            scheduledRelink = false;\n          }, 200);\n        }\n      }\n\n      function paramDef(index) {\n        if (index < func.def.params.length) {\n          return func.def.params[index];\n        }\n        if (_.last(func.def.params).multiple) {\n          return _.assign({}, _.last(func.def.params), { optional: true });\n        }\n        return {};\n      }\n\n      function switchToLink(inputElem, paramIndex) {\n        /*jshint validthis:true */\n        const $input = $(inputElem);\n\n        clearTimeout(cancelBlur);\n        cancelBlur = null;\n\n        const $link = $input.prev();\n        const $comma = $link.prev('.comma');\n        const newValue = $input.val();\n\n        // remove optional empty params\n        if (newValue !== '' || paramDef(paramIndex).optional) {\n          func.updateParam(newValue, paramIndex);\n          $link.html(newValue ? templateSrv.highlightVariablesAsHtml(newValue) : '&nbsp;');\n        }\n\n        scheduledRelinkIfNeeded();\n\n        $scope.$apply(() => {\n          ctrl.targetChanged();\n        });\n\n        if ($link.hasClass('query-part__last') && newValue === '') {\n          $comma.addClass('query-part__last');\n        } else {\n          $link.removeClass('query-part__last');\n        }\n\n        $input.hide();\n        $link.show();\n      }\n\n      // this = input element\n      function inputBlur(this: any, paramIndex) {\n        /*jshint validthis:true */\n        const inputElem = this;\n        // happens long before the click event on the typeahead options\n        // need to have long delay because the blur\n        cancelBlur = setTimeout(() => {\n          switchToLink(inputElem, paramIndex);\n        }, 200);\n      }\n\n      function inputKeyPress(this: any, paramIndex, e) {\n        /*jshint validthis:true */\n        if (e.which === 13) {\n          $(this).blur();\n        }\n      }\n\n      function inputKeyDown(this: any) {\n        /*jshint validthis:true */\n        this.style.width = (3 + this.value.length) * 8 + 'px';\n      }\n\n      function addTypeahead($input, paramIndex) {\n        $input.attr('data-provide', 'typeahead');\n\n        let options = paramDef(paramIndex).options;\n        if (paramDef(paramIndex).type === 'int') {\n          options = _.map(options, val => {\n            return val.toString();\n          });\n        }\n\n        $input.typeahead({\n          source: options,\n          minLength: 0,\n          items: 20,\n          updater: value => {\n            $input.val(value);\n            switchToLink($input[0], paramIndex);\n            return value;\n          },\n        });\n\n        const typeahead = $input.data('typeahead');\n        typeahead.lookup = function() {\n          this.query = this.$element.val() || '';\n          return this.process(this.source);\n        };\n      }\n\n      function toggleFuncControls() {\n        const targetDiv = elem.closest('.tight-form');\n\n        if (elem.hasClass('show-function-controls')) {\n          elem.removeClass('show-function-controls');\n          targetDiv.removeClass('has-open-function');\n          $funcControls.hide();\n          return;\n        }\n\n        elem.addClass('show-function-controls');\n        targetDiv.addClass('has-open-function');\n\n        $funcControls.show();\n      }\n\n      function addElementsAndCompile() {\n        $funcControls.appendTo(elem);\n        $funcLink.appendTo(elem);\n\n        const defParams = _.clone(func.def.params);\n        const lastParam = _.last(func.def.params);\n\n        while (func.params.length >= defParams.length && lastParam && lastParam.multiple) {\n          defParams.push(_.assign({}, lastParam, { optional: true }));\n        }\n\n        _.each(defParams, (param, index) => {\n          if (param.optional && func.params.length < index) {\n            return false;\n          }\n\n          let paramValue = templateSrv.highlightVariablesAsHtml(func.params[index]);\n\n          const last = index >= func.params.length - 1 && param.optional && !paramValue;\n          if (last && param.multiple) {\n            paramValue = '+';\n          }\n\n          if (index > 0) {\n            $('<span class=\"comma' + (last ? ' query-part__last' : '') + '\">, </span>').appendTo(elem);\n          }\n\n          const $paramLink = $(\n            '<a ng-click=\"\" class=\"graphite-func-param-link' +\n              (last ? ' query-part__last' : '') +\n              '\">' +\n              (paramValue || '&nbsp;') +\n              '</a>'\n          );\n          const $input = $(paramTemplate);\n          $input.attr('placeholder', param.name);\n\n          paramCountAtLink++;\n\n          $paramLink.appendTo(elem);\n          $input.appendTo(elem);\n\n          $input.blur(_.partial(inputBlur, index));\n          $input.keyup(inputKeyDown);\n          $input.keypress(_.partial(inputKeyPress, index));\n          $paramLink.click(_.partial(clickFuncParam, index));\n\n          if (param.options) {\n            addTypeahead($input, index);\n          }\n\n          return true;\n        });\n\n        $('<span>)</span>').appendTo(elem);\n\n        $compile(elem.contents())($scope);\n      }\n\n      function ifJustAddedFocusFirstParam() {\n        if ($scope.func.added) {\n          $scope.func.added = false;\n          setTimeout(() => {\n            elem\n              .find('.graphite-func-param-link')\n              .first()\n              .click();\n          }, 10);\n        }\n      }\n\n      function registerFuncControlsToggle() {\n        $funcLink.click(toggleFuncControls);\n      }\n\n      function registerFuncControlsActions() {\n        $funcControls.click(e => {\n          const $target = $(e.target);\n          if ($target.hasClass('fa-remove')) {\n            toggleFuncControls();\n            $scope.$apply(() => {\n              ctrl.removeFunction($scope.func);\n            });\n            return;\n          }\n\n          if ($target.hasClass('fa-arrow-left')) {\n            $scope.$apply(() => {\n              _.move(ctrl.queryModel.functions, $scope.$index, $scope.$index - 1);\n              ctrl.targetChanged();\n            });\n            return;\n          }\n\n          if ($target.hasClass('fa-arrow-right')) {\n            $scope.$apply(() => {\n              _.move(ctrl.queryModel.functions, $scope.$index, $scope.$index + 1);\n              ctrl.targetChanged();\n            });\n            return;\n          }\n\n          if ($target.hasClass('fa-question-circle')) {\n            const funcDef = ctrl.datasource.getFuncDef(func.def.name);\n            if (funcDef && funcDef.description) {\n              popoverSrv.show({\n                element: e.target,\n                position: 'bottom left',\n                classNames: 'drop-popover drop-function-def',\n                template: `\n                  <div style=\"overflow:auto;max-height:30rem;\">\n                    <h4> ${funcDef.name} </h4>\n                    ${rst2html(funcDef.description)}\n                  </div>`,\n                openOn: 'click',\n              });\n            } else {\n              window.open(\n                'http://graphite.readthedocs.org/en/latest/functions.html#graphite.render.functions.' + func.def.name,\n                '_blank'\n              );\n            }\n            return;\n          }\n        });\n      }\n\n      function relink() {\n        elem.children().remove();\n\n        addElementsAndCompile();\n        ifJustAddedFocusFirstParam();\n        registerFuncControlsToggle();\n        registerFuncControlsActions();\n      }\n\n      relink();\n    },\n  };\n}\n\nangular.module('grafana.directives').directive('graphiteFuncEditor', graphiteFuncEditor);\n","import _ from 'lodash';\n\n// This is auto generated from the unicode tables.\n// The tables are at:\n// http://www.fileformat.info/info/unicode/category/Lu/list.htm\n// http://www.fileformat.info/info/unicode/category/Ll/list.htm\n// http://www.fileformat.info/info/unicode/category/Lt/list.htm\n// http://www.fileformat.info/info/unicode/category/Lm/list.htm\n// http://www.fileformat.info/info/unicode/category/Lo/list.htm\n// http://www.fileformat.info/info/unicode/category/Nl/list.htm\n\nconst unicodeLetterTable = [\n  170,\n  170,\n  181,\n  181,\n  186,\n  186,\n  192,\n  214,\n  216,\n  246,\n  248,\n  705,\n  710,\n  721,\n  736,\n  740,\n  748,\n  748,\n  750,\n  750,\n  880,\n  884,\n  886,\n  887,\n  890,\n  893,\n  902,\n  902,\n  904,\n  906,\n  908,\n  908,\n  910,\n  929,\n  931,\n  1013,\n  1015,\n  1153,\n  1162,\n  1319,\n  1329,\n  1366,\n  1369,\n  1369,\n  1377,\n  1415,\n  1488,\n  1514,\n  1520,\n  1522,\n  1568,\n  1610,\n  1646,\n  1647,\n  1649,\n  1747,\n  1749,\n  1749,\n  1765,\n  1766,\n  1774,\n  1775,\n  1786,\n  1788,\n  1791,\n  1791,\n  1808,\n  1808,\n  1810,\n  1839,\n  1869,\n  1957,\n  1969,\n  1969,\n  1994,\n  2026,\n  2036,\n  2037,\n  2042,\n  2042,\n  2048,\n  2069,\n  2074,\n  2074,\n  2084,\n  2084,\n  2088,\n  2088,\n  2112,\n  2136,\n  2308,\n  2361,\n  2365,\n  2365,\n  2384,\n  2384,\n  2392,\n  2401,\n  2417,\n  2423,\n  2425,\n  2431,\n  2437,\n  2444,\n  2447,\n  2448,\n  2451,\n  2472,\n  2474,\n  2480,\n  2482,\n  2482,\n  2486,\n  2489,\n  2493,\n  2493,\n  2510,\n  2510,\n  2524,\n  2525,\n  2527,\n  2529,\n  2544,\n  2545,\n  2565,\n  2570,\n  2575,\n  2576,\n  2579,\n  2600,\n  2602,\n  2608,\n  2610,\n  2611,\n  2613,\n  2614,\n  2616,\n  2617,\n  2649,\n  2652,\n  2654,\n  2654,\n  2674,\n  2676,\n  2693,\n  2701,\n  2703,\n  2705,\n  2707,\n  2728,\n  2730,\n  2736,\n  2738,\n  2739,\n  2741,\n  2745,\n  2749,\n  2749,\n  2768,\n  2768,\n  2784,\n  2785,\n  2821,\n  2828,\n  2831,\n  2832,\n  2835,\n  2856,\n  2858,\n  2864,\n  2866,\n  2867,\n  2869,\n  2873,\n  2877,\n  2877,\n  2908,\n  2909,\n  2911,\n  2913,\n  2929,\n  2929,\n  2947,\n  2947,\n  2949,\n  2954,\n  2958,\n  2960,\n  2962,\n  2965,\n  2969,\n  2970,\n  2972,\n  2972,\n  2974,\n  2975,\n  2979,\n  2980,\n  2984,\n  2986,\n  2990,\n  3001,\n  3024,\n  3024,\n  3077,\n  3084,\n  3086,\n  3088,\n  3090,\n  3112,\n  3114,\n  3123,\n  3125,\n  3129,\n  3133,\n  3133,\n  3160,\n  3161,\n  3168,\n  3169,\n  3205,\n  3212,\n  3214,\n  3216,\n  3218,\n  3240,\n  3242,\n  3251,\n  3253,\n  3257,\n  3261,\n  3261,\n  3294,\n  3294,\n  3296,\n  3297,\n  3313,\n  3314,\n  3333,\n  3340,\n  3342,\n  3344,\n  3346,\n  3386,\n  3389,\n  3389,\n  3406,\n  3406,\n  3424,\n  3425,\n  3450,\n  3455,\n  3461,\n  3478,\n  3482,\n  3505,\n  3507,\n  3515,\n  3517,\n  3517,\n  3520,\n  3526,\n  3585,\n  3632,\n  3634,\n  3635,\n  3648,\n  3654,\n  3713,\n  3714,\n  3716,\n  3716,\n  3719,\n  3720,\n  3722,\n  3722,\n  3725,\n  3725,\n  3732,\n  3735,\n  3737,\n  3743,\n  3745,\n  3747,\n  3749,\n  3749,\n  3751,\n  3751,\n  3754,\n  3755,\n  3757,\n  3760,\n  3762,\n  3763,\n  3773,\n  3773,\n  3776,\n  3780,\n  3782,\n  3782,\n  3804,\n  3805,\n  3840,\n  3840,\n  3904,\n  3911,\n  3913,\n  3948,\n  3976,\n  3980,\n  4096,\n  4138,\n  4159,\n  4159,\n  4176,\n  4181,\n  4186,\n  4189,\n  4193,\n  4193,\n  4197,\n  4198,\n  4206,\n  4208,\n  4213,\n  4225,\n  4238,\n  4238,\n  4256,\n  4293,\n  4304,\n  4346,\n  4348,\n  4348,\n  4352,\n  4680,\n  4682,\n  4685,\n  4688,\n  4694,\n  4696,\n  4696,\n  4698,\n  4701,\n  4704,\n  4744,\n  4746,\n  4749,\n  4752,\n  4784,\n  4786,\n  4789,\n  4792,\n  4798,\n  4800,\n  4800,\n  4802,\n  4805,\n  4808,\n  4822,\n  4824,\n  4880,\n  4882,\n  4885,\n  4888,\n  4954,\n  4992,\n  5007,\n  5024,\n  5108,\n  5121,\n  5740,\n  5743,\n  5759,\n  5761,\n  5786,\n  5792,\n  5866,\n  5870,\n  5872,\n  5888,\n  5900,\n  5902,\n  5905,\n  5920,\n  5937,\n  5952,\n  5969,\n  5984,\n  5996,\n  5998,\n  6000,\n  6016,\n  6067,\n  6103,\n  6103,\n  6108,\n  6108,\n  6176,\n  6263,\n  6272,\n  6312,\n  6314,\n  6314,\n  6320,\n  6389,\n  6400,\n  6428,\n  6480,\n  6509,\n  6512,\n  6516,\n  6528,\n  6571,\n  6593,\n  6599,\n  6656,\n  6678,\n  6688,\n  6740,\n  6823,\n  6823,\n  6917,\n  6963,\n  6981,\n  6987,\n  7043,\n  7072,\n  7086,\n  7087,\n  7104,\n  7141,\n  7168,\n  7203,\n  7245,\n  7247,\n  7258,\n  7293,\n  7401,\n  7404,\n  7406,\n  7409,\n  7424,\n  7615,\n  7680,\n  7957,\n  7960,\n  7965,\n  7968,\n  8005,\n  8008,\n  8013,\n  8016,\n  8023,\n  8025,\n  8025,\n  8027,\n  8027,\n  8029,\n  8029,\n  8031,\n  8061,\n  8064,\n  8116,\n  8118,\n  8124,\n  8126,\n  8126,\n  8130,\n  8132,\n  8134,\n  8140,\n  8144,\n  8147,\n  8150,\n  8155,\n  8160,\n  8172,\n  8178,\n  8180,\n  8182,\n  8188,\n  8305,\n  8305,\n  8319,\n  8319,\n  8336,\n  8348,\n  8450,\n  8450,\n  8455,\n  8455,\n  8458,\n  8467,\n  8469,\n  8469,\n  8473,\n  8477,\n  8484,\n  8484,\n  8486,\n  8486,\n  8488,\n  8488,\n  8490,\n  8493,\n  8495,\n  8505,\n  8508,\n  8511,\n  8517,\n  8521,\n  8526,\n  8526,\n  8544,\n  8584,\n  11264,\n  11310,\n  11312,\n  11358,\n  11360,\n  11492,\n  11499,\n  11502,\n  11520,\n  11557,\n  11568,\n  11621,\n  11631,\n  11631,\n  11648,\n  11670,\n  11680,\n  11686,\n  11688,\n  11694,\n  11696,\n  11702,\n  11704,\n  11710,\n  11712,\n  11718,\n  11720,\n  11726,\n  11728,\n  11734,\n  11736,\n  11742,\n  11823,\n  11823,\n  12293,\n  12295,\n  12321,\n  12329,\n  12337,\n  12341,\n  12344,\n  12348,\n  12353,\n  12438,\n  12445,\n  12447,\n  12449,\n  12538,\n  12540,\n  12543,\n  12549,\n  12589,\n  12593,\n  12686,\n  12704,\n  12730,\n  12784,\n  12799,\n  13312,\n  13312,\n  19893,\n  19893,\n  19968,\n  19968,\n  40907,\n  40907,\n  40960,\n  42124,\n  42192,\n  42237,\n  42240,\n  42508,\n  42512,\n  42527,\n  42538,\n  42539,\n  42560,\n  42606,\n  42623,\n  42647,\n  42656,\n  42735,\n  42775,\n  42783,\n  42786,\n  42888,\n  42891,\n  42894,\n  42896,\n  42897,\n  42912,\n  42921,\n  43002,\n  43009,\n  43011,\n  43013,\n  43015,\n  43018,\n  43020,\n  43042,\n  43072,\n  43123,\n  43138,\n  43187,\n  43250,\n  43255,\n  43259,\n  43259,\n  43274,\n  43301,\n  43312,\n  43334,\n  43360,\n  43388,\n  43396,\n  43442,\n  43471,\n  43471,\n  43520,\n  43560,\n  43584,\n  43586,\n  43588,\n  43595,\n  43616,\n  43638,\n  43642,\n  43642,\n  43648,\n  43695,\n  43697,\n  43697,\n  43701,\n  43702,\n  43705,\n  43709,\n  43712,\n  43712,\n  43714,\n  43714,\n  43739,\n  43741,\n  43777,\n  43782,\n  43785,\n  43790,\n  43793,\n  43798,\n  43808,\n  43814,\n  43816,\n  43822,\n  43968,\n  44002,\n  44032,\n  44032,\n  55203,\n  55203,\n  55216,\n  55238,\n  55243,\n  55291,\n  63744,\n  64045,\n  64048,\n  64109,\n  64112,\n  64217,\n  64256,\n  64262,\n  64275,\n  64279,\n  64285,\n  64285,\n  64287,\n  64296,\n  64298,\n  64310,\n  64312,\n  64316,\n  64318,\n  64318,\n  64320,\n  64321,\n  64323,\n  64324,\n  64326,\n  64433,\n  64467,\n  64829,\n  64848,\n  64911,\n  64914,\n  64967,\n  65008,\n  65019,\n  65136,\n  65140,\n  65142,\n  65276,\n  65313,\n  65338,\n  65345,\n  65370,\n  65382,\n  65470,\n  65474,\n  65479,\n  65482,\n  65487,\n  65490,\n  65495,\n  65498,\n  65500,\n  65536,\n  65547,\n  65549,\n  65574,\n  65576,\n  65594,\n  65596,\n  65597,\n  65599,\n  65613,\n  65616,\n  65629,\n  65664,\n  65786,\n  65856,\n  65908,\n  66176,\n  66204,\n  66208,\n  66256,\n  66304,\n  66334,\n  66352,\n  66378,\n  66432,\n  66461,\n  66464,\n  66499,\n  66504,\n  66511,\n  66513,\n  66517,\n  66560,\n  66717,\n  67584,\n  67589,\n  67592,\n  67592,\n  67594,\n  67637,\n  67639,\n  67640,\n  67644,\n  67644,\n  67647,\n  67669,\n  67840,\n  67861,\n  67872,\n  67897,\n  68096,\n  68096,\n  68112,\n  68115,\n  68117,\n  68119,\n  68121,\n  68147,\n  68192,\n  68220,\n  68352,\n  68405,\n  68416,\n  68437,\n  68448,\n  68466,\n  68608,\n  68680,\n  69635,\n  69687,\n  69763,\n  69807,\n  73728,\n  74606,\n  74752,\n  74850,\n  77824,\n  78894,\n  92160,\n  92728,\n  110592,\n  110593,\n  119808,\n  119892,\n  119894,\n  119964,\n  119966,\n  119967,\n  119970,\n  119970,\n  119973,\n  119974,\n  119977,\n  119980,\n  119982,\n  119993,\n  119995,\n  119995,\n  119997,\n  120003,\n  120005,\n  120069,\n  120071,\n  120074,\n  120077,\n  120084,\n  120086,\n  120092,\n  120094,\n  120121,\n  120123,\n  120126,\n  120128,\n  120132,\n  120134,\n  120134,\n  120138,\n  120144,\n  120146,\n  120485,\n  120488,\n  120512,\n  120514,\n  120538,\n  120540,\n  120570,\n  120572,\n  120596,\n  120598,\n  120628,\n  120630,\n  120654,\n  120656,\n  120686,\n  120688,\n  120712,\n  120714,\n  120744,\n  120746,\n  120770,\n  120772,\n  120779,\n  131072,\n  131072,\n  173782,\n  173782,\n  173824,\n  173824,\n  177972,\n  177972,\n  177984,\n  177984,\n  178205,\n  178205,\n  194560,\n  195101,\n];\n\nconst identifierStartTable = [];\n\nfor (let i = 0; i < 128; i++) {\n  identifierStartTable[i] =\n    (i >= 48 && i <= 57) || // 0-9\n    i === 36 || // $\n    i === 126 || // ~\n    i === 124 || // |\n    (i >= 65 && i <= 90) || // A-Z\n    i === 95 || // _\n    i === 45 || // -\n    i === 42 || // *\n    i === 58 || // :\n    i === 91 || // templateStart [\n    i === 93 || // templateEnd ]\n    i === 63 || // ?\n    i === 37 || // %\n    i === 35 || // #\n    i === 61 || // =\n    (i >= 97 && i <= 122); // a-z\n}\n\nconst identifierPartTable = identifierStartTable;\n\nexport function Lexer(this: any, expression) {\n  this.input = expression;\n  this.char = 1;\n  this.from = 1;\n}\n\nLexer.prototype = {\n  peek: function(i) {\n    return this.input.charAt(i || 0);\n  },\n\n  skip: function(i) {\n    i = i || 1;\n    this.char += i;\n    this.input = this.input.slice(i);\n  },\n\n  tokenize: function() {\n    const list = [];\n    let token = this.next();\n    while (token) {\n      list.push(token);\n      token = this.next();\n    }\n    return list;\n  },\n\n  next: function() {\n    this.from = this.char;\n\n    // Move to the next non-space character.\n    if (/\\s/.test(this.peek())) {\n      while (/\\s/.test(this.peek())) {\n        this.from += 1;\n        this.skip();\n      }\n\n      if (this.peek() === '') {\n        // EOL\n        return null;\n      }\n    }\n\n    let match = this.scanStringLiteral();\n    if (match) {\n      return match;\n    }\n\n    match = this.scanPunctuator() || this.scanNumericLiteral() || this.scanIdentifier() || this.scanTemplateSequence();\n\n    if (match) {\n      this.skip(match.value.length);\n      return match;\n    }\n\n    // No token could be matched, give up.\n    return null;\n  },\n\n  scanTemplateSequence: function() {\n    if (this.peek() === '[' && this.peek(1) === '[') {\n      return {\n        type: 'templateStart',\n        value: '[[',\n        pos: this.char,\n      };\n    }\n\n    if (this.peek() === ']' && this.peek(1) === ']') {\n      return {\n        type: 'templateEnd',\n        value: '[[',\n        pos: this.char,\n      };\n    }\n\n    return null;\n  },\n\n  /*\n   * Extract a JavaScript identifier out of the next sequence of\n   * characters or return 'null' if its not possible. In addition,\n   * to Identifier this method can also produce BooleanLiteral\n   * (true/false) and NullLiteral (null).\n   */\n  scanIdentifier: function() {\n    let id = '';\n    let index = 0;\n    let type, char;\n\n    // Detects any character in the Unicode categories \"Uppercase\n    // letter (Lu)\", \"Lowercase letter (Ll)\", \"Titlecase letter\n    // (Lt)\", \"Modifier letter (Lm)\", \"Other letter (Lo)\", or\n    // \"Letter number (Nl)\".\n    //\n    // Both approach and unicodeLetterTable were borrowed from\n    // Google's Traceur.\n\n    function isUnicodeLetter(code) {\n      for (let i = 0; i < unicodeLetterTable.length; ) {\n        if (code < unicodeLetterTable[i++]) {\n          return false;\n        }\n\n        if (code <= unicodeLetterTable[i++]) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n\n    function isHexDigit(str) {\n      return /^[0-9a-fA-F]$/.test(str);\n    }\n\n    const readUnicodeEscapeSequence = _.bind(function(this: any) {\n      /*jshint validthis:true */\n      index += 1;\n\n      if (this.peek(index) !== 'u') {\n        return null;\n      }\n\n      const ch1 = this.peek(index + 1);\n      const ch2 = this.peek(index + 2);\n      const ch3 = this.peek(index + 3);\n      const ch4 = this.peek(index + 4);\n      let code;\n\n      if (isHexDigit(ch1) && isHexDigit(ch2) && isHexDigit(ch3) && isHexDigit(ch4)) {\n        code = parseInt(ch1 + ch2 + ch3 + ch4, 16);\n\n        if (isUnicodeLetter(code)) {\n          index += 5;\n          return '\\\\u' + ch1 + ch2 + ch3 + ch4;\n        }\n\n        return null;\n      }\n\n      return null;\n    }, this);\n\n    const getIdentifierStart = _.bind(function(this: any) {\n      /*jshint validthis:true */\n      const chr = this.peek(index);\n      const code = chr.charCodeAt(0);\n\n      if (chr === '*') {\n        index += 1;\n        return chr;\n      }\n\n      if (code === 92) {\n        return readUnicodeEscapeSequence();\n      }\n\n      if (code < 128) {\n        if (identifierStartTable[code]) {\n          index += 1;\n          return chr;\n        }\n\n        return null;\n      }\n\n      if (isUnicodeLetter(code)) {\n        index += 1;\n        return chr;\n      }\n\n      return null;\n    }, this);\n\n    const getIdentifierPart = _.bind(function(this: any) {\n      /*jshint validthis:true */\n      const chr = this.peek(index);\n      const code = chr.charCodeAt(0);\n\n      if (code === 92) {\n        return readUnicodeEscapeSequence();\n      }\n\n      if (code < 128) {\n        if (identifierPartTable[code]) {\n          index += 1;\n          return chr;\n        }\n\n        return null;\n      }\n\n      if (isUnicodeLetter(code)) {\n        index += 1;\n        return chr;\n      }\n\n      return null;\n    }, this);\n\n    char = getIdentifierStart();\n    if (char === null) {\n      return null;\n    }\n\n    id = char;\n    for (;;) {\n      char = getIdentifierPart();\n\n      if (char === null) {\n        break;\n      }\n\n      id += char;\n    }\n\n    switch (id) {\n      case 'true': {\n        type = 'bool';\n        break;\n      }\n      case 'false': {\n        type = 'bool';\n        break;\n      }\n      default:\n        type = 'identifier';\n    }\n\n    return {\n      type: type,\n      value: id,\n      pos: this.char,\n    };\n  },\n\n  /*\n   * Extract a numeric literal out of the next sequence of\n   * characters or return 'null' if its not possible. This method\n   * supports all numeric literals described in section 7.8.3\n   * of the EcmaScript 5 specification.\n   *\n   * This method's implementation was heavily influenced by the\n   * scanNumericLiteral function in the Esprima parser's source code.\n   */\n  scanNumericLiteral: function(): any {\n    let index = 0;\n    let value = '';\n    const length = this.input.length;\n    let char = this.peek(index);\n    let bad;\n\n    function isDecimalDigit(str) {\n      return /^[0-9]$/.test(str);\n    }\n\n    function isOctalDigit(str) {\n      return /^[0-7]$/.test(str);\n    }\n\n    function isHexDigit(str) {\n      return /^[0-9a-fA-F]$/.test(str);\n    }\n\n    function isIdentifierStart(ch) {\n      return ch === '$' || ch === '_' || ch === '\\\\' || (ch >= 'a' && ch <= 'z') || (ch >= 'A' && ch <= 'Z');\n    }\n\n    // handle negative num literals\n    if (char === '-') {\n      value += char;\n      index += 1;\n      char = this.peek(index);\n    }\n\n    // Numbers must start either with a decimal digit or a point.\n    if (char !== '.' && !isDecimalDigit(char)) {\n      return null;\n    }\n\n    if (char !== '.') {\n      value += this.peek(index);\n      index += 1;\n      char = this.peek(index);\n\n      if (value === '0') {\n        // Base-16 numbers.\n        if (char === 'x' || char === 'X') {\n          index += 1;\n          value += char;\n\n          while (index < length) {\n            char = this.peek(index);\n            if (!isHexDigit(char)) {\n              break;\n            }\n            value += char;\n            index += 1;\n          }\n\n          if (value.length <= 2) {\n            // 0x\n            return {\n              type: 'number',\n              value: value,\n              isMalformed: true,\n              pos: this.char,\n            };\n          }\n\n          if (index < length) {\n            char = this.peek(index);\n            if (isIdentifierStart(char)) {\n              return null;\n            }\n          }\n\n          return {\n            type: 'number',\n            value: value,\n            base: 16,\n            isMalformed: false,\n            pos: this.char,\n          };\n        }\n\n        // Base-8 numbers.\n        if (isOctalDigit(char)) {\n          index += 1;\n          value += char;\n          bad = false;\n\n          while (index < length) {\n            char = this.peek(index);\n\n            // Numbers like '019' (note the 9) are not valid octals\n            // but we still parse them and mark as malformed.\n\n            if (isDecimalDigit(char)) {\n              bad = true;\n            }\n            if (!isOctalDigit(char)) {\n              // if the char is a non punctuator then its not a valid number\n              if (!this.isPunctuator(char)) {\n                return null;\n              }\n              break;\n            }\n            value += char;\n            index += 1;\n          }\n\n          if (index < length) {\n            char = this.peek(index);\n            if (isIdentifierStart(char)) {\n              return null;\n            }\n          }\n\n          return {\n            type: 'number',\n            value: value,\n            base: 8,\n            isMalformed: bad,\n          };\n        }\n\n        // Decimal numbers that start with '0' such as '09' are illegal\n        // but we still parse them and return as malformed.\n\n        if (isDecimalDigit(char)) {\n          index += 1;\n          value += char;\n        }\n      }\n\n      while (index < length) {\n        char = this.peek(index);\n        if (!isDecimalDigit(char)) {\n          break;\n        }\n        value += char;\n        index += 1;\n      }\n    }\n\n    // Decimal digits.\n\n    if (char === '.') {\n      value += char;\n      index += 1;\n\n      while (index < length) {\n        char = this.peek(index);\n        if (!isDecimalDigit(char)) {\n          break;\n        }\n        value += char;\n        index += 1;\n      }\n    }\n\n    // Exponent part.\n\n    if (char === 'e' || char === 'E') {\n      value += char;\n      index += 1;\n      char = this.peek(index);\n\n      if (char === '+' || char === '-') {\n        value += this.peek(index);\n        index += 1;\n      }\n\n      char = this.peek(index);\n      if (isDecimalDigit(char)) {\n        value += char;\n        index += 1;\n\n        while (index < length) {\n          char = this.peek(index);\n          if (!isDecimalDigit(char)) {\n            break;\n          }\n          value += char;\n          index += 1;\n        }\n      } else {\n        return null;\n      }\n    }\n\n    if (index < length) {\n      char = this.peek(index);\n      if (!this.isPunctuator(char)) {\n        return null;\n      }\n    }\n\n    return {\n      type: 'number',\n      value: value,\n      base: 10,\n      pos: this.char,\n      isMalformed: !isFinite(+value),\n    };\n  },\n\n  isPunctuator: ch1 => {\n    switch (ch1) {\n      case '.':\n      case '(':\n      case ')':\n      case ',':\n      case '{':\n      case '}':\n        return true;\n    }\n\n    return false;\n  },\n\n  scanPunctuator: function() {\n    const ch1 = this.peek();\n\n    if (this.isPunctuator(ch1)) {\n      return {\n        type: ch1,\n        value: ch1,\n        pos: this.char,\n      };\n    }\n\n    return null;\n  },\n\n  /*\n   * Extract a string out of the next sequence of characters and/or\n   * lines or return 'null' if its not possible. Since strings can\n   * span across multiple lines this method has to move the char\n   * pointer.\n   *\n   * This method recognizes pseudo-multiline JavaScript strings:\n   *\n   *   var str = \"hello\\\n   *   world\";\n   */\n  scanStringLiteral: function() {\n    /*jshint loopfunc:true */\n    const quote = this.peek();\n\n    // String must start with a quote.\n    if (quote !== '\"' && quote !== \"'\") {\n      return null;\n    }\n\n    let value = '';\n\n    this.skip();\n\n    while (this.peek() !== quote) {\n      if (this.peek() === '') {\n        // End Of Line\n        return {\n          type: 'string',\n          value: value,\n          isUnclosed: true,\n          quote: quote,\n          pos: this.char,\n        };\n      }\n\n      const char = this.peek();\n      const jump = 1; // A length of a jump, after we're done\n      // parsing this character.\n\n      value += char;\n      this.skip(jump);\n    }\n\n    this.skip();\n    return {\n      type: 'string',\n      value: value,\n      isUnclosed: false,\n      quote: quote,\n      pos: this.char,\n    };\n  },\n};\n","import { Lexer } from './lexer';\n\nexport function Parser(this: any, expression) {\n  this.expression = expression;\n  this.lexer = new Lexer(expression);\n  this.tokens = this.lexer.tokenize();\n  this.index = 0;\n}\n\nParser.prototype = {\n  getAst: function() {\n    return this.start();\n  },\n\n  start: function() {\n    try {\n      return this.functionCall() || this.metricExpression();\n    } catch (e) {\n      return {\n        type: 'error',\n        message: e.message,\n        pos: e.pos,\n      };\n    }\n  },\n\n  curlyBraceSegment: function() {\n    if (this.match('identifier', '{') || this.match('{')) {\n      let curlySegment = '';\n\n      while (!this.match('') && !this.match('}')) {\n        curlySegment += this.consumeToken().value;\n      }\n\n      if (!this.match('}')) {\n        this.errorMark(\"Expected closing '}'\");\n      }\n\n      curlySegment += this.consumeToken().value;\n\n      // if curly segment is directly followed by identifier\n      // include it in the segment\n      if (this.match('identifier')) {\n        curlySegment += this.consumeToken().value;\n      }\n\n      return {\n        type: 'segment',\n        value: curlySegment,\n      };\n    } else {\n      return null;\n    }\n  },\n\n  metricSegment: function() {\n    const curly = this.curlyBraceSegment();\n    if (curly) {\n      return curly;\n    }\n\n    if (this.match('identifier') || this.match('number')) {\n      // hack to handle float numbers in metric segments\n      const parts = this.consumeToken().value.split('.');\n      if (parts.length === 2) {\n        this.tokens.splice(this.index, 0, { type: '.' });\n        this.tokens.splice(this.index + 1, 0, {\n          type: 'number',\n          value: parts[1],\n        });\n      }\n\n      return {\n        type: 'segment',\n        value: parts[0],\n      };\n    }\n\n    if (!this.match('templateStart')) {\n      this.errorMark('Expected metric identifier');\n    }\n\n    this.consumeToken();\n\n    if (!this.match('identifier')) {\n      this.errorMark('Expected identifier after templateStart');\n    }\n\n    const node = {\n      type: 'template',\n      value: this.consumeToken().value,\n    };\n\n    if (!this.match('templateEnd')) {\n      this.errorMark('Expected templateEnd');\n    }\n\n    this.consumeToken();\n    return node;\n  },\n\n  metricExpression: function() {\n    if (!this.match('templateStart') && !this.match('identifier') && !this.match('number') && !this.match('{')) {\n      return null;\n    }\n\n    const node = {\n      type: 'metric',\n      segments: [],\n    };\n\n    node.segments.push(this.metricSegment());\n\n    while (this.match('.')) {\n      this.consumeToken();\n\n      const segment = this.metricSegment();\n      if (!segment) {\n        this.errorMark('Expected metric identifier');\n      }\n\n      node.segments.push(segment);\n    }\n\n    return node;\n  },\n\n  functionCall: function() {\n    if (!this.match('identifier', '(')) {\n      return null;\n    }\n\n    const node: any = {\n      type: 'function',\n      name: this.consumeToken().value,\n    };\n\n    // consume left parenthesis\n    this.consumeToken();\n\n    node.params = this.functionParameters();\n\n    if (!this.match(')')) {\n      this.errorMark('Expected closing parenthesis');\n    }\n\n    this.consumeToken();\n\n    return node;\n  },\n\n  boolExpression: function() {\n    if (!this.match('bool')) {\n      return null;\n    }\n\n    return {\n      type: 'bool',\n      value: this.consumeToken().value === 'true',\n    };\n  },\n\n  functionParameters: function() {\n    if (this.match(')') || this.match('')) {\n      return [];\n    }\n\n    const param =\n      this.functionCall() ||\n      this.numericLiteral() ||\n      this.seriesRefExpression() ||\n      this.boolExpression() ||\n      this.metricExpression() ||\n      this.stringLiteral();\n\n    if (!this.match(',')) {\n      return [param];\n    }\n\n    this.consumeToken();\n    return [param].concat(this.functionParameters());\n  },\n\n  seriesRefExpression: function() {\n    if (!this.match('identifier')) {\n      return null;\n    }\n\n    const value = this.tokens[this.index].value;\n    if (!value.match(/\\#[A-Z]/)) {\n      return null;\n    }\n\n    const token = this.consumeToken();\n\n    return {\n      type: 'series-ref',\n      value: token.value,\n    };\n  },\n\n  numericLiteral: function() {\n    if (!this.match('number')) {\n      return null;\n    }\n\n    return {\n      type: 'number',\n      value: parseFloat(this.consumeToken().value),\n    };\n  },\n\n  stringLiteral: function() {\n    if (!this.match('string')) {\n      return null;\n    }\n\n    const token = this.consumeToken();\n    if (token.isUnclosed) {\n      throw { message: 'Unclosed string parameter', pos: token.pos };\n    }\n\n    return {\n      type: 'string',\n      value: token.value,\n    };\n  },\n\n  errorMark: function(text) {\n    const currentToken = this.tokens[this.index];\n    const type = currentToken ? currentToken.type : 'end of string';\n    throw {\n      message: text + ' instead found ' + type,\n      pos: currentToken ? currentToken.pos : this.lexer.char,\n    };\n  },\n\n  // returns token value and incre\n  consumeToken: function() {\n    this.index++;\n    return this.tokens[this.index - 1];\n  },\n\n  matchToken: function(type, index) {\n    const token = this.tokens[this.index + index];\n    return (token === undefined && type === '') || (token && token.type === type);\n  },\n\n  match: function(token1, token2) {\n    return this.matchToken(token1, 0) && (!token2 || this.matchToken(token2, 1));\n  },\n};\n","import _ from 'lodash';\nimport { Parser } from './parser';\n\nexport default class GraphiteQuery {\n  datasource: any;\n  target: any;\n  functions: any[];\n  segments: any[];\n  tags: any[];\n  error: any;\n  seriesByTagUsed: boolean;\n  checkOtherSegmentsIndex: number;\n  removeTagValue: string;\n  templateSrv: any;\n  scopedVars: any;\n\n  /** @ngInject */\n  constructor(datasource, target, templateSrv?, scopedVars?) {\n    this.datasource = datasource;\n    this.target = target;\n    this.parseTarget();\n\n    this.removeTagValue = '-- remove tag --';\n  }\n\n  parseTarget() {\n    this.functions = [];\n    this.segments = [];\n    this.tags = [];\n    this.error = null;\n\n    if (this.target.textEditor) {\n      return;\n    }\n\n    const parser = new Parser(this.target.target);\n    const astNode = parser.getAst();\n    if (astNode === null) {\n      this.checkOtherSegmentsIndex = 0;\n      return;\n    }\n\n    if (astNode.type === 'error') {\n      this.error = astNode.message + ' at position: ' + astNode.pos;\n      this.target.textEditor = true;\n      return;\n    }\n\n    try {\n      this.parseTargetRecursive(astNode, null);\n    } catch (err) {\n      console.log('error parsing target:', err.message);\n      this.error = err.message;\n      this.target.textEditor = true;\n    }\n\n    this.checkOtherSegmentsIndex = this.segments.length - 1;\n    this.checkForSeriesByTag();\n  }\n\n  checkForSeriesByTag() {\n    const seriesByTagFunc = _.find(this.functions, func => func.def.name === 'seriesByTag');\n    if (seriesByTagFunc) {\n      this.seriesByTagUsed = true;\n      seriesByTagFunc.hidden = true;\n      const tags = this.splitSeriesByTagParams(seriesByTagFunc);\n      this.tags = tags;\n    }\n  }\n\n  getSegmentPathUpTo(index) {\n    const arr = this.segments.slice(0, index);\n\n    return _.reduce(\n      arr,\n      (result, segment) => {\n        return result ? result + '.' + segment.value : segment.value;\n      },\n      ''\n    );\n  }\n\n  parseTargetRecursive(astNode, func) {\n    if (astNode === null) {\n      return null;\n    }\n\n    switch (astNode.type) {\n      case 'function':\n        const innerFunc = this.datasource.createFuncInstance(astNode.name, {\n          withDefaultParams: false,\n        });\n        _.each(astNode.params, param => {\n          this.parseTargetRecursive(param, innerFunc);\n        });\n\n        innerFunc.updateText();\n        this.functions.push(innerFunc);\n        break;\n      case 'series-ref':\n        if (this.segments.length > 0) {\n          this.addFunctionParameter(func, astNode.value);\n        } else {\n          this.segments.push(astNode);\n        }\n        break;\n      case 'bool':\n      case 'string':\n      case 'number':\n        this.addFunctionParameter(func, astNode.value);\n        break;\n      case 'metric':\n        if (this.segments.length > 0) {\n          this.addFunctionParameter(func, _.join(_.map(astNode.segments, 'value'), '.'));\n        } else {\n          this.segments = astNode.segments;\n        }\n        break;\n    }\n  }\n\n  updateSegmentValue(segment, index) {\n    this.segments[index].value = segment.value;\n  }\n\n  addSelectMetricSegment() {\n    this.segments.push({ value: 'select metric' });\n  }\n\n  addFunction(newFunc) {\n    this.functions.push(newFunc);\n    this.moveAliasFuncLast();\n  }\n\n  moveAliasFuncLast() {\n    const aliasFunc = _.find(this.functions, func => {\n      return func.def.name.startsWith('alias');\n    });\n\n    if (aliasFunc) {\n      this.functions = _.without(this.functions, aliasFunc);\n      this.functions.push(aliasFunc);\n    }\n  }\n\n  addFunctionParameter(func, value) {\n    if (func.params.length >= func.def.params.length && !_.get(_.last(func.def.params), 'multiple', false)) {\n      throw { message: 'too many parameters for function ' + func.def.name };\n    }\n    func.params.push(value);\n  }\n\n  removeFunction(func) {\n    this.functions = _.without(this.functions, func);\n  }\n\n  updateModelTarget(targets) {\n    // render query\n    if (!this.target.textEditor) {\n      const metricPath = this.getSegmentPathUpTo(this.segments.length).replace(/\\.select metric$/, '');\n      this.target.target = _.reduce(this.functions, wrapFunction, metricPath);\n    }\n\n    this.updateRenderedTarget(this.target, targets);\n\n    // loop through other queries and update targetFull as needed\n    for (const target of targets || []) {\n      if (target.refId !== this.target.refId) {\n        this.updateRenderedTarget(target, targets);\n      }\n    }\n  }\n\n  updateRenderedTarget(target, targets) {\n    // render nested query\n    const targetsByRefId = _.keyBy(targets, 'refId');\n\n    // no references to self\n    delete targetsByRefId[target.refId];\n\n    const nestedSeriesRefRegex = /\\#([A-Z])/g;\n    let targetWithNestedQueries = target.target;\n\n    // Use ref count to track circular references\n    function countTargetRefs(targetsByRefId, refId) {\n      let refCount = 0;\n      _.each(targetsByRefId, (t, id) => {\n        if (id !== refId) {\n          const match = nestedSeriesRefRegex.exec(t.target);\n          const count = match && match.length ? match.length - 1 : 0;\n          refCount += count;\n        }\n      });\n      targetsByRefId[refId].refCount = refCount;\n    }\n    _.each(targetsByRefId, (t, id) => {\n      countTargetRefs(targetsByRefId, id);\n    });\n\n    // Keep interpolating until there are no query references\n    // The reason for the loop is that the referenced query might contain another reference to another query\n    while (targetWithNestedQueries.match(nestedSeriesRefRegex)) {\n      const updated = targetWithNestedQueries.replace(nestedSeriesRefRegex, (match, g1) => {\n        const t = targetsByRefId[g1];\n        if (!t) {\n          return match;\n        }\n\n        // no circular references\n        if (t.refCount === 0) {\n          delete targetsByRefId[g1];\n        }\n        t.refCount--;\n\n        return t.target;\n      });\n\n      if (updated === targetWithNestedQueries) {\n        break;\n      }\n\n      targetWithNestedQueries = updated;\n    }\n\n    delete target.targetFull;\n    if (target.target !== targetWithNestedQueries) {\n      target.targetFull = targetWithNestedQueries;\n    }\n  }\n\n  splitSeriesByTagParams(func) {\n    const tagPattern = /([^\\!=~]+)(\\!?=~?)(.*)/;\n    return _.flatten(\n      _.map(func.params, (param: string) => {\n        const matches = tagPattern.exec(param);\n        if (matches) {\n          const tag = matches.slice(1);\n          if (tag.length === 3) {\n            return {\n              key: tag[0],\n              operator: tag[1],\n              value: tag[2],\n            };\n          }\n        }\n        return [];\n      })\n    );\n  }\n\n  getSeriesByTagFuncIndex() {\n    return _.findIndex(this.functions, func => func.def.name === 'seriesByTag');\n  }\n\n  getSeriesByTagFunc() {\n    const seriesByTagFuncIndex = this.getSeriesByTagFuncIndex();\n    if (seriesByTagFuncIndex >= 0) {\n      return this.functions[seriesByTagFuncIndex];\n    } else {\n      return undefined;\n    }\n  }\n\n  addTag(tag) {\n    const newTagParam = renderTagString(tag);\n    this.getSeriesByTagFunc().params.push(newTagParam);\n    this.tags.push(tag);\n  }\n\n  removeTag(index) {\n    this.getSeriesByTagFunc().params.splice(index, 1);\n    this.tags.splice(index, 1);\n  }\n\n  updateTag(tag, tagIndex) {\n    this.error = null;\n\n    if (tag.key === this.removeTagValue) {\n      this.removeTag(tagIndex);\n      return;\n    }\n\n    const newTagParam = renderTagString(tag);\n    this.getSeriesByTagFunc().params[tagIndex] = newTagParam;\n    this.tags[tagIndex] = tag;\n  }\n\n  renderTagExpressions(excludeIndex = -1) {\n    return _.compact(\n      _.map(this.tags, (tagExpr, index) => {\n        // Don't render tag that we want to lookup\n        if (index !== excludeIndex) {\n          return tagExpr.key + tagExpr.operator + tagExpr.value;\n        }\n      })\n    );\n  }\n}\n\nfunction wrapFunction(target, func) {\n  return func.render(target);\n}\n\nfunction renderTagString(tag) {\n  return tag.key + tag.operator + tag.value;\n}\n","import './add_graphite_func';\nimport './func_editor';\n\nimport _ from 'lodash';\nimport GraphiteQuery from './graphite_query';\nimport { QueryCtrl } from 'app/plugins/sdk';\nimport appEvents from 'app/core/app_events';\n\nconst GRAPHITE_TAG_OPERATORS = ['=', '!=', '=~', '!=~'];\nconst TAG_PREFIX = 'tag: ';\n\nexport class GraphiteQueryCtrl extends QueryCtrl {\n  static templateUrl = 'partials/query.editor.html';\n\n  queryModel: GraphiteQuery;\n  segments: any[];\n  addTagSegments: any[];\n  removeTagValue: string;\n  supportsTags: boolean;\n  paused: boolean;\n\n  /** @ngInject */\n  constructor($scope, $injector, private uiSegmentSrv, private templateSrv, $timeout) {\n    super($scope, $injector);\n    this.supportsTags = this.datasource.supportsTags;\n    this.paused = false;\n    this.target.target = this.target.target || '';\n\n    this.datasource.waitForFuncDefsLoaded().then(() => {\n      this.queryModel = new GraphiteQuery(this.datasource, this.target, templateSrv);\n      this.buildSegments();\n    });\n\n    this.removeTagValue = '-- remove tag --';\n  }\n\n  parseTarget() {\n    this.queryModel.parseTarget();\n    this.buildSegments();\n  }\n\n  toggleEditorMode() {\n    this.target.textEditor = !this.target.textEditor;\n    this.parseTarget();\n  }\n\n  buildSegments() {\n    this.segments = _.map(this.queryModel.segments, segment => {\n      return this.uiSegmentSrv.newSegment(segment);\n    });\n\n    const checkOtherSegmentsIndex = this.queryModel.checkOtherSegmentsIndex || 0;\n    this.checkOtherSegments(checkOtherSegmentsIndex);\n\n    if (this.queryModel.seriesByTagUsed) {\n      this.fixTagSegments();\n    }\n  }\n\n  addSelectMetricSegment() {\n    this.queryModel.addSelectMetricSegment();\n    this.segments.push(this.uiSegmentSrv.newSelectMetric());\n  }\n\n  checkOtherSegments(fromIndex) {\n    if (this.queryModel.segments.length === 1 && this.queryModel.segments[0].type === 'series-ref') {\n      return;\n    }\n\n    if (fromIndex === 0) {\n      this.addSelectMetricSegment();\n      return;\n    }\n\n    const path = this.queryModel.getSegmentPathUpTo(fromIndex + 1);\n    if (path === '') {\n      return Promise.resolve();\n    }\n\n    return this.datasource\n      .metricFindQuery(path)\n      .then(segments => {\n        if (segments.length === 0) {\n          if (path !== '') {\n            this.queryModel.segments = this.queryModel.segments.splice(0, fromIndex);\n            this.segments = this.segments.splice(0, fromIndex);\n            this.addSelectMetricSegment();\n          }\n        } else if (segments[0].expandable) {\n          if (this.segments.length === fromIndex) {\n            this.addSelectMetricSegment();\n          } else {\n            return this.checkOtherSegments(fromIndex + 1);\n          }\n        }\n      })\n      .catch(err => {\n        appEvents.emit('alert-error', ['Error', err]);\n      });\n  }\n\n  setSegmentFocus(segmentIndex) {\n    _.each(this.segments, (segment, index) => {\n      segment.focus = segmentIndex === index;\n    });\n  }\n\n  getAltSegments(index, prefix) {\n    let query = prefix && prefix.length > 0 ? '*' + prefix + '*' : '*';\n    if (index > 0) {\n      query = this.queryModel.getSegmentPathUpTo(index) + '.' + query;\n    }\n    const options = {\n      range: this.panelCtrl.range,\n      requestId: 'get-alt-segments',\n    };\n\n    return this.datasource\n      .metricFindQuery(query, options)\n      .then(segments => {\n        const altSegments = _.map(segments, segment => {\n          return this.uiSegmentSrv.newSegment({\n            value: segment.text,\n            expandable: segment.expandable,\n          });\n        });\n\n        if (index > 0 && altSegments.length === 0) {\n          return altSegments;\n        }\n\n        // add query references\n        if (index === 0) {\n          _.eachRight(this.panelCtrl.panel.targets, target => {\n            if (target.refId === this.queryModel.target.refId) {\n              return;\n            }\n\n            altSegments.unshift(\n              this.uiSegmentSrv.newSegment({\n                type: 'series-ref',\n                value: '#' + target.refId,\n                expandable: false,\n              })\n            );\n          });\n        }\n\n        // add template variables\n        _.eachRight(this.templateSrv.variables, variable => {\n          altSegments.unshift(\n            this.uiSegmentSrv.newSegment({\n              type: 'template',\n              value: '$' + variable.name,\n              expandable: true,\n            })\n          );\n        });\n\n        // add wildcard option\n        altSegments.unshift(this.uiSegmentSrv.newSegment('*'));\n\n        if (this.supportsTags && index === 0) {\n          this.removeTaggedEntry(altSegments);\n          return this.addAltTagSegments(prefix, altSegments);\n        } else {\n          return altSegments;\n        }\n      })\n      .catch(err => {\n        return [];\n      });\n  }\n\n  addAltTagSegments(prefix, altSegments) {\n    return this.getTagsAsSegments(prefix).then(tagSegments => {\n      tagSegments = _.map(tagSegments, segment => {\n        segment.value = TAG_PREFIX + segment.value;\n        return segment;\n      });\n      return altSegments.concat(...tagSegments);\n    });\n  }\n\n  removeTaggedEntry(altSegments) {\n    altSegments = _.remove(altSegments, s => s.value === '_tagged');\n  }\n\n  segmentValueChanged(segment, segmentIndex) {\n    this.error = null;\n    this.queryModel.updateSegmentValue(segment, segmentIndex);\n\n    if (this.queryModel.functions.length > 0 && this.queryModel.functions[0].def.fake) {\n      this.queryModel.functions = [];\n    }\n\n    if (segment.type === 'tag') {\n      const tag = removeTagPrefix(segment.value);\n      this.pause();\n      this.addSeriesByTagFunc(tag);\n      return;\n    }\n\n    if (segment.expandable) {\n      return this.checkOtherSegments(segmentIndex + 1).then(() => {\n        this.setSegmentFocus(segmentIndex + 1);\n        this.targetChanged();\n      });\n    } else {\n      this.spliceSegments(segmentIndex + 1);\n    }\n\n    this.setSegmentFocus(segmentIndex + 1);\n    this.targetChanged();\n  }\n\n  spliceSegments(index) {\n    this.segments = this.segments.splice(0, index);\n    this.queryModel.segments = this.queryModel.segments.splice(0, index);\n  }\n\n  emptySegments() {\n    this.queryModel.segments = [];\n    this.segments = [];\n  }\n\n  targetTextChanged() {\n    this.updateModelTarget();\n    this.refresh();\n  }\n\n  updateModelTarget() {\n    this.queryModel.updateModelTarget(this.panelCtrl.panel.targets);\n  }\n\n  targetChanged() {\n    if (this.queryModel.error) {\n      return;\n    }\n\n    const oldTarget = this.queryModel.target.target;\n    this.updateModelTarget();\n\n    if (this.queryModel.target !== oldTarget && !this.paused) {\n      this.panelCtrl.refresh();\n    }\n  }\n\n  addFunction(funcDef) {\n    const newFunc = this.datasource.createFuncInstance(funcDef, {\n      withDefaultParams: true,\n    });\n    newFunc.added = true;\n    this.queryModel.addFunction(newFunc);\n    this.smartlyHandleNewAliasByNode(newFunc);\n\n    if (this.segments.length === 1 && this.segments[0].fake) {\n      this.emptySegments();\n    }\n\n    if (!newFunc.params.length && newFunc.added) {\n      this.targetChanged();\n    }\n\n    if (newFunc.def.name === 'seriesByTag') {\n      this.parseTarget();\n    }\n  }\n\n  removeFunction(func) {\n    this.queryModel.removeFunction(func);\n    this.targetChanged();\n  }\n\n  addSeriesByTagFunc(tag) {\n    const newFunc = this.datasource.createFuncInstance('seriesByTag', {\n      withDefaultParams: false,\n    });\n    const tagParam = `${tag}=`;\n    newFunc.params = [tagParam];\n    this.queryModel.addFunction(newFunc);\n    newFunc.added = true;\n\n    this.emptySegments();\n    this.targetChanged();\n    this.parseTarget();\n  }\n\n  smartlyHandleNewAliasByNode(func) {\n    if (func.def.name !== 'aliasByNode') {\n      return;\n    }\n\n    for (let i = 0; i < this.segments.length; i++) {\n      if (this.segments[i].value.indexOf('*') >= 0) {\n        func.params[0] = i;\n        func.added = false;\n        this.targetChanged();\n        return;\n      }\n    }\n  }\n\n  getAllTags() {\n    return this.datasource.getTags().then(values => {\n      const altTags = _.map(values, 'text');\n      altTags.splice(0, 0, this.removeTagValue);\n      return mapToDropdownOptions(altTags);\n    });\n  }\n\n  getTags(index, tagPrefix) {\n    const tagExpressions = this.queryModel.renderTagExpressions(index);\n    return this.datasource.getTagsAutoComplete(tagExpressions, tagPrefix).then(values => {\n      const altTags = _.map(values, 'text');\n      altTags.splice(0, 0, this.removeTagValue);\n      return mapToDropdownOptions(altTags);\n    });\n  }\n\n  getTagsAsSegments(tagPrefix) {\n    const tagExpressions = this.queryModel.renderTagExpressions();\n    return this.datasource.getTagsAutoComplete(tagExpressions, tagPrefix).then(values => {\n      return _.map(values, val => {\n        return this.uiSegmentSrv.newSegment({\n          value: val.text,\n          type: 'tag',\n          expandable: false,\n        });\n      });\n    });\n  }\n\n  getTagOperators() {\n    return mapToDropdownOptions(GRAPHITE_TAG_OPERATORS);\n  }\n\n  getAllTagValues(tag) {\n    const tagKey = tag.key;\n    return this.datasource.getTagValues(tagKey).then(values => {\n      const altValues = _.map(values, 'text');\n      return mapToDropdownOptions(altValues);\n    });\n  }\n\n  getTagValues(tag, index, valuePrefix) {\n    const tagExpressions = this.queryModel.renderTagExpressions(index);\n    const tagKey = tag.key;\n    return this.datasource.getTagValuesAutoComplete(tagExpressions, tagKey, valuePrefix).then(values => {\n      const altValues = _.map(values, 'text');\n      // Add template variables as additional values\n      _.eachRight(this.templateSrv.variables, variable => {\n        altValues.push('${' + variable.name + ':regex}');\n      });\n      return mapToDropdownOptions(altValues);\n    });\n  }\n\n  tagChanged(tag, tagIndex) {\n    this.queryModel.updateTag(tag, tagIndex);\n    this.targetChanged();\n  }\n\n  addNewTag(segment) {\n    const newTagKey = segment.value;\n    const newTag = { key: newTagKey, operator: '=', value: '' };\n    this.queryModel.addTag(newTag);\n    this.targetChanged();\n    this.fixTagSegments();\n  }\n\n  removeTag(index) {\n    this.queryModel.removeTag(index);\n    this.targetChanged();\n  }\n\n  fixTagSegments() {\n    // Adding tag with the same name as just removed works incorrectly if single segment is used (instead of array)\n    this.addTagSegments = [this.uiSegmentSrv.newPlusButton()];\n  }\n\n  showDelimiter(index) {\n    return index !== this.queryModel.tags.length - 1;\n  }\n\n  pause() {\n    this.paused = true;\n  }\n\n  unpause() {\n    this.paused = false;\n    this.panelCtrl.refresh();\n  }\n}\n\nfunction mapToDropdownOptions(results) {\n  return _.map(results, value => {\n    return { text: value, value: value };\n  });\n}\n\nfunction removeTagPrefix(value: string): string {\n  return value.replace(TAG_PREFIX, '');\n}\n","export class GraphiteConfigCtrl {\n  static templateUrl = 'public/app/plugins/datasource/graphite/partials/config.html';\n  datasourceSrv: any;\n  current: any;\n\n  /** @ngInject */\n  constructor($scope, datasourceSrv) {\n    this.datasourceSrv = datasourceSrv;\n    this.current.jsonData = this.current.jsonData || {};\n    this.current.jsonData.graphiteVersion = this.current.jsonData.graphiteVersion || '0.9';\n    this.autoDetectGraphiteVersion();\n  }\n\n  autoDetectGraphiteVersion() {\n    if (!this.current.id) {\n      return;\n    }\n\n    this.datasourceSrv\n      .loadDatasource(this.current.name)\n      .then(ds => {\n        return ds.getVersion();\n      })\n      .then(version => {\n        this.graphiteVersions.push({ name: version, value: version });\n        this.current.jsonData.graphiteVersion = version;\n      });\n  }\n\n  graphiteVersions = [\n    { name: '0.9.x', value: '0.9' },\n    { name: '1.0.x', value: '1.0' },\n    { name: '1.1.x', value: '1.1' },\n  ];\n}\n","import { GraphiteDatasource } from './datasource';\nimport { GraphiteQueryCtrl } from './query_ctrl';\nimport { GraphiteConfigCtrl } from './config_ctrl';\n\nclass AnnotationsQueryCtrl {\n  static templateUrl = 'partials/annotations.editor.html';\n}\n\nexport {\n  GraphiteDatasource as Datasource,\n  GraphiteQueryCtrl as QueryCtrl,\n  GraphiteConfigCtrl as ConfigCtrl,\n  AnnotationsQueryCtrl,\n};\n","import angular from 'angular';\nimport _ from 'lodash';\n\nexport class CloudWatchQueryParameter {\n  constructor() {\n    return {\n      templateUrl: 'public/app/plugins/datasource/cloudwatch/partials/query.parameter.html',\n      controller: 'CloudWatchQueryParameterCtrl',\n      restrict: 'E',\n      scope: {\n        target: '=',\n        datasource: '=',\n        onChange: '&',\n      },\n    };\n  }\n}\n\nexport class CloudWatchQueryParameterCtrl {\n  /** @ngInject */\n  constructor($scope, templateSrv, uiSegmentSrv, datasourceSrv, $q) {\n    $scope.init = () => {\n      const target = $scope.target;\n      target.namespace = target.namespace || '';\n      target.metricName = target.metricName || '';\n      target.statistics = target.statistics || ['Average'];\n      target.dimensions = target.dimensions || {};\n      target.period = target.period || '';\n      target.region = target.region || 'default';\n      target.id = target.id || '';\n      target.expression = target.expression || '';\n      target.returnData = target.returnData || false;\n      target.highResolution = target.highResolution || false;\n\n      $scope.regionSegment = uiSegmentSrv.getSegmentForValue($scope.target.region, 'select region');\n      $scope.namespaceSegment = uiSegmentSrv.getSegmentForValue($scope.target.namespace, 'select namespace');\n      $scope.metricSegment = uiSegmentSrv.getSegmentForValue($scope.target.metricName, 'select metric');\n\n      $scope.dimSegments = _.reduce(\n        $scope.target.dimensions,\n        (memo, value, key) => {\n          memo.push(uiSegmentSrv.newKey(key));\n          memo.push(uiSegmentSrv.newOperator('='));\n          memo.push(uiSegmentSrv.newKeyValue(value));\n          return memo;\n        },\n        []\n      );\n\n      $scope.statSegments = _.map($scope.target.statistics, stat => {\n        return uiSegmentSrv.getSegmentForValue(stat);\n      });\n\n      $scope.ensurePlusButton($scope.statSegments);\n      $scope.ensurePlusButton($scope.dimSegments);\n      $scope.removeDimSegment = uiSegmentSrv.newSegment({\n        fake: true,\n        value: '-- remove dimension --',\n      });\n      $scope.removeStatSegment = uiSegmentSrv.newSegment({\n        fake: true,\n        value: '-- remove stat --',\n      });\n\n      if (_.isEmpty($scope.target.region)) {\n        $scope.target.region = 'default';\n      }\n\n      if (!$scope.onChange) {\n        $scope.onChange = () => {};\n      }\n    };\n\n    $scope.getStatSegments = () => {\n      return $q.when(\n        _.flatten([\n          angular.copy($scope.removeStatSegment),\n          _.map($scope.datasource.standardStatistics, s => {\n            return uiSegmentSrv.getSegmentForValue(s);\n          }),\n          uiSegmentSrv.getSegmentForValue('pNN.NN'),\n        ])\n      );\n    };\n\n    $scope.statSegmentChanged = (segment, index) => {\n      if (segment.value === $scope.removeStatSegment.value) {\n        $scope.statSegments.splice(index, 1);\n      } else {\n        segment.type = 'value';\n      }\n\n      $scope.target.statistics = _.reduce(\n        $scope.statSegments,\n        (memo, seg) => {\n          if (!seg.fake) {\n            memo.push(seg.value);\n          }\n          return memo;\n        },\n        []\n      );\n\n      $scope.ensurePlusButton($scope.statSegments);\n      $scope.onChange();\n    };\n\n    $scope.ensurePlusButton = segments => {\n      const count = segments.length;\n      const lastSegment = segments[Math.max(count - 1, 0)];\n\n      if (!lastSegment || lastSegment.type !== 'plus-button') {\n        segments.push(uiSegmentSrv.newPlusButton());\n      }\n    };\n\n    $scope.getDimSegments = (segment, $index) => {\n      if (segment.type === 'operator') {\n        return $q.when([]);\n      }\n\n      const target = $scope.target;\n      let query = $q.when([]);\n\n      if (segment.type === 'key' || segment.type === 'plus-button') {\n        query = $scope.datasource.getDimensionKeys($scope.target.namespace, $scope.target.region);\n      } else if (segment.type === 'value') {\n        const dimensionKey = $scope.dimSegments[$index - 2].value;\n        query = $scope.datasource.getDimensionValues(\n          target.region,\n          target.namespace,\n          target.metricName,\n          dimensionKey,\n          target.dimensions\n        );\n      }\n\n      return query.then($scope.transformToSegments(true)).then(results => {\n        if (segment.type === 'key') {\n          results.splice(0, 0, angular.copy($scope.removeDimSegment));\n        }\n        return results;\n      });\n    };\n\n    $scope.dimSegmentChanged = (segment, index) => {\n      $scope.dimSegments[index] = segment;\n\n      if (segment.value === $scope.removeDimSegment.value) {\n        $scope.dimSegments.splice(index, 3);\n      } else if (segment.type === 'plus-button') {\n        $scope.dimSegments.push(uiSegmentSrv.newOperator('='));\n        $scope.dimSegments.push(uiSegmentSrv.newFake('select dimension value', 'value', 'query-segment-value'));\n        segment.type = 'key';\n        segment.cssClass = 'query-segment-key';\n      }\n\n      $scope.syncDimSegmentsWithModel();\n      $scope.ensurePlusButton($scope.dimSegments);\n      $scope.onChange();\n    };\n\n    $scope.syncDimSegmentsWithModel = () => {\n      const dims = {};\n      const length = $scope.dimSegments.length;\n\n      for (let i = 0; i < length - 2; i += 3) {\n        const keySegment = $scope.dimSegments[i];\n        const valueSegment = $scope.dimSegments[i + 2];\n        if (!valueSegment.fake) {\n          dims[keySegment.value] = valueSegment.value;\n        }\n      }\n\n      $scope.target.dimensions = dims;\n    };\n\n    $scope.getRegions = () => {\n      return $scope.datasource\n        .metricFindQuery('regions()')\n        .then(results => {\n          results.unshift({ text: 'default' });\n          return results;\n        })\n        .then($scope.transformToSegments(true));\n    };\n\n    $scope.getNamespaces = () => {\n      return $scope.datasource.metricFindQuery('namespaces()').then($scope.transformToSegments(true));\n    };\n\n    $scope.getMetrics = () => {\n      return $scope.datasource\n        .metricFindQuery('metrics(' + $scope.target.namespace + ',' + $scope.target.region + ')')\n        .then($scope.transformToSegments(true));\n    };\n\n    $scope.regionChanged = () => {\n      $scope.target.region = $scope.regionSegment.value;\n      $scope.onChange();\n    };\n\n    $scope.namespaceChanged = () => {\n      $scope.target.namespace = $scope.namespaceSegment.value;\n      $scope.onChange();\n    };\n\n    $scope.metricChanged = () => {\n      $scope.target.metricName = $scope.metricSegment.value;\n      $scope.onChange();\n    };\n\n    $scope.transformToSegments = addTemplateVars => {\n      return results => {\n        const segments = _.map(results, segment => {\n          return uiSegmentSrv.newSegment({\n            value: segment.text,\n            expandable: segment.expandable,\n          });\n        });\n\n        if (addTemplateVars) {\n          _.each(templateSrv.variables, variable => {\n            segments.unshift(\n              uiSegmentSrv.newSegment({\n                type: 'template',\n                value: '$' + variable.name,\n                expandable: true,\n              })\n            );\n          });\n        }\n\n        return segments;\n      };\n    };\n\n    $scope.init();\n  }\n}\n\nangular.module('grafana.controllers').directive('cloudwatchQueryParameter', CloudWatchQueryParameter);\nangular.module('grafana.controllers').controller('CloudWatchQueryParameterCtrl', CloudWatchQueryParameterCtrl);\n","import angular from 'angular';\nimport _ from 'lodash';\nimport * as dateMath from 'app/core/utils/datemath';\nimport kbn from 'app/core/utils/kbn';\nimport * as templatingVariable from 'app/features/templating/variable';\n// import * as moment from 'moment';\n\nexport default class CloudWatchDatasource {\n  type: any;\n  name: any;\n  proxyUrl: any;\n  defaultRegion: any;\n  instanceSettings: any;\n  standardStatistics: any;\n  /** @ngInject */\n  constructor(instanceSettings, private $q, private backendSrv, private templateSrv, private timeSrv) {\n    this.type = 'cloudwatch';\n    this.name = instanceSettings.name;\n    this.proxyUrl = instanceSettings.url;\n    this.defaultRegion = instanceSettings.jsonData.defaultRegion;\n    this.instanceSettings = instanceSettings;\n    this.standardStatistics = ['Average', 'Maximum', 'Minimum', 'Sum', 'SampleCount'];\n  }\n\n  query(options) {\n    options = angular.copy(options);\n    options.targets = this.expandTemplateVariable(options.targets, options.scopedVars, this.templateSrv);\n\n    const queries = _.filter(options.targets, item => {\n      return (\n        (item.id !== '' || item.hide !== true) &&\n        ((!!item.region && !!item.namespace && !!item.metricName && !_.isEmpty(item.statistics)) ||\n          item.expression.length > 0)\n      );\n    }).map(item => {\n      item.region = this.templateSrv.replace(this.getActualRegion(item.region), options.scopedVars);\n      item.namespace = this.templateSrv.replace(item.namespace, options.scopedVars);\n      item.metricName = this.templateSrv.replace(item.metricName, options.scopedVars);\n      item.dimensions = this.convertDimensionFormat(item.dimensions, options.scopedVars);\n      item.period = String(this.getPeriod(item, options)); // use string format for period in graph query, and alerting\n      item.id = this.templateSrv.replace(item.id, options.scopedVars);\n      item.expression = this.templateSrv.replace(item.expression, options.scopedVars);\n      item.returnData = typeof item.hide === 'undefined' ? true : !item.hide;\n\n      // valid ExtendedStatistics is like p90.00, check the pattern\n      const hasInvalidStatistics = item.statistics.some(s => {\n        if (s.indexOf('p') === 0) {\n          const matches = /^p\\d{2}(?:\\.\\d{1,2})?$/.exec(s);\n\n          return !matches || matches[0] !== s;\n        }\n\n        return false;\n      });\n      if (hasInvalidStatistics) {\n        throw { message: 'Invalid extended statistics' };\n      }\n\n      return _.extend(\n        {\n          refId: item.refId,\n          intervalMs: options.intervalMs,\n          maxDataPoints: options.maxDataPoints,\n          datasourceId: this.instanceSettings.id,\n          type: 'timeSeriesQuery',\n        },\n        item\n      );\n    });\n\n    // No valid targets, return the empty result to save a round trip.\n    if (_.isEmpty(queries)) {\n      const d = this.$q.defer();\n      d.resolve({ data: [] });\n      return d.promise;\n    }\n\n    const request = {\n      from: options.range.from.valueOf().toString(),\n      to: options.range.to.valueOf().toString(),\n      queries: queries,\n    };\n\n    return this.performTimeSeriesQuery(request);\n  }\n\n  getPeriod(target, options, now?) {\n    const start = this.convertToCloudWatchTime(options.range.from, false);\n    const end = this.convertToCloudWatchTime(options.range.to, true);\n    now = Math.round((now || Date.now()) / 1000);\n\n    let period;\n    const range = end - start;\n\n    const hourSec = 60 * 60;\n    const daySec = hourSec * 24;\n    let periodUnit = 60;\n    if (!target.period) {\n      if (now - start <= daySec * 15) {\n        // until 15 days ago\n        if (target.namespace === 'AWS/EC2') {\n          periodUnit = period = 300;\n        } else {\n          periodUnit = period = 60;\n        }\n      } else if (now - start <= daySec * 63) {\n        // until 63 days ago\n        periodUnit = period = 60 * 5;\n      } else if (now - start <= daySec * 455) {\n        // until 455 days ago\n        periodUnit = period = 60 * 60;\n      } else {\n        // over 455 days, should return error, but try to long period\n        periodUnit = period = 60 * 60;\n      }\n    } else {\n      if (/^\\d+$/.test(target.period)) {\n        period = parseInt(target.period, 10);\n      } else {\n        period = kbn.interval_to_seconds(this.templateSrv.replace(target.period, options.scopedVars));\n      }\n    }\n    if (period < 1) {\n      period = 1;\n    }\n    if (!target.highResolution && range / period >= 1440) {\n      period = Math.ceil(range / 1440 / periodUnit) * periodUnit;\n    }\n\n    return period;\n  }\n\n  performTimeSeriesQuery(request) {\n    return this.awsRequest('/api/tsdb/query', request).then(res => {\n      const data = [];\n\n      if (res.results) {\n        _.forEach(res.results, queryRes => {\n          _.forEach(queryRes.series, series => {\n            const s = { target: series.name, datapoints: series.points } as any;\n            if (queryRes.meta.unit) {\n              s.unit = queryRes.meta.unit;\n            }\n            data.push(s);\n          });\n        });\n      }\n\n      return { data: data };\n    });\n  }\n\n  transformSuggestDataFromTable(suggestData) {\n    return _.map(suggestData.results['metricFindQuery'].tables[0].rows, v => {\n      return {\n        text: v[0],\n        value: v[1],\n      };\n    });\n  }\n\n  doMetricQueryRequest(subtype, parameters) {\n    const range = this.timeSrv.timeRange();\n    return this.awsRequest('/api/tsdb/query', {\n      from: range.from.valueOf().toString(),\n      to: range.to.valueOf().toString(),\n      queries: [\n        _.extend(\n          {\n            refId: 'metricFindQuery',\n            intervalMs: 1, // dummy\n            maxDataPoints: 1, // dummy\n            datasourceId: this.instanceSettings.id,\n            type: 'metricFindQuery',\n            subtype: subtype,\n          },\n          parameters\n        ),\n      ],\n    }).then(r => {\n      return this.transformSuggestDataFromTable(r);\n    });\n  }\n\n  getRegions() {\n    return this.doMetricQueryRequest('regions', null);\n  }\n\n  getNamespaces() {\n    return this.doMetricQueryRequest('namespaces', null);\n  }\n\n  getMetrics(namespace, region) {\n    return this.doMetricQueryRequest('metrics', {\n      region: this.templateSrv.replace(this.getActualRegion(region)),\n      namespace: this.templateSrv.replace(namespace),\n    });\n  }\n\n  getDimensionKeys(namespace, region) {\n    return this.doMetricQueryRequest('dimension_keys', {\n      region: this.templateSrv.replace(this.getActualRegion(region)),\n      namespace: this.templateSrv.replace(namespace),\n    });\n  }\n\n  getDimensionValues(region, namespace, metricName, dimensionKey, filterDimensions) {\n    return this.doMetricQueryRequest('dimension_values', {\n      region: this.templateSrv.replace(this.getActualRegion(region)),\n      namespace: this.templateSrv.replace(namespace),\n      metricName: this.templateSrv.replace(metricName),\n      dimensionKey: this.templateSrv.replace(dimensionKey),\n      dimensions: this.convertDimensionFormat(filterDimensions, {}),\n    });\n  }\n\n  getEbsVolumeIds(region, instanceId) {\n    return this.doMetricQueryRequest('ebs_volume_ids', {\n      region: this.templateSrv.replace(this.getActualRegion(region)),\n      instanceId: this.templateSrv.replace(instanceId),\n    });\n  }\n\n  getEc2InstanceAttribute(region, attributeName, filters) {\n    return this.doMetricQueryRequest('ec2_instance_attribute', {\n      region: this.templateSrv.replace(this.getActualRegion(region)),\n      attributeName: this.templateSrv.replace(attributeName),\n      filters: filters,\n    });\n  }\n\n  metricFindQuery(query) {\n    let region;\n    let namespace;\n    let metricName;\n    let filterJson;\n\n    const regionQuery = query.match(/^regions\\(\\)/);\n    if (regionQuery) {\n      return this.getRegions();\n    }\n\n    const namespaceQuery = query.match(/^namespaces\\(\\)/);\n    if (namespaceQuery) {\n      return this.getNamespaces();\n    }\n\n    const metricNameQuery = query.match(/^metrics\\(([^\\)]+?)(,\\s?([^,]+?))?\\)/);\n    if (metricNameQuery) {\n      namespace = metricNameQuery[1];\n      region = metricNameQuery[3];\n      return this.getMetrics(namespace, region);\n    }\n\n    const dimensionKeysQuery = query.match(/^dimension_keys\\(([^\\)]+?)(,\\s?([^,]+?))?\\)/);\n    if (dimensionKeysQuery) {\n      namespace = dimensionKeysQuery[1];\n      region = dimensionKeysQuery[3];\n      return this.getDimensionKeys(namespace, region);\n    }\n\n    const dimensionValuesQuery = query.match(\n      /^dimension_values\\(([^,]+?),\\s?([^,]+?),\\s?([^,]+?),\\s?([^,]+?)(,\\s?(.+))?\\)/\n    );\n    if (dimensionValuesQuery) {\n      region = dimensionValuesQuery[1];\n      namespace = dimensionValuesQuery[2];\n      metricName = dimensionValuesQuery[3];\n      const dimensionKey = dimensionValuesQuery[4];\n      filterJson = {};\n      if (dimensionValuesQuery[6]) {\n        filterJson = JSON.parse(this.templateSrv.replace(dimensionValuesQuery[6]));\n      }\n\n      return this.getDimensionValues(region, namespace, metricName, dimensionKey, filterJson);\n    }\n\n    const ebsVolumeIdsQuery = query.match(/^ebs_volume_ids\\(([^,]+?),\\s?([^,]+?)\\)/);\n    if (ebsVolumeIdsQuery) {\n      region = ebsVolumeIdsQuery[1];\n      const instanceId = ebsVolumeIdsQuery[2];\n      return this.getEbsVolumeIds(region, instanceId);\n    }\n\n    const ec2InstanceAttributeQuery = query.match(/^ec2_instance_attribute\\(([^,]+?),\\s?([^,]+?),\\s?(.+?)\\)/);\n    if (ec2InstanceAttributeQuery) {\n      region = ec2InstanceAttributeQuery[1];\n      const targetAttributeName = ec2InstanceAttributeQuery[2];\n      filterJson = JSON.parse(this.templateSrv.replace(ec2InstanceAttributeQuery[3]));\n      return this.getEc2InstanceAttribute(region, targetAttributeName, filterJson);\n    }\n\n    return this.$q.when([]);\n  }\n\n  annotationQuery(options) {\n    const annotation = options.annotation;\n    const statistics = _.map(annotation.statistics, s => {\n      return this.templateSrv.replace(s);\n    });\n    const defaultPeriod = annotation.prefixMatching ? '' : '300';\n    let period = annotation.period || defaultPeriod;\n    period = parseInt(period, 10);\n    const parameters = {\n      prefixMatching: annotation.prefixMatching,\n      region: this.templateSrv.replace(this.getActualRegion(annotation.region)),\n      namespace: this.templateSrv.replace(annotation.namespace),\n      metricName: this.templateSrv.replace(annotation.metricName),\n      dimensions: this.convertDimensionFormat(annotation.dimensions, {}),\n      statistics: statistics,\n      period: period,\n      actionPrefix: annotation.actionPrefix || '',\n      alarmNamePrefix: annotation.alarmNamePrefix || '',\n    };\n\n    return this.awsRequest('/api/tsdb/query', {\n      from: options.range.from.valueOf().toString(),\n      to: options.range.to.valueOf().toString(),\n      queries: [\n        _.extend(\n          {\n            refId: 'annotationQuery',\n            intervalMs: 1, // dummy\n            maxDataPoints: 1, // dummy\n            datasourceId: this.instanceSettings.id,\n            type: 'annotationQuery',\n          },\n          parameters\n        ),\n      ],\n    }).then(r => {\n      return _.map(r.results['annotationQuery'].tables[0].rows, v => {\n        return {\n          annotation: annotation,\n          time: Date.parse(v[0]),\n          title: v[1],\n          tags: [v[2]],\n          text: v[3],\n        };\n      });\n    });\n  }\n\n  targetContainsTemplate(target) {\n    return (\n      this.templateSrv.variableExists(target.region) ||\n      this.templateSrv.variableExists(target.namespace) ||\n      this.templateSrv.variableExists(target.metricName) ||\n      _.find(target.dimensions, (v, k) => {\n        return this.templateSrv.variableExists(k) || this.templateSrv.variableExists(v);\n      })\n    );\n  }\n\n  testDatasource() {\n    /* use billing metrics for test */\n    const region = this.defaultRegion;\n    const namespace = 'AWS/Billing';\n    const metricName = 'EstimatedCharges';\n    const dimensions = {};\n\n    return this.getDimensionValues(region, namespace, metricName, 'ServiceName', dimensions).then(\n      () => {\n        return { status: 'success', message: 'Data source is working' };\n      },\n      err => {\n        return { status: 'error', message: err.message };\n      }\n    );\n  }\n\n  awsRequest(url, data) {\n    const options = {\n      method: 'POST',\n      url: url,\n      data: data,\n    };\n\n    return this.backendSrv.datasourceRequest(options).then(result => {\n      return result.data;\n    });\n  }\n\n  getDefaultRegion() {\n    return this.defaultRegion;\n  }\n\n  getActualRegion(region) {\n    if (region === 'default' || _.isEmpty(region)) {\n      return this.getDefaultRegion();\n    }\n    return region;\n  }\n\n  getExpandedVariables(target, dimensionKey, variable, templateSrv) {\n    /* if the all checkbox is marked we should add all values to the targets */\n    const allSelected = _.find(variable.options, { selected: true, text: 'All' });\n    const selectedVariables = _.filter(variable.options, v => {\n      if (allSelected) {\n        return v.text !== 'All';\n      } else {\n        return v.selected;\n      }\n    });\n    const currentVariables = !_.isArray(variable.current.value)\n      ? [variable.current]\n      : variable.current.value.map(v => {\n          return {\n            text: v,\n            value: v,\n          };\n        });\n    const useSelectedVariables =\n      selectedVariables.some(s => {\n        return s.value === currentVariables[0].value;\n      }) || currentVariables[0].value === '$__all';\n    return (useSelectedVariables ? selectedVariables : currentVariables).map(v => {\n      const t = angular.copy(target);\n      const scopedVar = {};\n      scopedVar[variable.name] = v;\n      t.refId = target.refId + '_' + v.value;\n      t.dimensions[dimensionKey] = templateSrv.replace(t.dimensions[dimensionKey], scopedVar);\n      if (variable.multi && target.id) {\n        t.id = target.id + window.btoa(v.value).replace(/=/g, '0'); // generate unique id\n      } else {\n        t.id = target.id;\n      }\n      return t;\n    });\n  }\n\n  expandTemplateVariable(targets, scopedVars, templateSrv) {\n    // Datasource and template srv logic uber-complected. This should be cleaned up.\n    return _.chain(targets)\n      .map(target => {\n        const dimensionKey = _.findKey(target.dimensions, v => {\n          return templateSrv.variableExists(v) && !_.has(scopedVars, templateSrv.getVariableName(v));\n        });\n\n        if (dimensionKey) {\n          const multiVariable = _.find(templateSrv.variables, variable => {\n            return (\n              templatingVariable.containsVariable(target.dimensions[dimensionKey], variable.name) && variable.multi\n            );\n          });\n          const variable = _.find(templateSrv.variables, variable => {\n            return templatingVariable.containsVariable(target.dimensions[dimensionKey], variable.name);\n          });\n          return this.getExpandedVariables(target, dimensionKey, multiVariable || variable, templateSrv);\n        } else {\n          return [target];\n        }\n      })\n      .flatten()\n      .value();\n  }\n\n  convertToCloudWatchTime(date, roundUp) {\n    if (_.isString(date)) {\n      date = dateMath.parse(date, roundUp);\n    }\n    return Math.round(date.valueOf() / 1000);\n  }\n\n  convertDimensionFormat(dimensions, scopedVars) {\n    const convertedDimensions = {};\n    _.each(dimensions, (value, key) => {\n      convertedDimensions[this.templateSrv.replace(key, scopedVars)] = this.templateSrv.replace(value, scopedVars);\n    });\n    return convertedDimensions;\n  }\n}\n","export class CloudWatchConfigCtrl {\n  static templateUrl = 'partials/config.html';\n  current: any;\n\n  accessKeyExist = false;\n  secretKeyExist = false;\n\n  /** @ngInject */\n  constructor($scope) {\n    this.current.jsonData.timeField = this.current.jsonData.timeField || '@timestamp';\n    this.current.jsonData.authType = this.current.jsonData.authType || 'credentials';\n\n    this.accessKeyExist = this.current.secureJsonFields.accessKey;\n    this.secretKeyExist = this.current.secureJsonFields.secretKey;\n  }\n\n  resetAccessKey() {\n    this.accessKeyExist = false;\n  }\n\n  resetSecretKey() {\n    this.secretKeyExist = false;\n  }\n\n  authTypes = [\n    { name: 'Access & secret key', value: 'keys' },\n    { name: 'Credentials file', value: 'credentials' },\n    { name: 'ARN', value: 'arn' },\n  ];\n\n  indexPatternTypes = [\n    { name: 'No pattern', value: undefined },\n    { name: 'Hourly', value: 'Hourly', example: '[logstash-]YYYY.MM.DD.HH' },\n    { name: 'Daily', value: 'Daily', example: '[logstash-]YYYY.MM.DD' },\n    { name: 'Weekly', value: 'Weekly', example: '[logstash-]GGGG.WW' },\n    { name: 'Monthly', value: 'Monthly', example: '[logstash-]YYYY.MM' },\n    { name: 'Yearly', value: 'Yearly', example: '[logstash-]YYYY' },\n  ];\n}\n","import './query_parameter_ctrl';\nimport { QueryCtrl } from 'app/plugins/sdk';\n\nexport class CloudWatchQueryCtrl extends QueryCtrl {\n  static templateUrl = 'partials/query.editor.html';\n\n  aliasSyntax: string;\n\n  /** @ngInject */\n  constructor($scope, $injector) {\n    super($scope, $injector);\n    this.aliasSyntax = '{{metric}} {{stat}} {{namespace}} {{region}} {{<dimension name>}}';\n  }\n}\n","import './query_parameter_ctrl';\n\nimport CloudWatchDatasource from './datasource';\nimport { CloudWatchQueryCtrl } from './query_ctrl';\nimport { CloudWatchConfigCtrl } from './config_ctrl';\n\nclass CloudWatchAnnotationsQueryCtrl {\n  static templateUrl = 'partials/annotations.editor.html';\n}\n\nexport {\n  CloudWatchDatasource as Datasource,\n  CloudWatchQueryCtrl as QueryCtrl,\n  CloudWatchConfigCtrl as ConfigCtrl,\n  CloudWatchAnnotationsQueryCtrl as AnnotationsQueryCtrl,\n};\n","import _ from 'lodash';\n\nexport const metricAggTypes = [\n  { text: 'Count', value: 'count', requiresField: false },\n  {\n    text: 'Average',\n    value: 'avg',\n    requiresField: true,\n    supportsInlineScript: true,\n    supportsMissing: true,\n  },\n  {\n    text: 'Sum',\n    value: 'sum',\n    requiresField: true,\n    supportsInlineScript: true,\n    supportsMissing: true,\n  },\n  {\n    text: 'Max',\n    value: 'max',\n    requiresField: true,\n    supportsInlineScript: true,\n    supportsMissing: true,\n  },\n  {\n    text: 'Min',\n    value: 'min',\n    requiresField: true,\n    supportsInlineScript: true,\n    supportsMissing: true,\n  },\n  {\n    text: 'Extended Stats',\n    value: 'extended_stats',\n    requiresField: true,\n    supportsMissing: true,\n    supportsInlineScript: true,\n  },\n  {\n    text: 'Percentiles',\n    value: 'percentiles',\n    requiresField: true,\n    supportsMissing: true,\n    supportsInlineScript: true,\n  },\n  {\n    text: 'Unique Count',\n    value: 'cardinality',\n    requiresField: true,\n    supportsMissing: true,\n  },\n  {\n    text: 'Moving Average',\n    value: 'moving_avg',\n    requiresField: false,\n    isPipelineAgg: true,\n    minVersion: 2,\n  },\n  {\n    text: 'Derivative',\n    value: 'derivative',\n    requiresField: false,\n    isPipelineAgg: true,\n    minVersion: 2,\n  },\n  { text: 'Raw Document', value: 'raw_document', requiresField: false },\n];\n\nexport const bucketAggTypes = [\n  { text: 'Terms', value: 'terms', requiresField: true },\n  { text: 'Filters', value: 'filters' },\n  { text: 'Geo Hash Grid', value: 'geohash_grid', requiresField: true },\n  { text: 'Date Histogram', value: 'date_histogram', requiresField: true },\n  { text: 'Histogram', value: 'histogram', requiresField: true },\n];\n\nexport const orderByOptions = [{ text: 'Doc Count', value: '_count' }, { text: 'Term value', value: '_term' }];\n\nexport const orderOptions = [{ text: 'Top', value: 'desc' }, { text: 'Bottom', value: 'asc' }];\n\nexport const sizeOptions = [\n  { text: 'No limit', value: '0' },\n  { text: '1', value: '1' },\n  { text: '2', value: '2' },\n  { text: '3', value: '3' },\n  { text: '5', value: '5' },\n  { text: '10', value: '10' },\n  { text: '15', value: '15' },\n  { text: '20', value: '20' },\n];\n\nexport const extendedStats = [\n  { text: 'Avg', value: 'avg' },\n  { text: 'Min', value: 'min' },\n  { text: 'Max', value: 'max' },\n  { text: 'Sum', value: 'sum' },\n  { text: 'Count', value: 'count' },\n  { text: 'Std Dev', value: 'std_deviation' },\n  { text: 'Std Dev Upper', value: 'std_deviation_bounds_upper' },\n  { text: 'Std Dev Lower', value: 'std_deviation_bounds_lower' },\n];\n\nexport const intervalOptions = [\n  { text: 'auto', value: 'auto' },\n  { text: '10s', value: '10s' },\n  { text: '1m', value: '1m' },\n  { text: '5m', value: '5m' },\n  { text: '10m', value: '10m' },\n  { text: '20m', value: '20m' },\n  { text: '1h', value: '1h' },\n  { text: '1d', value: '1d' },\n];\n\nexport const movingAvgModelOptions = [\n  { text: 'Simple', value: 'simple' },\n  { text: 'Linear', value: 'linear' },\n  { text: 'Exponentially Weighted', value: 'ewma' },\n  { text: 'Holt Linear', value: 'holt' },\n  { text: 'Holt Winters', value: 'holt_winters' },\n];\n\nexport const pipelineOptions = {\n  moving_avg: [\n    { text: 'window', default: 5 },\n    { text: 'model', default: 'simple' },\n    { text: 'predict', default: undefined },\n    { text: 'minimize', default: false },\n  ],\n  derivative: [{ text: 'unit', default: undefined }],\n};\n\nexport const movingAvgModelSettings = {\n  simple: [],\n  linear: [],\n  ewma: [{ text: 'Alpha', value: 'alpha', default: undefined }],\n  holt: [{ text: 'Alpha', value: 'alpha', default: undefined }, { text: 'Beta', value: 'beta', default: undefined }],\n  holt_winters: [\n    { text: 'Alpha', value: 'alpha', default: undefined },\n    { text: 'Beta', value: 'beta', default: undefined },\n    { text: 'Gamma', value: 'gamma', default: undefined },\n    { text: 'Period', value: 'period', default: undefined },\n    { text: 'Pad', value: 'pad', default: undefined, isCheckbox: true },\n  ],\n};\n\nexport function getMetricAggTypes(esVersion) {\n  return _.filter(metricAggTypes, f => {\n    if (f.minVersion) {\n      return f.minVersion <= esVersion;\n    } else {\n      return true;\n    }\n  });\n}\n\nexport function getPipelineOptions(metric) {\n  if (!isPipelineAgg(metric.type)) {\n    return [];\n  }\n\n  return pipelineOptions[metric.type];\n}\n\nexport function isPipelineAgg(metricType) {\n  if (metricType) {\n    const po = pipelineOptions[metricType];\n    return po !== null && po !== undefined;\n  }\n\n  return false;\n}\n\nexport function getPipelineAggOptions(targets) {\n  const result = [];\n  _.each(targets.metrics, metric => {\n    if (!isPipelineAgg(metric.type)) {\n      result.push({ text: describeMetric(metric), value: metric.id });\n    }\n  });\n\n  return result;\n}\n\nexport function getMovingAvgSettings(model, filtered) {\n  const filteredResult = [];\n  if (filtered) {\n    _.each(movingAvgModelSettings[model], setting => {\n      if (!setting.isCheckbox) {\n        filteredResult.push(setting);\n      }\n    });\n    return filteredResult;\n  }\n  return movingAvgModelSettings[model];\n}\n\nexport function getOrderByOptions(target) {\n  const metricRefs = [];\n  _.each(target.metrics, metric => {\n    if (metric.type !== 'count') {\n      metricRefs.push({ text: describeMetric(metric), value: metric.id });\n    }\n  });\n\n  return orderByOptions.concat(metricRefs);\n}\n\nexport function describeOrder(order) {\n  const def = _.find(orderOptions, { value: order });\n  return def.text;\n}\n\nexport function describeMetric(metric) {\n  const def = _.find(metricAggTypes, { value: metric.type });\n  return def.text + ' ' + metric.field;\n}\n\nexport function describeOrderBy(orderBy, target) {\n  const def = _.find(orderByOptions, { value: orderBy });\n  if (def) {\n    return def.text;\n  }\n  const metric = _.find(target.metrics, { id: orderBy });\n  if (metric) {\n    return describeMetric(metric);\n  } else {\n    return 'metric not found';\n  }\n}\n","import * as queryDef from './query_def';\n\nexport class ElasticQueryBuilder {\n  timeField: string;\n  esVersion: number;\n\n  constructor(options) {\n    this.timeField = options.timeField;\n    this.esVersion = options.esVersion;\n  }\n\n  getRangeFilter() {\n    const filter = {};\n    filter[this.timeField] = {\n      gte: '$timeFrom',\n      lte: '$timeTo',\n      format: 'epoch_millis',\n    };\n\n    return filter;\n  }\n\n  buildTermsAgg(aggDef, queryNode, target) {\n    let metricRef, metric, y;\n    queryNode.terms = { field: aggDef.field };\n\n    if (!aggDef.settings) {\n      return queryNode;\n    }\n\n    queryNode.terms.size = parseInt(aggDef.settings.size, 10) === 0 ? 500 : parseInt(aggDef.settings.size, 10);\n    if (aggDef.settings.orderBy !== void 0) {\n      queryNode.terms.order = {};\n      queryNode.terms.order[aggDef.settings.orderBy] = aggDef.settings.order;\n\n      // if metric ref, look it up and add it to this agg level\n      metricRef = parseInt(aggDef.settings.orderBy, 10);\n      if (!isNaN(metricRef)) {\n        for (y = 0; y < target.metrics.length; y++) {\n          metric = target.metrics[y];\n          if (metric.id === aggDef.settings.orderBy) {\n            queryNode.aggs = {};\n            queryNode.aggs[metric.id] = {};\n            queryNode.aggs[metric.id][metric.type] = { field: metric.field };\n            break;\n          }\n        }\n      }\n    }\n\n    if (aggDef.settings.min_doc_count !== void 0) {\n      queryNode.terms.min_doc_count = parseInt(aggDef.settings.min_doc_count, 10);\n    }\n\n    if (aggDef.settings.missing) {\n      queryNode.terms.missing = aggDef.settings.missing;\n    }\n\n    return queryNode;\n  }\n\n  getDateHistogramAgg(aggDef) {\n    const esAgg: any = {};\n    const settings = aggDef.settings || {};\n    esAgg.interval = settings.interval;\n    esAgg.field = this.timeField;\n    esAgg.min_doc_count = settings.min_doc_count || 0;\n    esAgg.extended_bounds = { min: '$timeFrom', max: '$timeTo' };\n    esAgg.format = 'epoch_millis';\n\n    if (esAgg.interval === 'auto') {\n      esAgg.interval = '$__interval';\n    }\n\n    if (settings.missing) {\n      esAgg.missing = settings.missing;\n    }\n\n    return esAgg;\n  }\n\n  getHistogramAgg(aggDef) {\n    const esAgg: any = {};\n    const settings = aggDef.settings || {};\n    esAgg.interval = settings.interval;\n    esAgg.field = aggDef.field;\n    esAgg.min_doc_count = settings.min_doc_count || 0;\n\n    if (settings.missing) {\n      esAgg.missing = settings.missing;\n    }\n    return esAgg;\n  }\n\n  getFiltersAgg(aggDef) {\n    const filterObj = {};\n    for (let i = 0; i < aggDef.settings.filters.length; i++) {\n      const query = aggDef.settings.filters[i].query;\n      let label = aggDef.settings.filters[i].label;\n      label = label === '' || label === undefined ? query : label;\n      filterObj[label] = {\n        query_string: {\n          query: query,\n          analyze_wildcard: true,\n        },\n      };\n    }\n\n    return filterObj;\n  }\n\n  documentQuery(query, size) {\n    query.size = size;\n    query.sort = {};\n    query.sort[this.timeField] = { order: 'desc', unmapped_type: 'boolean' };\n\n    // fields field not supported on ES 5.x\n    if (this.esVersion < 5) {\n      query.fields = ['*', '_source'];\n    }\n\n    query.script_fields = {};\n    if (this.esVersion < 5) {\n      query.fielddata_fields = [this.timeField];\n    } else {\n      query.docvalue_fields = [this.timeField];\n    }\n    return query;\n  }\n\n  addAdhocFilters(query, adhocFilters) {\n    if (!adhocFilters) {\n      return;\n    }\n\n    let i, filter, condition, queryCondition;\n\n    for (i = 0; i < adhocFilters.length; i++) {\n      filter = adhocFilters[i];\n      condition = {};\n      condition[filter.key] = filter.value;\n      queryCondition = {};\n      queryCondition[filter.key] = { query: filter.value };\n\n      switch (filter.operator) {\n        case '=':\n          if (!query.query.bool.must) {\n            query.query.bool.must = [];\n          }\n          query.query.bool.must.push({ match_phrase: queryCondition });\n          break;\n        case '!=':\n          if (!query.query.bool.must_not) {\n            query.query.bool.must_not = [];\n          }\n          query.query.bool.must_not.push({ match_phrase: queryCondition });\n          break;\n        case '<':\n          condition[filter.key] = { lt: filter.value };\n          query.query.bool.filter.push({ range: condition });\n          break;\n        case '>':\n          condition[filter.key] = { gt: filter.value };\n          query.query.bool.filter.push({ range: condition });\n          break;\n        case '=~':\n          query.query.bool.filter.push({ regexp: condition });\n          break;\n        case '!~':\n          query.query.bool.filter.push({\n            bool: { must_not: { regexp: condition } },\n          });\n          break;\n      }\n    }\n  }\n\n  build(target, adhocFilters?, queryString?) {\n    // make sure query has defaults;\n    target.metrics = target.metrics || [{ type: 'count', id: '1' }];\n    target.bucketAggs = target.bucketAggs || [{ type: 'date_histogram', id: '2', settings: { interval: 'auto' } }];\n    target.timeField = this.timeField;\n\n    let i, nestedAggs, metric;\n    const query = {\n      size: 0,\n      query: {\n        bool: {\n          filter: [\n            { range: this.getRangeFilter() },\n            {\n              query_string: {\n                analyze_wildcard: true,\n                query: queryString,\n              },\n            },\n          ],\n        },\n      },\n    };\n\n    this.addAdhocFilters(query, adhocFilters);\n\n    // handle document query\n    if (target.bucketAggs.length === 0) {\n      metric = target.metrics[0];\n      if (!metric || metric.type !== 'raw_document') {\n        throw { message: 'Invalid query' };\n      }\n\n      const size = (metric.settings && metric.settings.size) || 500;\n      return this.documentQuery(query, size);\n    }\n\n    nestedAggs = query;\n\n    for (i = 0; i < target.bucketAggs.length; i++) {\n      const aggDef = target.bucketAggs[i];\n      const esAgg = {};\n\n      switch (aggDef.type) {\n        case 'date_histogram': {\n          esAgg['date_histogram'] = this.getDateHistogramAgg(aggDef);\n          break;\n        }\n        case 'histogram': {\n          esAgg['histogram'] = this.getHistogramAgg(aggDef);\n          break;\n        }\n        case 'filters': {\n          esAgg['filters'] = { filters: this.getFiltersAgg(aggDef) };\n          break;\n        }\n        case 'terms': {\n          this.buildTermsAgg(aggDef, esAgg, target);\n          break;\n        }\n        case 'geohash_grid': {\n          esAgg['geohash_grid'] = {\n            field: aggDef.field,\n            precision: aggDef.settings.precision,\n          };\n          break;\n        }\n      }\n\n      nestedAggs.aggs = nestedAggs.aggs || {};\n      nestedAggs.aggs[aggDef.id] = esAgg;\n      nestedAggs = esAgg;\n    }\n\n    nestedAggs.aggs = {};\n\n    for (i = 0; i < target.metrics.length; i++) {\n      metric = target.metrics[i];\n      if (metric.type === 'count') {\n        continue;\n      }\n\n      const aggField = {};\n      let metricAgg = null;\n\n      if (queryDef.isPipelineAgg(metric.type)) {\n        if (metric.pipelineAgg && /^\\d*$/.test(metric.pipelineAgg)) {\n          metricAgg = { buckets_path: metric.pipelineAgg };\n        } else {\n          continue;\n        }\n      } else {\n        metricAgg = { field: metric.field };\n      }\n\n      for (const prop in metric.settings) {\n        if (metric.settings.hasOwnProperty(prop) && metric.settings[prop] !== null) {\n          metricAgg[prop] = metric.settings[prop];\n        }\n      }\n\n      aggField[metric.type] = metricAgg;\n      nestedAggs.aggs[metric.id] = aggField;\n    }\n\n    return query;\n  }\n\n  getTermsQuery(queryDef) {\n    const query: any = {\n      size: 0,\n      query: {\n        bool: {\n          filter: [{ range: this.getRangeFilter() }],\n        },\n      },\n    };\n\n    if (queryDef.query) {\n      query.query.bool.filter.push({\n        query_string: {\n          analyze_wildcard: true,\n          query: queryDef.query,\n        },\n      });\n    }\n\n    let size = 500;\n    if (queryDef.size) {\n      size = queryDef.size;\n    }\n\n    query.aggs = {\n      '1': {\n        terms: {\n          field: queryDef.field,\n          size: size,\n          order: {\n            _term: 'asc',\n          },\n        },\n      },\n    };\n    return query;\n  }\n}\n","import moment from 'moment';\n\nconst intervalMap = {\n  Hourly: { startOf: 'hour', amount: 'hours' },\n  Daily: { startOf: 'day', amount: 'days' },\n  Weekly: { startOf: 'isoWeek', amount: 'weeks' },\n  Monthly: { startOf: 'month', amount: 'months' },\n  Yearly: { startOf: 'year', amount: 'years' },\n};\n\nexport class IndexPattern {\n  constructor(private pattern, private interval: string | null) {}\n\n  getIndexForToday() {\n    if (this.interval) {\n      return moment.utc().format(this.pattern);\n    } else {\n      return this.pattern;\n    }\n  }\n\n  getIndexList(from, to) {\n    if (!this.interval) {\n      return this.pattern;\n    }\n\n    const intervalInfo = intervalMap[this.interval];\n    const start = moment(from)\n      .utc()\n      .startOf(intervalInfo.startOf);\n    const endEpoch = moment(to)\n      .utc()\n      .startOf(intervalInfo.startOf)\n      .valueOf();\n    const indexList = [];\n\n    while (start.valueOf() <= endEpoch) {\n      indexList.push(start.format(this.pattern));\n      start.add(1, intervalInfo.amount);\n    }\n\n    return indexList;\n  }\n}\n","import _ from 'lodash';\nimport * as queryDef from './query_def';\nimport TableModel from 'app/core/table_model';\n\nexport class ElasticResponse {\n  constructor(private targets, private response) {\n    this.targets = targets;\n    this.response = response;\n  }\n\n  processMetrics(esAgg, target, seriesList, props) {\n    let metric, y, i, newSeries, bucket, value;\n\n    for (y = 0; y < target.metrics.length; y++) {\n      metric = target.metrics[y];\n      if (metric.hide) {\n        continue;\n      }\n\n      switch (metric.type) {\n        case 'count': {\n          newSeries = { datapoints: [], metric: 'count', props: props };\n          for (i = 0; i < esAgg.buckets.length; i++) {\n            bucket = esAgg.buckets[i];\n            value = bucket.doc_count;\n            newSeries.datapoints.push([value, bucket.key]);\n          }\n          seriesList.push(newSeries);\n          break;\n        }\n        case 'percentiles': {\n          if (esAgg.buckets.length === 0) {\n            break;\n          }\n\n          const firstBucket = esAgg.buckets[0];\n          const percentiles = firstBucket[metric.id].values;\n\n          for (const percentileName in percentiles) {\n            newSeries = {\n              datapoints: [],\n              metric: 'p' + percentileName,\n              props: props,\n              field: metric.field,\n            };\n\n            for (i = 0; i < esAgg.buckets.length; i++) {\n              bucket = esAgg.buckets[i];\n              const values = bucket[metric.id].values;\n              newSeries.datapoints.push([values[percentileName], bucket.key]);\n            }\n            seriesList.push(newSeries);\n          }\n\n          break;\n        }\n        case 'extended_stats': {\n          for (const statName in metric.meta) {\n            if (!metric.meta[statName]) {\n              continue;\n            }\n\n            newSeries = {\n              datapoints: [],\n              metric: statName,\n              props: props,\n              field: metric.field,\n            };\n\n            for (i = 0; i < esAgg.buckets.length; i++) {\n              bucket = esAgg.buckets[i];\n              const stats = bucket[metric.id];\n\n              // add stats that are in nested obj to top level obj\n              stats.std_deviation_bounds_upper = stats.std_deviation_bounds.upper;\n              stats.std_deviation_bounds_lower = stats.std_deviation_bounds.lower;\n\n              newSeries.datapoints.push([stats[statName], bucket.key]);\n            }\n\n            seriesList.push(newSeries);\n          }\n\n          break;\n        }\n        default: {\n          newSeries = {\n            datapoints: [],\n            metric: metric.type,\n            field: metric.field,\n            props: props,\n          };\n          for (i = 0; i < esAgg.buckets.length; i++) {\n            bucket = esAgg.buckets[i];\n\n            value = bucket[metric.id];\n            if (value !== undefined) {\n              if (value.normalized_value) {\n                newSeries.datapoints.push([value.normalized_value, bucket.key]);\n              } else {\n                newSeries.datapoints.push([value.value, bucket.key]);\n              }\n            }\n          }\n          seriesList.push(newSeries);\n          break;\n        }\n      }\n    }\n  }\n\n  processAggregationDocs(esAgg, aggDef, target, table, props) {\n    // add columns\n    if (table.columns.length === 0) {\n      for (const propKey of _.keys(props)) {\n        table.addColumn({ text: propKey, filterable: true });\n      }\n      table.addColumn({ text: aggDef.field, filterable: true });\n    }\n\n    // helper func to add values to value array\n    const addMetricValue = (values, metricName, value) => {\n      table.addColumn({ text: metricName });\n      values.push(value);\n    };\n\n    for (const bucket of esAgg.buckets) {\n      const values = [];\n\n      for (const propValues of _.values(props)) {\n        values.push(propValues);\n      }\n\n      // add bucket key (value)\n      values.push(bucket.key);\n\n      for (const metric of target.metrics) {\n        switch (metric.type) {\n          case 'count': {\n            addMetricValue(values, this.getMetricName(metric.type), bucket.doc_count);\n            break;\n          }\n          case 'extended_stats': {\n            for (const statName in metric.meta) {\n              if (!metric.meta[statName]) {\n                continue;\n              }\n\n              const stats = bucket[metric.id];\n              // add stats that are in nested obj to top level obj\n              stats.std_deviation_bounds_upper = stats.std_deviation_bounds.upper;\n              stats.std_deviation_bounds_lower = stats.std_deviation_bounds.lower;\n\n              addMetricValue(values, this.getMetricName(statName), stats[statName]);\n            }\n            break;\n          }\n          default: {\n            let metricName = this.getMetricName(metric.type);\n            const otherMetrics = _.filter(target.metrics, { type: metric.type });\n\n            // if more of the same metric type include field field name in property\n            if (otherMetrics.length > 1) {\n              metricName += ' ' + metric.field;\n            }\n\n            addMetricValue(values, metricName, bucket[metric.id].value);\n            break;\n          }\n        }\n      }\n\n      table.rows.push(values);\n    }\n  }\n\n  // This is quite complex\n  // need to recurise down the nested buckets to build series\n  processBuckets(aggs, target, seriesList, table, props, depth) {\n    let bucket, aggDef, esAgg, aggId;\n    const maxDepth = target.bucketAggs.length - 1;\n\n    for (aggId in aggs) {\n      aggDef = _.find(target.bucketAggs, { id: aggId });\n      esAgg = aggs[aggId];\n\n      if (!aggDef) {\n        continue;\n      }\n\n      if (depth === maxDepth) {\n        if (aggDef.type === 'date_histogram') {\n          this.processMetrics(esAgg, target, seriesList, props);\n        } else {\n          this.processAggregationDocs(esAgg, aggDef, target, table, props);\n        }\n      } else {\n        for (const nameIndex in esAgg.buckets) {\n          bucket = esAgg.buckets[nameIndex];\n          props = _.clone(props);\n          if (bucket.key !== void 0) {\n            props[aggDef.field] = bucket.key;\n          } else {\n            props['filter'] = nameIndex;\n          }\n          if (bucket.key_as_string) {\n            props[aggDef.field] = bucket.key_as_string;\n          }\n          this.processBuckets(bucket, target, seriesList, table, props, depth + 1);\n        }\n      }\n    }\n  }\n\n  private getMetricName(metric) {\n    let metricDef = _.find(queryDef.metricAggTypes, { value: metric });\n    if (!metricDef) {\n      metricDef = _.find(queryDef.extendedStats, { value: metric });\n    }\n\n    return metricDef ? metricDef.text : metric;\n  }\n\n  private getSeriesName(series, target, metricTypeCount) {\n    let metricName = this.getMetricName(series.metric);\n\n    if (target.alias) {\n      const regex = /\\{\\{([\\s\\S]+?)\\}\\}/g;\n\n      return target.alias.replace(regex, (match, g1, g2) => {\n        const group = g1 || g2;\n\n        if (group.indexOf('term ') === 0) {\n          return series.props[group.substring(5)];\n        }\n        if (series.props[group] !== void 0) {\n          return series.props[group];\n        }\n        if (group === 'metric') {\n          return metricName;\n        }\n        if (group === 'field') {\n          return series.field;\n        }\n\n        return match;\n      });\n    }\n\n    if (series.field && queryDef.isPipelineAgg(series.metric)) {\n      const appliedAgg = _.find(target.metrics, { id: series.field });\n      if (appliedAgg) {\n        metricName += ' ' + queryDef.describeMetric(appliedAgg);\n      } else {\n        metricName = 'Unset';\n      }\n    } else if (series.field) {\n      metricName += ' ' + series.field;\n    }\n\n    const propKeys = _.keys(series.props);\n    if (propKeys.length === 0) {\n      return metricName;\n    }\n\n    let name = '';\n    for (const propName in series.props) {\n      name += series.props[propName] + ' ';\n    }\n\n    if (metricTypeCount === 1) {\n      return name.trim();\n    }\n\n    return name.trim() + ' ' + metricName;\n  }\n\n  nameSeries(seriesList, target) {\n    const metricTypeCount = _.uniq(_.map(seriesList, 'metric')).length;\n\n    for (let i = 0; i < seriesList.length; i++) {\n      const series = seriesList[i];\n      series.target = this.getSeriesName(series, target, metricTypeCount);\n    }\n  }\n\n  processHits(hits, seriesList) {\n    const series = {\n      target: 'docs',\n      type: 'docs',\n      datapoints: [],\n      total: hits.total,\n      filterable: true,\n    };\n    let propName, hit, doc, i;\n\n    for (i = 0; i < hits.hits.length; i++) {\n      hit = hits.hits[i];\n      doc = {\n        _id: hit._id,\n        _type: hit._type,\n        _index: hit._index,\n      };\n\n      if (hit._source) {\n        for (propName in hit._source) {\n          doc[propName] = hit._source[propName];\n        }\n      }\n\n      for (propName in hit.fields) {\n        doc[propName] = hit.fields[propName];\n      }\n      series.datapoints.push(doc);\n    }\n\n    seriesList.push(series);\n  }\n\n  trimDatapoints(aggregations, target) {\n    const histogram = _.find(target.bucketAggs, { type: 'date_histogram' });\n\n    const shouldDropFirstAndLast = histogram && histogram.settings && histogram.settings.trimEdges;\n    if (shouldDropFirstAndLast) {\n      const trim = histogram.settings.trimEdges;\n      for (const prop in aggregations) {\n        const points = aggregations[prop];\n        if (points.datapoints.length > trim * 2) {\n          points.datapoints = points.datapoints.slice(trim, points.datapoints.length - trim);\n        }\n      }\n    }\n  }\n\n  getErrorFromElasticResponse(response, err) {\n    const result: any = {};\n    result.data = JSON.stringify(err, null, 4);\n    if (err.root_cause && err.root_cause.length > 0 && err.root_cause[0].reason) {\n      result.message = err.root_cause[0].reason;\n    } else {\n      result.message = err.reason || 'Unkown elastic error response';\n    }\n\n    if (response.$$config) {\n      result.config = response.$$config;\n    }\n\n    return result;\n  }\n\n  getTimeSeries() {\n    const seriesList = [];\n\n    for (let i = 0; i < this.response.responses.length; i++) {\n      const response = this.response.responses[i];\n      if (response.error) {\n        throw this.getErrorFromElasticResponse(this.response, response.error);\n      }\n\n      if (response.hits && response.hits.hits.length > 0) {\n        this.processHits(response.hits, seriesList);\n      }\n\n      if (response.aggregations) {\n        const aggregations = response.aggregations;\n        const target = this.targets[i];\n        const tmpSeriesList = [];\n        const table = new TableModel();\n\n        this.processBuckets(aggregations, target, tmpSeriesList, table, {}, 0);\n        this.trimDatapoints(tmpSeriesList, target);\n        this.nameSeries(tmpSeriesList, target);\n\n        for (let y = 0; y < tmpSeriesList.length; y++) {\n          seriesList.push(tmpSeriesList[y]);\n        }\n\n        if (table.rows.length > 0) {\n          seriesList.push(table);\n        }\n      }\n    }\n\n    return { data: seriesList };\n  }\n}\n","import angular from 'angular';\nimport _ from 'lodash';\nimport moment from 'moment';\nimport { ElasticQueryBuilder } from './query_builder';\nimport { IndexPattern } from './index_pattern';\nimport { ElasticResponse } from './elastic_response';\n\nexport class ElasticDatasource {\n  basicAuth: string;\n  withCredentials: boolean;\n  url: string;\n  name: string;\n  index: string;\n  timeField: string;\n  esVersion: number;\n  interval: string;\n  maxConcurrentShardRequests: number;\n  queryBuilder: ElasticQueryBuilder;\n  indexPattern: IndexPattern;\n\n  /** @ngInject */\n  constructor(instanceSettings, private $q, private backendSrv, private templateSrv, private timeSrv) {\n    this.basicAuth = instanceSettings.basicAuth;\n    this.withCredentials = instanceSettings.withCredentials;\n    this.url = instanceSettings.url;\n    this.name = instanceSettings.name;\n    this.index = instanceSettings.index;\n    this.timeField = instanceSettings.jsonData.timeField;\n    this.esVersion = instanceSettings.jsonData.esVersion;\n    this.indexPattern = new IndexPattern(instanceSettings.index, instanceSettings.jsonData.interval);\n    this.interval = instanceSettings.jsonData.timeInterval;\n    this.maxConcurrentShardRequests = instanceSettings.jsonData.maxConcurrentShardRequests;\n    this.queryBuilder = new ElasticQueryBuilder({\n      timeField: this.timeField,\n      esVersion: this.esVersion,\n    });\n  }\n\n  private request(method, url, data?) {\n    const options: any = {\n      url: this.url + '/' + url,\n      method: method,\n      data: data,\n    };\n\n    if (this.basicAuth || this.withCredentials) {\n      options.withCredentials = true;\n    }\n    if (this.basicAuth) {\n      options.headers = {\n        Authorization: this.basicAuth,\n      };\n    }\n\n    return this.backendSrv.datasourceRequest(options);\n  }\n\n  private get(url) {\n    const range = this.timeSrv.timeRange();\n    const indexList = this.indexPattern.getIndexList(range.from.valueOf(), range.to.valueOf());\n    if (_.isArray(indexList) && indexList.length) {\n      return this.request('GET', indexList[0] + url).then(results => {\n        results.data.$$config = results.config;\n        return results.data;\n      });\n    } else {\n      return this.request('GET', this.indexPattern.getIndexForToday() + url).then(results => {\n        results.data.$$config = results.config;\n        return results.data;\n      });\n    }\n  }\n\n  private post(url, data) {\n    return this.request('POST', url, data)\n      .then(results => {\n        results.data.$$config = results.config;\n        return results.data;\n      })\n      .catch(err => {\n        if (err.data && err.data.error) {\n          throw {\n            message: 'Elasticsearch error: ' + err.data.error.reason,\n            error: err.data.error,\n          };\n        }\n\n        throw err;\n      });\n  }\n\n  annotationQuery(options) {\n    const annotation = options.annotation;\n    const timeField = annotation.timeField || '@timestamp';\n    const queryString = annotation.query || '*';\n    const tagsField = annotation.tagsField || 'tags';\n    const textField = annotation.textField || null;\n\n    const range = {};\n    range[timeField] = {\n      from: options.range.from.valueOf(),\n      to: options.range.to.valueOf(),\n      format: 'epoch_millis',\n    };\n\n    const queryInterpolated = this.templateSrv.replace(queryString, {}, 'lucene');\n    const query = {\n      bool: {\n        filter: [\n          { range: range },\n          {\n            query_string: {\n              query: queryInterpolated,\n            },\n          },\n        ],\n      },\n    };\n\n    const data = {\n      query: query,\n      size: 10000,\n    };\n\n    // fields field not supported on ES 5.x\n    if (this.esVersion < 5) {\n      data['fields'] = [timeField, '_source'];\n    }\n\n    const header: any = {\n      search_type: 'query_then_fetch',\n      ignore_unavailable: true,\n    };\n\n    // old elastic annotations had index specified on them\n    if (annotation.index) {\n      header.index = annotation.index;\n    } else {\n      header.index = this.indexPattern.getIndexList(options.range.from, options.range.to);\n    }\n\n    const payload = angular.toJson(header) + '\\n' + angular.toJson(data) + '\\n';\n\n    return this.post('_msearch', payload).then(res => {\n      const list = [];\n      const hits = res.responses[0].hits.hits;\n\n      const getFieldFromSource = (source, fieldName) => {\n        if (!fieldName) {\n          return;\n        }\n\n        const fieldNames = fieldName.split('.');\n        let fieldValue = source;\n\n        for (let i = 0; i < fieldNames.length; i++) {\n          fieldValue = fieldValue[fieldNames[i]];\n          if (!fieldValue) {\n            console.log('could not find field in annotation: ', fieldName);\n            return '';\n          }\n        }\n\n        return fieldValue;\n      };\n\n      for (let i = 0; i < hits.length; i++) {\n        const source = hits[i]._source;\n        let time = getFieldFromSource(source, timeField);\n        if (typeof hits[i].fields !== 'undefined') {\n          const fields = hits[i].fields;\n          if (_.isString(fields[timeField]) || _.isNumber(fields[timeField])) {\n            time = fields[timeField];\n          }\n        }\n\n        const event = {\n          annotation: annotation,\n          time: moment.utc(time).valueOf(),\n          text: getFieldFromSource(source, textField),\n          tags: getFieldFromSource(source, tagsField),\n        };\n\n        // legacy support for title tield\n        if (annotation.titleField) {\n          const title = getFieldFromSource(source, annotation.titleField);\n          if (title) {\n            event.text = title + '\\n' + event.text;\n          }\n        }\n\n        if (typeof event.tags === 'string') {\n          event.tags = event.tags.split(',');\n        }\n\n        list.push(event);\n      }\n      return list;\n    });\n  }\n\n  testDatasource() {\n    this.timeSrv.setTime({ from: 'now-1m', to: 'now' }, true);\n    // validate that the index exist and has date field\n    return this.getFields({ type: 'date' }).then(\n      dateFields => {\n        const timeField = _.find(dateFields, { text: this.timeField });\n        if (!timeField) {\n          return {\n            status: 'error',\n            message: 'No date field named ' + this.timeField + ' found',\n          };\n        }\n        return { status: 'success', message: 'Index OK. Time field name OK.' };\n      },\n      err => {\n        console.log(err);\n        if (err.data && err.data.error) {\n          let message = angular.toJson(err.data.error);\n          if (err.data.error.reason) {\n            message = err.data.error.reason;\n          }\n          return { status: 'error', message: message };\n        } else {\n          return { status: 'error', message: err.status };\n        }\n      }\n    );\n  }\n\n  getQueryHeader(searchType, timeFrom, timeTo) {\n    const queryHeader: any = {\n      search_type: searchType,\n      ignore_unavailable: true,\n      index: this.indexPattern.getIndexList(timeFrom, timeTo),\n    };\n    if (this.esVersion >= 56) {\n      queryHeader['max_concurrent_shard_requests'] = this.maxConcurrentShardRequests;\n    }\n    return angular.toJson(queryHeader);\n  }\n\n  query(options) {\n    let payload = '';\n    let target;\n    const sentTargets = [];\n\n    // add global adhoc filters to timeFilter\n    const adhocFilters = this.templateSrv.getAdhocFilters(this.name);\n\n    for (let i = 0; i < options.targets.length; i++) {\n      target = options.targets[i];\n      if (target.hide) {\n        continue;\n      }\n\n      const queryString = this.templateSrv.replace(target.query || '*', options.scopedVars, 'lucene');\n      const queryObj = this.queryBuilder.build(target, adhocFilters, queryString);\n      const esQuery = angular.toJson(queryObj);\n\n      const searchType = queryObj.size === 0 && this.esVersion < 5 ? 'count' : 'query_then_fetch';\n      const header = this.getQueryHeader(searchType, options.range.from, options.range.to);\n      payload += header + '\\n';\n\n      payload += esQuery + '\\n';\n      sentTargets.push(target);\n    }\n\n    if (sentTargets.length === 0) {\n      return this.$q.when([]);\n    }\n\n    payload = payload.replace(/\\$timeFrom/g, options.range.from.valueOf());\n    payload = payload.replace(/\\$timeTo/g, options.range.to.valueOf());\n    payload = this.templateSrv.replace(payload, options.scopedVars);\n\n    return this.post('_msearch', payload).then(res => {\n      return new ElasticResponse(sentTargets, res).getTimeSeries();\n    });\n  }\n\n  getFields(query) {\n    return this.get('/_mapping').then(result => {\n      const typeMap = {\n        float: 'number',\n        double: 'number',\n        integer: 'number',\n        long: 'number',\n        date: 'date',\n        string: 'string',\n        text: 'string',\n        scaled_float: 'number',\n        nested: 'nested',\n      };\n\n      function shouldAddField(obj, key, query) {\n        if (key[0] === '_') {\n          return false;\n        }\n\n        if (!query.type) {\n          return true;\n        }\n\n        // equal query type filter, or via typemap translation\n        return query.type === obj.type || query.type === typeMap[obj.type];\n      }\n\n      // Store subfield names: [system, process, cpu, total] -> system.process.cpu.total\n      const fieldNameParts = [];\n      const fields = {};\n\n      function getFieldsRecursively(obj) {\n        for (const key in obj) {\n          const subObj = obj[key];\n\n          // Check mapping field for nested fields\n          if (_.isObject(subObj.properties)) {\n            fieldNameParts.push(key);\n            getFieldsRecursively(subObj.properties);\n          }\n\n          if (_.isObject(subObj.fields)) {\n            fieldNameParts.push(key);\n            getFieldsRecursively(subObj.fields);\n          }\n\n          if (_.isString(subObj.type)) {\n            const fieldName = fieldNameParts.concat(key).join('.');\n\n            // Hide meta-fields and check field type\n            if (shouldAddField(subObj, key, query)) {\n              fields[fieldName] = {\n                text: fieldName,\n                type: subObj.type,\n              };\n            }\n          }\n        }\n        fieldNameParts.pop();\n      }\n\n      for (const indexName in result) {\n        const index = result[indexName];\n        if (index && index.mappings) {\n          const mappings = index.mappings;\n          for (const typeName in mappings) {\n            const properties = mappings[typeName].properties;\n            getFieldsRecursively(properties);\n          }\n        }\n      }\n\n      // transform to array\n      return _.map(fields, value => {\n        return value;\n      });\n    });\n  }\n\n  getTerms(queryDef) {\n    const range = this.timeSrv.timeRange();\n    const searchType = this.esVersion >= 5 ? 'query_then_fetch' : 'count';\n    const header = this.getQueryHeader(searchType, range.from, range.to);\n    let esQuery = angular.toJson(this.queryBuilder.getTermsQuery(queryDef));\n\n    esQuery = esQuery.replace(/\\$timeFrom/g, range.from.valueOf());\n    esQuery = esQuery.replace(/\\$timeTo/g, range.to.valueOf());\n    esQuery = header + '\\n' + esQuery + '\\n';\n\n    return this.post('_msearch?search_type=' + searchType, esQuery).then(res => {\n      if (!res.responses[0].aggregations) {\n        return [];\n      }\n\n      const buckets = res.responses[0].aggregations['1'].buckets;\n      return _.map(buckets, bucket => {\n        return {\n          text: bucket.key_as_string || bucket.key,\n          value: bucket.key,\n        };\n      });\n    });\n  }\n\n  metricFindQuery(query) {\n    query = angular.fromJson(query);\n    if (!query) {\n      return this.$q.when([]);\n    }\n\n    if (query.find === 'fields') {\n      query.field = this.templateSrv.replace(query.field, {}, 'lucene');\n      return this.getFields(query);\n    }\n\n    if (query.find === 'terms') {\n      query.field = this.templateSrv.replace(query.field, {}, 'lucene');\n      query.query = this.templateSrv.replace(query.query || '*', {}, 'lucene');\n      return this.getTerms(query);\n    }\n  }\n\n  getTagKeys() {\n    return this.getFields({});\n  }\n\n  getTagValues(options) {\n    return this.getTerms({ field: options.key, query: '*' });\n  }\n\n  targetContainsTemplate(target) {\n    if (this.templateSrv.variableExists(target.query) || this.templateSrv.variableExists(target.alias)) {\n      return true;\n    }\n\n    for (const bucketAgg of target.bucketAggs) {\n      if (this.templateSrv.variableExists(bucketAgg.field) || this.objectContainsTemplate(bucketAgg.settings)) {\n        return true;\n      }\n    }\n\n    for (const metric of target.metrics) {\n      if (\n        this.templateSrv.variableExists(metric.field) ||\n        this.objectContainsTemplate(metric.settings) ||\n        this.objectContainsTemplate(metric.meta)\n      ) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  private isPrimitive(obj) {\n    if (obj === null || obj === undefined) {\n      return true;\n    }\n    if (['string', 'number', 'boolean'].some(type => type === typeof true)) {\n      return true;\n    }\n\n    return false;\n  }\n\n  private objectContainsTemplate(obj) {\n    if (!obj) {\n      return false;\n    }\n\n    for (const key of Object.keys(obj)) {\n      if (this.isPrimitive(obj[key])) {\n        if (this.templateSrv.variableExists(obj[key])) {\n          return true;\n        }\n      } else if (Array.isArray(obj[key])) {\n        for (const item of obj[key]) {\n          if (this.objectContainsTemplate(item)) {\n            return true;\n          }\n        }\n      } else {\n        if (this.objectContainsTemplate(obj[key])) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n}\n","import angular from 'angular';\nimport _ from 'lodash';\nimport * as queryDef from './query_def';\n\nexport function elasticBucketAgg() {\n  return {\n    templateUrl: 'public/app/plugins/datasource/elasticsearch/partials/bucket_agg.html',\n    controller: 'ElasticBucketAggCtrl',\n    restrict: 'E',\n    scope: {\n      target: '=',\n      index: '=',\n      onChange: '&',\n      getFields: '&',\n    },\n  };\n}\n\nexport class ElasticBucketAggCtrl {\n  /** @nginject */\n  constructor($scope, uiSegmentSrv, $q, $rootScope) {\n    const bucketAggs = $scope.target.bucketAggs;\n\n    $scope.orderByOptions = [];\n\n    $scope.getBucketAggTypes = () => {\n      return queryDef.bucketAggTypes;\n    };\n\n    $scope.getOrderOptions = () => {\n      return queryDef.orderOptions;\n    };\n\n    $scope.getSizeOptions = () => {\n      return queryDef.sizeOptions;\n    };\n\n    $rootScope.onAppEvent(\n      'elastic-query-updated',\n      () => {\n        $scope.validateModel();\n      },\n      $scope\n    );\n\n    $scope.init = () => {\n      $scope.agg = bucketAggs[$scope.index];\n      $scope.validateModel();\n    };\n\n    $scope.onChangeInternal = () => {\n      $scope.onChange();\n    };\n\n    $scope.onTypeChanged = () => {\n      $scope.agg.settings = {};\n      $scope.showOptions = false;\n\n      switch ($scope.agg.type) {\n        case 'date_histogram':\n        case 'histogram':\n        case 'terms': {\n          delete $scope.agg.query;\n          $scope.agg.field = 'select field';\n          break;\n        }\n        case 'filters': {\n          delete $scope.agg.field;\n          $scope.agg.query = '*';\n          break;\n        }\n        case 'geohash_grid': {\n          $scope.agg.settings.precision = 3;\n          break;\n        }\n      }\n\n      $scope.validateModel();\n      $scope.onChange();\n    };\n\n    $scope.validateModel = () => {\n      $scope.index = _.indexOf(bucketAggs, $scope.agg);\n      $scope.isFirst = $scope.index === 0;\n      $scope.bucketAggCount = bucketAggs.length;\n\n      let settingsLinkText = '';\n      const settings = $scope.agg.settings || {};\n\n      switch ($scope.agg.type) {\n        case 'terms': {\n          settings.order = settings.order || 'desc';\n          settings.size = settings.size || '10';\n          settings.min_doc_count = settings.min_doc_count || 1;\n          settings.orderBy = settings.orderBy || '_term';\n\n          if (settings.size !== '0') {\n            settingsLinkText = queryDef.describeOrder(settings.order) + ' ' + settings.size + ', ';\n          }\n\n          if (settings.min_doc_count > 0) {\n            settingsLinkText += 'Min Doc Count: ' + settings.min_doc_count + ', ';\n          }\n\n          settingsLinkText += 'Order by: ' + queryDef.describeOrderBy(settings.orderBy, $scope.target);\n\n          if (settings.size === '0') {\n            settingsLinkText += ' (' + settings.order + ')';\n          }\n\n          break;\n        }\n        case 'filters': {\n          settings.filters = settings.filters || [{ query: '*' }];\n          settingsLinkText = _.reduce(\n            settings.filters,\n            (memo, value, index) => {\n              memo += 'Q' + (index + 1) + '  = ' + value.query + ' ';\n              return memo;\n            },\n            ''\n          );\n          if (settingsLinkText.length > 50) {\n            settingsLinkText = settingsLinkText.substr(0, 50) + '...';\n          }\n          settingsLinkText = 'Filter Queries (' + settings.filters.length + ')';\n          break;\n        }\n        case 'date_histogram': {\n          settings.interval = settings.interval || 'auto';\n          settings.min_doc_count = settings.min_doc_count || 0;\n          $scope.agg.field = $scope.target.timeField;\n          settingsLinkText = 'Interval: ' + settings.interval;\n\n          if (settings.min_doc_count > 0) {\n            settingsLinkText += ', Min Doc Count: ' + settings.min_doc_count;\n          }\n\n          if (settings.trimEdges === undefined || settings.trimEdges < 0) {\n            settings.trimEdges = 0;\n          }\n\n          if (settings.trimEdges && settings.trimEdges > 0) {\n            settingsLinkText += ', Trim edges: ' + settings.trimEdges;\n          }\n          break;\n        }\n        case 'histogram': {\n          settings.interval = settings.interval || 1000;\n          settings.min_doc_count = _.defaultTo(settings.min_doc_count, 1);\n          settingsLinkText = 'Interval: ' + settings.interval;\n\n          if (settings.min_doc_count > 0) {\n            settingsLinkText += ', Min Doc Count: ' + settings.min_doc_count;\n          }\n          break;\n        }\n        case 'geohash_grid': {\n          // limit precision to 7\n          settings.precision = Math.max(Math.min(settings.precision, 7), 1);\n          settingsLinkText = 'Precision: ' + settings.precision;\n          break;\n        }\n      }\n\n      $scope.settingsLinkText = settingsLinkText;\n      $scope.agg.settings = settings;\n      return true;\n    };\n\n    $scope.addFiltersQuery = () => {\n      $scope.agg.settings.filters.push({ query: '*' });\n    };\n\n    $scope.removeFiltersQuery = filter => {\n      $scope.agg.settings.filters = _.without($scope.agg.settings.filters, filter);\n    };\n\n    $scope.toggleOptions = () => {\n      $scope.showOptions = !$scope.showOptions;\n    };\n\n    $scope.getOrderByOptions = () => {\n      return queryDef.getOrderByOptions($scope.target);\n    };\n\n    $scope.getFieldsInternal = () => {\n      if ($scope.agg.type === 'date_histogram') {\n        return $scope.getFields({ $fieldType: 'date' });\n      } else {\n        return $scope.getFields();\n      }\n    };\n\n    $scope.getIntervalOptions = () => {\n      return $q.when(uiSegmentSrv.transformToSegments(true, 'interval')(queryDef.intervalOptions));\n    };\n\n    $scope.addBucketAgg = () => {\n      // if last is date histogram add it before\n      const lastBucket = bucketAggs[bucketAggs.length - 1];\n      let addIndex = bucketAggs.length - 1;\n\n      if (lastBucket && lastBucket.type === 'date_histogram') {\n        addIndex -= 1;\n      }\n\n      const id = _.reduce(\n        $scope.target.bucketAggs.concat($scope.target.metrics),\n        (max, val) => {\n          return parseInt(val.id, 10) > max ? parseInt(val.id, 10) : max;\n        },\n        0\n      );\n\n      bucketAggs.splice(addIndex, 0, { type: 'terms', field: 'select field', id: (id + 1).toString(), fake: true });\n      $scope.onChange();\n    };\n\n    $scope.removeBucketAgg = () => {\n      bucketAggs.splice($scope.index, 1);\n      $scope.onChange();\n    };\n\n    $scope.init();\n  }\n}\n\nconst module = angular.module('grafana.directives');\nmodule.directive('elasticBucketAgg', elasticBucketAgg);\nmodule.controller('ElasticBucketAggCtrl', ElasticBucketAggCtrl);\n","import angular from 'angular';\nimport _ from 'lodash';\nimport * as queryDef from './query_def';\n\nexport function elasticMetricAgg() {\n  return {\n    templateUrl: 'public/app/plugins/datasource/elasticsearch/partials/metric_agg.html',\n    controller: 'ElasticMetricAggCtrl',\n    restrict: 'E',\n    scope: {\n      target: '=',\n      index: '=',\n      onChange: '&',\n      getFields: '&',\n      esVersion: '=',\n    },\n  };\n}\n\nexport class ElasticMetricAggCtrl {\n  constructor($scope, uiSegmentSrv, $q, $rootScope) {\n    const metricAggs = $scope.target.metrics;\n    $scope.metricAggTypes = queryDef.getMetricAggTypes($scope.esVersion);\n    $scope.extendedStats = queryDef.extendedStats;\n    $scope.pipelineAggOptions = [];\n    $scope.modelSettingsValues = {};\n\n    $scope.init = () => {\n      $scope.agg = metricAggs[$scope.index];\n      $scope.validateModel();\n      $scope.updatePipelineAggOptions();\n    };\n\n    $scope.updatePipelineAggOptions = () => {\n      $scope.pipelineAggOptions = queryDef.getPipelineAggOptions($scope.target);\n    };\n\n    $rootScope.onAppEvent(\n      'elastic-query-updated',\n      () => {\n        $scope.index = _.indexOf(metricAggs, $scope.agg);\n        $scope.updatePipelineAggOptions();\n        $scope.validateModel();\n      },\n      $scope\n    );\n\n    $scope.validateModel = () => {\n      $scope.isFirst = $scope.index === 0;\n      $scope.isSingle = metricAggs.length === 1;\n      $scope.settingsLinkText = '';\n      $scope.aggDef = _.find($scope.metricAggTypes, { value: $scope.agg.type });\n\n      if (queryDef.isPipelineAgg($scope.agg.type)) {\n        $scope.agg.pipelineAgg = $scope.agg.pipelineAgg || 'select metric';\n        $scope.agg.field = $scope.agg.pipelineAgg;\n\n        const pipelineOptions = queryDef.getPipelineOptions($scope.agg);\n        if (pipelineOptions.length > 0) {\n          _.each(pipelineOptions, opt => {\n            $scope.agg.settings[opt.text] = $scope.agg.settings[opt.text] || opt.default;\n          });\n          $scope.settingsLinkText = 'Options';\n        }\n      } else if (!$scope.agg.field) {\n        $scope.agg.field = 'select field';\n      }\n      switch ($scope.agg.type) {\n        case 'cardinality': {\n          const precisionThreshold = $scope.agg.settings.precision_threshold || '';\n          $scope.settingsLinkText = 'Precision threshold: ' + precisionThreshold;\n          break;\n        }\n        case 'percentiles': {\n          $scope.agg.settings.percents = $scope.agg.settings.percents || [25, 50, 75, 95, 99];\n          $scope.settingsLinkText = 'Values: ' + $scope.agg.settings.percents.join(',');\n          break;\n        }\n        case 'extended_stats': {\n          if (_.keys($scope.agg.meta).length === 0) {\n            $scope.agg.meta.std_deviation_bounds_lower = true;\n            $scope.agg.meta.std_deviation_bounds_upper = true;\n          }\n\n          const stats = _.reduce(\n            $scope.agg.meta,\n            (memo, val, key) => {\n              if (val) {\n                const def = _.find($scope.extendedStats, { value: key });\n                memo.push(def.text);\n              }\n              return memo;\n            },\n            []\n          );\n\n          $scope.settingsLinkText = 'Stats: ' + stats.join(', ');\n          break;\n        }\n        case 'moving_avg': {\n          $scope.movingAvgModelTypes = queryDef.movingAvgModelOptions;\n          $scope.modelSettings = queryDef.getMovingAvgSettings($scope.agg.settings.model, true);\n          $scope.updateMovingAvgModelSettings();\n          break;\n        }\n        case 'raw_document': {\n          $scope.agg.settings.size = $scope.agg.settings.size || 500;\n          $scope.settingsLinkText = 'Size: ' + $scope.agg.settings.size;\n          $scope.target.metrics.splice(0, $scope.target.metrics.length, $scope.agg);\n\n          $scope.target.bucketAggs = [];\n          break;\n        }\n      }\n      if ($scope.aggDef.supportsInlineScript) {\n        // I know this stores the inline script twice\n        // but having it like this simplifes the query_builder\n        const inlineScript = $scope.agg.inlineScript;\n        if (inlineScript) {\n          $scope.agg.settings.script = { inline: inlineScript };\n        } else {\n          delete $scope.agg.settings.script;\n        }\n\n        if ($scope.settingsLinkText === '') {\n          $scope.settingsLinkText = 'Options';\n        }\n      }\n    };\n\n    $scope.toggleOptions = () => {\n      $scope.showOptions = !$scope.showOptions;\n      $scope.updatePipelineAggOptions();\n    };\n\n    $scope.onChangeInternal = () => {\n      $scope.onChange();\n    };\n\n    $scope.updateMovingAvgModelSettings = () => {\n      const modelSettingsKeys = [];\n      const modelSettings = queryDef.getMovingAvgSettings($scope.agg.settings.model, false);\n      for (let i = 0; i < modelSettings.length; i++) {\n        modelSettingsKeys.push(modelSettings[i].value);\n      }\n\n      for (const key in $scope.agg.settings.settings) {\n        if ($scope.agg.settings.settings[key] === null || modelSettingsKeys.indexOf(key) === -1) {\n          delete $scope.agg.settings.settings[key];\n        }\n      }\n    };\n\n    $scope.onChangeClearInternal = () => {\n      delete $scope.agg.settings.minimize;\n      $scope.onChange();\n    };\n\n    $scope.onTypeChange = () => {\n      $scope.agg.settings = {};\n      $scope.agg.meta = {};\n      $scope.showOptions = false;\n      $scope.updatePipelineAggOptions();\n      $scope.onChange();\n    };\n\n    $scope.getFieldsInternal = () => {\n      if ($scope.agg.type === 'cardinality') {\n        return $scope.getFields();\n      }\n      return $scope.getFields({ $fieldType: 'number' });\n    };\n\n    $scope.addMetricAgg = () => {\n      const addIndex = metricAggs.length;\n\n      const id = _.reduce(\n        $scope.target.bucketAggs.concat($scope.target.metrics),\n        (max, val) => {\n          return parseInt(val.id, 10) > max ? parseInt(val.id, 10) : max;\n        },\n        0\n      );\n\n      metricAggs.splice(addIndex, 0, { type: 'count', field: 'select field', id: (id + 1).toString() });\n      $scope.onChange();\n    };\n\n    $scope.removeMetricAgg = () => {\n      metricAggs.splice($scope.index, 1);\n      $scope.onChange();\n    };\n\n    $scope.toggleShowMetric = () => {\n      $scope.agg.hide = !$scope.agg.hide;\n      if (!$scope.agg.hide) {\n        delete $scope.agg.hide;\n      }\n      $scope.onChange();\n    };\n\n    $scope.init();\n  }\n}\n\nconst module = angular.module('grafana.directives');\nmodule.directive('elasticMetricAgg', elasticMetricAgg);\nmodule.controller('ElasticMetricAggCtrl', ElasticMetricAggCtrl);\n","import './bucket_agg';\nimport './metric_agg';\n\nimport angular from 'angular';\nimport _ from 'lodash';\nimport * as queryDef from './query_def';\nimport { QueryCtrl } from 'app/plugins/sdk';\n\nexport class ElasticQueryCtrl extends QueryCtrl {\n  static templateUrl = 'partials/query.editor.html';\n\n  esVersion: any;\n  rawQueryOld: string;\n\n  /** @ngInject */\n  constructor($scope, $injector, private $rootScope, private uiSegmentSrv) {\n    super($scope, $injector);\n\n    this.esVersion = this.datasource.esVersion;\n    this.queryUpdated();\n  }\n\n  getFields(type) {\n    const jsonStr = angular.toJson({ find: 'fields', type: type });\n    return this.datasource\n      .metricFindQuery(jsonStr)\n      .then(this.uiSegmentSrv.transformToSegments(false))\n      .catch(this.handleQueryError.bind(this));\n  }\n\n  queryUpdated() {\n    const newJson = angular.toJson(this.datasource.queryBuilder.build(this.target), true);\n    if (this.rawQueryOld && newJson !== this.rawQueryOld) {\n      this.refresh();\n    }\n\n    this.rawQueryOld = newJson;\n    this.$rootScope.appEvent('elastic-query-updated');\n  }\n\n  getCollapsedText() {\n    const metricAggs = this.target.metrics;\n    const bucketAggs = this.target.bucketAggs;\n    const metricAggTypes = queryDef.getMetricAggTypes(this.esVersion);\n    const bucketAggTypes = queryDef.bucketAggTypes;\n    let text = '';\n\n    if (this.target.query) {\n      text += 'Query: ' + this.target.query + ', ';\n    }\n\n    text += 'Metrics: ';\n\n    _.each(metricAggs, (metric, index) => {\n      const aggDef = _.find(metricAggTypes, { value: metric.type });\n      text += aggDef.text + '(';\n      if (aggDef.requiresField) {\n        text += metric.field;\n      }\n      text += '), ';\n    });\n\n    _.each(bucketAggs, (bucketAgg, index) => {\n      if (index === 0) {\n        text += ' Group by: ';\n      }\n\n      const aggDef = _.find(bucketAggTypes, { value: bucketAgg.type });\n      text += aggDef.text + '(';\n      if (aggDef.requiresField) {\n        text += bucketAgg.field;\n      }\n      text += '), ';\n    });\n\n    if (this.target.alias) {\n      text += 'Alias: ' + this.target.alias;\n    }\n\n    return text;\n  }\n\n  handleQueryError(err) {\n    this.error = err.message || 'Failed to issue metric query';\n    return [];\n  }\n}\n","import angular from 'angular';\nimport _ from 'lodash';\nimport * as dateMath from 'app/core/utils/datemath';\n\nexport default class OpenTsDatasource {\n  type: any;\n  url: any;\n  name: any;\n  withCredentials: any;\n  basicAuth: any;\n  tsdbVersion: any;\n  tsdbResolution: any;\n  tagKeys: any;\n\n  aggregatorsPromise: any;\n  filterTypesPromise: any;\n\n  /** @ngInject */\n  constructor(instanceSettings, private $q, private backendSrv, private templateSrv) {\n    this.type = 'opentsdb';\n    this.url = instanceSettings.url;\n    this.name = instanceSettings.name;\n    this.withCredentials = instanceSettings.withCredentials;\n    this.basicAuth = instanceSettings.basicAuth;\n    instanceSettings.jsonData = instanceSettings.jsonData || {};\n    this.tsdbVersion = instanceSettings.jsonData.tsdbVersion || 1;\n    this.tsdbResolution = instanceSettings.jsonData.tsdbResolution || 1;\n    this.tagKeys = {};\n\n    this.aggregatorsPromise = null;\n    this.filterTypesPromise = null;\n  }\n\n  // Called once per panel (graph)\n  query(options) {\n    const start = this.convertToTSDBTime(options.rangeRaw.from, false);\n    const end = this.convertToTSDBTime(options.rangeRaw.to, true);\n    const qs = [];\n\n    _.each(options.targets, target => {\n      if (!target.metric) {\n        return;\n      }\n      qs.push(this.convertTargetToQuery(target, options, this.tsdbVersion));\n    });\n\n    const queries = _.compact(qs);\n\n    // No valid targets, return the empty result to save a round trip.\n    if (_.isEmpty(queries)) {\n      const d = this.$q.defer();\n      d.resolve({ data: [] });\n      return d.promise;\n    }\n\n    const groupByTags = {};\n    _.each(queries, query => {\n      if (query.filters && query.filters.length > 0) {\n        _.each(query.filters, val => {\n          groupByTags[val.tagk] = true;\n        });\n      } else {\n        _.each(query.tags, (val, key) => {\n          groupByTags[key] = true;\n        });\n      }\n    });\n\n    options.targets = _.filter(options.targets, query => {\n      return query.hide !== true;\n    });\n\n    return this.performTimeSeriesQuery(queries, start, end).then(response => {\n      const metricToTargetMapping = this.mapMetricsToTargets(response.data, options, this.tsdbVersion);\n      const result = _.map(response.data, (metricData, index) => {\n        index = metricToTargetMapping[index];\n        if (index === -1) {\n          index = 0;\n        }\n        this._saveTagKeys(metricData);\n\n        return this.transformMetricData(metricData, groupByTags, options.targets[index], options, this.tsdbResolution);\n      });\n      return { data: result };\n    });\n  }\n\n  annotationQuery(options) {\n    const start = this.convertToTSDBTime(options.rangeRaw.from, false);\n    const end = this.convertToTSDBTime(options.rangeRaw.to, true);\n    const qs = [];\n    const eventList = [];\n\n    qs.push({ aggregator: 'sum', metric: options.annotation.target });\n\n    const queries = _.compact(qs);\n\n    return this.performTimeSeriesQuery(queries, start, end).then(results => {\n      if (results.data[0]) {\n        let annotationObject = results.data[0].annotations;\n        if (options.annotation.isGlobal) {\n          annotationObject = results.data[0].globalAnnotations;\n        }\n        if (annotationObject) {\n          _.each(annotationObject, annotation => {\n            const event = {\n              text: annotation.description,\n              time: Math.floor(annotation.startTime) * 1000,\n              annotation: options.annotation,\n            };\n\n            eventList.push(event);\n          });\n        }\n      }\n      return eventList;\n    });\n  }\n\n  targetContainsTemplate(target) {\n    if (target.filters && target.filters.length > 0) {\n      for (let i = 0; i < target.filters.length; i++) {\n        if (this.templateSrv.variableExists(target.filters[i].filter)) {\n          return true;\n        }\n      }\n    }\n\n    if (target.tags && Object.keys(target.tags).length > 0) {\n      for (const tagKey in target.tags) {\n        if (this.templateSrv.variableExists(target.tags[tagKey])) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  performTimeSeriesQuery(queries, start, end) {\n    let msResolution = false;\n    if (this.tsdbResolution === 2) {\n      msResolution = true;\n    }\n    const reqBody: any = {\n      start: start,\n      queries: queries,\n      msResolution: msResolution,\n      globalAnnotations: true,\n    };\n    if (this.tsdbVersion === 3) {\n      reqBody.showQuery = true;\n    }\n\n    // Relative queries (e.g. last hour) don't include an end time\n    if (end) {\n      reqBody.end = end;\n    }\n\n    const options = {\n      method: 'POST',\n      url: this.url + '/api/query',\n      data: reqBody,\n    };\n\n    this._addCredentialOptions(options);\n    return this.backendSrv.datasourceRequest(options);\n  }\n\n  suggestTagKeys(metric) {\n    return this.$q.when(this.tagKeys[metric] || []);\n  }\n\n  _saveTagKeys(metricData) {\n    const tagKeys = Object.keys(metricData.tags);\n    _.each(metricData.aggregateTags, tag => {\n      tagKeys.push(tag);\n    });\n\n    this.tagKeys[metricData.metric] = tagKeys;\n  }\n\n  _performSuggestQuery(query, type) {\n    return this._get('/api/suggest', { type: type, q: query, max: 1000 }).then(result => {\n      return result.data;\n    });\n  }\n\n  _performMetricKeyValueLookup(metric, keys) {\n    if (!metric || !keys) {\n      return this.$q.when([]);\n    }\n\n    const keysArray = keys.split(',').map(key => {\n      return key.trim();\n    });\n    const key = keysArray[0];\n    let keysQuery = key + '=*';\n\n    if (keysArray.length > 1) {\n      keysQuery += ',' + keysArray.splice(1).join(',');\n    }\n\n    const m = metric + '{' + keysQuery + '}';\n\n    return this._get('/api/search/lookup', { m: m, limit: 3000 }).then(result => {\n      result = result.data.results;\n      const tagvs = [];\n      _.each(result, r => {\n        if (tagvs.indexOf(r.tags[key]) === -1) {\n          tagvs.push(r.tags[key]);\n        }\n      });\n      return tagvs;\n    });\n  }\n\n  _performMetricKeyLookup(metric) {\n    if (!metric) {\n      return this.$q.when([]);\n    }\n\n    return this._get('/api/search/lookup', { m: metric, limit: 1000 }).then(result => {\n      result = result.data.results;\n      const tagks = [];\n      _.each(result, r => {\n        _.each(r.tags, (tagv, tagk) => {\n          if (tagks.indexOf(tagk) === -1) {\n            tagks.push(tagk);\n          }\n        });\n      });\n      return tagks;\n    });\n  }\n\n  _get(relativeUrl, params?) {\n    const options = {\n      method: 'GET',\n      url: this.url + relativeUrl,\n      params: params,\n    };\n\n    this._addCredentialOptions(options);\n\n    return this.backendSrv.datasourceRequest(options);\n  }\n\n  _addCredentialOptions(options) {\n    if (this.basicAuth || this.withCredentials) {\n      options.withCredentials = true;\n    }\n    if (this.basicAuth) {\n      options.headers = { Authorization: this.basicAuth };\n    }\n  }\n\n  metricFindQuery(query) {\n    if (!query) {\n      return this.$q.when([]);\n    }\n\n    let interpolated;\n    try {\n      interpolated = this.templateSrv.replace(query, {}, 'distributed');\n    } catch (err) {\n      return this.$q.reject(err);\n    }\n\n    const responseTransform = result => {\n      return _.map(result, value => {\n        return { text: value };\n      });\n    };\n\n    const metricsRegex = /metrics\\((.*)\\)/;\n    const tagNamesRegex = /tag_names\\((.*)\\)/;\n    const tagValuesRegex = /tag_values\\((.*?),\\s?(.*)\\)/;\n    const tagNamesSuggestRegex = /suggest_tagk\\((.*)\\)/;\n    const tagValuesSuggestRegex = /suggest_tagv\\((.*)\\)/;\n\n    const metricsQuery = interpolated.match(metricsRegex);\n    if (metricsQuery) {\n      return this._performSuggestQuery(metricsQuery[1], 'metrics').then(responseTransform);\n    }\n\n    const tagNamesQuery = interpolated.match(tagNamesRegex);\n    if (tagNamesQuery) {\n      return this._performMetricKeyLookup(tagNamesQuery[1]).then(responseTransform);\n    }\n\n    const tagValuesQuery = interpolated.match(tagValuesRegex);\n    if (tagValuesQuery) {\n      return this._performMetricKeyValueLookup(tagValuesQuery[1], tagValuesQuery[2]).then(responseTransform);\n    }\n\n    const tagNamesSuggestQuery = interpolated.match(tagNamesSuggestRegex);\n    if (tagNamesSuggestQuery) {\n      return this._performSuggestQuery(tagNamesSuggestQuery[1], 'tagk').then(responseTransform);\n    }\n\n    const tagValuesSuggestQuery = interpolated.match(tagValuesSuggestRegex);\n    if (tagValuesSuggestQuery) {\n      return this._performSuggestQuery(tagValuesSuggestQuery[1], 'tagv').then(responseTransform);\n    }\n\n    return this.$q.when([]);\n  }\n\n  testDatasource() {\n    return this._performSuggestQuery('cpu', 'metrics').then(() => {\n      return { status: 'success', message: 'Data source is working' };\n    });\n  }\n\n  getAggregators() {\n    if (this.aggregatorsPromise) {\n      return this.aggregatorsPromise;\n    }\n\n    this.aggregatorsPromise = this._get('/api/aggregators').then(result => {\n      if (result.data && _.isArray(result.data)) {\n        return result.data.sort();\n      }\n      return [];\n    });\n    return this.aggregatorsPromise;\n  }\n\n  getFilterTypes() {\n    if (this.filterTypesPromise) {\n      return this.filterTypesPromise;\n    }\n\n    this.filterTypesPromise = this._get('/api/config/filters').then(result => {\n      if (result.data) {\n        return Object.keys(result.data).sort();\n      }\n      return [];\n    });\n    return this.filterTypesPromise;\n  }\n\n  transformMetricData(md, groupByTags, target, options, tsdbResolution) {\n    const metricLabel = this.createMetricLabel(md, target, groupByTags, options);\n    const dps = [];\n\n    // TSDB returns datapoints has a hash of ts => value.\n    // Can't use _.pairs(invert()) because it stringifies keys/values\n    _.each(md.dps, (v, k) => {\n      if (tsdbResolution === 2) {\n        dps.push([v, k * 1]);\n      } else {\n        dps.push([v, k * 1000]);\n      }\n    });\n\n    return { target: metricLabel, datapoints: dps };\n  }\n\n  createMetricLabel(md, target, groupByTags, options) {\n    if (target.alias) {\n      const scopedVars = _.clone(options.scopedVars || {});\n      _.each(md.tags, (value, key) => {\n        scopedVars['tag_' + key] = { value: value };\n      });\n      return this.templateSrv.replace(target.alias, scopedVars);\n    }\n\n    let label = md.metric;\n    const tagData = [];\n\n    if (!_.isEmpty(md.tags)) {\n      _.each(_.toPairs(md.tags), tag => {\n        if (_.has(groupByTags, tag[0])) {\n          tagData.push(tag[0] + '=' + tag[1]);\n        }\n      });\n    }\n\n    if (!_.isEmpty(tagData)) {\n      label += '{' + tagData.join(', ') + '}';\n    }\n\n    return label;\n  }\n\n  convertTargetToQuery(target, options, tsdbVersion) {\n    if (!target.metric || target.hide) {\n      return null;\n    }\n\n    const query: any = {\n      metric: this.templateSrv.replace(target.metric, options.scopedVars, 'pipe'),\n      aggregator: 'avg',\n    };\n\n    if (target.aggregator) {\n      query.aggregator = this.templateSrv.replace(target.aggregator);\n    }\n\n    if (target.shouldComputeRate) {\n      query.rate = true;\n      query.rateOptions = {\n        counter: !!target.isCounter,\n      };\n\n      if (target.counterMax && target.counterMax.length) {\n        query.rateOptions.counterMax = parseInt(target.counterMax, 10);\n      }\n\n      if (target.counterResetValue && target.counterResetValue.length) {\n        query.rateOptions.resetValue = parseInt(target.counterResetValue, 10);\n      }\n\n      if (tsdbVersion >= 2) {\n        query.rateOptions.dropResets =\n          !query.rateOptions.counterMax && (!query.rateOptions.ResetValue || query.rateOptions.ResetValue === 0);\n      }\n    }\n\n    if (!target.disableDownsampling) {\n      let interval = this.templateSrv.replace(target.downsampleInterval || options.interval);\n\n      if (interval.match(/\\.[0-9]+s/)) {\n        interval = parseFloat(interval) * 1000 + 'ms';\n      }\n\n      query.downsample = interval + '-' + target.downsampleAggregator;\n\n      if (target.downsampleFillPolicy && target.downsampleFillPolicy !== 'none') {\n        query.downsample += '-' + target.downsampleFillPolicy;\n      }\n    }\n\n    if (target.filters && target.filters.length > 0) {\n      query.filters = angular.copy(target.filters);\n      if (query.filters) {\n        for (const filterKey in query.filters) {\n          query.filters[filterKey].filter = this.templateSrv.replace(\n            query.filters[filterKey].filter,\n            options.scopedVars,\n            'pipe'\n          );\n        }\n      }\n    } else {\n      query.tags = angular.copy(target.tags);\n      if (query.tags) {\n        for (const tagKey in query.tags) {\n          query.tags[tagKey] = this.templateSrv.replace(query.tags[tagKey], options.scopedVars, 'pipe');\n        }\n      }\n    }\n\n    if (target.explicitTags) {\n      query.explicitTags = true;\n    }\n\n    return query;\n  }\n\n  mapMetricsToTargets(metrics, options, tsdbVersion) {\n    let interpolatedTagValue, arrTagV;\n    return _.map(metrics, metricData => {\n      if (tsdbVersion === 3) {\n        return metricData.query.index;\n      } else {\n        return _.findIndex(options.targets, target => {\n          if (target.filters && target.filters.length > 0) {\n            return target.metric === metricData.metric;\n          } else {\n            return (\n              target.metric === metricData.metric &&\n              _.every(target.tags, (tagV, tagK) => {\n                interpolatedTagValue = this.templateSrv.replace(tagV, options.scopedVars, 'pipe');\n                arrTagV = interpolatedTagValue.split('|');\n                return _.includes(arrTagV, metricData.tags[tagK]) || interpolatedTagValue === '*';\n              })\n            );\n          }\n        });\n      }\n    });\n  }\n\n  convertToTSDBTime(date, roundUp) {\n    if (date === 'now') {\n      return null;\n    }\n\n    date = dateMath.parse(date, roundUp);\n    return date.valueOf();\n  }\n}\n","import _ from 'lodash';\n\nexport class ElasticConfigCtrl {\n  static templateUrl = 'public/app/plugins/datasource/elasticsearch/partials/config.html';\n  current: any;\n\n  /** @ngInject */\n  constructor($scope) {\n    this.current.jsonData.timeField = this.current.jsonData.timeField || '@timestamp';\n    this.current.jsonData.esVersion = this.current.jsonData.esVersion || 5;\n    this.current.jsonData.maxConcurrentShardRequests = this.current.jsonData.maxConcurrentShardRequests || 256;\n  }\n\n  indexPatternTypes = [\n    { name: 'No pattern', value: undefined },\n    { name: 'Hourly', value: 'Hourly', example: '[logstash-]YYYY.MM.DD.HH' },\n    { name: 'Daily', value: 'Daily', example: '[logstash-]YYYY.MM.DD' },\n    { name: 'Weekly', value: 'Weekly', example: '[logstash-]GGGG.WW' },\n    { name: 'Monthly', value: 'Monthly', example: '[logstash-]YYYY.MM' },\n    { name: 'Yearly', value: 'Yearly', example: '[logstash-]YYYY' },\n  ];\n\n  esVersions = [{ name: '2.x', value: 2 }, { name: '5.x', value: 5 }, { name: '5.6+', value: 56 }];\n\n  indexPatternTypeChanged() {\n    const def = _.find(this.indexPatternTypes, {\n      value: this.current.jsonData.interval,\n    });\n    this.current.database = def.example || 'es-index-name';\n  }\n}\n","import { ElasticDatasource } from './datasource';\nimport { ElasticQueryCtrl } from './query_ctrl';\nimport { ElasticConfigCtrl } from './config_ctrl';\n\nclass ElasticAnnotationsQueryCtrl {\n  static templateUrl = 'partials/annotations.editor.html';\n}\n\nexport {\n  ElasticDatasource as Datasource,\n  ElasticQueryCtrl as QueryCtrl,\n  ElasticConfigCtrl as ConfigCtrl,\n  ElasticAnnotationsQueryCtrl as AnnotationsQueryCtrl,\n};\n","import _ from 'lodash';\nimport kbn from 'app/core/utils/kbn';\nimport { QueryCtrl } from 'app/plugins/sdk';\n\nexport class OpenTsQueryCtrl extends QueryCtrl {\n  static templateUrl = 'partials/query.editor.html';\n  aggregators: any;\n  fillPolicies: any;\n  filterTypes: any;\n  tsdbVersion: any;\n  aggregator: any;\n  downsampleInterval: any;\n  downsampleAggregator: any;\n  downsampleFillPolicy: any;\n  errors: any;\n  suggestMetrics: any;\n  suggestTagKeys: any;\n  suggestTagValues: any;\n  addTagMode: boolean;\n  addFilterMode: boolean;\n\n  /** @ngInject */\n  constructor($scope, $injector) {\n    super($scope, $injector);\n\n    this.errors = this.validateTarget();\n    this.aggregators = ['avg', 'sum', 'min', 'max', 'dev', 'zimsum', 'mimmin', 'mimmax'];\n    this.fillPolicies = ['none', 'nan', 'null', 'zero'];\n    this.filterTypes = [\n      'wildcard',\n      'iliteral_or',\n      'not_iliteral_or',\n      'not_literal_or',\n      'iwildcard',\n      'literal_or',\n      'regexp',\n    ];\n\n    this.tsdbVersion = this.datasource.tsdbVersion;\n\n    if (!this.target.aggregator) {\n      this.target.aggregator = 'sum';\n    }\n\n    if (!this.target.downsampleAggregator) {\n      this.target.downsampleAggregator = 'avg';\n    }\n\n    if (!this.target.downsampleFillPolicy) {\n      this.target.downsampleFillPolicy = 'none';\n    }\n\n    this.datasource.getAggregators().then(aggs => {\n      if (aggs.length !== 0) {\n        this.aggregators = aggs;\n      }\n    });\n\n    this.datasource.getFilterTypes().then(filterTypes => {\n      if (filterTypes.length !== 0) {\n        this.filterTypes = filterTypes;\n      }\n    });\n\n    // needs to be defined here as it is called from typeahead\n    this.suggestMetrics = (query, callback) => {\n      this.datasource\n        .metricFindQuery('metrics(' + query + ')')\n        .then(this.getTextValues)\n        .then(callback);\n    };\n\n    this.suggestTagKeys = (query, callback) => {\n      this.datasource.suggestTagKeys(this.target.metric).then(callback);\n    };\n\n    this.suggestTagValues = (query, callback) => {\n      this.datasource\n        .metricFindQuery('suggest_tagv(' + query + ')')\n        .then(this.getTextValues)\n        .then(callback);\n    };\n  }\n\n  targetBlur() {\n    this.errors = this.validateTarget();\n    this.refresh();\n  }\n\n  getTextValues(metricFindResult) {\n    return _.map(metricFindResult, value => {\n      return value.text;\n    });\n  }\n\n  addTag() {\n    if (this.target.filters && this.target.filters.length > 0) {\n      this.errors.tags = 'Please remove filters to use tags, tags and filters are mutually exclusive.';\n    }\n\n    if (!this.addTagMode) {\n      this.addTagMode = true;\n      return;\n    }\n\n    if (!this.target.tags) {\n      this.target.tags = {};\n    }\n\n    this.errors = this.validateTarget();\n\n    if (!this.errors.tags) {\n      this.target.tags[this.target.currentTagKey] = this.target.currentTagValue;\n      this.target.currentTagKey = '';\n      this.target.currentTagValue = '';\n      this.targetBlur();\n    }\n\n    this.addTagMode = false;\n  }\n\n  removeTag(key) {\n    delete this.target.tags[key];\n    this.targetBlur();\n  }\n\n  editTag(key, value) {\n    this.removeTag(key);\n    this.target.currentTagKey = key;\n    this.target.currentTagValue = value;\n    this.addTag();\n  }\n\n  closeAddTagMode() {\n    this.addTagMode = false;\n    return;\n  }\n\n  addFilter() {\n    if (this.target.tags && _.size(this.target.tags) > 0) {\n      this.errors.filters = 'Please remove tags to use filters, tags and filters are mutually exclusive.';\n    }\n\n    if (!this.addFilterMode) {\n      this.addFilterMode = true;\n      return;\n    }\n\n    if (!this.target.filters) {\n      this.target.filters = [];\n    }\n\n    if (!this.target.currentFilterType) {\n      this.target.currentFilterType = 'iliteral_or';\n    }\n\n    if (!this.target.currentFilterGroupBy) {\n      this.target.currentFilterGroupBy = false;\n    }\n\n    this.errors = this.validateTarget();\n\n    if (!this.errors.filters) {\n      const currentFilter = {\n        type: this.target.currentFilterType,\n        tagk: this.target.currentFilterKey,\n        filter: this.target.currentFilterValue,\n        groupBy: this.target.currentFilterGroupBy,\n      };\n      this.target.filters.push(currentFilter);\n      this.target.currentFilterType = 'literal_or';\n      this.target.currentFilterKey = '';\n      this.target.currentFilterValue = '';\n      this.target.currentFilterGroupBy = false;\n      this.targetBlur();\n    }\n\n    this.addFilterMode = false;\n  }\n\n  removeFilter(index) {\n    this.target.filters.splice(index, 1);\n    this.targetBlur();\n  }\n\n  editFilter(fil, index) {\n    this.removeFilter(index);\n    this.target.currentFilterKey = fil.tagk;\n    this.target.currentFilterValue = fil.filter;\n    this.target.currentFilterType = fil.type;\n    this.target.currentFilterGroupBy = fil.groupBy;\n    this.addFilter();\n  }\n\n  closeAddFilterMode() {\n    this.addFilterMode = false;\n    return;\n  }\n\n  validateTarget() {\n    const errs: any = {};\n\n    if (this.target.shouldDownsample) {\n      try {\n        if (this.target.downsampleInterval) {\n          kbn.describe_interval(this.target.downsampleInterval);\n        } else {\n          errs.downsampleInterval = \"You must supply a downsample interval (e.g. '1m' or '1h').\";\n        }\n      } catch (err) {\n        errs.downsampleInterval = err.message;\n      }\n    }\n\n    if (this.target.tags && _.has(this.target.tags, this.target.currentTagKey)) {\n      errs.tags = \"Duplicate tag key '\" + this.target.currentTagKey + \"'.\";\n    }\n\n    return errs;\n  }\n}\n","export class OpenTsConfigCtrl {\n  static templateUrl = 'public/app/plugins/datasource/opentsdb/partials/config.html';\n  current: any;\n\n  /** @ngInject */\n  constructor($scope) {\n    this.current.jsonData = this.current.jsonData || {};\n    this.current.jsonData.tsdbVersion = this.current.jsonData.tsdbVersion || 1;\n    this.current.jsonData.tsdbResolution = this.current.jsonData.tsdbResolution || 1;\n  }\n\n  tsdbVersions = [{ name: '<=2.1', value: 1 }, { name: '==2.2', value: 2 }, { name: '==2.3', value: 3 }];\n\n  tsdbResolutions = [{ name: 'second', value: 1 }, { name: 'millisecond', value: 2 }];\n}\n","import OpenTsDatasource from './datasource';\nimport { OpenTsQueryCtrl } from './query_ctrl';\nimport { OpenTsConfigCtrl } from './config_ctrl';\n\nclass AnnotationsQueryCtrl {\n  static templateUrl = 'partials/annotations.editor.html';\n}\n\nexport {\n  OpenTsDatasource as Datasource,\n  OpenTsQueryCtrl as QueryCtrl,\n  OpenTsConfigCtrl as ConfigCtrl,\n  AnnotationsQueryCtrl,\n};\n","import _ from 'lodash';\n\nclass GrafanaDatasource {\n  /** @ngInject */\n  constructor(private backendSrv, private $q, private templateSrv) {}\n\n  query(options) {\n    return this.backendSrv\n      .get('/api/tsdb/testdata/random-walk', {\n        from: options.range.from.valueOf(),\n        to: options.range.to.valueOf(),\n        intervalMs: options.intervalMs,\n        maxDataPoints: options.maxDataPoints,\n      })\n      .then(res => {\n        const data = [];\n\n        if (res.results) {\n          _.forEach(res.results, queryRes => {\n            for (const series of queryRes.series) {\n              data.push({\n                target: series.name,\n                datapoints: series.points,\n              });\n            }\n          });\n        }\n\n        return { data: data };\n      });\n  }\n\n  metricFindQuery(options) {\n    return this.$q.when({ data: [] });\n  }\n\n  annotationQuery(options) {\n    const params: any = {\n      from: options.range.from.valueOf(),\n      to: options.range.to.valueOf(),\n      limit: options.annotation.limit,\n      tags: options.annotation.tags,\n      matchAny: options.annotation.matchAny,\n    };\n\n    if (options.annotation.type === 'dashboard') {\n      // if no dashboard id yet return\n      if (!options.dashboard.id) {\n        return this.$q.when([]);\n      }\n      // filter by dashboard id\n      params.dashboardId = options.dashboard.id;\n      // remove tags filter if any\n      delete params.tags;\n    } else {\n      // require at least one tag\n      if (!_.isArray(options.annotation.tags) || options.annotation.tags.length === 0) {\n        return this.$q.when([]);\n      }\n      const tags = [];\n      for (const t of params.tags) {\n        const renderedValues = this.templateSrv.replace(t, {}, 'pipe');\n        for (const tt of renderedValues.split('|')) {\n          tags.push(tt);\n        }\n      }\n      params.tags = tags;\n    }\n\n    return this.backendSrv.get('/api/annotations', params);\n  }\n}\n\nexport { GrafanaDatasource };\n","import { GrafanaDatasource } from './datasource';\nimport { QueryCtrl } from 'app/plugins/sdk';\n\nclass GrafanaQueryCtrl extends QueryCtrl {\n  static templateUrl = 'partials/query.editor.html';\n}\n\nclass GrafanaAnnotationsQueryCtrl {\n  annotation: any;\n\n  types = [{ text: 'Dashboard', value: 'dashboard' }, { text: 'Tags', value: 'tags' }];\n\n  constructor() {\n    this.annotation.type = this.annotation.type || 'tags';\n    this.annotation.limit = this.annotation.limit || 100;\n  }\n\n  static templateUrl = 'partials/annotations.editor.html';\n}\n\nexport {\n  GrafanaDatasource,\n  GrafanaDatasource as Datasource,\n  GrafanaQueryCtrl as QueryCtrl,\n  GrafanaAnnotationsQueryCtrl as AnnotationsQueryCtrl,\n};\n","import _ from 'lodash';\nimport TableModel from 'app/core/table_model';\n\nexport default class InfluxSeries {\n  series: any;\n  alias: any;\n  annotation: any;\n\n  constructor(options) {\n    this.series = options.series;\n    this.alias = options.alias;\n    this.annotation = options.annotation;\n  }\n\n  getTimeSeries() {\n    const output = [];\n    let i, j;\n\n    if (this.series.length === 0) {\n      return output;\n    }\n\n    _.each(this.series, series => {\n      const columns = series.columns.length;\n      const tags = _.map(series.tags, (value, key) => {\n        return key + ': ' + value;\n      });\n\n      for (j = 1; j < columns; j++) {\n        let seriesName = series.name;\n        const columnName = series.columns[j];\n        if (columnName !== 'value') {\n          seriesName = seriesName + '.' + columnName;\n        }\n\n        if (this.alias) {\n          seriesName = this._getSeriesName(series, j);\n        } else if (series.tags) {\n          seriesName = seriesName + ' {' + tags.join(', ') + '}';\n        }\n\n        const datapoints = [];\n        if (series.values) {\n          for (i = 0; i < series.values.length; i++) {\n            datapoints[i] = [series.values[i][j], series.values[i][0]];\n          }\n        }\n\n        output.push({ target: seriesName, datapoints: datapoints });\n      }\n    });\n\n    return output;\n  }\n\n  _getSeriesName(series, index) {\n    const regex = /\\$(\\w+)|\\[\\[([\\s\\S]+?)\\]\\]/g;\n    const segments = series.name.split('.');\n\n    return this.alias.replace(regex, (match, g1, g2) => {\n      const group = g1 || g2;\n      const segIndex = parseInt(group, 10);\n\n      if (group === 'm' || group === 'measurement') {\n        return series.name;\n      }\n      if (group === 'col') {\n        return series.columns[index];\n      }\n      if (!isNaN(segIndex)) {\n        return segments[segIndex];\n      }\n      if (group.indexOf('tag_') !== 0) {\n        return match;\n      }\n\n      const tag = group.replace('tag_', '');\n      if (!series.tags) {\n        return match;\n      }\n      return series.tags[tag];\n    });\n  }\n\n  getAnnotations() {\n    const list = [];\n\n    _.each(this.series, series => {\n      let titleCol = null;\n      let timeCol = null;\n      const tagsCol = [];\n      let textCol = null;\n\n      _.each(series.columns, (column, index) => {\n        if (column === 'time') {\n          timeCol = index;\n          return;\n        }\n        if (column === 'sequence_number') {\n          return;\n        }\n        if (column === this.annotation.titleColumn) {\n          titleCol = index;\n          return;\n        }\n        if (_.includes((this.annotation.tagsColumn || '').replace(' ', '').split(','), column)) {\n          tagsCol.push(index);\n          return;\n        }\n        if (column === this.annotation.textColumn) {\n          textCol = index;\n          return;\n        }\n        // legacy case\n        if (!titleCol && textCol !== index) {\n          titleCol = index;\n        }\n      });\n\n      _.each(series.values, value => {\n        const data = {\n          annotation: this.annotation,\n          time: +new Date(value[timeCol]),\n          title: value[titleCol],\n          // Remove empty values, then split in different tags for comma separated values\n          tags: _.flatten(\n            tagsCol\n              .filter(t => {\n                return value[t];\n              })\n              .map(t => {\n                return value[t].split(',');\n              })\n          ),\n          text: value[textCol],\n        };\n\n        list.push(data);\n      });\n    });\n\n    return list;\n  }\n\n  getTable() {\n    const table = new TableModel();\n    let i, j;\n\n    if (this.series.length === 0) {\n      return table;\n    }\n\n    _.each(this.series, (series, seriesIndex) => {\n      if (seriesIndex === 0) {\n        j = 0;\n        // Check that the first column is indeed 'time'\n        if (series.columns[0] === 'time') {\n          // Push this now before the tags and with the right type\n          table.columns.push({ text: 'Time', type: 'time' });\n          j++;\n        }\n        _.each(_.keys(series.tags), key => {\n          table.columns.push({ text: key });\n        });\n        for (; j < series.columns.length; j++) {\n          table.columns.push({ text: series.columns[j] });\n        }\n      }\n\n      if (series.values) {\n        for (i = 0; i < series.values.length; i++) {\n          const values = series.values[i];\n          const reordered = [values[0]];\n          if (series.tags) {\n            for (const key in series.tags) {\n              if (series.tags.hasOwnProperty(key)) {\n                reordered.push(series.tags[key]);\n              }\n            }\n          }\n          for (j = 1; j < values.length; j++) {\n            reordered.push(values[j]);\n          }\n          table.rows.push(reordered);\n        }\n      }\n    });\n\n    return table;\n  }\n}\n","import _ from 'lodash';\nimport { QueryPartDef, QueryPart, functionRenderer, suffixRenderer } from 'app/core/components/query_part/query_part';\n\nconst index = [];\nconst categories = {\n  Aggregations: [],\n  Selectors: [],\n  Transformations: [],\n  Predictors: [],\n  Math: [],\n  Aliasing: [],\n  Fields: [],\n};\n\nfunction createPart(part): any {\n  const def = index[part.type];\n  if (!def) {\n    throw { message: 'Could not find query part ' + part.type };\n  }\n\n  return new QueryPart(part, def);\n}\n\nfunction register(options: any) {\n  index[options.type] = new QueryPartDef(options);\n  options.category.push(index[options.type]);\n}\n\nconst groupByTimeFunctions = [];\n\nfunction aliasRenderer(part, innerExpr) {\n  return innerExpr + ' AS ' + '\"' + part.params[0] + '\"';\n}\n\nfunction fieldRenderer(part, innerExpr) {\n  if (part.params[0] === '*') {\n    return '*';\n  }\n  return '\"' + part.params[0] + '\"';\n}\n\nfunction replaceAggregationAddStrategy(selectParts, partModel) {\n  // look for existing aggregation\n  for (let i = 0; i < selectParts.length; i++) {\n    const part = selectParts[i];\n    if (part.def.category === categories.Aggregations) {\n      if (part.def.type === partModel.def.type) {\n        return;\n      }\n      // count distinct is allowed\n      if (part.def.type === 'count' && partModel.def.type === 'distinct') {\n        break;\n      }\n      // remove next aggregation if distinct was replaced\n      if (part.def.type === 'distinct') {\n        const morePartsAvailable = selectParts.length >= i + 2;\n        if (partModel.def.type !== 'count' && morePartsAvailable) {\n          const nextPart = selectParts[i + 1];\n          if (nextPart.def.category === categories.Aggregations) {\n            selectParts.splice(i + 1, 1);\n          }\n        } else if (partModel.def.type === 'count') {\n          if (!morePartsAvailable || selectParts[i + 1].def.type !== 'count') {\n            selectParts.splice(i + 1, 0, partModel);\n          }\n          return;\n        }\n      }\n      selectParts[i] = partModel;\n      return;\n    }\n    if (part.def.category === categories.Selectors) {\n      selectParts[i] = partModel;\n      return;\n    }\n  }\n\n  selectParts.splice(1, 0, partModel);\n}\n\nfunction addTransformationStrategy(selectParts, partModel) {\n  let i;\n  // look for index to add transformation\n  for (i = 0; i < selectParts.length; i++) {\n    const part = selectParts[i];\n    if (part.def.category === categories.Math || part.def.category === categories.Aliasing) {\n      break;\n    }\n  }\n\n  selectParts.splice(i, 0, partModel);\n}\n\nfunction addMathStrategy(selectParts, partModel) {\n  const partCount = selectParts.length;\n  if (partCount > 0) {\n    // if last is math, replace it\n    if (selectParts[partCount - 1].def.type === 'math') {\n      selectParts[partCount - 1] = partModel;\n      return;\n    }\n    // if next to last is math, replace it\n    if (partCount > 1 && selectParts[partCount - 2].def.type === 'math') {\n      selectParts[partCount - 2] = partModel;\n      return;\n    } else if (selectParts[partCount - 1].def.type === 'alias') {\n      // if last is alias add it before\n      selectParts.splice(partCount - 1, 0, partModel);\n      return;\n    }\n  }\n  selectParts.push(partModel);\n}\n\nfunction addAliasStrategy(selectParts, partModel) {\n  const partCount = selectParts.length;\n  if (partCount > 0) {\n    // if last is alias, replace it\n    if (selectParts[partCount - 1].def.type === 'alias') {\n      selectParts[partCount - 1] = partModel;\n      return;\n    }\n  }\n  selectParts.push(partModel);\n}\n\nfunction addFieldStrategy(selectParts, partModel, query) {\n  // copy all parts\n  const parts = _.map(selectParts, (part: any) => {\n    return createPart({ type: part.def.type, params: _.clone(part.params) });\n  });\n\n  query.selectModels.push(parts);\n}\n\nregister({\n  type: 'field',\n  addStrategy: addFieldStrategy,\n  category: categories.Fields,\n  params: [{ type: 'field', dynamicLookup: true }],\n  defaultParams: ['value'],\n  renderer: fieldRenderer,\n});\n\n// Aggregations\nregister({\n  type: 'count',\n  addStrategy: replaceAggregationAddStrategy,\n  category: categories.Aggregations,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'distinct',\n  addStrategy: replaceAggregationAddStrategy,\n  category: categories.Aggregations,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'integral',\n  addStrategy: replaceAggregationAddStrategy,\n  category: categories.Aggregations,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'mean',\n  addStrategy: replaceAggregationAddStrategy,\n  category: categories.Aggregations,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'median',\n  addStrategy: replaceAggregationAddStrategy,\n  category: categories.Aggregations,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'mode',\n  addStrategy: replaceAggregationAddStrategy,\n  category: categories.Aggregations,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'sum',\n  addStrategy: replaceAggregationAddStrategy,\n  category: categories.Aggregations,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n\n// transformations\n\nregister({\n  type: 'derivative',\n  addStrategy: addTransformationStrategy,\n  category: categories.Transformations,\n  params: [\n    {\n      name: 'duration',\n      type: 'interval',\n      options: ['1s', '10s', '1m', '5m', '10m', '15m', '1h'],\n    },\n  ],\n  defaultParams: ['10s'],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'spread',\n  addStrategy: addTransformationStrategy,\n  category: categories.Transformations,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'non_negative_derivative',\n  addStrategy: addTransformationStrategy,\n  category: categories.Transformations,\n  params: [\n    {\n      name: 'duration',\n      type: 'interval',\n      options: ['1s', '10s', '1m', '5m', '10m', '15m', '1h'],\n    },\n  ],\n  defaultParams: ['10s'],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'difference',\n  addStrategy: addTransformationStrategy,\n  category: categories.Transformations,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'non_negative_difference',\n  addStrategy: addTransformationStrategy,\n  category: categories.Transformations,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'moving_average',\n  addStrategy: addTransformationStrategy,\n  category: categories.Transformations,\n  params: [{ name: 'window', type: 'int', options: [5, 10, 20, 30, 40] }],\n  defaultParams: [10],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'cumulative_sum',\n  addStrategy: addTransformationStrategy,\n  category: categories.Transformations,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'stddev',\n  addStrategy: addTransformationStrategy,\n  category: categories.Transformations,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'time',\n  category: groupByTimeFunctions,\n  params: [\n    {\n      name: 'interval',\n      type: 'time',\n      options: ['$__interval', '1s', '10s', '1m', '5m', '10m', '15m', '1h'],\n    },\n  ],\n  defaultParams: ['$__interval'],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'fill',\n  category: groupByTimeFunctions,\n  params: [\n    {\n      name: 'fill',\n      type: 'string',\n      options: ['none', 'null', '0', 'previous', 'linear'],\n    },\n  ],\n  defaultParams: ['null'],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'elapsed',\n  addStrategy: addTransformationStrategy,\n  category: categories.Transformations,\n  params: [\n    {\n      name: 'duration',\n      type: 'interval',\n      options: ['1s', '10s', '1m', '5m', '10m', '15m', '1h'],\n    },\n  ],\n  defaultParams: ['10s'],\n  renderer: functionRenderer,\n});\n\n// predictions\nregister({\n  type: 'holt_winters',\n  addStrategy: addTransformationStrategy,\n  category: categories.Predictors,\n  params: [\n    { name: 'number', type: 'int', options: [5, 10, 20, 30, 40] },\n    { name: 'season', type: 'int', options: [0, 1, 2, 5, 10] },\n  ],\n  defaultParams: [10, 2],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'holt_winters_with_fit',\n  addStrategy: addTransformationStrategy,\n  category: categories.Predictors,\n  params: [\n    { name: 'number', type: 'int', options: [5, 10, 20, 30, 40] },\n    { name: 'season', type: 'int', options: [0, 1, 2, 5, 10] },\n  ],\n  defaultParams: [10, 2],\n  renderer: functionRenderer,\n});\n\n// Selectors\nregister({\n  type: 'bottom',\n  addStrategy: replaceAggregationAddStrategy,\n  category: categories.Selectors,\n  params: [{ name: 'count', type: 'int' }],\n  defaultParams: [3],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'first',\n  addStrategy: replaceAggregationAddStrategy,\n  category: categories.Selectors,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'last',\n  addStrategy: replaceAggregationAddStrategy,\n  category: categories.Selectors,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'max',\n  addStrategy: replaceAggregationAddStrategy,\n  category: categories.Selectors,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'min',\n  addStrategy: replaceAggregationAddStrategy,\n  category: categories.Selectors,\n  params: [],\n  defaultParams: [],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'percentile',\n  addStrategy: replaceAggregationAddStrategy,\n  category: categories.Selectors,\n  params: [{ name: 'nth', type: 'int' }],\n  defaultParams: [95],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'top',\n  addStrategy: replaceAggregationAddStrategy,\n  category: categories.Selectors,\n  params: [{ name: 'count', type: 'int' }],\n  defaultParams: [3],\n  renderer: functionRenderer,\n});\n\nregister({\n  type: 'tag',\n  category: groupByTimeFunctions,\n  params: [{ name: 'tag', type: 'string', dynamicLookup: true }],\n  defaultParams: ['tag'],\n  renderer: fieldRenderer,\n});\n\nregister({\n  type: 'math',\n  addStrategy: addMathStrategy,\n  category: categories.Math,\n  params: [{ name: 'expr', type: 'string' }],\n  defaultParams: [' / 100'],\n  renderer: suffixRenderer,\n});\n\nregister({\n  type: 'alias',\n  addStrategy: addAliasStrategy,\n  category: categories.Aliasing,\n  params: [{ name: 'name', type: 'string', quote: 'double' }],\n  defaultParams: ['alias'],\n  renderMode: 'suffix',\n  renderer: aliasRenderer,\n});\n\nexport default {\n  create: createPart,\n  getCategories: () => {\n    return categories;\n  },\n  replaceAggregationAdd: replaceAggregationAddStrategy,\n};\n","import _ from 'lodash';\nimport queryPart from './query_part';\nimport kbn from 'app/core/utils/kbn';\n\nexport default class InfluxQuery {\n  target: any;\n  selectModels: any[];\n  queryBuilder: any;\n  groupByParts: any;\n  templateSrv: any;\n  scopedVars: any;\n\n  /** @ngInject */\n  constructor(target, templateSrv?, scopedVars?) {\n    this.target = target;\n    this.templateSrv = templateSrv;\n    this.scopedVars = scopedVars;\n\n    target.policy = target.policy || 'default';\n    target.resultFormat = target.resultFormat || 'time_series';\n    target.orderByTime = target.orderByTime || 'ASC';\n    target.tags = target.tags || [];\n    target.groupBy = target.groupBy || [{ type: 'time', params: ['$__interval'] }, { type: 'fill', params: ['null'] }];\n    target.select = target.select || [[{ type: 'field', params: ['value'] }, { type: 'mean', params: [] }]];\n\n    this.updateProjection();\n  }\n\n  updateProjection() {\n    this.selectModels = _.map(this.target.select, (parts: any) => {\n      return _.map(parts, queryPart.create);\n    });\n    this.groupByParts = _.map(this.target.groupBy, queryPart.create);\n  }\n\n  updatePersistedParts() {\n    this.target.select = _.map(this.selectModels, selectParts => {\n      return _.map(selectParts, (part: any) => {\n        return { type: part.def.type, params: part.params };\n      });\n    });\n  }\n\n  hasGroupByTime() {\n    return _.find(this.target.groupBy, (g: any) => g.type === 'time');\n  }\n\n  hasFill() {\n    return _.find(this.target.groupBy, (g: any) => g.type === 'fill');\n  }\n\n  addGroupBy(value) {\n    const stringParts = value.match(/^(\\w+)\\((.*)\\)$/);\n    const typePart = stringParts[1];\n    const arg = stringParts[2];\n    const partModel = queryPart.create({ type: typePart, params: [arg] });\n    const partCount = this.target.groupBy.length;\n\n    if (partCount === 0) {\n      this.target.groupBy.push(partModel.part);\n    } else if (typePart === 'time') {\n      this.target.groupBy.splice(0, 0, partModel.part);\n    } else if (typePart === 'tag') {\n      if (this.target.groupBy[partCount - 1].type === 'fill') {\n        this.target.groupBy.splice(partCount - 1, 0, partModel.part);\n      } else {\n        this.target.groupBy.push(partModel.part);\n      }\n    } else {\n      this.target.groupBy.push(partModel.part);\n    }\n\n    this.updateProjection();\n  }\n\n  removeGroupByPart(part, index) {\n    const categories = queryPart.getCategories();\n\n    if (part.def.type === 'time') {\n      // remove fill\n      this.target.groupBy = _.filter(this.target.groupBy, (g: any) => g.type !== 'fill');\n      // remove aggregations\n      this.target.select = _.map(this.target.select, (s: any) => {\n        return _.filter(s, (part: any) => {\n          const partModel = queryPart.create(part);\n          if (partModel.def.category === categories.Aggregations) {\n            return false;\n          }\n          if (partModel.def.category === categories.Selectors) {\n            return false;\n          }\n          return true;\n        });\n      });\n    }\n\n    this.target.groupBy.splice(index, 1);\n    this.updateProjection();\n  }\n\n  removeSelect(index: number) {\n    this.target.select.splice(index, 1);\n    this.updateProjection();\n  }\n\n  removeSelectPart(selectParts, part) {\n    // if we remove the field remove the whole statement\n    if (part.def.type === 'field') {\n      if (this.selectModels.length > 1) {\n        const modelsIndex = _.indexOf(this.selectModels, selectParts);\n        this.selectModels.splice(modelsIndex, 1);\n      }\n    } else {\n      const partIndex = _.indexOf(selectParts, part);\n      selectParts.splice(partIndex, 1);\n    }\n\n    this.updatePersistedParts();\n  }\n\n  addSelectPart(selectParts, type) {\n    const partModel = queryPart.create({ type: type });\n    partModel.def.addStrategy(selectParts, partModel, this);\n    this.updatePersistedParts();\n  }\n\n  private renderTagCondition(tag, index, interpolate) {\n    let str = '';\n    let operator = tag.operator;\n    let value = tag.value;\n    if (index > 0) {\n      str = (tag.condition || 'AND') + ' ';\n    }\n\n    if (!operator) {\n      if (/^\\/.*\\/$/.test(value)) {\n        operator = '=~';\n      } else {\n        operator = '=';\n      }\n    }\n\n    // quote value unless regex\n    if (operator !== '=~' && operator !== '!~') {\n      if (interpolate) {\n        value = this.templateSrv.replace(value, this.scopedVars);\n      }\n      if (operator !== '>' && operator !== '<') {\n        value = \"'\" + value.replace(/\\\\/g, '\\\\\\\\') + \"'\";\n      }\n    } else if (interpolate) {\n      value = this.templateSrv.replace(value, this.scopedVars, 'regex');\n    }\n\n    return str + '\"' + tag.key + '\" ' + operator + ' ' + value;\n  }\n\n  getMeasurementAndPolicy(interpolate) {\n    let policy = this.target.policy;\n    let measurement = this.target.measurement || 'measurement';\n\n    if (!measurement.match('^/.*/$')) {\n      measurement = '\"' + measurement + '\"';\n    } else if (interpolate) {\n      measurement = this.templateSrv.replace(measurement, this.scopedVars, 'regex');\n    }\n\n    if (policy !== 'default') {\n      policy = '\"' + this.target.policy + '\".';\n    } else {\n      policy = '';\n    }\n\n    return policy + measurement;\n  }\n\n  interpolateQueryStr(value, variable, defaultFormatFn) {\n    // if no multi or include all do not regexEscape\n    if (!variable.multi && !variable.includeAll) {\n      return value;\n    }\n\n    if (typeof value === 'string') {\n      return kbn.regexEscape(value);\n    }\n\n    const escapedValues = _.map(value, kbn.regexEscape);\n    return '(' + escapedValues.join('|') + ')';\n  }\n\n  render(interpolate?) {\n    const target = this.target;\n\n    if (target.rawQuery) {\n      if (interpolate) {\n        return this.templateSrv.replace(target.query, this.scopedVars, this.interpolateQueryStr);\n      } else {\n        return target.query;\n      }\n    }\n\n    let query = 'SELECT ';\n    let i, y;\n    for (i = 0; i < this.selectModels.length; i++) {\n      const parts = this.selectModels[i];\n      let selectText = '';\n      for (y = 0; y < parts.length; y++) {\n        const part = parts[y];\n        selectText = part.render(selectText);\n      }\n\n      if (i > 0) {\n        query += ', ';\n      }\n      query += selectText;\n    }\n\n    query += ' FROM ' + this.getMeasurementAndPolicy(interpolate) + ' WHERE ';\n    const conditions = _.map(target.tags, (tag, index) => {\n      return this.renderTagCondition(tag, index, interpolate);\n    });\n\n    if (conditions.length > 0) {\n      query += '(' + conditions.join(' ') + ') AND ';\n    }\n\n    query += '$timeFilter';\n\n    let groupBySection = '';\n    for (i = 0; i < this.groupByParts.length; i++) {\n      const part = this.groupByParts[i];\n      if (i > 0) {\n        // for some reason fill has no separator\n        groupBySection += part.def.type === 'fill' ? ' ' : ', ';\n      }\n      groupBySection += part.render('');\n    }\n\n    if (groupBySection.length) {\n      query += ' GROUP BY ' + groupBySection;\n    }\n\n    if (target.fill) {\n      query += ' fill(' + target.fill + ')';\n    }\n\n    if (target.orderByTime === 'DESC') {\n      query += ' ORDER BY time DESC';\n    }\n\n    if (target.limit) {\n      query += ' LIMIT ' + target.limit;\n    }\n\n    if (target.slimit) {\n      query += ' SLIMIT ' + target.slimit;\n    }\n\n    return query;\n  }\n\n  renderAdhocFilters(filters) {\n    const conditions = _.map(filters, (tag, index) => {\n      return this.renderTagCondition(tag, index, false);\n    });\n    return conditions.join(' ');\n  }\n}\n","import _ from 'lodash';\n\nexport default class ResponseParser {\n  parse(query, results) {\n    if (!results || results.results.length === 0) {\n      return [];\n    }\n\n    const influxResults = results.results[0];\n    if (!influxResults.series) {\n      return [];\n    }\n\n    const normalizedQuery = query.toLowerCase();\n    const isValueFirst =\n      normalizedQuery.indexOf('show field keys') >= 0 || normalizedQuery.indexOf('show retention policies') >= 0;\n\n    const res = {};\n    _.each(influxResults.series, serie => {\n      _.each(serie.values, value => {\n        if (_.isArray(value)) {\n          // In general, there are 2 possible shapes for the returned value.\n          // The first one is a two-element array,\n          // where the first element is somewhat a metadata value:\n          // the tag name for SHOW TAG VALUES queries,\n          // the time field for SELECT queries, etc.\n          // The second shape is an one-element array,\n          // that is containing an immediate value.\n          // For example, SHOW FIELD KEYS queries return such shape.\n          // Note, pre-0.11 versions return\n          // the second shape for SHOW TAG VALUES queries\n          // (while the newer versions—first).\n\n          if (isValueFirst) {\n            addUnique(res, value[0]);\n          } else if (value[1] !== undefined) {\n            addUnique(res, value[1]);\n          } else {\n            addUnique(res, value[0]);\n          }\n        } else {\n          addUnique(res, value);\n        }\n      });\n    });\n\n    return _.map(res, value => {\n      return { text: value.toString() };\n    });\n  }\n}\n\nfunction addUnique(arr, value) {\n  arr[value] = value;\n}\n","import _ from 'lodash';\n\nfunction renderTagCondition(tag, index) {\n  let str = '';\n  let operator = tag.operator;\n  let value = tag.value;\n  if (index > 0) {\n    str = (tag.condition || 'AND') + ' ';\n  }\n\n  if (!operator) {\n    if (/^\\/.*\\/$/.test(tag.value)) {\n      operator = '=~';\n    } else {\n      operator = '=';\n    }\n  }\n\n  // quote value unless regex or number\n  if (operator !== '=~' && operator !== '!~' && isNaN(+value)) {\n    value = \"'\" + value + \"'\";\n  }\n\n  return str + '\"' + tag.key + '\" ' + operator + ' ' + value;\n}\n\nexport class InfluxQueryBuilder {\n  constructor(private target, private database?) {}\n\n  buildExploreQuery(type: string, withKey?: string, withMeasurementFilter?: string) {\n    let query;\n    let measurement;\n    let policy;\n\n    if (type === 'TAG_KEYS') {\n      query = 'SHOW TAG KEYS';\n      measurement = this.target.measurement;\n      policy = this.target.policy;\n    } else if (type === 'TAG_VALUES') {\n      query = 'SHOW TAG VALUES';\n      measurement = this.target.measurement;\n      policy = this.target.policy;\n    } else if (type === 'MEASUREMENTS') {\n      query = 'SHOW MEASUREMENTS';\n      if (withMeasurementFilter) {\n        query += ' WITH MEASUREMENT =~ /' + withMeasurementFilter + '/';\n      }\n    } else if (type === 'FIELDS') {\n      measurement = this.target.measurement;\n      policy = this.target.policy;\n\n      if (!measurement.match('^/.*/')) {\n        measurement = '\"' + measurement + '\"';\n\n        if (policy && policy !== 'default') {\n          policy = '\"' + policy + '\"';\n          measurement = policy + '.' + measurement;\n        }\n      }\n\n      return 'SHOW FIELD KEYS FROM ' + measurement;\n    } else if (type === 'RETENTION POLICIES') {\n      query = 'SHOW RETENTION POLICIES on \"' + this.database + '\"';\n      return query;\n    }\n\n    if (measurement) {\n      if (!measurement.match('^/.*/') && !measurement.match(/^merge\\(.*\\)/)) {\n        measurement = '\"' + measurement + '\"';\n      }\n\n      if (policy && policy !== 'default') {\n        policy = '\"' + policy + '\"';\n        measurement = policy + '.' + measurement;\n      }\n\n      query += ' FROM ' + measurement;\n    }\n\n    if (withKey) {\n      query += ' WITH KEY = \"' + withKey + '\"';\n    }\n\n    if (this.target.tags && this.target.tags.length > 0) {\n      const whereConditions = _.reduce(\n        this.target.tags,\n        (memo, tag) => {\n          // do not add a condition for the key we want to explore for\n          if (tag.key === withKey) {\n            return memo;\n          }\n          memo.push(renderTagCondition(tag, memo.length));\n          return memo;\n        },\n        []\n      );\n\n      if (whereConditions.length > 0) {\n        query += ' WHERE ' + whereConditions.join(' ');\n      }\n    }\n    if (type === 'MEASUREMENTS') {\n      query += ' LIMIT 100';\n      //Solve issue #2524 by limiting the number of measurements returned\n      //LIMIT must be after WITH MEASUREMENT and WHERE clauses\n      //This also could be used for TAG KEYS and TAG VALUES, if desired\n    }\n    return query;\n  }\n}\n","import _ from 'lodash';\n\nimport * as dateMath from 'app/core/utils/datemath';\nimport InfluxSeries from './influx_series';\nimport InfluxQuery from './influx_query';\nimport ResponseParser from './response_parser';\nimport { InfluxQueryBuilder } from './query_builder';\n\nexport default class InfluxDatasource {\n  type: string;\n  urls: any;\n  username: string;\n  password: string;\n  name: string;\n  database: any;\n  basicAuth: any;\n  withCredentials: any;\n  interval: any;\n  responseParser: any;\n\n  /** @ngInject */\n  constructor(instanceSettings, private $q, private backendSrv, private templateSrv) {\n    this.type = 'influxdb';\n    this.urls = _.map(instanceSettings.url.split(','), url => {\n      return url.trim();\n    });\n\n    this.username = instanceSettings.username;\n    this.password = instanceSettings.password;\n    this.name = instanceSettings.name;\n    this.database = instanceSettings.database;\n    this.basicAuth = instanceSettings.basicAuth;\n    this.withCredentials = instanceSettings.withCredentials;\n    this.interval = (instanceSettings.jsonData || {}).timeInterval;\n    this.responseParser = new ResponseParser();\n  }\n\n  query(options) {\n    let timeFilter = this.getTimeFilter(options);\n    const scopedVars = options.scopedVars;\n    const targets = _.cloneDeep(options.targets);\n    const queryTargets = [];\n    let queryModel;\n    let i, y;\n\n    let allQueries = _.map(targets, target => {\n      if (target.hide) {\n        return '';\n      }\n\n      queryTargets.push(target);\n\n      // backward compatibility\n      scopedVars.interval = scopedVars.__interval;\n\n      queryModel = new InfluxQuery(target, this.templateSrv, scopedVars);\n      return queryModel.render(true);\n    }).reduce((acc, current) => {\n      if (current !== '') {\n        acc += ';' + current;\n      }\n      return acc;\n    });\n\n    if (allQueries === '') {\n      return this.$q.when({ data: [] });\n    }\n\n    // add global adhoc filters to timeFilter\n    const adhocFilters = this.templateSrv.getAdhocFilters(this.name);\n    if (adhocFilters.length > 0) {\n      timeFilter += ' AND ' + queryModel.renderAdhocFilters(adhocFilters);\n    }\n\n    // replace grafana variables\n    scopedVars.timeFilter = { value: timeFilter };\n\n    // replace templated variables\n    allQueries = this.templateSrv.replace(allQueries, scopedVars);\n\n    return this._seriesQuery(allQueries, options).then((data): any => {\n      if (!data || !data.results) {\n        return [];\n      }\n\n      const seriesList = [];\n      for (i = 0; i < data.results.length; i++) {\n        const result = data.results[i];\n        if (!result || !result.series) {\n          continue;\n        }\n\n        const target = queryTargets[i];\n        let alias = target.alias;\n        if (alias) {\n          alias = this.templateSrv.replace(target.alias, options.scopedVars);\n        }\n\n        const influxSeries = new InfluxSeries({\n          series: data.results[i].series,\n          alias: alias,\n        });\n\n        switch (target.resultFormat) {\n          case 'table': {\n            seriesList.push(influxSeries.getTable());\n            break;\n          }\n          default: {\n            const timeSeries = influxSeries.getTimeSeries();\n            for (y = 0; y < timeSeries.length; y++) {\n              seriesList.push(timeSeries[y]);\n            }\n            break;\n          }\n        }\n      }\n\n      return { data: seriesList };\n    });\n  }\n\n  annotationQuery(options) {\n    if (!options.annotation.query) {\n      return this.$q.reject({\n        message: 'Query missing in annotation definition',\n      });\n    }\n\n    const timeFilter = this.getTimeFilter({ rangeRaw: options.rangeRaw });\n    let query = options.annotation.query.replace('$timeFilter', timeFilter);\n    query = this.templateSrv.replace(query, null, 'regex');\n\n    return this._seriesQuery(query, options).then(data => {\n      if (!data || !data.results || !data.results[0]) {\n        throw { message: 'No results in response from InfluxDB' };\n      }\n      return new InfluxSeries({\n        series: data.results[0].series,\n        annotation: options.annotation,\n      }).getAnnotations();\n    });\n  }\n\n  targetContainsTemplate(target) {\n    for (const group of target.groupBy) {\n      for (const param of group.params) {\n        if (this.templateSrv.variableExists(param)) {\n          return true;\n        }\n      }\n    }\n\n    for (const i in target.tags) {\n      if (this.templateSrv.variableExists(target.tags[i].value)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  metricFindQuery(query: string, options?: any) {\n    const interpolated = this.templateSrv.replace(query, null, 'regex');\n\n    return this._seriesQuery(interpolated, options).then(_.curry(this.responseParser.parse)(query));\n  }\n\n  getTagKeys(options) {\n    const queryBuilder = new InfluxQueryBuilder({ measurement: '', tags: [] }, this.database);\n    const query = queryBuilder.buildExploreQuery('TAG_KEYS');\n    return this.metricFindQuery(query, options);\n  }\n\n  getTagValues(options) {\n    const queryBuilder = new InfluxQueryBuilder({ measurement: '', tags: [] }, this.database);\n    const query = queryBuilder.buildExploreQuery('TAG_VALUES', options.key);\n    return this.metricFindQuery(query, options);\n  }\n\n  _seriesQuery(query: string, options?: any) {\n    if (!query) {\n      return this.$q.when({ results: [] });\n    }\n\n    if (options && options.range) {\n      const timeFilter = this.getTimeFilter({ rangeRaw: options.range });\n      query = query.replace('$timeFilter', timeFilter);\n    }\n\n    return this._influxRequest('GET', '/query', { q: query, epoch: 'ms' }, options);\n  }\n\n  serializeParams(params) {\n    if (!params) {\n      return '';\n    }\n\n    return _.reduce(\n      params,\n      (memo, value, key) => {\n        if (value === null || value === undefined) {\n          return memo;\n        }\n        memo.push(encodeURIComponent(key) + '=' + encodeURIComponent(value));\n        return memo;\n      },\n      []\n    ).join('&');\n  }\n\n  testDatasource() {\n    const queryBuilder = new InfluxQueryBuilder({ measurement: '', tags: [] }, this.database);\n    const query = queryBuilder.buildExploreQuery('RETENTION POLICIES');\n\n    return this._seriesQuery(query)\n      .then(res => {\n        const error = _.get(res, 'results[0].error');\n        if (error) {\n          return { status: 'error', message: error };\n        }\n        return { status: 'success', message: 'Data source is working' };\n      })\n      .catch(err => {\n        return { status: 'error', message: err.message };\n      });\n  }\n\n  _influxRequest(method: string, url: string, data: any, options?: any) {\n    const currentUrl = this.urls.shift();\n    this.urls.push(currentUrl);\n\n    const params: any = {};\n\n    if (this.username) {\n      params.u = this.username;\n      params.p = this.password;\n    }\n\n    if (options && options.database) {\n      params.db = options.database;\n    } else if (this.database) {\n      params.db = this.database;\n    }\n\n    if (method === 'GET') {\n      _.extend(params, data);\n      data = null;\n    }\n\n    const req: any = {\n      method: method,\n      url: currentUrl + url,\n      params: params,\n      data: data,\n      precision: 'ms',\n      inspect: { type: 'influxdb' },\n      paramSerializer: this.serializeParams,\n    };\n\n    req.headers = req.headers || {};\n    if (this.basicAuth || this.withCredentials) {\n      req.withCredentials = true;\n    }\n    if (this.basicAuth) {\n      req.headers.Authorization = this.basicAuth;\n    }\n\n    return this.backendSrv.datasourceRequest(req).then(\n      result => {\n        return result.data;\n      },\n      err => {\n        if (err.status !== 0 || err.status >= 300) {\n          if (err.data && err.data.error) {\n            throw {\n              message: 'InfluxDB Error: ' + err.data.error,\n              data: err.data,\n              config: err.config,\n            };\n          } else {\n            throw {\n              message: 'Network Error: ' + err.statusText + '(' + err.status + ')',\n              data: err.data,\n              config: err.config,\n            };\n          }\n        }\n      }\n    );\n  }\n\n  getTimeFilter(options) {\n    const from = this.getInfluxTime(options.rangeRaw.from, false);\n    const until = this.getInfluxTime(options.rangeRaw.to, true);\n    const fromIsAbsolute = from[from.length - 1] === 'ms';\n\n    if (until === 'now()' && !fromIsAbsolute) {\n      return 'time >= ' + from;\n    }\n\n    return 'time >= ' + from + ' and time <= ' + until;\n  }\n\n  getInfluxTime(date, roundUp) {\n    if (_.isString(date)) {\n      if (date === 'now') {\n        return 'now()';\n      }\n\n      const parts = /^now-(\\d+)([d|h|m|s])$/.exec(date);\n      if (parts) {\n        const amount = parseInt(parts[1], 10);\n        const unit = parts[2];\n        return 'now() - ' + amount + unit;\n      }\n      date = dateMath.parse(date, roundUp);\n    }\n\n    return date.valueOf() + 'ms';\n  }\n}\n","import angular from 'angular';\nimport _ from 'lodash';\nimport { InfluxQueryBuilder } from './query_builder';\nimport InfluxQuery from './influx_query';\nimport queryPart from './query_part';\nimport { QueryCtrl } from 'app/plugins/sdk';\n\nexport class InfluxQueryCtrl extends QueryCtrl {\n  static templateUrl = 'partials/query.editor.html';\n\n  queryModel: InfluxQuery;\n  queryBuilder: any;\n  groupBySegment: any;\n  resultFormats: any[];\n  orderByTime: any[];\n  policySegment: any;\n  tagSegments: any[];\n  selectMenu: any;\n  measurementSegment: any;\n  removeTagFilterSegment: any;\n\n  /** @ngInject */\n  constructor($scope, $injector, private templateSrv, private $q, private uiSegmentSrv) {\n    super($scope, $injector);\n    this.target = this.target;\n    this.queryModel = new InfluxQuery(this.target, templateSrv, this.panel.scopedVars);\n    this.queryBuilder = new InfluxQueryBuilder(this.target, this.datasource.database);\n    this.groupBySegment = this.uiSegmentSrv.newPlusButton();\n    this.resultFormats = [{ text: 'Time series', value: 'time_series' }, { text: 'Table', value: 'table' }];\n    this.policySegment = uiSegmentSrv.newSegment(this.target.policy);\n\n    if (!this.target.measurement) {\n      this.measurementSegment = uiSegmentSrv.newSelectMeasurement();\n    } else {\n      this.measurementSegment = uiSegmentSrv.newSegment(this.target.measurement);\n    }\n\n    this.tagSegments = [];\n    for (const tag of this.target.tags) {\n      if (!tag.operator) {\n        if (/^\\/.*\\/$/.test(tag.value)) {\n          tag.operator = '=~';\n        } else {\n          tag.operator = '=';\n        }\n      }\n\n      if (tag.condition) {\n        this.tagSegments.push(uiSegmentSrv.newCondition(tag.condition));\n      }\n\n      this.tagSegments.push(uiSegmentSrv.newKey(tag.key));\n      this.tagSegments.push(uiSegmentSrv.newOperator(tag.operator));\n      this.tagSegments.push(uiSegmentSrv.newKeyValue(tag.value));\n    }\n\n    this.fixTagSegments();\n    this.buildSelectMenu();\n    this.removeTagFilterSegment = uiSegmentSrv.newSegment({\n      fake: true,\n      value: '-- remove tag filter --',\n    });\n  }\n\n  removeOrderByTime() {\n    this.target.orderByTime = 'ASC';\n  }\n\n  buildSelectMenu() {\n    const categories = queryPart.getCategories();\n    this.selectMenu = _.reduce(\n      categories,\n      (memo, cat, key) => {\n        const menu = {\n          text: key,\n          submenu: cat.map(item => {\n            return { text: item.type, value: item.type };\n          }),\n        };\n        memo.push(menu);\n        return memo;\n      },\n      []\n    );\n  }\n\n  getGroupByOptions() {\n    const query = this.queryBuilder.buildExploreQuery('TAG_KEYS');\n\n    return this.datasource\n      .metricFindQuery(query)\n      .then(tags => {\n        const options = [];\n        if (!this.queryModel.hasFill()) {\n          options.push(this.uiSegmentSrv.newSegment({ value: 'fill(null)' }));\n        }\n        if (!this.target.limit) {\n          options.push(this.uiSegmentSrv.newSegment({ value: 'LIMIT' }));\n        }\n        if (!this.target.slimit) {\n          options.push(this.uiSegmentSrv.newSegment({ value: 'SLIMIT' }));\n        }\n        if (this.target.orderByTime === 'ASC') {\n          options.push(this.uiSegmentSrv.newSegment({ value: 'ORDER BY time DESC' }));\n        }\n        if (!this.queryModel.hasGroupByTime()) {\n          options.push(this.uiSegmentSrv.newSegment({ value: 'time($interval)' }));\n        }\n        for (const tag of tags) {\n          options.push(this.uiSegmentSrv.newSegment({ value: 'tag(' + tag.text + ')' }));\n        }\n        return options;\n      })\n      .catch(this.handleQueryError.bind(this));\n  }\n\n  groupByAction() {\n    switch (this.groupBySegment.value) {\n      case 'LIMIT': {\n        this.target.limit = 10;\n        break;\n      }\n      case 'SLIMIT': {\n        this.target.slimit = 10;\n        break;\n      }\n      case 'ORDER BY time DESC': {\n        this.target.orderByTime = 'DESC';\n        break;\n      }\n      default: {\n        this.queryModel.addGroupBy(this.groupBySegment.value);\n      }\n    }\n\n    const plusButton = this.uiSegmentSrv.newPlusButton();\n    this.groupBySegment.value = plusButton.value;\n    this.groupBySegment.html = plusButton.html;\n    this.panelCtrl.refresh();\n  }\n\n  addSelectPart(selectParts, cat, subitem) {\n    this.queryModel.addSelectPart(selectParts, subitem.value);\n    this.panelCtrl.refresh();\n  }\n\n  handleSelectPartEvent(selectParts, part, evt) {\n    switch (evt.name) {\n      case 'get-param-options': {\n        const fieldsQuery = this.queryBuilder.buildExploreQuery('FIELDS');\n        return this.datasource\n          .metricFindQuery(fieldsQuery)\n          .then(this.transformToSegments(true))\n          .catch(this.handleQueryError.bind(this));\n      }\n      case 'part-param-changed': {\n        this.panelCtrl.refresh();\n        break;\n      }\n      case 'action': {\n        this.queryModel.removeSelectPart(selectParts, part);\n        this.panelCtrl.refresh();\n        break;\n      }\n      case 'get-part-actions': {\n        return this.$q.when([{ text: 'Remove', value: 'remove-part' }]);\n      }\n    }\n  }\n\n  handleGroupByPartEvent(part, index, evt) {\n    switch (evt.name) {\n      case 'get-param-options': {\n        const tagsQuery = this.queryBuilder.buildExploreQuery('TAG_KEYS');\n        return this.datasource\n          .metricFindQuery(tagsQuery)\n          .then(this.transformToSegments(true))\n          .catch(this.handleQueryError.bind(this));\n      }\n      case 'part-param-changed': {\n        this.panelCtrl.refresh();\n        break;\n      }\n      case 'action': {\n        this.queryModel.removeGroupByPart(part, index);\n        this.panelCtrl.refresh();\n        break;\n      }\n      case 'get-part-actions': {\n        return this.$q.when([{ text: 'Remove', value: 'remove-part' }]);\n      }\n    }\n  }\n\n  fixTagSegments() {\n    const count = this.tagSegments.length;\n    const lastSegment = this.tagSegments[Math.max(count - 1, 0)];\n\n    if (!lastSegment || lastSegment.type !== 'plus-button') {\n      this.tagSegments.push(this.uiSegmentSrv.newPlusButton());\n    }\n  }\n\n  measurementChanged() {\n    this.target.measurement = this.measurementSegment.value;\n    this.panelCtrl.refresh();\n  }\n\n  getPolicySegments() {\n    const policiesQuery = this.queryBuilder.buildExploreQuery('RETENTION POLICIES');\n    return this.datasource\n      .metricFindQuery(policiesQuery)\n      .then(this.transformToSegments(false))\n      .catch(this.handleQueryError.bind(this));\n  }\n\n  policyChanged() {\n    this.target.policy = this.policySegment.value;\n    this.panelCtrl.refresh();\n  }\n\n  toggleEditorMode() {\n    try {\n      this.target.query = this.queryModel.render(false);\n    } catch (err) {\n      console.log('query render error');\n    }\n    this.target.rawQuery = !this.target.rawQuery;\n  }\n\n  getMeasurements(measurementFilter) {\n    const query = this.queryBuilder.buildExploreQuery('MEASUREMENTS', undefined, measurementFilter);\n    return this.datasource\n      .metricFindQuery(query)\n      .then(this.transformToSegments(true))\n      .catch(this.handleQueryError.bind(this));\n  }\n\n  handleQueryError(err) {\n    this.error = err.message || 'Failed to issue metric query';\n    return [];\n  }\n\n  transformToSegments(addTemplateVars) {\n    return results => {\n      const segments = _.map(results, segment => {\n        return this.uiSegmentSrv.newSegment({\n          value: segment.text,\n          expandable: segment.expandable,\n        });\n      });\n\n      if (addTemplateVars) {\n        for (const variable of this.templateSrv.variables) {\n          segments.unshift(\n            this.uiSegmentSrv.newSegment({\n              type: 'value',\n              value: '/^$' + variable.name + '$/',\n              expandable: true,\n            })\n          );\n        }\n      }\n\n      return segments;\n    };\n  }\n\n  getTagsOrValues(segment, index) {\n    if (segment.type === 'condition') {\n      return this.$q.when([this.uiSegmentSrv.newSegment('AND'), this.uiSegmentSrv.newSegment('OR')]);\n    }\n    if (segment.type === 'operator') {\n      const nextValue = this.tagSegments[index + 1].value;\n      if (/^\\/.*\\/$/.test(nextValue)) {\n        return this.$q.when(this.uiSegmentSrv.newOperators(['=~', '!~']));\n      } else {\n        return this.$q.when(this.uiSegmentSrv.newOperators(['=', '!=', '<>', '<', '>']));\n      }\n    }\n\n    let query, addTemplateVars;\n    if (segment.type === 'key' || segment.type === 'plus-button') {\n      query = this.queryBuilder.buildExploreQuery('TAG_KEYS');\n      addTemplateVars = false;\n    } else if (segment.type === 'value') {\n      query = this.queryBuilder.buildExploreQuery('TAG_VALUES', this.tagSegments[index - 2].value);\n      addTemplateVars = true;\n    }\n\n    return this.datasource\n      .metricFindQuery(query)\n      .then(this.transformToSegments(addTemplateVars))\n      .then(results => {\n        if (segment.type === 'key') {\n          results.splice(0, 0, angular.copy(this.removeTagFilterSegment));\n        }\n        return results;\n      })\n      .catch(this.handleQueryError.bind(this));\n  }\n\n  getFieldSegments() {\n    const fieldsQuery = this.queryBuilder.buildExploreQuery('FIELDS');\n    return this.datasource\n      .metricFindQuery(fieldsQuery)\n      .then(this.transformToSegments(false))\n      .catch(this.handleQueryError);\n  }\n\n  tagSegmentUpdated(segment, index) {\n    this.tagSegments[index] = segment;\n\n    // handle remove tag condition\n    if (segment.value === this.removeTagFilterSegment.value) {\n      this.tagSegments.splice(index, 3);\n      if (this.tagSegments.length === 0) {\n        this.tagSegments.push(this.uiSegmentSrv.newPlusButton());\n      } else if (this.tagSegments.length > 2) {\n        this.tagSegments.splice(Math.max(index - 1, 0), 1);\n        if (this.tagSegments[this.tagSegments.length - 1].type !== 'plus-button') {\n          this.tagSegments.push(this.uiSegmentSrv.newPlusButton());\n        }\n      }\n    } else {\n      if (segment.type === 'plus-button') {\n        if (index > 2) {\n          this.tagSegments.splice(index, 0, this.uiSegmentSrv.newCondition('AND'));\n        }\n        this.tagSegments.push(this.uiSegmentSrv.newOperator('='));\n        this.tagSegments.push(this.uiSegmentSrv.newFake('select tag value', 'value', 'query-segment-value'));\n        segment.type = 'key';\n        segment.cssClass = 'query-segment-key';\n      }\n\n      if (index + 1 === this.tagSegments.length) {\n        this.tagSegments.push(this.uiSegmentSrv.newPlusButton());\n      }\n    }\n\n    this.rebuildTargetTagConditions();\n  }\n\n  rebuildTargetTagConditions() {\n    const tags = [];\n    let tagIndex = 0;\n    let tagOperator = '';\n\n    _.each(this.tagSegments, (segment2, index) => {\n      if (segment2.type === 'key') {\n        if (tags.length === 0) {\n          tags.push({});\n        }\n        tags[tagIndex].key = segment2.value;\n      } else if (segment2.type === 'value') {\n        tagOperator = this.getTagValueOperator(segment2.value, tags[tagIndex].operator);\n        if (tagOperator) {\n          this.tagSegments[index - 1] = this.uiSegmentSrv.newOperator(tagOperator);\n          tags[tagIndex].operator = tagOperator;\n        }\n        tags[tagIndex].value = segment2.value;\n      } else if (segment2.type === 'condition') {\n        tags.push({ condition: segment2.value });\n        tagIndex += 1;\n      } else if (segment2.type === 'operator') {\n        tags[tagIndex].operator = segment2.value;\n      }\n    });\n\n    this.target.tags = tags;\n    this.panelCtrl.refresh();\n  }\n\n  getTagValueOperator(tagValue, tagOperator): string {\n    if (tagOperator !== '=~' && tagOperator !== '!~' && /^\\/.*\\/$/.test(tagValue)) {\n      return '=~';\n    } else if ((tagOperator === '=~' || tagOperator === '!~') && /^(?!\\/.*\\/$)/.test(tagValue)) {\n      return '=';\n    }\n    return null;\n  }\n\n  getCollapsedText() {\n    return this.queryModel.render(false);\n  }\n}\n","import _ from 'lodash';\nimport moment from 'moment';\n\nimport { LogLevel, LogsModel, LogRow } from 'app/core/logs_model';\n\nexport function getLogLevel(line: string): LogLevel {\n  if (!line) {\n    return undefined;\n  }\n  let level: LogLevel;\n  Object.keys(LogLevel).forEach(key => {\n    if (!level) {\n      const regexp = new RegExp(`\\\\b${key}\\\\b`, 'i');\n      if (regexp.test(line)) {\n        level = LogLevel[key];\n      }\n    }\n  });\n  return level;\n}\n\nexport function getSearchMatches(line: string, search: string) {\n  // Empty search can send re.exec() into infinite loop, exit early\n  if (!line || !search) {\n    return [];\n  }\n  const regexp = new RegExp(`(?:${search})`, 'g');\n  const matches = [];\n  let match = regexp.exec(line);\n  while (match) {\n    matches.push({\n      text: match[0],\n      start: match.index,\n      length: match[0].length,\n    });\n    match = regexp.exec(line);\n  }\n  return matches;\n}\n\nexport function processEntry(entry: { line: string; timestamp: string }, stream): LogRow {\n  const { line, timestamp } = entry;\n  const { labels } = stream;\n  const key = `EK${timestamp}${labels}`;\n  const time = moment(timestamp);\n  const timeFromNow = time.fromNow();\n  const timeLocal = time.format('YYYY-MM-DD HH:mm:ss');\n  const searchMatches = getSearchMatches(line, stream.search);\n  const logLevel = getLogLevel(line);\n\n  return {\n    key,\n    logLevel,\n    searchMatches,\n    timeFromNow,\n    timeLocal,\n    entry: line,\n    timestamp: timestamp,\n  };\n}\n\nexport function processStreams(streams, limit?: number): LogsModel {\n  const combinedEntries = streams.reduce((acc, stream) => {\n    return [...acc, ...stream.entries.map(entry => processEntry(entry, stream))];\n  }, []);\n  const sortedEntries = _.chain(combinedEntries)\n    .sortBy('timestamp')\n    .reverse()\n    .slice(0, limit || combinedEntries.length)\n    .value();\n  return { rows: sortedEntries };\n}\n","import InfluxDatasource from './datasource';\nimport { InfluxQueryCtrl } from './query_ctrl';\n\nclass InfluxConfigCtrl {\n  static templateUrl = 'partials/config.html';\n}\n\nclass InfluxAnnotationsQueryCtrl {\n  static templateUrl = 'partials/annotations.editor.html';\n}\n\nexport {\n  InfluxDatasource as Datasource,\n  InfluxQueryCtrl as QueryCtrl,\n  InfluxConfigCtrl as ConfigCtrl,\n  InfluxAnnotationsQueryCtrl as AnnotationsQueryCtrl,\n};\n","export enum LogLevel {\n  crit = 'crit',\n  warn = 'warn',\n  err = 'error',\n  error = 'error',\n  info = 'info',\n  debug = 'debug',\n  trace = 'trace',\n}\n\nexport interface LogSearchMatch {\n  start: number;\n  length: number;\n  text?: string;\n}\n\nexport interface LogRow {\n  key: string;\n  entry: string;\n  logLevel: LogLevel;\n  timestamp: string;\n  timeFromNow: string;\n  timeLocal: string;\n  searchMatches?: LogSearchMatch[];\n}\n\nexport interface LogsModel {\n  rows: LogRow[];\n}\n","import _ from 'lodash';\n\nimport * as dateMath from 'app/core/utils/datemath';\n\nimport { processStreams } from './result_transformer';\n\nconst DEFAULT_LIMIT = 100;\n\nconst DEFAULT_QUERY_PARAMS = {\n  direction: 'BACKWARD',\n  limit: DEFAULT_LIMIT,\n  regexp: '',\n  query: '',\n};\n\nconst QUERY_REGEXP = /({\\w+=\"[^\"]+\"})?\\s*(\\w[^{]+)?\\s*({\\w+=\"[^\"]+\"})?/;\nexport function parseQuery(input: string) {\n  const match = input.match(QUERY_REGEXP);\n  let query = '';\n  let regexp = '';\n\n  if (match) {\n    if (match[1]) {\n      query = match[1];\n    }\n    if (match[2]) {\n      regexp = match[2].trim();\n    }\n    if (match[3]) {\n      if (match[1]) {\n        query = `${match[1].slice(0, -1)},${match[3].slice(1)}`;\n      } else {\n        query = match[3];\n      }\n    }\n  }\n\n  return { query, regexp };\n}\n\nfunction serializeParams(data: any) {\n  return Object.keys(data)\n    .map(k => {\n      const v = data[k];\n      return encodeURIComponent(k) + '=' + encodeURIComponent(v);\n    })\n    .join('&');\n}\n\nexport default class LoggingDatasource {\n  /** @ngInject */\n  constructor(private instanceSettings, private backendSrv, private templateSrv) {}\n\n  _request(apiUrl: string, data?, options?: any) {\n    const baseUrl = this.instanceSettings.url;\n    const params = data ? serializeParams(data) : '';\n    const url = `${baseUrl}${apiUrl}?${params}`;\n    const req = {\n      ...options,\n      url,\n    };\n    return this.backendSrv.datasourceRequest(req);\n  }\n\n  prepareQueryTarget(target, options) {\n    const interpolated = this.templateSrv.replace(target.expr);\n    const start = this.getTime(options.range.from, false);\n    const end = this.getTime(options.range.to, true);\n    return {\n      ...DEFAULT_QUERY_PARAMS,\n      ...parseQuery(interpolated),\n      start,\n      end,\n    };\n  }\n\n  query(options) {\n    const queryTargets = options.targets\n      .filter(target => target.expr)\n      .map(target => this.prepareQueryTarget(target, options));\n    if (queryTargets.length === 0) {\n      return Promise.resolve({ data: [] });\n    }\n\n    const queries = queryTargets.map(target => this._request('/api/prom/query', target));\n\n    return Promise.all(queries).then((results: any[]) => {\n      // Flatten streams from multiple queries\n      const allStreams = results.reduce((acc, response, i) => {\n        const streams = response.data.streams || [];\n        // Inject search for match highlighting\n        const search = queryTargets[i].regexp;\n        streams.forEach(s => {\n          s.search = search;\n        });\n        return [...acc, ...streams];\n      }, []);\n      const model = processStreams(allStreams, DEFAULT_LIMIT);\n      return { data: model };\n    });\n  }\n\n  metadataRequest(url) {\n    // HACK to get label values for {job=|}, will be replaced when implementing LoggingQueryField\n    const apiUrl = url.replace('v1', 'prom');\n    return this._request(apiUrl, { silent: true }).then(res => {\n      const data = { data: { data: res.data.values || [] } };\n      return data;\n    });\n  }\n\n  getTime(date, roundUp) {\n    if (_.isString(date)) {\n      date = dateMath.parse(date, roundUp);\n    }\n    return Math.ceil(date.valueOf() * 1e6);\n  }\n\n  testDatasource() {\n    return this._request('/api/prom/label')\n      .then(res => {\n        if (res && res.data && res.data.values && res.data.values.length > 0) {\n          return { status: 'success', message: 'Data source connected and labels found.' };\n        }\n        return {\n          status: 'error',\n          message: 'Data source connected, but no labels received. Verify that logging is configured properly.',\n        };\n      })\n      .catch(err => {\n        return { status: 'error', message: err.message };\n      });\n  }\n}\n","import _ from 'lodash';\n\nexport default class ResponseParser {\n  constructor(private $q) {}\n\n  processQueryResult(res) {\n    const data = [];\n\n    if (!res.data.results) {\n      return { data: data };\n    }\n\n    for (const key in res.data.results) {\n      const queryRes = res.data.results[key];\n\n      if (queryRes.series) {\n        for (const series of queryRes.series) {\n          data.push({\n            target: series.name,\n            datapoints: series.points,\n            refId: queryRes.refId,\n            meta: queryRes.meta,\n          });\n        }\n      }\n\n      if (queryRes.tables) {\n        for (const table of queryRes.tables) {\n          table.type = 'table';\n          table.refId = queryRes.refId;\n          table.meta = queryRes.meta;\n          data.push(table);\n        }\n      }\n    }\n\n    return { data: data };\n  }\n\n  parseMetricFindQueryResult(refId, results) {\n    if (!results || results.data.length === 0 || results.data.results[refId].meta.rowCount === 0) {\n      return [];\n    }\n\n    const columns = results.data.results[refId].tables[0].columns;\n    const rows = results.data.results[refId].tables[0].rows;\n    const textColIndex = this.findColIndex(columns, '__text');\n    const valueColIndex = this.findColIndex(columns, '__value');\n\n    if (columns.length === 2 && textColIndex !== -1 && valueColIndex !== -1) {\n      return this.transformToKeyValueList(rows, textColIndex, valueColIndex);\n    }\n\n    return this.transformToSimpleList(rows);\n  }\n\n  transformToKeyValueList(rows, textColIndex, valueColIndex) {\n    const res = [];\n\n    for (let i = 0; i < rows.length; i++) {\n      if (!this.containsKey(res, rows[i][textColIndex])) {\n        res.push({\n          text: rows[i][textColIndex],\n          value: rows[i][valueColIndex],\n        });\n      }\n    }\n\n    return res;\n  }\n\n  transformToSimpleList(rows) {\n    const res = [];\n\n    for (let i = 0; i < rows.length; i++) {\n      for (let j = 0; j < rows[i].length; j++) {\n        const value = rows[i][j];\n        if (res.indexOf(value) === -1) {\n          res.push(value);\n        }\n      }\n    }\n\n    return _.map(res, value => {\n      return { text: value };\n    });\n  }\n\n  findColIndex(columns, colName) {\n    for (let i = 0; i < columns.length; i++) {\n      if (columns[i].text === colName) {\n        return i;\n      }\n    }\n\n    return -1;\n  }\n\n  containsKey(res, key) {\n    for (let i = 0; i < res.length; i++) {\n      if (res[i].text === key) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  transformAnnotationResponse(options, data) {\n    const table = data.data.results[options.annotation.name].tables[0];\n\n    let timeColumnIndex = -1;\n    let textColumnIndex = -1;\n    let tagsColumnIndex = -1;\n\n    for (let i = 0; i < table.columns.length; i++) {\n      if (table.columns[i].text === 'time_sec' || table.columns[i].text === 'time') {\n        timeColumnIndex = i;\n      } else if (table.columns[i].text === 'title') {\n        return this.$q.reject({\n          message: 'The title column for annotations is deprecated, now only a column named text is returned',\n        });\n      } else if (table.columns[i].text === 'text') {\n        textColumnIndex = i;\n      } else if (table.columns[i].text === 'tags') {\n        tagsColumnIndex = i;\n      }\n    }\n\n    if (timeColumnIndex === -1) {\n      return this.$q.reject({\n        message: 'Missing mandatory time column (with time_sec column alias) in annotation query.',\n      });\n    }\n\n    const list = [];\n    for (let i = 0; i < table.rows.length; i++) {\n      const row = table.rows[i];\n      list.push({\n        annotation: options.annotation,\n        time: Math.floor(row[timeColumnIndex]),\n        text: row[textColumnIndex] ? row[textColumnIndex].toString() : '',\n        tags: row[tagsColumnIndex] ? row[tagsColumnIndex].trim().split(/\\s*,\\s*/) : [],\n      });\n    }\n\n    return list;\n  }\n}\n","import Datasource from './datasource';\n\nexport class LoggingConfigCtrl {\n  static templateUrl = 'partials/config.html';\n}\n\nexport { Datasource, LoggingConfigCtrl as ConfigCtrl };\n","import angular from 'angular';\nimport _ from 'lodash';\n\nclass MixedDatasource {\n  /** @ngInject */\n  constructor(private $q, private datasourceSrv) {}\n\n  query(options) {\n    const sets = _.groupBy(options.targets, 'datasource');\n    const promises = _.map(sets, targets => {\n      const dsName = targets[0].datasource;\n      if (dsName === '-- Mixed --') {\n        return this.$q([]);\n      }\n\n      return this.datasourceSrv.get(dsName).then(ds => {\n        const opt = angular.copy(options);\n        opt.targets = targets;\n        return ds.query(opt);\n      });\n    });\n\n    return this.$q.all(promises).then(results => {\n      return { data: _.flatten(_.map(results, 'data')) };\n    });\n  }\n}\n\nexport { MixedDatasource, MixedDatasource as Datasource };\n","import { MixedDatasource } from './datasource';\nexport { MixedDatasource, MixedDatasource as Datasource };\n","import _ from 'lodash';\nimport ResponseParser from './response_parser';\n\nexport class MysqlDatasource {\n  id: any;\n  name: any;\n  responseParser: ResponseParser;\n  interval: string;\n\n  /** @ngInject */\n  constructor(instanceSettings, private backendSrv, private $q, private templateSrv) {\n    this.name = instanceSettings.name;\n    this.id = instanceSettings.id;\n    this.responseParser = new ResponseParser(this.$q);\n    this.interval = (instanceSettings.jsonData || {}).timeInterval;\n  }\n\n  interpolateVariable(value, variable) {\n    if (typeof value === 'string') {\n      if (variable.multi || variable.includeAll) {\n        return \"'\" + value.replace(/'/g, `''`) + \"'\";\n      } else {\n        return value;\n      }\n    }\n\n    if (typeof value === 'number') {\n      return value;\n    }\n\n    const quotedValues = _.map(value, val => {\n      if (typeof value === 'number') {\n        return value;\n      }\n\n      return \"'\" + val.replace(/'/g, `''`) + \"'\";\n    });\n    return quotedValues.join(',');\n  }\n\n  query(options) {\n    const queries = _.filter(options.targets, item => {\n      return item.hide !== true;\n    }).map(item => {\n      return {\n        refId: item.refId,\n        intervalMs: options.intervalMs,\n        maxDataPoints: options.maxDataPoints,\n        datasourceId: this.id,\n        rawSql: this.templateSrv.replace(item.rawSql, options.scopedVars, this.interpolateVariable),\n        format: item.format,\n      };\n    });\n\n    if (queries.length === 0) {\n      return this.$q.when({ data: [] });\n    }\n\n    return this.backendSrv\n      .datasourceRequest({\n        url: '/api/tsdb/query',\n        method: 'POST',\n        data: {\n          from: options.range.from.valueOf().toString(),\n          to: options.range.to.valueOf().toString(),\n          queries: queries,\n        },\n      })\n      .then(this.responseParser.processQueryResult);\n  }\n\n  annotationQuery(options) {\n    if (!options.annotation.rawQuery) {\n      return this.$q.reject({\n        message: 'Query missing in annotation definition',\n      });\n    }\n\n    const query = {\n      refId: options.annotation.name,\n      datasourceId: this.id,\n      rawSql: this.templateSrv.replace(options.annotation.rawQuery, options.scopedVars, this.interpolateVariable),\n      format: 'table',\n    };\n\n    return this.backendSrv\n      .datasourceRequest({\n        url: '/api/tsdb/query',\n        method: 'POST',\n        data: {\n          from: options.range.from.valueOf().toString(),\n          to: options.range.to.valueOf().toString(),\n          queries: [query],\n        },\n      })\n      .then(data => this.responseParser.transformAnnotationResponse(options, data));\n  }\n\n  metricFindQuery(query, optionalOptions) {\n    let refId = 'tempvar';\n    if (optionalOptions && optionalOptions.variable && optionalOptions.variable.name) {\n      refId = optionalOptions.variable.name;\n    }\n\n    const interpolatedQuery = {\n      refId: refId,\n      datasourceId: this.id,\n      rawSql: this.templateSrv.replace(query, {}, this.interpolateVariable),\n      format: 'table',\n    };\n\n    const data = {\n      queries: [interpolatedQuery],\n    };\n\n    if (optionalOptions && optionalOptions.range && optionalOptions.range.from) {\n      data['from'] = optionalOptions.range.from.valueOf().toString();\n    }\n    if (optionalOptions && optionalOptions.range && optionalOptions.range.to) {\n      data['to'] = optionalOptions.range.to.valueOf().toString();\n    }\n\n    return this.backendSrv\n      .datasourceRequest({\n        url: '/api/tsdb/query',\n        method: 'POST',\n        data: data,\n      })\n      .then(data => this.responseParser.parseMetricFindQueryResult(refId, data));\n  }\n\n  testDatasource() {\n    return this.backendSrv\n      .datasourceRequest({\n        url: '/api/tsdb/query',\n        method: 'POST',\n        data: {\n          from: '5m',\n          to: 'now',\n          queries: [\n            {\n              refId: 'A',\n              intervalMs: 1,\n              maxDataPoints: 1,\n              datasourceId: this.id,\n              rawSql: 'SELECT 1',\n              format: 'table',\n            },\n          ],\n        },\n      })\n      .then(res => {\n        return { status: 'success', message: 'Database Connection OK' };\n      })\n      .catch(err => {\n        console.log(err);\n        if (err.data && err.data.message) {\n          return { status: 'error', message: err.data.message };\n        } else {\n          return { status: 'error', message: err.status };\n        }\n      });\n  }\n}\n","import { MysqlDatasource } from './datasource';\nimport { MysqlQueryCtrl } from './query_ctrl';\n\nclass MysqlConfigCtrl {\n  static templateUrl = 'partials/config.html';\n}\n\nconst defaultQuery = `SELECT\n    UNIX_TIMESTAMP(<time_column>) as time_sec,\n    <text_column> as text,\n    <tags_column> as tags\n  FROM <table name>\n  WHERE $__timeFilter(time_column)\n  ORDER BY <time_column> ASC\n  LIMIT 100\n  `;\n\nclass MysqlAnnotationsQueryCtrl {\n  static templateUrl = 'partials/annotations.editor.html';\n\n  annotation: any;\n\n  /** @ngInject */\n  constructor() {\n    this.annotation.rawQuery = this.annotation.rawQuery || defaultQuery;\n  }\n}\n\nexport {\n  MysqlDatasource,\n  MysqlDatasource as Datasource,\n  MysqlQueryCtrl as QueryCtrl,\n  MysqlConfigCtrl as ConfigCtrl,\n  MysqlAnnotationsQueryCtrl as AnnotationsQueryCtrl,\n};\n","import _ from 'lodash';\nimport { QueryCtrl } from 'app/plugins/sdk';\n\nexport interface MysqlQuery {\n  refId: string;\n  format: string;\n  alias: string;\n  rawSql: string;\n}\n\nexport interface QueryMeta {\n  sql: string;\n}\n\nconst defaultQuery = `SELECT\n  UNIX_TIMESTAMP(<time_column>) as time_sec,\n  <value column> as value,\n  <series name column> as metric\nFROM <table name>\nWHERE $__timeFilter(time_column)\nORDER BY <time_column> ASC\n`;\n\nexport class MysqlQueryCtrl extends QueryCtrl {\n  static templateUrl = 'partials/query.editor.html';\n\n  showLastQuerySQL: boolean;\n  formats: any[];\n  target: MysqlQuery;\n  lastQueryMeta: QueryMeta;\n  lastQueryError: string;\n  showHelp: boolean;\n\n  /** @ngInject */\n  constructor($scope, $injector) {\n    super($scope, $injector);\n\n    this.target.format = this.target.format || 'time_series';\n    this.target.alias = '';\n    this.formats = [{ text: 'Time series', value: 'time_series' }, { text: 'Table', value: 'table' }];\n\n    if (!this.target.rawSql) {\n      // special handling when in table panel\n      if (this.panelCtrl.panel.type === 'table') {\n        this.target.format = 'table';\n        this.target.rawSql = 'SELECT 1';\n      } else {\n        this.target.rawSql = defaultQuery;\n      }\n    }\n\n    this.panelCtrl.events.on('data-received', this.onDataReceived.bind(this), $scope);\n    this.panelCtrl.events.on('data-error', this.onDataError.bind(this), $scope);\n  }\n\n  onDataReceived(dataList) {\n    this.lastQueryMeta = null;\n    this.lastQueryError = null;\n\n    const anySeriesFromQuery = _.find(dataList, { refId: this.target.refId });\n    if (anySeriesFromQuery) {\n      this.lastQueryMeta = anySeriesFromQuery.meta;\n    }\n  }\n\n  onDataError(err) {\n    if (err.data && err.data.results) {\n      const queryRes = err.data.results[this.target.refId];\n      if (queryRes) {\n        this.lastQueryMeta = queryRes.meta;\n        this.lastQueryError = queryRes.error;\n      }\n    }\n  }\n}\n","import _ from 'lodash';\n\nexport default class ResponseParser {\n  constructor(private $q) {}\n\n  processQueryResult(res) {\n    const data = [];\n\n    if (!res.data.results) {\n      return { data: data };\n    }\n\n    for (const key in res.data.results) {\n      const queryRes = res.data.results[key];\n\n      if (queryRes.series) {\n        for (const series of queryRes.series) {\n          data.push({\n            target: series.name,\n            datapoints: series.points,\n            refId: queryRes.refId,\n            meta: queryRes.meta,\n          });\n        }\n      }\n\n      if (queryRes.tables) {\n        for (const table of queryRes.tables) {\n          table.type = 'table';\n          table.refId = queryRes.refId;\n          table.meta = queryRes.meta;\n          data.push(table);\n        }\n      }\n    }\n\n    return { data: data };\n  }\n\n  parseMetricFindQueryResult(refId, results) {\n    if (!results || results.data.length === 0 || results.data.results[refId].meta.rowCount === 0) {\n      return [];\n    }\n\n    const columns = results.data.results[refId].tables[0].columns;\n    const rows = results.data.results[refId].tables[0].rows;\n    const textColIndex = this.findColIndex(columns, '__text');\n    const valueColIndex = this.findColIndex(columns, '__value');\n\n    if (columns.length === 2 && textColIndex !== -1 && valueColIndex !== -1) {\n      return this.transformToKeyValueList(rows, textColIndex, valueColIndex);\n    }\n\n    return this.transformToSimpleList(rows);\n  }\n\n  transformToKeyValueList(rows, textColIndex, valueColIndex) {\n    const res = [];\n\n    for (let i = 0; i < rows.length; i++) {\n      if (!this.containsKey(res, rows[i][textColIndex])) {\n        res.push({\n          text: rows[i][textColIndex],\n          value: rows[i][valueColIndex],\n        });\n      }\n    }\n\n    return res;\n  }\n\n  transformToSimpleList(rows) {\n    const res = [];\n\n    for (let i = 0; i < rows.length; i++) {\n      for (let j = 0; j < rows[i].length; j++) {\n        const value = rows[i][j];\n        if (res.indexOf(value) === -1) {\n          res.push(value);\n        }\n      }\n    }\n\n    return _.map(res, value => {\n      return { text: value };\n    });\n  }\n\n  findColIndex(columns, colName) {\n    for (let i = 0; i < columns.length; i++) {\n      if (columns[i].text === colName) {\n        return i;\n      }\n    }\n\n    return -1;\n  }\n\n  containsKey(res, key) {\n    for (let i = 0; i < res.length; i++) {\n      if (res[i].text === key) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  transformAnnotationResponse(options, data) {\n    const table = data.data.results[options.annotation.name].tables[0];\n\n    let timeColumnIndex = -1;\n    const titleColumnIndex = -1;\n    let textColumnIndex = -1;\n    let tagsColumnIndex = -1;\n\n    for (let i = 0; i < table.columns.length; i++) {\n      if (table.columns[i].text === 'time') {\n        timeColumnIndex = i;\n      } else if (table.columns[i].text === 'text') {\n        textColumnIndex = i;\n      } else if (table.columns[i].text === 'tags') {\n        tagsColumnIndex = i;\n      }\n    }\n\n    if (timeColumnIndex === -1) {\n      return this.$q.reject({\n        message: 'Missing mandatory time column in annotation query.',\n      });\n    }\n\n    const list = [];\n    for (let i = 0; i < table.rows.length; i++) {\n      const row = table.rows[i];\n      list.push({\n        annotation: options.annotation,\n        time: Math.floor(row[timeColumnIndex]),\n        title: row[titleColumnIndex],\n        text: row[textColumnIndex],\n        tags: row[tagsColumnIndex] ? row[tagsColumnIndex].trim().split(/\\s*,\\s*/) : [],\n      });\n    }\n\n    return list;\n  }\n}\n","import _ from 'lodash';\n\nexport default class PostgresQuery {\n  target: any;\n  templateSrv: any;\n  scopedVars: any;\n\n  /** @ngInject */\n  constructor(target, templateSrv?, scopedVars?) {\n    this.target = target;\n    this.templateSrv = templateSrv;\n    this.scopedVars = scopedVars;\n\n    target.format = target.format || 'time_series';\n    target.timeColumn = target.timeColumn || 'time';\n    target.metricColumn = target.metricColumn || 'none';\n\n    target.group = target.group || [];\n    target.where = target.where || [{ type: 'macro', name: '$__timeFilter', params: [] }];\n    target.select = target.select || [[{ type: 'column', params: ['value'] }]];\n\n    // handle pre query gui panels gracefully\n    if (!('rawQuery' in this.target)) {\n      if ('rawSql' in target) {\n        // pre query gui panel\n        target.rawQuery = true;\n      } else {\n        // new panel\n        target.rawQuery = false;\n      }\n    }\n\n    // give interpolateQueryStr access to this\n    this.interpolateQueryStr = this.interpolateQueryStr.bind(this);\n  }\n\n  // remove identifier quoting from identifier to use in metadata queries\n  unquoteIdentifier(value) {\n    if (value[0] === '\"' && value[value.length - 1] === '\"') {\n      return value.substring(1, value.length - 1).replace(/\"\"/g, '\"');\n    } else {\n      return value;\n    }\n  }\n\n  quoteIdentifier(value) {\n    return '\"' + String(value).replace(/\"/g, '\"\"') + '\"';\n  }\n\n  quoteLiteral(value) {\n    return \"'\" + String(value).replace(/'/g, \"''\") + \"'\";\n  }\n\n  escapeLiteral(value) {\n    return String(value).replace(/'/g, \"''\");\n  }\n\n  hasTimeGroup() {\n    return _.find(this.target.group, (g: any) => g.type === 'time');\n  }\n\n  hasMetricColumn() {\n    return this.target.metricColumn !== 'none';\n  }\n\n  interpolateQueryStr(value, variable, defaultFormatFn) {\n    // if no multi or include all do not regexEscape\n    if (!variable.multi && !variable.includeAll) {\n      return this.escapeLiteral(value);\n    }\n\n    if (typeof value === 'string') {\n      return this.quoteLiteral(value);\n    }\n\n    const escapedValues = _.map(value, this.quoteLiteral);\n    return escapedValues.join(',');\n  }\n\n  render(interpolate?) {\n    const target = this.target;\n\n    // new query with no table set yet\n    if (!this.target.rawQuery && !('table' in this.target)) {\n      return '';\n    }\n\n    if (!target.rawQuery) {\n      target.rawSql = this.buildQuery();\n    }\n\n    if (interpolate) {\n      return this.templateSrv.replace(target.rawSql, this.scopedVars, this.interpolateQueryStr);\n    } else {\n      return target.rawSql;\n    }\n  }\n\n  hasUnixEpochTimecolumn() {\n    return ['int4', 'int8', 'float4', 'float8', 'numeric'].indexOf(this.target.timeColumnType) > -1;\n  }\n\n  buildTimeColumn(alias = true) {\n    const timeGroup = this.hasTimeGroup();\n    let query;\n    let macro = '$__timeGroup';\n\n    if (timeGroup) {\n      let args;\n      if (timeGroup.params.length > 1 && timeGroup.params[1] !== 'none') {\n        args = timeGroup.params.join(',');\n      } else {\n        args = timeGroup.params[0];\n      }\n      if (this.hasUnixEpochTimecolumn()) {\n        macro = '$__unixEpochGroup';\n      }\n      if (alias) {\n        macro += 'Alias';\n      }\n      query = macro + '(' + this.target.timeColumn + ',' + args + ')';\n    } else {\n      query = this.target.timeColumn;\n      if (alias) {\n        query += ' AS \"time\"';\n      }\n    }\n\n    return query;\n  }\n\n  buildMetricColumn() {\n    if (this.hasMetricColumn()) {\n      return this.target.metricColumn + ' AS metric';\n    }\n\n    return '';\n  }\n\n  buildValueColumns() {\n    let query = '';\n    for (const column of this.target.select) {\n      query += ',\\n  ' + this.buildValueColumn(column);\n    }\n\n    return query;\n  }\n\n  buildValueColumn(column) {\n    let query = '';\n\n    const columnName = _.find(column, (g: any) => g.type === 'column');\n    query = columnName.params[0];\n\n    const aggregate = _.find(column, (g: any) => g.type === 'aggregate' || g.type === 'percentile');\n    const windows = _.find(column, (g: any) => g.type === 'window' || g.type === 'moving_window');\n\n    if (aggregate) {\n      const func = aggregate.params[0];\n      switch (aggregate.type) {\n        case 'aggregate':\n          if (func === 'first' || func === 'last') {\n            query = func + '(' + query + ',' + this.target.timeColumn + ')';\n          } else {\n            query = func + '(' + query + ')';\n          }\n          break;\n        case 'percentile':\n          query = func + '(' + aggregate.params[1] + ') WITHIN GROUP (ORDER BY ' + query + ')';\n          break;\n      }\n    }\n\n    if (windows) {\n      const overParts = [];\n      if (this.hasMetricColumn()) {\n        overParts.push('PARTITION BY ' + this.target.metricColumn);\n      }\n      overParts.push('ORDER BY ' + this.buildTimeColumn(false));\n\n      const over = overParts.join(' ');\n      let curr: string;\n      let prev: string;\n      switch (windows.type) {\n        case 'window':\n          switch (windows.params[0]) {\n            case 'increase':\n              curr = query;\n              prev = 'lag(' + curr + ') OVER (' + over + ')';\n              query = '(CASE WHEN ' + curr + ' >= ' + prev + ' THEN ' + curr + ' - ' + prev;\n              query += ' WHEN ' + prev + ' IS NULL THEN NULL ELSE ' + curr + ' END)';\n              break;\n            case 'rate':\n              let timeColumn = this.target.timeColumn;\n              if (aggregate) {\n                timeColumn = 'min(' + timeColumn + ')';\n              }\n\n              curr = query;\n              prev = 'lag(' + curr + ') OVER (' + over + ')';\n              query = '(CASE WHEN ' + curr + ' >= ' + prev + ' THEN ' + curr + ' - ' + prev;\n              query += ' WHEN ' + prev + ' IS NULL THEN NULL ELSE ' + curr + ' END)';\n              query += '/extract(epoch from ' + timeColumn + ' - lag(' + timeColumn + ') OVER (' + over + '))';\n              break;\n            default:\n              query = windows.params[0] + '(' + query + ') OVER (' + over + ')';\n              break;\n          }\n          break;\n        case 'moving_window':\n          query = windows.params[0] + '(' + query + ') OVER (' + over + ' ROWS ' + windows.params[1] + ' PRECEDING)';\n          break;\n      }\n    }\n\n    const alias = _.find(column, (g: any) => g.type === 'alias');\n    if (alias) {\n      query += ' AS ' + this.quoteIdentifier(alias.params[0]);\n    }\n\n    return query;\n  }\n\n  buildWhereClause() {\n    let query = '';\n    const conditions = _.map(this.target.where, (tag, index) => {\n      switch (tag.type) {\n        case 'macro':\n          return tag.name + '(' + this.target.timeColumn + ')';\n          break;\n        case 'expression':\n          return tag.params.join(' ');\n          break;\n      }\n    });\n\n    if (conditions.length > 0) {\n      query = '\\nWHERE\\n  ' + conditions.join(' AND\\n  ');\n    }\n\n    return query;\n  }\n\n  buildGroupClause() {\n    let query = '';\n    let groupSection = '';\n\n    for (let i = 0; i < this.target.group.length; i++) {\n      const part = this.target.group[i];\n      if (i > 0) {\n        groupSection += ', ';\n      }\n      if (part.type === 'time') {\n        groupSection += '1';\n      } else {\n        groupSection += part.params[0];\n      }\n    }\n\n    if (groupSection.length) {\n      query = '\\nGROUP BY ' + groupSection;\n      if (this.hasMetricColumn()) {\n        query += ',2';\n      }\n    }\n    return query;\n  }\n\n  buildQuery() {\n    let query = 'SELECT';\n\n    query += '\\n  ' + this.buildTimeColumn();\n    if (this.hasMetricColumn()) {\n      query += ',\\n  ' + this.buildMetricColumn();\n    }\n    query += this.buildValueColumns();\n\n    query += '\\nFROM ' + this.target.table;\n\n    query += this.buildWhereClause();\n    query += this.buildGroupClause();\n\n    query += '\\nORDER BY 1';\n    if (this.hasMetricColumn()) {\n      query += ',2';\n    }\n\n    return query;\n  }\n}\n","import _ from 'lodash';\nimport ResponseParser from './response_parser';\nimport PostgresQuery from 'app/plugins/datasource/postgres/postgres_query';\n\nexport class PostgresDatasource {\n  id: any;\n  name: any;\n  jsonData: any;\n  responseParser: ResponseParser;\n  queryModel: PostgresQuery;\n  interval: string;\n\n  /** @ngInject */\n  constructor(instanceSettings, private backendSrv, private $q, private templateSrv, private timeSrv) {\n    this.name = instanceSettings.name;\n    this.id = instanceSettings.id;\n    this.jsonData = instanceSettings.jsonData;\n    this.responseParser = new ResponseParser(this.$q);\n    this.queryModel = new PostgresQuery({});\n    this.interval = (instanceSettings.jsonData || {}).timeInterval;\n  }\n\n  interpolateVariable = (value, variable) => {\n    if (typeof value === 'string') {\n      if (variable.multi || variable.includeAll) {\n        return this.queryModel.quoteLiteral(value);\n      } else {\n        return value;\n      }\n    }\n\n    if (typeof value === 'number') {\n      return value;\n    }\n\n    const quotedValues = _.map(value, v => {\n      return this.queryModel.quoteLiteral(v);\n    });\n    return quotedValues.join(',');\n  };\n\n  query(options) {\n    const queries = _.filter(options.targets, target => {\n      return target.hide !== true;\n    }).map(target => {\n      const queryModel = new PostgresQuery(target, this.templateSrv, options.scopedVars);\n\n      return {\n        refId: target.refId,\n        intervalMs: options.intervalMs,\n        maxDataPoints: options.maxDataPoints,\n        datasourceId: this.id,\n        rawSql: queryModel.render(this.interpolateVariable),\n        format: target.format,\n      };\n    });\n\n    if (queries.length === 0) {\n      return this.$q.when({ data: [] });\n    }\n\n    return this.backendSrv\n      .datasourceRequest({\n        url: '/api/tsdb/query',\n        method: 'POST',\n        data: {\n          from: options.range.from.valueOf().toString(),\n          to: options.range.to.valueOf().toString(),\n          queries: queries,\n        },\n      })\n      .then(this.responseParser.processQueryResult);\n  }\n\n  annotationQuery(options) {\n    if (!options.annotation.rawQuery) {\n      return this.$q.reject({\n        message: 'Query missing in annotation definition',\n      });\n    }\n\n    const query = {\n      refId: options.annotation.name,\n      datasourceId: this.id,\n      rawSql: this.templateSrv.replace(options.annotation.rawQuery, options.scopedVars, this.interpolateVariable),\n      format: 'table',\n    };\n\n    return this.backendSrv\n      .datasourceRequest({\n        url: '/api/tsdb/query',\n        method: 'POST',\n        data: {\n          from: options.range.from.valueOf().toString(),\n          to: options.range.to.valueOf().toString(),\n          queries: [query],\n        },\n      })\n      .then(data => this.responseParser.transformAnnotationResponse(options, data));\n  }\n\n  metricFindQuery(query, optionalOptions) {\n    let refId = 'tempvar';\n    if (optionalOptions && optionalOptions.variable && optionalOptions.variable.name) {\n      refId = optionalOptions.variable.name;\n    }\n\n    const interpolatedQuery = {\n      refId: refId,\n      datasourceId: this.id,\n      rawSql: this.templateSrv.replace(query, {}, this.interpolateVariable),\n      format: 'table',\n    };\n\n    const range = this.timeSrv.timeRange();\n    const data = {\n      queries: [interpolatedQuery],\n      from: range.from.valueOf().toString(),\n      to: range.to.valueOf().toString(),\n    };\n\n    return this.backendSrv\n      .datasourceRequest({\n        url: '/api/tsdb/query',\n        method: 'POST',\n        data: data,\n      })\n      .then(data => this.responseParser.parseMetricFindQueryResult(refId, data));\n  }\n\n  getVersion() {\n    return this.metricFindQuery(\"SELECT current_setting('server_version_num')::int/100\", {});\n  }\n\n  getTimescaleDBVersion() {\n    return this.metricFindQuery(\"SELECT extversion FROM pg_extension WHERE extname = 'timescaledb'\", {});\n  }\n\n  testDatasource() {\n    return this.metricFindQuery('SELECT 1', {})\n      .then(res => {\n        return { status: 'success', message: 'Database Connection OK' };\n      })\n      .catch(err => {\n        console.log(err);\n        if (err.data && err.data.message) {\n          return { status: 'error', message: err.data.message };\n        } else {\n          return { status: 'error', message: err.status };\n        }\n      });\n  }\n}\n","export class PostgresMetaQuery {\n  constructor(private target, private queryModel) {}\n\n  getOperators(datatype: string) {\n    switch (datatype) {\n      case 'float4':\n      case 'float8': {\n        return ['=', '!=', '<', '<=', '>', '>='];\n      }\n      case 'text':\n      case 'varchar':\n      case 'char': {\n        return ['=', '!=', '<', '<=', '>', '>=', 'IN', 'NOT IN', 'LIKE', 'NOT LIKE', '~', '~*', '!~', '!~*'];\n      }\n      default: {\n        return ['=', '!=', '<', '<=', '>', '>=', 'IN', 'NOT IN'];\n      }\n    }\n  }\n\n  // quote identifier as literal to use in metadata queries\n  quoteIdentAsLiteral(value) {\n    return this.queryModel.quoteLiteral(this.queryModel.unquoteIdentifier(value));\n  }\n\n  findMetricTable() {\n    // query that returns first table found that has a timestamp(tz) column and a float column\n    let query = `\nSELECT\n\tquote_ident(table_name) as table_name,\n\t( SELECT\n\t    quote_ident(column_name) as column_name\n\t  FROM information_schema.columns c\n    WHERE\n      c.table_schema = t.table_schema AND\n      c.table_name = t.table_name AND\n      udt_name IN ('timestamptz','timestamp')\n    ORDER BY ordinal_position LIMIT 1\n  ) AS time_column,\n  ( SELECT\n      quote_ident(column_name) AS column_name\n    FROM information_schema.columns c\n    WHERE\n      c.table_schema = t.table_schema AND\n      c.table_name = t.table_name AND\n      udt_name='float8'\n    ORDER BY ordinal_position LIMIT 1\n  ) AS value_column\nFROM information_schema.tables t\nWHERE `;\n    query += this.buildSchemaConstraint();\n    query += ` AND\n  EXISTS\n  ( SELECT 1\n    FROM information_schema.columns c\n    WHERE\n      c.table_schema = t.table_schema AND\n      c.table_name = t.table_name AND\n      udt_name IN ('timestamptz','timestamp')\n  ) AND\n  EXISTS\n  ( SELECT 1\n    FROM information_schema.columns c\n    WHERE\n      c.table_schema = t.table_schema AND\n      c.table_name = t.table_name AND\n      udt_name='float8'\n  )\nLIMIT 1\n;`;\n    return query;\n  }\n\n  buildSchemaConstraint() {\n    const query = `\ntable_schema IN (\n  SELECT\n    CASE WHEN trim(s[i]) = '\"$user\"' THEN user ELSE trim(s[i]) END\n  FROM\n    generate_series(\n      array_lower(string_to_array(current_setting('search_path'),','),1),\n      array_upper(string_to_array(current_setting('search_path'),','),1)\n    ) as i,\n    string_to_array(current_setting('search_path'),',') s\n)`;\n    return query;\n  }\n\n  buildTableConstraint(table: string) {\n    let query = '';\n\n    // check for schema qualified table\n    if (table.includes('.')) {\n      const parts = table.split('.');\n      query = 'table_schema = ' + this.quoteIdentAsLiteral(parts[0]);\n      query += ' AND table_name = ' + this.quoteIdentAsLiteral(parts[1]);\n      return query;\n    } else {\n      query = this.buildSchemaConstraint();\n      query += ' AND table_name = ' + this.quoteIdentAsLiteral(table);\n\n      return query;\n    }\n  }\n\n  buildTableQuery() {\n    let query = 'SELECT quote_ident(table_name) FROM information_schema.tables WHERE ';\n    query += this.buildSchemaConstraint();\n    query += ' ORDER BY table_name';\n    return query;\n  }\n\n  buildColumnQuery(type?: string) {\n    let query = 'SELECT quote_ident(column_name) FROM information_schema.columns WHERE ';\n    query += this.buildTableConstraint(this.target.table);\n\n    switch (type) {\n      case 'time': {\n        query +=\n          \" AND data_type IN ('timestamp without time zone','timestamp with time zone','bigint','integer','double precision','real')\";\n        break;\n      }\n      case 'metric': {\n        query += \" AND data_type IN ('text','character','character varying')\";\n        break;\n      }\n      case 'value': {\n        query += \" AND data_type IN ('bigint','integer','double precision','real')\";\n        query += ' AND column_name <> ' + this.quoteIdentAsLiteral(this.target.timeColumn);\n        break;\n      }\n      case 'group': {\n        query += \" AND data_type IN ('text','character','character varying')\";\n        break;\n      }\n    }\n\n    query += ' ORDER BY column_name';\n\n    return query;\n  }\n\n  buildValueQuery(column: string) {\n    let query = 'SELECT DISTINCT quote_literal(' + column + ')';\n    query += ' FROM ' + this.target.table;\n    query += ' WHERE $__timeFilter(' + this.target.timeColumn + ')';\n    query += ' AND ' + column + ' IS NOT NULL';\n    query += ' ORDER BY 1 LIMIT 100';\n    return query;\n  }\n\n  buildDatatypeQuery(column: string) {\n    let query = 'SELECT udt_name FROM information_schema.columns WHERE ';\n    query += this.buildSchemaConstraint();\n    query += ' AND table_name = ' + this.quoteIdentAsLiteral(this.target.table);\n    query += ' AND column_name = ' + this.quoteIdentAsLiteral(column);\n    return query;\n  }\n\n  buildAggregateQuery() {\n    let query = 'SELECT DISTINCT proname FROM pg_aggregate ';\n    query += 'INNER JOIN pg_proc ON pg_aggregate.aggfnoid = pg_proc.oid ';\n    query += 'INNER JOIN pg_type ON pg_type.oid=pg_proc.prorettype ';\n    query += \"WHERE pronargs=1 AND typname IN ('float8') AND aggkind='n' ORDER BY 1\";\n    return query;\n  }\n}\n","import _ from 'lodash';\n\nexport class SqlPartDef {\n  type: string;\n  style: string;\n  label: string;\n  params: any[];\n  defaultParams: any[];\n  wrapOpen: string;\n  wrapClose: string;\n  separator: string;\n\n  constructor(options: any) {\n    this.type = options.type;\n    if (options.label) {\n      this.label = options.label;\n    } else {\n      this.label = this.type[0].toUpperCase() + this.type.substring(1) + ':';\n    }\n    this.style = options.style;\n    if (this.style === 'function') {\n      this.wrapOpen = '(';\n      this.wrapClose = ')';\n      this.separator = ', ';\n    } else {\n      this.wrapOpen = ' ';\n      this.wrapClose = ' ';\n      this.separator = ' ';\n    }\n    this.params = options.params;\n    this.defaultParams = options.defaultParams;\n  }\n}\n\nexport class SqlPart {\n  part: any;\n  def: SqlPartDef;\n  params: any[];\n  label: string;\n  name: string;\n  datatype: string;\n\n  constructor(part: any, def: any) {\n    this.part = part;\n    this.def = def;\n    if (!this.def) {\n      throw { message: 'Could not find sql part ' + part.type };\n    }\n\n    this.datatype = part.datatype;\n\n    if (part.name) {\n      this.name = part.name;\n      this.label = def.label + ' ' + part.name;\n    } else {\n      this.name = '';\n      this.label = def.label;\n    }\n\n    part.params = part.params || _.clone(this.def.defaultParams);\n    this.params = part.params;\n  }\n\n  updateParam(strValue, index) {\n    // handle optional parameters\n    if (strValue === '' && this.def.params[index].optional) {\n      this.params.splice(index, 1);\n    } else {\n      this.params[index] = strValue;\n    }\n\n    this.part.params = this.params;\n  }\n}\n","import { SqlPartDef, SqlPart } from 'app/core/components/sql_part/sql_part';\n\nconst index = [];\n\nfunction createPart(part): any {\n  const def = index[part.type];\n  if (!def) {\n    return null;\n  }\n\n  return new SqlPart(part, def);\n}\n\nfunction register(options: any) {\n  index[options.type] = new SqlPartDef(options);\n}\n\nregister({\n  type: 'column',\n  style: 'label',\n  params: [{ type: 'column', dynamicLookup: true }],\n  defaultParams: ['value'],\n});\n\nregister({\n  type: 'expression',\n  style: 'expression',\n  label: 'Expr:',\n  params: [\n    { name: 'left', type: 'string', dynamicLookup: true },\n    { name: 'op', type: 'string', dynamicLookup: true },\n    { name: 'right', type: 'string', dynamicLookup: true },\n  ],\n  defaultParams: ['value', '=', 'value'],\n});\n\nregister({\n  type: 'macro',\n  style: 'label',\n  label: 'Macro:',\n  params: [],\n  defaultParams: [],\n});\n\nregister({\n  type: 'aggregate',\n  style: 'label',\n  params: [\n    {\n      name: 'name',\n      type: 'string',\n      options: ['avg', 'count', 'min', 'max', 'sum', 'stddev', 'variance'],\n    },\n  ],\n  defaultParams: ['avg'],\n});\n\nregister({\n  type: 'percentile',\n  label: 'Aggregate:',\n  style: 'label',\n  params: [\n    {\n      name: 'name',\n      type: 'string',\n      options: ['percentile_cont', 'percentile_disc'],\n    },\n    {\n      name: 'fraction',\n      type: 'number',\n      options: ['0.5', '0.75', '0.9', '0.95', '0.99'],\n    },\n  ],\n  defaultParams: ['percentile_cont', '0.95'],\n});\n\nregister({\n  type: 'alias',\n  style: 'label',\n  params: [{ name: 'name', type: 'string', quote: 'double' }],\n  defaultParams: ['alias'],\n});\n\nregister({\n  type: 'time',\n  style: 'function',\n  label: 'time',\n  params: [\n    {\n      name: 'interval',\n      type: 'interval',\n      options: ['$__interval', '1s', '10s', '1m', '5m', '10m', '15m', '1h'],\n    },\n    {\n      name: 'fill',\n      type: 'string',\n      options: ['none', 'NULL', 'previous', '0'],\n    },\n  ],\n  defaultParams: ['$__interval', 'none'],\n});\n\nregister({\n  type: 'window',\n  style: 'label',\n  params: [\n    {\n      name: 'function',\n      type: 'string',\n      options: ['increase', 'rate', 'sum'],\n    },\n  ],\n  defaultParams: ['increase'],\n});\n\nregister({\n  type: 'moving_window',\n  style: 'label',\n  label: 'Moving Window:',\n  params: [\n    {\n      name: 'function',\n      type: 'string',\n      options: ['avg'],\n    },\n    {\n      name: 'window_size',\n      type: 'number',\n      options: ['3', '5', '7', '10', '20'],\n    },\n  ],\n  defaultParams: ['avg', '5'],\n});\n\nexport default {\n  create: createPart,\n};\n","import _ from 'lodash';\nimport appEvents from 'app/core/app_events';\nimport { PostgresMetaQuery } from './meta_query';\nimport { QueryCtrl } from 'app/plugins/sdk';\nimport { SqlPart } from 'app/core/components/sql_part/sql_part';\nimport PostgresQuery from './postgres_query';\nimport sqlPart from './sql_part';\n\nexport interface QueryMeta {\n  sql: string;\n}\n\nconst defaultQuery = `SELECT\n  $__time(time_column),\n  value1\nFROM\n  metric_table\nWHERE\n  $__timeFilter(time_column)\n`;\n\nexport class PostgresQueryCtrl extends QueryCtrl {\n  static templateUrl = 'partials/query.editor.html';\n\n  showLastQuerySQL: boolean;\n  formats: any[];\n  queryModel: PostgresQuery;\n  metaBuilder: PostgresMetaQuery;\n  lastQueryMeta: QueryMeta;\n  lastQueryError: string;\n  showHelp: boolean;\n  tableSegment: any;\n  whereAdd: any;\n  timeColumnSegment: any;\n  metricColumnSegment: any;\n  selectMenu: any[];\n  selectParts: SqlPart[][];\n  groupParts: SqlPart[];\n  whereParts: SqlPart[];\n  groupAdd: any;\n\n  /** @ngInject */\n  constructor($scope, $injector, private templateSrv, private $q, private uiSegmentSrv) {\n    super($scope, $injector);\n    this.target = this.target;\n    this.queryModel = new PostgresQuery(this.target, templateSrv, this.panel.scopedVars);\n    this.metaBuilder = new PostgresMetaQuery(this.target, this.queryModel);\n    this.updateProjection();\n\n    this.formats = [{ text: 'Time series', value: 'time_series' }, { text: 'Table', value: 'table' }];\n\n    if (!this.target.rawSql) {\n      // special handling when in table panel\n      if (this.panelCtrl.panel.type === 'table') {\n        this.target.format = 'table';\n        this.target.rawSql = 'SELECT 1';\n        this.target.rawQuery = true;\n      } else {\n        this.target.rawSql = defaultQuery;\n        this.datasource.metricFindQuery(this.metaBuilder.findMetricTable()).then(result => {\n          if (result.length > 0) {\n            this.target.table = result[0].text;\n            let segment = this.uiSegmentSrv.newSegment(this.target.table);\n            this.tableSegment.html = segment.html;\n            this.tableSegment.value = segment.value;\n\n            this.target.timeColumn = result[1].text;\n            segment = this.uiSegmentSrv.newSegment(this.target.timeColumn);\n            this.timeColumnSegment.html = segment.html;\n            this.timeColumnSegment.value = segment.value;\n\n            this.target.timeColumnType = 'timestamp';\n            this.target.select = [[{ type: 'column', params: [result[2].text] }]];\n            this.updateProjection();\n            this.panelCtrl.refresh();\n          }\n        });\n      }\n    }\n\n    if (!this.target.table) {\n      this.tableSegment = uiSegmentSrv.newSegment({ value: 'select table', fake: true });\n    } else {\n      this.tableSegment = uiSegmentSrv.newSegment(this.target.table);\n    }\n\n    this.timeColumnSegment = uiSegmentSrv.newSegment(this.target.timeColumn);\n    this.metricColumnSegment = uiSegmentSrv.newSegment(this.target.metricColumn);\n\n    this.buildSelectMenu();\n    this.whereAdd = this.uiSegmentSrv.newPlusButton();\n    this.groupAdd = this.uiSegmentSrv.newPlusButton();\n\n    this.panelCtrl.events.on('data-received', this.onDataReceived.bind(this), $scope);\n    this.panelCtrl.events.on('data-error', this.onDataError.bind(this), $scope);\n  }\n\n  updateProjection() {\n    this.selectParts = _.map(this.target.select, (parts: any) => {\n      return _.map(parts, sqlPart.create).filter(n => n);\n    });\n    this.whereParts = _.map(this.target.where, sqlPart.create).filter(n => n);\n    this.groupParts = _.map(this.target.group, sqlPart.create).filter(n => n);\n  }\n\n  updatePersistedParts() {\n    this.target.select = _.map(this.selectParts, selectParts => {\n      return _.map(selectParts, (part: any) => {\n        return { type: part.def.type, datatype: part.datatype, params: part.params };\n      });\n    });\n    this.target.where = _.map(this.whereParts, (part: any) => {\n      return { type: part.def.type, datatype: part.datatype, name: part.name, params: part.params };\n    });\n    this.target.group = _.map(this.groupParts, (part: any) => {\n      return { type: part.def.type, datatype: part.datatype, params: part.params };\n    });\n  }\n\n  buildSelectMenu() {\n    this.selectMenu = [];\n    const aggregates = {\n      text: 'Aggregate Functions',\n      value: 'aggregate',\n      submenu: [\n        { text: 'Average', value: 'avg' },\n        { text: 'Count', value: 'count' },\n        { text: 'Maximum', value: 'max' },\n        { text: 'Minimum', value: 'min' },\n        { text: 'Sum', value: 'sum' },\n        { text: 'Standard deviation', value: 'stddev' },\n        { text: 'Variance', value: 'variance' },\n      ],\n    };\n\n    // first and last aggregate are timescaledb specific\n    if (this.datasource.jsonData.timescaledb === true) {\n      aggregates.submenu.push({ text: 'First', value: 'first' });\n      aggregates.submenu.push({ text: 'Last', value: 'last' });\n    }\n\n    this.selectMenu.push(aggregates);\n\n    // ordered set aggregates require postgres 9.4+\n    if (this.datasource.jsonData.postgresVersion >= 904) {\n      const aggregates2 = {\n        text: 'Ordered-Set Aggregate Functions',\n        value: 'percentile',\n        submenu: [\n          { text: 'Percentile (continuous)', value: 'percentile_cont' },\n          { text: 'Percentile (discrete)', value: 'percentile_disc' },\n        ],\n      };\n      this.selectMenu.push(aggregates2);\n    }\n\n    const windows = {\n      text: 'Window Functions',\n      value: 'window',\n      submenu: [\n        { text: 'Increase', value: 'increase' },\n        { text: 'Rate', value: 'rate' },\n        { text: 'Sum', value: 'sum' },\n        { text: 'Moving Average', value: 'avg', type: 'moving_window' },\n      ],\n    };\n    this.selectMenu.push(windows);\n\n    this.selectMenu.push({ text: 'Alias', value: 'alias' });\n    this.selectMenu.push({ text: 'Column', value: 'column' });\n  }\n\n  toggleEditorMode() {\n    if (this.target.rawQuery) {\n      appEvents.emit('confirm-modal', {\n        title: 'Warning',\n        text2: 'Switching to query builder may overwrite your raw SQL.',\n        icon: 'fa-exclamation',\n        yesText: 'Switch',\n        onConfirm: () => {\n          this.target.rawQuery = !this.target.rawQuery;\n        },\n      });\n    } else {\n      this.target.rawQuery = !this.target.rawQuery;\n    }\n  }\n\n  resetPlusButton(button) {\n    const plusButton = this.uiSegmentSrv.newPlusButton();\n    button.html = plusButton.html;\n    button.value = plusButton.value;\n  }\n\n  getTableSegments() {\n    return this.datasource\n      .metricFindQuery(this.metaBuilder.buildTableQuery())\n      .then(this.transformToSegments({}))\n      .catch(this.handleQueryError.bind(this));\n  }\n\n  tableChanged() {\n    this.target.table = this.tableSegment.value;\n    this.target.where = [];\n    this.target.group = [];\n    this.updateProjection();\n\n    const segment = this.uiSegmentSrv.newSegment('none');\n    this.metricColumnSegment.html = segment.html;\n    this.metricColumnSegment.value = segment.value;\n    this.target.metricColumn = 'none';\n\n    const task1 = this.datasource.metricFindQuery(this.metaBuilder.buildColumnQuery('time')).then(result => {\n      // check if time column is still valid\n      if (result.length > 0 && !_.find(result, (r: any) => r.text === this.target.timeColumn)) {\n        const segment = this.uiSegmentSrv.newSegment(result[0].text);\n        this.timeColumnSegment.html = segment.html;\n        this.timeColumnSegment.value = segment.value;\n      }\n      return this.timeColumnChanged(false);\n    });\n    const task2 = this.datasource.metricFindQuery(this.metaBuilder.buildColumnQuery('value')).then(result => {\n      if (result.length > 0) {\n        this.target.select = [[{ type: 'column', params: [result[0].text] }]];\n        this.updateProjection();\n      }\n    });\n\n    this.$q.all([task1, task2]).then(() => {\n      this.panelCtrl.refresh();\n    });\n  }\n\n  getTimeColumnSegments() {\n    return this.datasource\n      .metricFindQuery(this.metaBuilder.buildColumnQuery('time'))\n      .then(this.transformToSegments({}))\n      .catch(this.handleQueryError.bind(this));\n  }\n\n  timeColumnChanged(refresh?: boolean) {\n    this.target.timeColumn = this.timeColumnSegment.value;\n    return this.datasource.metricFindQuery(this.metaBuilder.buildDatatypeQuery(this.target.timeColumn)).then(result => {\n      if (result.length === 1) {\n        if (this.target.timeColumnType !== result[0].text) {\n          this.target.timeColumnType = result[0].text;\n        }\n        let partModel;\n        if (this.queryModel.hasUnixEpochTimecolumn()) {\n          partModel = sqlPart.create({ type: 'macro', name: '$__unixEpochFilter', params: [] });\n        } else {\n          partModel = sqlPart.create({ type: 'macro', name: '$__timeFilter', params: [] });\n        }\n\n        if (this.whereParts.length >= 1 && this.whereParts[0].def.type === 'macro') {\n          // replace current macro\n          this.whereParts[0] = partModel;\n        } else {\n          this.whereParts.splice(0, 0, partModel);\n        }\n      }\n\n      this.updatePersistedParts();\n      if (refresh !== false) {\n        this.panelCtrl.refresh();\n      }\n    });\n  }\n\n  getMetricColumnSegments() {\n    return this.datasource\n      .metricFindQuery(this.metaBuilder.buildColumnQuery('metric'))\n      .then(this.transformToSegments({ addNone: true }))\n      .catch(this.handleQueryError.bind(this));\n  }\n\n  metricColumnChanged() {\n    this.target.metricColumn = this.metricColumnSegment.value;\n    this.panelCtrl.refresh();\n  }\n\n  onDataReceived(dataList) {\n    this.lastQueryMeta = null;\n    this.lastQueryError = null;\n\n    const anySeriesFromQuery = _.find(dataList, { refId: this.target.refId });\n    if (anySeriesFromQuery) {\n      this.lastQueryMeta = anySeriesFromQuery.meta;\n    }\n  }\n\n  onDataError(err) {\n    if (err.data && err.data.results) {\n      const queryRes = err.data.results[this.target.refId];\n      if (queryRes) {\n        this.lastQueryMeta = queryRes.meta;\n        this.lastQueryError = queryRes.error;\n      }\n    }\n  }\n\n  transformToSegments(config) {\n    return results => {\n      const segments = _.map(results, segment => {\n        return this.uiSegmentSrv.newSegment({\n          value: segment.text,\n          expandable: segment.expandable,\n        });\n      });\n\n      if (config.addTemplateVars) {\n        for (const variable of this.templateSrv.variables) {\n          let value;\n          value = '$' + variable.name;\n          if (config.templateQuoter && variable.multi === false) {\n            value = config.templateQuoter(value);\n          }\n\n          segments.unshift(\n            this.uiSegmentSrv.newSegment({\n              type: 'template',\n              value: value,\n              expandable: true,\n            })\n          );\n        }\n      }\n\n      if (config.addNone) {\n        segments.unshift(this.uiSegmentSrv.newSegment({ type: 'template', value: 'none', expandable: true }));\n      }\n\n      return segments;\n    };\n  }\n\n  findAggregateIndex(selectParts) {\n    return _.findIndex(selectParts, (p: any) => p.def.type === 'aggregate' || p.def.type === 'percentile');\n  }\n\n  findWindowIndex(selectParts) {\n    return _.findIndex(selectParts, (p: any) => p.def.type === 'window' || p.def.type === 'moving_window');\n  }\n\n  addSelectPart(selectParts, item, subItem) {\n    let partType = item.value;\n    if (subItem && subItem.type) {\n      partType = subItem.type;\n    }\n    let partModel = sqlPart.create({ type: partType });\n    if (subItem) {\n      partModel.params[0] = subItem.value;\n    }\n    let addAlias = false;\n\n    switch (partType) {\n      case 'column':\n        const parts = _.map(selectParts, (part: any) => {\n          return sqlPart.create({ type: part.def.type, params: _.clone(part.params) });\n        });\n        this.selectParts.push(parts);\n        break;\n      case 'percentile':\n      case 'aggregate':\n        // add group by if no group by yet\n        if (this.target.group.length === 0) {\n          this.addGroup('time', '$__interval');\n        }\n        const aggIndex = this.findAggregateIndex(selectParts);\n        if (aggIndex !== -1) {\n          // replace current aggregation\n          selectParts[aggIndex] = partModel;\n        } else {\n          selectParts.splice(1, 0, partModel);\n        }\n        if (!_.find(selectParts, (p: any) => p.def.type === 'alias')) {\n          addAlias = true;\n        }\n        break;\n      case 'moving_window':\n      case 'window':\n        const windowIndex = this.findWindowIndex(selectParts);\n        if (windowIndex !== -1) {\n          // replace current window function\n          selectParts[windowIndex] = partModel;\n        } else {\n          const aggIndex = this.findAggregateIndex(selectParts);\n          if (aggIndex !== -1) {\n            selectParts.splice(aggIndex + 1, 0, partModel);\n          } else {\n            selectParts.splice(1, 0, partModel);\n          }\n        }\n        if (!_.find(selectParts, (p: any) => p.def.type === 'alias')) {\n          addAlias = true;\n        }\n        break;\n      case 'alias':\n        addAlias = true;\n        break;\n    }\n\n    if (addAlias) {\n      // set initial alias name to column name\n      partModel = sqlPart.create({ type: 'alias', params: [selectParts[0].params[0].replace(/\"/g, '')] });\n      if (selectParts[selectParts.length - 1].def.type === 'alias') {\n        selectParts[selectParts.length - 1] = partModel;\n      } else {\n        selectParts.push(partModel);\n      }\n    }\n\n    this.updatePersistedParts();\n    this.panelCtrl.refresh();\n  }\n\n  removeSelectPart(selectParts, part) {\n    if (part.def.type === 'column') {\n      // remove all parts of column unless its last column\n      if (this.selectParts.length > 1) {\n        const modelsIndex = _.indexOf(this.selectParts, selectParts);\n        this.selectParts.splice(modelsIndex, 1);\n      }\n    } else {\n      const partIndex = _.indexOf(selectParts, part);\n      selectParts.splice(partIndex, 1);\n    }\n\n    this.updatePersistedParts();\n  }\n\n  handleSelectPartEvent(selectParts, part, evt) {\n    switch (evt.name) {\n      case 'get-param-options': {\n        switch (part.def.type) {\n          case 'aggregate':\n            return this.datasource\n              .metricFindQuery(this.metaBuilder.buildAggregateQuery())\n              .then(this.transformToSegments({}))\n              .catch(this.handleQueryError.bind(this));\n          case 'column':\n            return this.datasource\n              .metricFindQuery(this.metaBuilder.buildColumnQuery('value'))\n              .then(this.transformToSegments({}))\n              .catch(this.handleQueryError.bind(this));\n        }\n      }\n      case 'part-param-changed': {\n        this.updatePersistedParts();\n        this.panelCtrl.refresh();\n        break;\n      }\n      case 'action': {\n        this.removeSelectPart(selectParts, part);\n        this.panelCtrl.refresh();\n        break;\n      }\n      case 'get-part-actions': {\n        return this.$q.when([{ text: 'Remove', value: 'remove-part' }]);\n      }\n    }\n  }\n\n  handleGroupPartEvent(part, index, evt) {\n    switch (evt.name) {\n      case 'get-param-options': {\n        return this.datasource\n          .metricFindQuery(this.metaBuilder.buildColumnQuery())\n          .then(this.transformToSegments({}))\n          .catch(this.handleQueryError.bind(this));\n      }\n      case 'part-param-changed': {\n        this.updatePersistedParts();\n        this.panelCtrl.refresh();\n        break;\n      }\n      case 'action': {\n        this.removeGroup(part, index);\n        this.panelCtrl.refresh();\n        break;\n      }\n      case 'get-part-actions': {\n        return this.$q.when([{ text: 'Remove', value: 'remove-part' }]);\n      }\n    }\n  }\n\n  addGroup(partType, value) {\n    let params = [value];\n    if (partType === 'time') {\n      params = ['$__interval', 'none'];\n    }\n    const partModel = sqlPart.create({ type: partType, params: params });\n\n    if (partType === 'time') {\n      // put timeGroup at start\n      this.groupParts.splice(0, 0, partModel);\n    } else {\n      this.groupParts.push(partModel);\n    }\n\n    // add aggregates when adding group by\n    for (const selectParts of this.selectParts) {\n      if (!selectParts.some(part => part.def.type === 'aggregate')) {\n        const aggregate = sqlPart.create({ type: 'aggregate', params: ['avg'] });\n        selectParts.splice(1, 0, aggregate);\n        if (!selectParts.some(part => part.def.type === 'alias')) {\n          const alias = sqlPart.create({ type: 'alias', params: [selectParts[0].part.params[0]] });\n          selectParts.push(alias);\n        }\n      }\n    }\n\n    this.updatePersistedParts();\n  }\n\n  removeGroup(part, index) {\n    if (part.def.type === 'time') {\n      // remove aggregations\n      this.selectParts = _.map(this.selectParts, (s: any) => {\n        return _.filter(s, (part: any) => {\n          if (part.def.type === 'aggregate' || part.def.type === 'percentile') {\n            return false;\n          }\n          return true;\n        });\n      });\n    }\n\n    this.groupParts.splice(index, 1);\n    this.updatePersistedParts();\n  }\n\n  handleWherePartEvent(whereParts, part, evt, index) {\n    switch (evt.name) {\n      case 'get-param-options': {\n        switch (evt.param.name) {\n          case 'left':\n            return this.datasource\n              .metricFindQuery(this.metaBuilder.buildColumnQuery())\n              .then(this.transformToSegments({}))\n              .catch(this.handleQueryError.bind(this));\n          case 'right':\n            if (['int4', 'int8', 'float4', 'float8', 'timestamp', 'timestamptz'].indexOf(part.datatype) > -1) {\n              // don't do value lookups for numerical fields\n              return this.$q.when([]);\n            } else {\n              return this.datasource\n                .metricFindQuery(this.metaBuilder.buildValueQuery(part.params[0]))\n                .then(\n                  this.transformToSegments({\n                    addTemplateVars: true,\n                    templateQuoter: (v: string) => {\n                      return this.queryModel.quoteLiteral(v);\n                    },\n                  })\n                )\n                .catch(this.handleQueryError.bind(this));\n            }\n          case 'op':\n            return this.$q.when(this.uiSegmentSrv.newOperators(this.metaBuilder.getOperators(part.datatype)));\n          default:\n            return this.$q.when([]);\n        }\n      }\n      case 'part-param-changed': {\n        this.updatePersistedParts();\n        this.datasource.metricFindQuery(this.metaBuilder.buildDatatypeQuery(part.params[0])).then((d: any) => {\n          if (d.length === 1) {\n            part.datatype = d[0].text;\n          }\n        });\n        this.panelCtrl.refresh();\n        break;\n      }\n      case 'action': {\n        // remove element\n        whereParts.splice(index, 1);\n        this.updatePersistedParts();\n        this.panelCtrl.refresh();\n        break;\n      }\n      case 'get-part-actions': {\n        return this.$q.when([{ text: 'Remove', value: 'remove-part' }]);\n      }\n    }\n  }\n\n  getWhereOptions() {\n    const options = [];\n    if (this.queryModel.hasUnixEpochTimecolumn()) {\n      options.push(this.uiSegmentSrv.newSegment({ type: 'macro', value: '$__unixEpochFilter' }));\n    } else {\n      options.push(this.uiSegmentSrv.newSegment({ type: 'macro', value: '$__timeFilter' }));\n    }\n    options.push(this.uiSegmentSrv.newSegment({ type: 'expression', value: 'Expression' }));\n    return this.$q.when(options);\n  }\n\n  addWhereAction(part, index) {\n    switch (this.whereAdd.type) {\n      case 'macro': {\n        const partModel = sqlPart.create({ type: 'macro', name: this.whereAdd.value, params: [] });\n        if (this.whereParts.length >= 1 && this.whereParts[0].def.type === 'macro') {\n          // replace current macro\n          this.whereParts[0] = partModel;\n        } else {\n          this.whereParts.splice(0, 0, partModel);\n        }\n        break;\n      }\n      default: {\n        this.whereParts.push(sqlPart.create({ type: 'expression', params: ['value', '=', 'value'] }));\n      }\n    }\n\n    this.updatePersistedParts();\n    this.resetPlusButton(this.whereAdd);\n    this.panelCtrl.refresh();\n  }\n\n  getGroupOptions() {\n    return this.datasource\n      .metricFindQuery(this.metaBuilder.buildColumnQuery('group'))\n      .then(tags => {\n        const options = [];\n        if (!this.queryModel.hasTimeGroup()) {\n          options.push(this.uiSegmentSrv.newSegment({ type: 'time', value: 'time($__interval,none)' }));\n        }\n        for (const tag of tags) {\n          options.push(this.uiSegmentSrv.newSegment({ type: 'column', value: tag.text }));\n        }\n        return options;\n      })\n      .catch(this.handleQueryError.bind(this));\n  }\n\n  addGroupAction() {\n    switch (this.groupAdd.value) {\n      default: {\n        this.addGroup(this.groupAdd.type, this.groupAdd.value);\n      }\n    }\n\n    this.resetPlusButton(this.groupAdd);\n    this.panelCtrl.refresh();\n  }\n\n  handleQueryError(err) {\n    this.error = err.message || 'Failed to issue metric query';\n    return [];\n  }\n}\n","import { PostgresDatasource } from './datasource';\nimport { PostgresQueryCtrl } from './query_ctrl';\nimport { PostgresConfigCtrl } from './config_ctrl';\n\nconst defaultQuery = `SELECT\n  extract(epoch from time_column) AS time,\n  text_column as text,\n  tags_column as tags\nFROM\n  metric_table\nWHERE\n  $__timeFilter(time_column)\n`;\n\nclass PostgresAnnotationsQueryCtrl {\n  static templateUrl = 'partials/annotations.editor.html';\n\n  annotation: any;\n\n  /** @ngInject */\n  constructor() {\n    this.annotation.rawQuery = this.annotation.rawQuery || defaultQuery;\n  }\n}\n\nexport {\n  PostgresDatasource,\n  PostgresDatasource as Datasource,\n  PostgresQueryCtrl as QueryCtrl,\n  PostgresConfigCtrl as ConfigCtrl,\n  PostgresAnnotationsQueryCtrl as AnnotationsQueryCtrl,\n};\n","import _ from 'lodash';\n\nexport class PostgresConfigCtrl {\n  static templateUrl = 'partials/config.html';\n\n  current: any;\n  datasourceSrv: any;\n  showTimescaleDBHelp: boolean;\n\n  /** @ngInject */\n  constructor($scope, datasourceSrv) {\n    this.datasourceSrv = datasourceSrv;\n    this.current.jsonData.sslmode = this.current.jsonData.sslmode || 'verify-full';\n    this.current.jsonData.postgresVersion = this.current.jsonData.postgresVersion || 903;\n    this.showTimescaleDBHelp = false;\n    this.autoDetectFeatures();\n  }\n\n  autoDetectFeatures() {\n    if (!this.current.id) {\n      return;\n    }\n\n    this.datasourceSrv.loadDatasource(this.current.name).then(ds => {\n      return ds.getVersion().then(version => {\n        version = Number(version[0].text);\n\n        // timescaledb is only available for 9.6+\n        if (version >= 906) {\n          ds.getTimescaleDBVersion().then(version => {\n            if (version.length === 1) {\n              this.current.jsonData.timescaledb = true;\n            }\n          });\n        }\n\n        const major = Math.trunc(version / 100);\n        const minor = version % 100;\n        let name = String(major);\n        if (version < 1000) {\n          name = String(major) + '.' + String(minor);\n        }\n        if (!_.find(this.postgresVersions, (p: any) => p.value === version)) {\n          this.postgresVersions.push({ name: name, value: version });\n        }\n        this.current.jsonData.postgresVersion = version;\n      });\n    });\n  }\n\n  toggleTimescaleDBHelp() {\n    this.showTimescaleDBHelp = !this.showTimescaleDBHelp;\n  }\n\n  // the value portion is derived from postgres server_version_num/100\n  postgresVersions = [\n    { name: '9.3', value: 903 },\n    { name: '9.4', value: 904 },\n    { name: '9.5', value: 905 },\n    { name: '9.6', value: 906 },\n    { name: '10', value: 1000 },\n  ];\n}\n","import _ from 'lodash';\n\nexport default class PrometheusMetricFindQuery {\n  datasource: any;\n  query: any;\n  range: any;\n\n  constructor(datasource, query, timeSrv) {\n    this.datasource = datasource;\n    this.query = query;\n    this.range = timeSrv.timeRange();\n  }\n\n  process() {\n    const labelValuesRegex = /^label_values\\((?:(.+),\\s*)?([a-zA-Z_][a-zA-Z0-9_]*)\\)\\s*$/;\n    const metricNamesRegex = /^metrics\\((.+)\\)\\s*$/;\n    const queryResultRegex = /^query_result\\((.+)\\)\\s*$/;\n\n    const labelValuesQuery = this.query.match(labelValuesRegex);\n    if (labelValuesQuery) {\n      if (labelValuesQuery[1]) {\n        return this.labelValuesQuery(labelValuesQuery[2], labelValuesQuery[1]);\n      } else {\n        return this.labelValuesQuery(labelValuesQuery[2], null);\n      }\n    }\n\n    const metricNamesQuery = this.query.match(metricNamesRegex);\n    if (metricNamesQuery) {\n      return this.metricNameQuery(metricNamesQuery[1]);\n    }\n\n    const queryResultQuery = this.query.match(queryResultRegex);\n    if (queryResultQuery) {\n      return this.queryResultQuery(queryResultQuery[1]);\n    }\n\n    // if query contains full metric name, return metric name and label list\n    return this.metricNameAndLabelsQuery(this.query);\n  }\n\n  labelValuesQuery(label, metric) {\n    let url;\n\n    if (!metric) {\n      // return label values globally\n      url = '/api/v1/label/' + label + '/values';\n\n      return this.datasource.metadataRequest(url).then(result => {\n        return _.map(result.data.data, value => {\n          return { text: value };\n        });\n      });\n    } else {\n      const start = this.datasource.getPrometheusTime(this.range.from, false);\n      const end = this.datasource.getPrometheusTime(this.range.to, true);\n      url = '/api/v1/series?match[]=' + encodeURIComponent(metric) + '&start=' + start + '&end=' + end;\n\n      return this.datasource.metadataRequest(url).then(result => {\n        const _labels = _.map(result.data.data, metric => {\n          return metric[label] || '';\n        }).filter(label => {\n          return label !== '';\n        });\n\n        return _.uniq(_labels).map(metric => {\n          return {\n            text: metric,\n            expandable: true,\n          };\n        });\n      });\n    }\n  }\n\n  metricNameQuery(metricFilterPattern) {\n    const url = '/api/v1/label/__name__/values';\n\n    return this.datasource.metadataRequest(url).then(result => {\n      return _.chain(result.data.data)\n        .filter(metricName => {\n          const r = new RegExp(metricFilterPattern);\n          return r.test(metricName);\n        })\n        .map(matchedMetricName => {\n          return {\n            text: matchedMetricName,\n            expandable: true,\n          };\n        })\n        .value();\n    });\n  }\n\n  queryResultQuery(query) {\n    const end = this.datasource.getPrometheusTime(this.range.to, true);\n    return this.datasource.performInstantQuery({ expr: query }, end).then(result => {\n      return _.map(result.data.data.result, metricData => {\n        let text = metricData.metric.__name__ || '';\n        delete metricData.metric.__name__;\n        text +=\n          '{' +\n          _.map(metricData.metric, (v, k) => {\n            return k + '=\"' + v + '\"';\n          }).join(',') +\n          '}';\n        text += ' ' + metricData.value[1] + ' ' + metricData.value[0] * 1000;\n\n        return {\n          text: text,\n          expandable: true,\n        };\n      });\n    });\n  }\n\n  metricNameAndLabelsQuery(query) {\n    const start = this.datasource.getPrometheusTime(this.range.from, false);\n    const end = this.datasource.getPrometheusTime(this.range.to, true);\n    const url = '/api/v1/series?match[]=' + encodeURIComponent(query) + '&start=' + start + '&end=' + end;\n\n    const self = this;\n    return this.datasource.metadataRequest(url).then(result => {\n      return _.map(result.data.data, metric => {\n        return {\n          text: self.datasource.getOriginalMetricName(metric),\n          expandable: true,\n        };\n      });\n    });\n  }\n}\n","import _ from 'lodash';\nimport TableModel from 'app/core/table_model';\n\nexport class ResultTransformer {\n  constructor(private templateSrv) {}\n\n  transform(response: any, options: any): any[] {\n    const prometheusResult = response.data.data.result;\n\n    if (options.format === 'table') {\n      return [this.transformMetricDataToTable(prometheusResult, options.responseListLength, options.refId)];\n    } else if (options.format === 'heatmap') {\n      let seriesList = [];\n      prometheusResult.sort(sortSeriesByLabel);\n      for (const metricData of prometheusResult) {\n        seriesList.push(this.transformMetricData(metricData, options, options.start, options.end));\n      }\n      seriesList = this.transformToHistogramOverTime(seriesList);\n      return seriesList;\n    } else {\n      const seriesList = [];\n      for (const metricData of prometheusResult) {\n        if (response.data.data.resultType === 'matrix') {\n          seriesList.push(this.transformMetricData(metricData, options, options.start, options.end));\n        } else if (response.data.data.resultType === 'vector') {\n          seriesList.push(this.transformInstantMetricData(metricData, options));\n        }\n      }\n      return seriesList;\n    }\n    return [];\n  }\n\n  transformMetricData(metricData, options, start, end) {\n    const dps = [];\n    let metricLabel = null;\n\n    metricLabel = this.createMetricLabel(metricData.metric, options);\n\n    const stepMs = parseInt(options.step, 10) * 1000;\n    let baseTimestamp = start * 1000;\n\n    if (metricData.values === undefined) {\n      throw new Error('Prometheus heatmap error: data should be a time series');\n    }\n\n    for (const value of metricData.values) {\n      let dpValue = parseFloat(value[1]);\n      if (_.isNaN(dpValue)) {\n        dpValue = null;\n      }\n\n      const timestamp = parseFloat(value[0]) * 1000;\n      for (let t = baseTimestamp; t < timestamp; t += stepMs) {\n        dps.push([null, t]);\n      }\n      baseTimestamp = timestamp + stepMs;\n      dps.push([dpValue, timestamp]);\n    }\n\n    const endTimestamp = end * 1000;\n    for (let t = baseTimestamp; t <= endTimestamp; t += stepMs) {\n      dps.push([null, t]);\n    }\n\n    return {\n      datapoints: dps,\n      query: options.query,\n      responseIndex: options.responseIndex,\n      target: metricLabel,\n    };\n  }\n\n  transformMetricDataToTable(md, resultCount: number, refId: string) {\n    const table = new TableModel();\n    let i, j;\n    const metricLabels = {};\n\n    if (md.length === 0) {\n      return table;\n    }\n\n    // Collect all labels across all metrics\n    _.each(md, series => {\n      for (const label in series.metric) {\n        if (!metricLabels.hasOwnProperty(label)) {\n          metricLabels[label] = 1;\n        }\n      }\n    });\n\n    // Sort metric labels, create columns for them and record their index\n    const sortedLabels = _.keys(metricLabels).sort();\n    table.columns.push({ text: 'Time', type: 'time' });\n    _.each(sortedLabels, (label, labelIndex) => {\n      metricLabels[label] = labelIndex + 1;\n      table.columns.push({ text: label, filterable: !label.startsWith('__') });\n    });\n    const valueText = resultCount > 1 ? `Value #${refId}` : 'Value';\n    table.columns.push({ text: valueText });\n\n    // Populate rows, set value to empty string when label not present.\n    _.each(md, series => {\n      if (series.value) {\n        series.values = [series.value];\n      }\n      if (series.values) {\n        for (i = 0; i < series.values.length; i++) {\n          const values = series.values[i];\n          const reordered: any = [values[0] * 1000];\n          if (series.metric) {\n            for (j = 0; j < sortedLabels.length; j++) {\n              const label = sortedLabels[j];\n              if (series.metric.hasOwnProperty(label)) {\n                reordered.push(series.metric[label]);\n              } else {\n                reordered.push('');\n              }\n            }\n          }\n          reordered.push(parseFloat(values[1]));\n          table.rows.push(reordered);\n        }\n      }\n    });\n\n    return table;\n  }\n\n  transformInstantMetricData(md, options) {\n    const dps = [];\n    let metricLabel = null;\n    metricLabel = this.createMetricLabel(md.metric, options);\n    dps.push([parseFloat(md.value[1]), md.value[0] * 1000]);\n    return { target: metricLabel, datapoints: dps, labels: md.metric };\n  }\n\n  createMetricLabel(labelData, options) {\n    let label = '';\n    if (_.isUndefined(options) || _.isEmpty(options.legendFormat)) {\n      label = this.getOriginalMetricName(labelData);\n    } else {\n      label = this.renderTemplate(this.templateSrv.replace(options.legendFormat), labelData);\n    }\n    if (!label || label === '{}') {\n      label = options.query;\n    }\n    return label;\n  }\n\n  renderTemplate(aliasPattern, aliasData) {\n    const aliasRegex = /\\{\\{\\s*(.+?)\\s*\\}\\}/g;\n    return aliasPattern.replace(aliasRegex, (match, g1) => {\n      if (aliasData[g1]) {\n        return aliasData[g1];\n      }\n      return g1;\n    });\n  }\n\n  getOriginalMetricName(labelData) {\n    const metricName = labelData.__name__ || '';\n    delete labelData.__name__;\n    const labelPart = _.map(_.toPairs(labelData), label => {\n      return label[0] + '=\"' + label[1] + '\"';\n    }).join(',');\n    return metricName + '{' + labelPart + '}';\n  }\n\n  transformToHistogramOverTime(seriesList) {\n    /*      t1 = timestamp1, t2 = timestamp2 etc.\n            t1  t2  t3          t1  t2  t3\n    le10    10  10  0     =>    10  10  0\n    le20    20  10  30    =>    10  0   30\n    le30    30  10  35    =>    10  0   5\n    */\n    for (let i = seriesList.length - 1; i > 0; i--) {\n      const topSeries = seriesList[i].datapoints;\n      const bottomSeries = seriesList[i - 1].datapoints;\n      if (!topSeries || !bottomSeries) {\n        throw new Error('Prometheus heatmap transform error: data should be a time series');\n      }\n\n      for (let j = 0; j < topSeries.length; j++) {\n        const bottomPoint = bottomSeries[j] || [0];\n        topSeries[j][0] -= bottomPoint[0];\n      }\n    }\n\n    return seriesList;\n  }\n}\n\nfunction sortSeriesByLabel(s1, s2): number {\n  let le1, le2;\n\n  try {\n    // fail if not integer. might happen with bad queries\n    le1 = parseHistogramLabel(s1.metric.le);\n    le2 = parseHistogramLabel(s2.metric.le);\n  } catch (err) {\n    console.log(err);\n    return 0;\n  }\n\n  if (le1 > le2) {\n    return 1;\n  }\n\n  if (le1 < le2) {\n    return -1;\n  }\n\n  return 0;\n}\n\nfunction parseHistogramLabel(le: string): number {\n  if (le === '+Inf') {\n    return +Infinity;\n  }\n  return Number(le);\n}\n","import _ from 'lodash';\n\nconst keywords = 'by|without|on|ignoring|group_left|group_right';\n\n// Duplicate from mode-prometheus.js, which can't be used in tests due to global ace not being loaded.\nconst builtInWords = [\n  keywords,\n  'count|count_values|min|max|avg|sum|stddev|stdvar|bottomk|topk|quantile',\n  'true|false|null|__name__|job',\n  'abs|absent|ceil|changes|clamp_max|clamp_min|count_scalar|day_of_month|day_of_week|days_in_month|delta|deriv',\n  'drop_common_labels|exp|floor|histogram_quantile|holt_winters|hour|idelta|increase|irate|label_replace|ln|log2',\n  'log10|minute|month|predict_linear|rate|resets|round|scalar|sort|sort_desc|sqrt|time|vector|year|avg_over_time',\n  'min_over_time|max_over_time|sum_over_time|count_over_time|quantile_over_time|stddev_over_time|stdvar_over_time',\n]\n  .join('|')\n  .split('|');\n\nconst metricNameRegexp = /([A-Za-z:][\\w:]*)\\b(?![\\(\\]{=!\",])/g;\nconst selectorRegexp = /{([^{]*)}/g;\n\n// addLabelToQuery('foo', 'bar', 'baz') => 'foo{bar=\"baz\"}'\nexport function addLabelToQuery(query: string, key: string, value: string, operator?: string): string {\n  if (!key || !value) {\n    throw new Error('Need label to add to query.');\n  }\n\n  // Add empty selectors to bare metric names\n  let previousWord;\n  query = query.replace(metricNameRegexp, (match, word, offset) => {\n    const insideSelector = isPositionInsideChars(query, offset, '{', '}');\n    // Handle \"sum by (key) (metric)\"\n    const previousWordIsKeyWord = previousWord && keywords.split('|').indexOf(previousWord) > -1;\n    previousWord = word;\n    if (!insideSelector && !previousWordIsKeyWord && builtInWords.indexOf(word) === -1) {\n      return `${word}{}`;\n    }\n    return word;\n  });\n\n  // Adding label to existing selectors\n  let match = selectorRegexp.exec(query);\n  const parts = [];\n  let lastIndex = 0;\n  let suffix = '';\n\n  while (match) {\n    const prefix = query.slice(lastIndex, match.index);\n    const selector = match[1];\n    const selectorWithLabel = addLabelToSelector(selector, key, value, operator);\n    lastIndex = match.index + match[1].length + 2;\n    suffix = query.slice(match.index + match[0].length);\n    parts.push(prefix, '{', selectorWithLabel, '}');\n    match = selectorRegexp.exec(query);\n  }\n\n  parts.push(suffix);\n  return parts.join('');\n}\n\nconst labelRegexp = /(\\w+)\\s*(=|!=|=~|!~)\\s*(\"[^\"]*\")/g;\n\nfunction addLabelToSelector(selector: string, labelKey: string, labelValue: string, labelOperator?: string) {\n  const parsedLabels = [];\n\n  // Split selector into labels\n  if (selector) {\n    let match = labelRegexp.exec(selector);\n    while (match) {\n      parsedLabels.push({ key: match[1], operator: match[2], value: match[3] });\n      match = labelRegexp.exec(selector);\n    }\n  }\n\n  // Add new label\n  const operatorForLabelKey = labelOperator || '=';\n  parsedLabels.push({ key: labelKey, operator: operatorForLabelKey, value: `\"${labelValue}\"` });\n\n  // Sort labels by key and put them together\n  return _.chain(parsedLabels)\n    .compact()\n    .sortBy('key')\n    .map(({ key, operator, value }) => `${key}${operator}${value}`)\n    .value()\n    .join(',');\n}\n\nfunction isPositionInsideChars(text: string, position: number, openChar: string, closeChar: string) {\n  const nextSelectorStart = text.slice(position).indexOf(openChar);\n  const nextSelectorEnd = text.slice(position).indexOf(closeChar);\n  return nextSelectorEnd > -1 && (nextSelectorStart === -1 || nextSelectorStart > nextSelectorEnd);\n}\n\nexport default addLabelToQuery;\n","import _ from 'lodash';\n\nimport $ from 'jquery';\nimport kbn from 'app/core/utils/kbn';\nimport * as dateMath from 'app/core/utils/datemath';\nimport PrometheusMetricFindQuery from './metric_find_query';\nimport { ResultTransformer } from './result_transformer';\nimport { BackendSrv } from 'app/core/services/backend_srv';\n\nimport addLabelToQuery from './add_label_to_query';\n\nexport function alignRange(start, end, step) {\n  const alignedEnd = Math.ceil(end / step) * step;\n  const alignedStart = Math.floor(start / step) * step;\n  return {\n    end: alignedEnd,\n    start: alignedStart,\n  };\n}\n\nexport function determineQueryHints(series: any[], datasource?: any): any[] {\n  const hints = series.map((s, i) => {\n    const query: string = s.query;\n    const index: number = s.responseIndex;\n    if (query === undefined || index === undefined) {\n      return null;\n    }\n\n    // ..._bucket metric needs a histogram_quantile()\n    const histogramMetric = query.trim().match(/^\\w+_bucket$/);\n    if (histogramMetric) {\n      const label = 'Time series has buckets, you probably wanted a histogram.';\n      return {\n        index,\n        label,\n        fix: {\n          label: 'Fix by adding histogram_quantile().',\n          action: {\n            type: 'ADD_HISTOGRAM_QUANTILE',\n            query,\n            index,\n          },\n        },\n      };\n    }\n\n    // Check for monotony\n    const datapoints: number[][] = s.datapoints;\n    if (query.indexOf('rate(') === -1 && datapoints.length > 1) {\n      let increasing = false;\n      const monotonic = datapoints.filter(dp => dp[0] !== null).every((dp, index) => {\n        if (index === 0) {\n          return true;\n        }\n        increasing = increasing || dp[0] > datapoints[index - 1][0];\n        // monotonic?\n        return dp[0] >= datapoints[index - 1][0];\n      });\n      if (increasing && monotonic) {\n        const simpleMetric = query.trim().match(/^\\w+$/);\n        let label = 'Time series is monotonously increasing.';\n        let fix;\n        if (simpleMetric) {\n          fix = {\n            label: 'Fix by adding rate().',\n            action: {\n              type: 'ADD_RATE',\n              query,\n              index,\n            },\n          };\n        } else {\n          label = `${label} Try applying a rate() function.`;\n        }\n        return {\n          label,\n          index,\n          fix,\n        };\n      }\n    }\n\n    // Check for recording rules expansion\n    if (datasource && datasource.ruleMappings) {\n      const mapping = datasource.ruleMappings;\n      const mappingForQuery = Object.keys(mapping).reduce((acc, ruleName) => {\n        if (query.search(ruleName) > -1) {\n          return {\n            ...acc,\n            [ruleName]: mapping[ruleName],\n          };\n        }\n        return acc;\n      }, {});\n      if (_.size(mappingForQuery) > 0) {\n        const label = 'Query contains recording rules.';\n        return {\n          label,\n          index,\n          fix: {\n            label: 'Expand rules',\n            action: {\n              type: 'EXPAND_RULES',\n              query,\n              index,\n              mapping: mappingForQuery,\n            },\n          },\n        };\n      }\n    }\n\n    // No hint found\n    return null;\n  });\n  return hints;\n}\n\nexport function extractRuleMappingFromGroups(groups: any[]) {\n  return groups.reduce(\n    (mapping, group) =>\n      group.rules.filter(rule => rule.type === 'recording').reduce(\n        (acc, rule) => ({\n          ...acc,\n          [rule.name]: rule.query,\n        }),\n        mapping\n      ),\n    {}\n  );\n}\n\nexport function prometheusRegularEscape(value) {\n  if (typeof value === 'string') {\n    return value.replace(/'/g, \"\\\\\\\\'\");\n  }\n  return value;\n}\n\nexport function prometheusSpecialRegexEscape(value) {\n  if (typeof value === 'string') {\n    return prometheusRegularEscape(value.replace(/\\\\/g, '\\\\\\\\\\\\\\\\').replace(/[$^*{}\\[\\]+?.()]/g, '\\\\\\\\$&'));\n  }\n  return value;\n}\n\nexport class PrometheusDatasource {\n  type: string;\n  editorSrc: string;\n  name: string;\n  ruleMappings: { [index: string]: string };\n  url: string;\n  directUrl: string;\n  basicAuth: any;\n  withCredentials: any;\n  metricsNameCache: any;\n  interval: string;\n  queryTimeout: string;\n  httpMethod: string;\n  resultTransformer: ResultTransformer;\n\n  /** @ngInject */\n  constructor(instanceSettings, private $q, private backendSrv: BackendSrv, private templateSrv, private timeSrv) {\n    this.type = 'prometheus';\n    this.editorSrc = 'app/features/prometheus/partials/query.editor.html';\n    this.name = instanceSettings.name;\n    this.url = instanceSettings.url;\n    this.directUrl = instanceSettings.directUrl;\n    this.basicAuth = instanceSettings.basicAuth;\n    this.withCredentials = instanceSettings.withCredentials;\n    this.interval = instanceSettings.jsonData.timeInterval || '15s';\n    this.queryTimeout = instanceSettings.jsonData.queryTimeout;\n    this.httpMethod = instanceSettings.jsonData.httpMethod || 'GET';\n    this.resultTransformer = new ResultTransformer(templateSrv);\n    this.ruleMappings = {};\n  }\n\n  init() {\n    this.loadRules();\n  }\n\n  _request(url, data?, options?: any) {\n    options = _.defaults(options || {}, {\n      url: this.url + url,\n      method: this.httpMethod,\n    });\n\n    if (options.method === 'GET') {\n      if (!_.isEmpty(data)) {\n        options.url =\n          options.url +\n          '?' +\n          _.map(data, (v, k) => {\n            return encodeURIComponent(k) + '=' + encodeURIComponent(v);\n          }).join('&');\n      }\n    } else {\n      options.headers = {\n        'Content-Type': 'application/x-www-form-urlencoded',\n      };\n      options.transformRequest = data => {\n        return $.param(data);\n      };\n      options.data = data;\n    }\n\n    if (this.basicAuth || this.withCredentials) {\n      options.withCredentials = true;\n    }\n\n    if (this.basicAuth) {\n      options.headers = {\n        Authorization: this.basicAuth,\n      };\n    }\n\n    return this.backendSrv.datasourceRequest(options);\n  }\n\n  // Use this for tab completion features, wont publish response to other components\n  metadataRequest(url) {\n    return this._request(url, null, { method: 'GET', silent: true });\n  }\n\n  interpolateQueryExpr(value, variable, defaultFormatFn) {\n    // if no multi or include all do not regexEscape\n    if (!variable.multi && !variable.includeAll) {\n      return prometheusRegularEscape(value);\n    }\n\n    if (typeof value === 'string') {\n      return prometheusSpecialRegexEscape(value);\n    }\n\n    const escapedValues = _.map(value, prometheusSpecialRegexEscape);\n    return escapedValues.join('|');\n  }\n\n  targetContainsTemplate(target) {\n    return this.templateSrv.variableExists(target.expr);\n  }\n\n  query(options) {\n    const start = this.getPrometheusTime(options.range.from, false);\n    const end = this.getPrometheusTime(options.range.to, true);\n\n    const queries = [];\n    const activeTargets = [];\n\n    options = _.clone(options);\n\n    for (const target of options.targets) {\n      if (!target.expr || target.hide) {\n        continue;\n      }\n\n      activeTargets.push(target);\n      queries.push(this.createQuery(target, options, start, end));\n    }\n\n    // No valid targets, return the empty result to save a round trip.\n    if (_.isEmpty(queries)) {\n      return this.$q.when({ data: [] });\n    }\n\n    const allQueryPromise = _.map(queries, query => {\n      if (!query.instant) {\n        return this.performTimeSeriesQuery(query, query.start, query.end);\n      } else {\n        return this.performInstantQuery(query, end);\n      }\n    });\n\n    return this.$q.all(allQueryPromise).then(responseList => {\n      let result = [];\n      let hints = [];\n\n      _.each(responseList, (response, index) => {\n        if (response.status === 'error') {\n          const error = {\n            index,\n            ...response.error,\n          };\n          throw error;\n        }\n\n        // Keeping original start/end for transformers\n        const transformerOptions = {\n          format: activeTargets[index].format,\n          step: queries[index].step,\n          legendFormat: activeTargets[index].legendFormat,\n          start: queries[index].start,\n          end: queries[index].end,\n          query: queries[index].expr,\n          responseListLength: responseList.length,\n          responseIndex: index,\n          refId: activeTargets[index].refId,\n        };\n        const series = this.resultTransformer.transform(response, transformerOptions);\n        result = [...result, ...series];\n\n        if (queries[index].hinting) {\n          const queryHints = determineQueryHints(series, this);\n          hints = [...hints, ...queryHints];\n        }\n      });\n\n      return { data: result, hints };\n    });\n  }\n\n  createQuery(target, options, start, end) {\n    const query: any = {\n      hinting: target.hinting,\n      instant: target.instant,\n    };\n    const range = Math.ceil(end - start);\n\n    let interval = kbn.interval_to_seconds(options.interval);\n    // Minimum interval (\"Min step\"), if specified for the query. or same as interval otherwise\n    const minInterval = kbn.interval_to_seconds(\n      this.templateSrv.replace(target.interval, options.scopedVars) || options.interval\n    );\n    const intervalFactor = target.intervalFactor || 1;\n    // Adjust the interval to take into account any specified minimum and interval factor plus Prometheus limits\n    const adjustedInterval = this.adjustInterval(interval, minInterval, range, intervalFactor);\n    let scopedVars = { ...options.scopedVars, ...this.getRangeScopedVars() };\n    // If the interval was adjusted, make a shallow copy of scopedVars with updated interval vars\n    if (interval !== adjustedInterval) {\n      interval = adjustedInterval;\n      scopedVars = Object.assign({}, options.scopedVars, {\n        __interval: { text: interval + 's', value: interval + 's' },\n        __interval_ms: { text: interval * 1000, value: interval * 1000 },\n        ...this.getRangeScopedVars(),\n      });\n    }\n    query.step = interval;\n\n    let expr = target.expr;\n\n    // Apply adhoc filters\n    const adhocFilters = this.templateSrv.getAdhocFilters(this.name);\n    expr = adhocFilters.reduce((acc, filter) => {\n      const { key, operator } = filter;\n      let { value } = filter;\n      if (operator === '=~' || operator === '!~') {\n        value = prometheusSpecialRegexEscape(value);\n      }\n      return addLabelToQuery(acc, key, value, operator);\n    }, expr);\n\n    // Only replace vars in expression after having (possibly) updated interval vars\n    query.expr = this.templateSrv.replace(expr, scopedVars, this.interpolateQueryExpr);\n    query.requestId = options.panelId + target.refId;\n\n    // Align query interval with step\n    const adjusted = alignRange(start, end, query.step);\n    query.start = adjusted.start;\n    query.end = adjusted.end;\n\n    return query;\n  }\n\n  adjustInterval(interval, minInterval, range, intervalFactor) {\n    // Prometheus will drop queries that might return more than 11000 data points.\n    // Calibrate interval if it is too small.\n    if (interval !== 0 && range / intervalFactor / interval > 11000) {\n      interval = Math.ceil(range / intervalFactor / 11000);\n    }\n    return Math.max(interval * intervalFactor, minInterval, 1);\n  }\n\n  performTimeSeriesQuery(query, start, end) {\n    if (start > end) {\n      throw { message: 'Invalid time range' };\n    }\n\n    const url = '/api/v1/query_range';\n    const data = {\n      query: query.expr,\n      start: start,\n      end: end,\n      step: query.step,\n    };\n    if (this.queryTimeout) {\n      data['timeout'] = this.queryTimeout;\n    }\n    return this._request(url, data, { requestId: query.requestId });\n  }\n\n  performInstantQuery(query, time) {\n    const url = '/api/v1/query';\n    const data = {\n      query: query.expr,\n      time: time,\n    };\n    if (this.queryTimeout) {\n      data['timeout'] = this.queryTimeout;\n    }\n    return this._request(url, data, { requestId: query.requestId });\n  }\n\n  performSuggestQuery(query, cache = false) {\n    const url = '/api/v1/label/__name__/values';\n\n    if (cache && this.metricsNameCache && this.metricsNameCache.expire > Date.now()) {\n      return this.$q.when(\n        _.filter(this.metricsNameCache.data, metricName => {\n          return metricName.indexOf(query) !== 1;\n        })\n      );\n    }\n\n    return this.metadataRequest(url).then(result => {\n      this.metricsNameCache = {\n        data: result.data.data,\n        expire: Date.now() + 60 * 1000,\n      };\n      return _.filter(result.data.data, metricName => {\n        return metricName.indexOf(query) !== 1;\n      });\n    });\n  }\n\n  metricFindQuery(query) {\n    if (!query) {\n      return this.$q.when([]);\n    }\n\n    const scopedVars = {\n      __interval: { text: this.interval, value: this.interval },\n      __interval_ms: { text: kbn.interval_to_ms(this.interval), value: kbn.interval_to_ms(this.interval) },\n      ...this.getRangeScopedVars(),\n    };\n    const interpolated = this.templateSrv.replace(query, scopedVars, this.interpolateQueryExpr);\n    const metricFindQuery = new PrometheusMetricFindQuery(this, interpolated, this.timeSrv);\n    return metricFindQuery.process();\n  }\n\n  getRangeScopedVars() {\n    const range = this.timeSrv.timeRange();\n    const msRange = range.to.diff(range.from);\n    const sRange = Math.round(msRange / 1000);\n    const regularRange = kbn.secondsToHms(msRange / 1000);\n    return {\n      __range_ms: { text: msRange, value: msRange },\n      __range_s: { text: sRange, value: sRange },\n      __range: { text: regularRange, value: regularRange },\n    };\n  }\n\n  annotationQuery(options) {\n    const annotation = options.annotation;\n    const expr = annotation.expr || '';\n    let tagKeys = annotation.tagKeys || '';\n    const titleFormat = annotation.titleFormat || '';\n    const textFormat = annotation.textFormat || '';\n\n    if (!expr) {\n      return this.$q.when([]);\n    }\n\n    const step = annotation.step || '60s';\n    const start = this.getPrometheusTime(options.range.from, false);\n    const end = this.getPrometheusTime(options.range.to, true);\n    // Unsetting min interval\n    const queryOptions = {\n      ...options,\n      interval: '0s',\n    };\n    const query = this.createQuery({ expr, interval: step }, queryOptions, start, end);\n\n    const self = this;\n    return this.performTimeSeriesQuery(query, query.start, query.end).then(results => {\n      const eventList = [];\n      tagKeys = tagKeys.split(',');\n\n      _.each(results.data.data.result, series => {\n        const tags = _.chain(series.metric)\n          .filter((v, k) => {\n            return _.includes(tagKeys, k);\n          })\n          .value();\n\n        for (const value of series.values) {\n          const valueIsTrue = value[1] === '1'; // e.g. ALERTS\n          if (valueIsTrue || annotation.useValueForTime) {\n            const event = {\n              annotation: annotation,\n              title: self.resultTransformer.renderTemplate(titleFormat, series.metric),\n              tags: tags,\n              text: self.resultTransformer.renderTemplate(textFormat, series.metric),\n            };\n\n            if (annotation.useValueForTime) {\n              event['time'] = Math.floor(parseFloat(value[1]));\n            } else {\n              event['time'] = Math.floor(parseFloat(value[0])) * 1000;\n            }\n\n            eventList.push(event);\n          }\n        }\n      });\n\n      return eventList;\n    });\n  }\n\n  testDatasource() {\n    const now = new Date().getTime();\n    return this.performInstantQuery({ expr: '1+1' }, now / 1000).then(response => {\n      if (response.data.status === 'success') {\n        return { status: 'success', message: 'Data source is working' };\n      } else {\n        return { status: 'error', message: response.error };\n      }\n    });\n  }\n\n  getExploreState(targets: any[]) {\n    let state = {};\n    if (targets && targets.length > 0) {\n      const queries = targets.map(t => ({\n        query: this.templateSrv.replace(t.expr, {}, this.interpolateQueryExpr),\n        format: t.format,\n      }));\n      state = {\n        ...state,\n        queries,\n        datasource: this.name,\n      };\n    }\n    return state;\n  }\n\n  loadRules() {\n    this.metadataRequest('/api/v1/rules')\n      .then(res => res.data || res.json())\n      .then(body => {\n        const groups = _.get(body, ['data', 'groups']);\n        if (groups) {\n          this.ruleMappings = extractRuleMappingFromGroups(groups);\n        }\n      })\n      .catch(e => {\n        console.log('Rules API is experimental. Ignore next error.');\n        console.error(e);\n      });\n  }\n\n  modifyQuery(query: string, action: any): string {\n    switch (action.type) {\n      case 'ADD_FILTER': {\n        return addLabelToQuery(query, action.key, action.value);\n      }\n      case 'ADD_HISTOGRAM_QUANTILE': {\n        return `histogram_quantile(0.95, sum(rate(${query}[5m])) by (le))`;\n      }\n      case 'ADD_RATE': {\n        return `rate(${query}[5m])`;\n      }\n      case 'EXPAND_RULES': {\n        const mapping = action.mapping;\n        if (mapping) {\n          const ruleNames = Object.keys(mapping);\n          const rulesRegex = new RegExp(`(\\\\s|^)(${ruleNames.join('|')})(\\\\s|$|\\\\()`, 'ig');\n          return query.replace(rulesRegex, (match, pre, name, post) => mapping[name]);\n        }\n      }\n      default:\n        return query;\n    }\n  }\n\n  getPrometheusTime(date, roundUp) {\n    if (_.isString(date)) {\n      date = dateMath.parse(date, roundUp);\n    }\n    return Math.ceil(date.valueOf() / 1000);\n  }\n\n  getTimeRange(): { start: number; end: number } {\n    const range = this.timeSrv.timeRange();\n    return {\n      start: this.getPrometheusTime(range.from, false),\n      end: this.getPrometheusTime(range.to, true),\n    };\n  }\n\n  getOriginalMetricName(labelData) {\n    return this.resultTransformer.getOriginalMetricName(labelData);\n  }\n}\n","export enum MetricKind {\n  METRIC_KIND_UNSPECIFIED = 'METRIC_KIND_UNSPECIFIED',\n  GAUGE = 'GAUGE',\n  DELTA = 'DELTA',\n  CUMULATIVE = 'CUMULATIVE',\n}\n\nexport enum ValueTypes {\n  VALUE_TYPE_UNSPECIFIED = 'VALUE_TYPE_UNSPECIFIED',\n  BOOL = 'BOOL',\n  INT64 = 'INT64',\n  DOUBLE = 'DOUBLE',\n  STRING = 'STRING',\n  DISTRIBUTION = 'DISTRIBUTION',\n  MONEY = 'MONEY',\n}\n\nexport const alignOptions = [\n  {\n    text: 'delta',\n    value: 'ALIGN_DELTA',\n    valueTypes: [ValueTypes.INT64, ValueTypes.DOUBLE, ValueTypes.MONEY, ValueTypes.DISTRIBUTION],\n    metricKinds: [MetricKind.CUMULATIVE, MetricKind.DELTA],\n  },\n  {\n    text: 'rate',\n    value: 'ALIGN_RATE',\n    valueTypes: [ValueTypes.INT64, ValueTypes.DOUBLE, ValueTypes.MONEY],\n    metricKinds: [MetricKind.CUMULATIVE, MetricKind.DELTA],\n  },\n  {\n    text: 'interpolate',\n    value: 'ALIGN_INTERPOLATE',\n    valueTypes: [ValueTypes.INT64, ValueTypes.DOUBLE, ValueTypes.MONEY],\n    metricKinds: [MetricKind.GAUGE],\n  },\n  {\n    text: 'next older',\n    value: 'ALIGN_NEXT_OLDER',\n    valueTypes: [\n      ValueTypes.INT64,\n      ValueTypes.DOUBLE,\n      ValueTypes.MONEY,\n      ValueTypes.DISTRIBUTION,\n      ValueTypes.STRING,\n      ValueTypes.VALUE_TYPE_UNSPECIFIED,\n      ValueTypes.BOOL,\n    ],\n    metricKinds: [MetricKind.GAUGE],\n  },\n  {\n    text: 'min',\n    value: 'ALIGN_MIN',\n    valueTypes: [ValueTypes.INT64, ValueTypes.DOUBLE, ValueTypes.MONEY],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: 'max',\n    value: 'ALIGN_MAX',\n    valueTypes: [ValueTypes.INT64, ValueTypes.DOUBLE, ValueTypes.MONEY],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: 'mean',\n    value: 'ALIGN_MEAN',\n    valueTypes: [ValueTypes.INT64, ValueTypes.DOUBLE, ValueTypes.MONEY],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: 'count',\n    value: 'ALIGN_COUNT',\n    valueTypes: [ValueTypes.INT64, ValueTypes.DOUBLE, ValueTypes.MONEY, ValueTypes.BOOL],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: 'sum',\n    value: 'ALIGN_SUM',\n    valueTypes: [ValueTypes.INT64, ValueTypes.DOUBLE, ValueTypes.MONEY, ValueTypes.DISTRIBUTION],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: 'stddev',\n    value: 'ALIGN_STDDEV',\n    valueTypes: [ValueTypes.INT64, ValueTypes.DOUBLE, ValueTypes.MONEY],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: 'count true',\n    value: 'ALIGN_COUNT_TRUE',\n    valueTypes: [ValueTypes.BOOL],\n    metricKinds: [MetricKind.GAUGE],\n  },\n  {\n    text: 'count false',\n    value: 'ALIGN_COUNT_FALSE',\n    valueTypes: [ValueTypes.BOOL],\n    metricKinds: [MetricKind.GAUGE],\n  },\n  {\n    text: 'fraction true',\n    value: 'ALIGN_FRACTION_TRUE',\n    valueTypes: [ValueTypes.BOOL],\n    metricKinds: [MetricKind.GAUGE],\n  },\n  {\n    text: 'percentile 99',\n    value: 'ALIGN_PERCENTILE_99',\n    valueTypes: [ValueTypes.DISTRIBUTION],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: 'percentile 95',\n    value: 'ALIGN_PERCENTILE_95',\n    valueTypes: [ValueTypes.DISTRIBUTION],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: 'percentile 50',\n    value: 'ALIGN_PERCENTILE_50',\n    valueTypes: [ValueTypes.DISTRIBUTION],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: 'percentile 05',\n    value: 'ALIGN_PERCENTILE_05',\n    valueTypes: [ValueTypes.DISTRIBUTION],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: 'percent change',\n    value: 'ALIGN_PERCENT_CHANGE',\n    valueTypes: [ValueTypes.INT64, ValueTypes.DOUBLE, ValueTypes.MONEY],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n];\n\nexport const aggOptions = [\n  {\n    text: 'none',\n    value: 'REDUCE_NONE',\n    valueTypes: [\n      ValueTypes.INT64,\n      ValueTypes.DOUBLE,\n      ValueTypes.MONEY,\n      ValueTypes.DISTRIBUTION,\n      ValueTypes.BOOL,\n      ValueTypes.STRING,\n    ],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA, MetricKind.CUMULATIVE, MetricKind.METRIC_KIND_UNSPECIFIED],\n  },\n  {\n    text: 'mean',\n    value: 'REDUCE_MEAN',\n    valueTypes: [ValueTypes.INT64, ValueTypes.DOUBLE, ValueTypes.MONEY],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: 'min',\n    value: 'REDUCE_MIN',\n    valueTypes: [ValueTypes.INT64, ValueTypes.DOUBLE, ValueTypes.MONEY],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: 'max',\n    value: 'REDUCE_MAX',\n    valueTypes: [ValueTypes.INT64, ValueTypes.DOUBLE, ValueTypes.MONEY],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: 'sum',\n    value: 'REDUCE_SUM',\n    valueTypes: [ValueTypes.INT64, ValueTypes.DOUBLE, ValueTypes.MONEY, ValueTypes.DISTRIBUTION],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: 'std. dev.',\n    value: 'REDUCE_STDDEV',\n    valueTypes: [ValueTypes.INT64, ValueTypes.DOUBLE, ValueTypes.MONEY, ValueTypes.DISTRIBUTION],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: 'count',\n    value: 'REDUCE_COUNT',\n    valueTypes: [\n      ValueTypes.INT64,\n      ValueTypes.DOUBLE,\n      ValueTypes.MONEY,\n      ValueTypes.DISTRIBUTION,\n      ValueTypes.BOOL,\n      ValueTypes.STRING,\n    ],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: 'count true',\n    value: 'REDUCE_COUNT_TRUE',\n    valueTypes: [ValueTypes.BOOL],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: 'count false',\n    value: 'REDUCE_COUNT_FALSE',\n    valueTypes: [ValueTypes.BOOL],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: '99th percentile',\n    value: 'REDUCE_PERCENTILE_99',\n    valueTypes: [ValueTypes.INT64, ValueTypes.DOUBLE, ValueTypes.MONEY, ValueTypes.DISTRIBUTION],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: '95th percentile',\n    value: 'REDUCE_PERCENTILE_95',\n    valueTypes: [ValueTypes.INT64, ValueTypes.DOUBLE, ValueTypes.MONEY, ValueTypes.DISTRIBUTION],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: '50th percentile',\n    value: 'REDUCE_PERCENTILE_50',\n    valueTypes: [ValueTypes.INT64, ValueTypes.DOUBLE, ValueTypes.MONEY, ValueTypes.DISTRIBUTION],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n  {\n    text: '5th percentile',\n    value: 'REDUCE_PERCENTILE_05',\n    valueTypes: [ValueTypes.INT64, ValueTypes.DOUBLE, ValueTypes.MONEY, ValueTypes.DISTRIBUTION],\n    metricKinds: [MetricKind.GAUGE, MetricKind.DELTA],\n  },\n];\n\nexport const alignmentPeriods = [\n  { text: 'grafana auto', value: 'grafana-auto' },\n  { text: 'stackdriver auto', value: 'stackdriver-auto' },\n  { text: '1m', value: '+60s' },\n  { text: '5m', value: '+300s' },\n  { text: '30m', value: '+1800s' },\n  { text: '1h', value: '+3600s' },\n  { text: '6h', value: '+21600s' },\n  { text: '1d', value: '+86400s' },\n  { text: '1w', value: '+604800s' },\n];\n\nexport const stackdriverUnitMappings = {\n  bit: 'bits',\n  By: 'bytes',\n  s: 's',\n  min: 'm',\n  h: 'h',\n  d: 'd',\n  us: 'µs',\n  ms: 'ms',\n  ns: 'ns',\n  percent: 'percent',\n  MiBy: 'mbytes',\n  'By/s': 'Bps',\n  GBy: 'decgbytes',\n};\n","import { PrometheusDatasource } from './datasource';\nimport _ from 'lodash';\n\nexport class PromCompleter {\n  labelQueryCache: any;\n  labelNameCache: any;\n  labelValueCache: any;\n  templateVariableCompletions: any;\n\n  identifierRegexps = [/\\[/, /[a-zA-Z0-9_:]/];\n\n  constructor(private datasource: PrometheusDatasource, private templateSrv) {\n    this.labelQueryCache = {};\n    this.labelNameCache = {};\n    this.labelValueCache = {};\n    this.templateVariableCompletions = this.templateSrv.variables.map(variable => {\n      return {\n        caption: '$' + variable.name,\n        value: '$' + variable.name,\n        meta: 'variable',\n        score: Number.MAX_VALUE,\n      };\n    });\n  }\n\n  getCompletions(editor, session, pos, prefix, callback) {\n    const wrappedCallback = (err, completions) => {\n      completions = completions.concat(this.templateVariableCompletions);\n      return callback(err, completions);\n    };\n\n    const token = session.getTokenAt(pos.row, pos.column);\n\n    switch (token.type) {\n      case 'entity.name.tag.label-matcher':\n        this.getCompletionsForLabelMatcherName(session, pos).then(completions => {\n          wrappedCallback(null, completions);\n        });\n        return;\n      case 'string.quoted.label-matcher':\n        this.getCompletionsForLabelMatcherValue(session, pos).then(completions => {\n          wrappedCallback(null, completions);\n        });\n        return;\n      case 'entity.name.tag.label-list-matcher':\n        this.getCompletionsForBinaryOperator(session, pos).then(completions => {\n          wrappedCallback(null, completions);\n        });\n        return;\n    }\n\n    if (token.type === 'paren.lparen' && token.value === '[') {\n      const vectors = [];\n      for (const unit of ['s', 'm', 'h']) {\n        for (const value of [1, 5, 10, 30]) {\n          vectors.push({\n            caption: value + unit,\n            value: '[' + value + unit,\n            meta: 'range vector',\n          });\n        }\n      }\n\n      vectors.unshift({\n        caption: '$__interval_ms',\n        value: '[$__interval_ms',\n        meta: 'range vector',\n      });\n\n      vectors.unshift({\n        caption: '$__interval',\n        value: '[$__interval',\n        meta: 'range vector',\n      });\n\n      wrappedCallback(null, vectors);\n      return;\n    }\n\n    const query = prefix;\n\n    return this.datasource.performSuggestQuery(query, true).then(metricNames => {\n      wrappedCallback(\n        null,\n        metricNames.map(name => {\n          let value = name;\n          if (prefix === '(') {\n            value = '(' + name;\n          }\n\n          return {\n            caption: name,\n            value: value,\n            meta: 'metric',\n          };\n        })\n      );\n    });\n  }\n\n  getCompletionsForLabelMatcherName(session, pos) {\n    const metricName = this.findMetricName(session, pos.row, pos.column);\n    if (!metricName) {\n      return Promise.resolve(this.transformToCompletions(['__name__', 'instance', 'job'], 'label name'));\n    }\n\n    if (this.labelNameCache[metricName]) {\n      return Promise.resolve(this.labelNameCache[metricName]);\n    }\n\n    return this.getLabelNameAndValueForExpression(metricName, 'metricName').then(result => {\n      const labelNames = this.transformToCompletions(\n        _.uniq(\n          _.flatten(\n            result.map(r => {\n              return Object.keys(r);\n            })\n          )\n        ),\n        'label name'\n      );\n      this.labelNameCache[metricName] = labelNames;\n      return Promise.resolve(labelNames);\n    });\n  }\n\n  getCompletionsForLabelMatcherValue(session, pos) {\n    const metricName = this.findMetricName(session, pos.row, pos.column);\n    if (!metricName) {\n      return Promise.resolve([]);\n    }\n\n    const labelNameToken = this.findToken(\n      session,\n      pos.row,\n      pos.column,\n      'entity.name.tag.label-matcher',\n      null,\n      'paren.lparen.label-matcher'\n    );\n    if (!labelNameToken) {\n      return Promise.resolve([]);\n    }\n    const labelName = labelNameToken.value;\n\n    if (this.labelValueCache[metricName] && this.labelValueCache[metricName][labelName]) {\n      return Promise.resolve(this.labelValueCache[metricName][labelName]);\n    }\n\n    return this.getLabelNameAndValueForExpression(metricName, 'metricName').then(result => {\n      const labelValues = this.transformToCompletions(\n        _.uniq(\n          result.map(r => {\n            return r[labelName];\n          })\n        ),\n        'label value'\n      );\n      this.labelValueCache[metricName] = this.labelValueCache[metricName] || {};\n      this.labelValueCache[metricName][labelName] = labelValues;\n      return Promise.resolve(labelValues);\n    });\n  }\n\n  getCompletionsForBinaryOperator(session, pos) {\n    const keywordOperatorToken = this.findToken(session, pos.row, pos.column, 'keyword.control', null, 'identifier');\n    if (!keywordOperatorToken) {\n      return Promise.resolve([]);\n    }\n    let rparenToken, expr;\n    switch (keywordOperatorToken.value) {\n      case 'by':\n      case 'without':\n        rparenToken = this.findToken(\n          session,\n          keywordOperatorToken.row,\n          keywordOperatorToken.column,\n          'paren.rparen',\n          null,\n          'identifier'\n        );\n        if (!rparenToken) {\n          return Promise.resolve([]);\n        }\n        expr = this.findExpressionMatchedParen(session, rparenToken.row, rparenToken.column);\n        if (expr === '') {\n          return Promise.resolve([]);\n        }\n        return this.getLabelNameAndValueForExpression(expr, 'expression').then(result => {\n          const labelNames = this.transformToCompletions(\n            _.uniq(\n              _.flatten(\n                result.map(r => {\n                  return Object.keys(r);\n                })\n              )\n            ),\n            'label name'\n          );\n          this.labelNameCache[expr] = labelNames;\n          return labelNames;\n        });\n      case 'on':\n      case 'ignoring':\n      case 'group_left':\n      case 'group_right':\n        const binaryOperatorToken = this.findToken(\n          session,\n          keywordOperatorToken.row,\n          keywordOperatorToken.column,\n          'keyword.operator.binary',\n          null,\n          'identifier'\n        );\n        if (!binaryOperatorToken) {\n          return Promise.resolve([]);\n        }\n        rparenToken = this.findToken(\n          session,\n          binaryOperatorToken.row,\n          binaryOperatorToken.column,\n          'paren.rparen',\n          null,\n          'identifier'\n        );\n        if (rparenToken) {\n          expr = this.findExpressionMatchedParen(session, rparenToken.row, rparenToken.column);\n          if (expr === '') {\n            return Promise.resolve([]);\n          }\n          return this.getLabelNameAndValueForExpression(expr, 'expression').then(result => {\n            const labelNames = this.transformToCompletions(\n              _.uniq(\n                _.flatten(\n                  result.map(r => {\n                    return Object.keys(r);\n                  })\n                )\n              ),\n              'label name'\n            );\n            this.labelNameCache[expr] = labelNames;\n            return labelNames;\n          });\n        } else {\n          const metricName = this.findMetricName(session, binaryOperatorToken.row, binaryOperatorToken.column);\n          return this.getLabelNameAndValueForExpression(metricName, 'metricName').then(result => {\n            const labelNames = this.transformToCompletions(\n              _.uniq(\n                _.flatten(\n                  result.map(r => {\n                    return Object.keys(r);\n                  })\n                )\n              ),\n              'label name'\n            );\n            this.labelNameCache[metricName] = labelNames;\n            return Promise.resolve(labelNames);\n          });\n        }\n    }\n\n    return Promise.resolve([]);\n  }\n\n  getLabelNameAndValueForExpression(expr: string, type: string): Promise<any> {\n    if (this.labelQueryCache[expr]) {\n      return Promise.resolve(this.labelQueryCache[expr]);\n    }\n    let query = expr;\n    if (type === 'metricName') {\n      let op = '=~';\n      if (/[a-zA-Z_:][a-zA-Z0-9_:]*/.test(expr)) {\n        op = '=';\n      }\n      query = '{__name__' + op + '\"' + expr + '\"}';\n    }\n    const { start, end } = this.datasource.getTimeRange();\n    const url = '/api/v1/series?match[]=' + encodeURIComponent(query) + '&start=' + start + '&end=' + end;\n    return this.datasource.metadataRequest(url).then(response => {\n      this.labelQueryCache[expr] = response.data.data;\n      return response.data.data;\n    });\n  }\n\n  transformToCompletions(words, meta) {\n    return words.map(name => {\n      return {\n        caption: name,\n        value: name,\n        meta: meta,\n        score: Number.MAX_VALUE,\n      };\n    });\n  }\n\n  findMetricName(session, row, column) {\n    let metricName = '';\n\n    let tokens;\n    const nameLabelNameToken = this.findToken(\n      session,\n      row,\n      column,\n      'entity.name.tag.label-matcher',\n      '__name__',\n      'paren.lparen.label-matcher'\n    );\n    if (nameLabelNameToken) {\n      tokens = session.getTokens(nameLabelNameToken.row);\n      const nameLabelValueToken = tokens[nameLabelNameToken.index + 2];\n      if (nameLabelValueToken && nameLabelValueToken.type === 'string.quoted.label-matcher') {\n        metricName = nameLabelValueToken.value.slice(1, -1); // cut begin/end quotation\n      }\n    } else {\n      const metricNameToken = this.findToken(session, row, column, 'identifier', null, null);\n      if (metricNameToken) {\n        tokens = session.getTokens(metricNameToken.row);\n        metricName = metricNameToken.value;\n      }\n    }\n\n    return metricName;\n  }\n\n  findToken(session, row, column, target, value, guard) {\n    let tokens, idx;\n    // find index and get column of previous token\n    for (let r = row; r >= 0; r--) {\n      let c;\n      tokens = session.getTokens(r);\n      if (r === row) {\n        // current row\n        c = 0;\n        for (idx = 0; idx < tokens.length; idx++) {\n          const nc = c + tokens[idx].value.length;\n          if (nc >= column) {\n            break;\n          }\n          c = nc;\n        }\n      } else {\n        idx = tokens.length - 1;\n        c =\n          _.sum(\n            tokens.map(t => {\n              return t.value.length;\n            })\n          ) - tokens[tokens.length - 1].value.length;\n      }\n\n      for (; idx >= 0; idx--) {\n        if (tokens[idx].type === guard) {\n          return null;\n        }\n\n        if (tokens[idx].type === target && (!value || tokens[idx].value === value)) {\n          tokens[idx].row = r;\n          tokens[idx].column = c;\n          tokens[idx].index = idx;\n          return tokens[idx];\n        }\n        c -= tokens[idx].value.length;\n      }\n    }\n\n    return null;\n  }\n\n  findExpressionMatchedParen(session, row, column) {\n    let tokens, idx;\n    let deep = 1;\n    let expression = ')';\n    for (let r = row; r >= 0; r--) {\n      tokens = session.getTokens(r);\n      if (r === row) {\n        // current row\n        let c = 0;\n        for (idx = 0; idx < tokens.length; idx++) {\n          c += tokens[idx].value.length;\n          if (c >= column) {\n            break;\n          }\n        }\n      } else {\n        idx = tokens.length - 1;\n      }\n\n      for (; idx >= 0; idx--) {\n        expression = tokens[idx].value + expression;\n        if (tokens[idx].type === 'paren.rparen') {\n          deep++;\n        } else if (tokens[idx].type === 'paren.lparen') {\n          deep--;\n          if (deep === 0) {\n            return expression;\n          }\n        }\n      }\n    }\n\n    return expression;\n  }\n}\n","import angular from 'angular';\nimport _ from 'lodash';\nimport { QueryCtrl } from 'app/plugins/sdk';\nimport { PromCompleter } from './completer';\nimport './mode-prometheus';\nimport './snippets/prometheus';\n\nclass PrometheusQueryCtrl extends QueryCtrl {\n  static templateUrl = 'partials/query.editor.html';\n\n  metric: any;\n  resolutions: any;\n  formats: any;\n  instant: any;\n  oldTarget: any;\n  suggestMetrics: any;\n  getMetricsAutocomplete: any;\n  linkToPrometheus: any;\n\n  /** @ngInject */\n  constructor($scope, $injector, private templateSrv) {\n    super($scope, $injector);\n\n    const target = this.target;\n    target.expr = target.expr || '';\n    target.intervalFactor = target.intervalFactor || 1;\n    target.format = target.format || this.getDefaultFormat();\n\n    this.metric = '';\n    this.resolutions = _.map([1, 2, 3, 4, 5, 10], f => {\n      return { factor: f, label: '1/' + f };\n    });\n\n    this.formats = [\n      { text: 'Time series', value: 'time_series' },\n      { text: 'Table', value: 'table' },\n      { text: 'Heatmap', value: 'heatmap' },\n    ];\n\n    this.instant = false;\n\n    this.updateLink();\n  }\n\n  getCompleter(query) {\n    return new PromCompleter(this.datasource, this.templateSrv);\n  }\n\n  getDefaultFormat() {\n    if (this.panelCtrl.panel.type === 'table') {\n      return 'table';\n    } else if (this.panelCtrl.panel.type === 'heatmap') {\n      return 'heatmap';\n    }\n\n    return 'time_series';\n  }\n\n  refreshMetricData() {\n    if (!_.isEqual(this.oldTarget, this.target)) {\n      this.oldTarget = angular.copy(this.target);\n      this.panelCtrl.refresh();\n      this.updateLink();\n    }\n  }\n\n  updateLink() {\n    const range = this.panelCtrl.range;\n    if (!range) {\n      return;\n    }\n\n    const rangeDiff = Math.ceil((range.to.valueOf() - range.from.valueOf()) / 1000);\n    const endTime = range.to.utc().format('YYYY-MM-DD HH:mm');\n    const expr = {\n      'g0.expr': this.templateSrv.replace(\n        this.target.expr,\n        this.panelCtrl.panel.scopedVars,\n        this.datasource.interpolateQueryExpr\n      ),\n      'g0.range_input': rangeDiff + 's',\n      'g0.end_input': endTime,\n      'g0.step_input': this.target.step,\n      'g0.stacked': this.panelCtrl.panel.stack ? 1 : 0,\n      'g0.tab': 0,\n    };\n    const args = _.map(expr, (v, k) => {\n      return k + '=' + encodeURIComponent(v);\n    }).join('&');\n    this.linkToPrometheus = this.datasource.directUrl + '/graph?' + args;\n  }\n\n  getCollapsedText() {\n    return this.target.expr;\n  }\n}\n\nexport { PrometheusQueryCtrl };\n","export class PrometheusConfigCtrl {\n  static templateUrl = 'public/app/plugins/datasource/prometheus/partials/config.html';\n  current: any;\n\n  /** @ngInject */\n  constructor($scope) {\n    this.current.jsonData.httpMethod = this.current.jsonData.httpMethod || 'GET';\n  }\n}\n","import { PrometheusDatasource } from './datasource';\nimport { PrometheusQueryCtrl } from './query_ctrl';\nimport { PrometheusConfigCtrl } from './config_ctrl';\n\nclass PrometheusAnnotationsQueryCtrl {\n  static templateUrl = 'partials/annotations.editor.html';\n}\n\nexport {\n  PrometheusDatasource as Datasource,\n  PrometheusQueryCtrl as QueryCtrl,\n  PrometheusConfigCtrl as ConfigCtrl,\n  PrometheusAnnotationsQueryCtrl as AnnotationsQueryCtrl,\n};\n","import _ from 'lodash';\n\nexport default class ResponseParser {\n  constructor(private $q) {}\n\n  processQueryResult(res) {\n    const data = [];\n\n    if (!res.data.results) {\n      return { data: data };\n    }\n\n    for (const key in res.data.results) {\n      const queryRes = res.data.results[key];\n\n      if (queryRes.series) {\n        for (const series of queryRes.series) {\n          data.push({\n            target: series.name,\n            datapoints: series.points,\n            refId: queryRes.refId,\n            meta: queryRes.meta,\n          });\n        }\n      }\n\n      if (queryRes.tables) {\n        for (const table of queryRes.tables) {\n          table.type = 'table';\n          table.refId = queryRes.refId;\n          table.meta = queryRes.meta;\n          data.push(table);\n        }\n      }\n    }\n\n    return { data: data };\n  }\n\n  parseMetricFindQueryResult(refId, results) {\n    if (!results || results.data.length === 0 || results.data.results[refId].meta.rowCount === 0) {\n      return [];\n    }\n\n    const columns = results.data.results[refId].tables[0].columns;\n    const rows = results.data.results[refId].tables[0].rows;\n    const textColIndex = this.findColIndex(columns, '__text');\n    const valueColIndex = this.findColIndex(columns, '__value');\n\n    if (columns.length === 2 && textColIndex !== -1 && valueColIndex !== -1) {\n      return this.transformToKeyValueList(rows, textColIndex, valueColIndex);\n    }\n\n    return this.transformToSimpleList(rows);\n  }\n\n  transformToKeyValueList(rows, textColIndex, valueColIndex) {\n    const res = [];\n\n    for (let i = 0; i < rows.length; i++) {\n      if (!this.containsKey(res, rows[i][textColIndex])) {\n        res.push({ text: rows[i][textColIndex], value: rows[i][valueColIndex] });\n      }\n    }\n\n    return res;\n  }\n\n  transformToSimpleList(rows) {\n    const res = [];\n\n    for (let i = 0; i < rows.length; i++) {\n      for (let j = 0; j < rows[i].length; j++) {\n        const value = rows[i][j];\n        if (res.indexOf(value) === -1) {\n          res.push(value);\n        }\n      }\n    }\n\n    return _.map(res, value => {\n      return { text: value };\n    });\n  }\n\n  findColIndex(columns, colName) {\n    for (let i = 0; i < columns.length; i++) {\n      if (columns[i].text === colName) {\n        return i;\n      }\n    }\n\n    return -1;\n  }\n\n  containsKey(res, key) {\n    for (let i = 0; i < res.length; i++) {\n      if (res[i].text === key) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  transformAnnotationResponse(options, data) {\n    const table = data.data.results[options.annotation.name].tables[0];\n\n    let timeColumnIndex = -1;\n    let textColumnIndex = -1;\n    let tagsColumnIndex = -1;\n\n    for (let i = 0; i < table.columns.length; i++) {\n      if (table.columns[i].text === 'time') {\n        timeColumnIndex = i;\n      } else if (table.columns[i].text === 'text') {\n        textColumnIndex = i;\n      } else if (table.columns[i].text === 'tags') {\n        tagsColumnIndex = i;\n      }\n    }\n\n    if (timeColumnIndex === -1) {\n      return this.$q.reject({ message: 'Missing mandatory time column (with time column alias) in annotation query.' });\n    }\n\n    const list = [];\n    for (let i = 0; i < table.rows.length; i++) {\n      const row = table.rows[i];\n      list.push({\n        annotation: options.annotation,\n        time: Math.floor(row[timeColumnIndex]),\n        text: row[textColumnIndex],\n        tags: row[tagsColumnIndex] ? row[tagsColumnIndex].trim().split(/\\s*,\\s*/) : [],\n      });\n    }\n\n    return list;\n  }\n}\n","import _ from 'lodash';\nimport ResponseParser from './response_parser';\n\nexport class MssqlDatasource {\n  id: any;\n  name: any;\n  responseParser: ResponseParser;\n  interval: string;\n\n  /** @ngInject */\n  constructor(instanceSettings, private backendSrv, private $q, private templateSrv) {\n    this.name = instanceSettings.name;\n    this.id = instanceSettings.id;\n    this.responseParser = new ResponseParser(this.$q);\n    this.interval = (instanceSettings.jsonData || {}).timeInterval;\n  }\n\n  interpolateVariable(value, variable) {\n    if (typeof value === 'string') {\n      if (variable.multi || variable.includeAll) {\n        return \"'\" + value.replace(/'/g, `''`) + \"'\";\n      } else {\n        return value;\n      }\n    }\n\n    if (typeof value === 'number') {\n      return value;\n    }\n\n    const quotedValues = _.map(value, val => {\n      if (typeof value === 'number') {\n        return value;\n      }\n\n      return \"'\" + val.replace(/'/g, `''`) + \"'\";\n    });\n    return quotedValues.join(',');\n  }\n\n  query(options) {\n    const queries = _.filter(options.targets, item => {\n      return item.hide !== true;\n    }).map(item => {\n      return {\n        refId: item.refId,\n        intervalMs: options.intervalMs,\n        maxDataPoints: options.maxDataPoints,\n        datasourceId: this.id,\n        rawSql: this.templateSrv.replace(item.rawSql, options.scopedVars, this.interpolateVariable),\n        format: item.format,\n      };\n    });\n\n    if (queries.length === 0) {\n      return this.$q.when({ data: [] });\n    }\n\n    return this.backendSrv\n      .datasourceRequest({\n        url: '/api/tsdb/query',\n        method: 'POST',\n        data: {\n          from: options.range.from.valueOf().toString(),\n          to: options.range.to.valueOf().toString(),\n          queries: queries,\n        },\n      })\n      .then(this.responseParser.processQueryResult);\n  }\n\n  annotationQuery(options) {\n    if (!options.annotation.rawQuery) {\n      return this.$q.reject({ message: 'Query missing in annotation definition' });\n    }\n\n    const query = {\n      refId: options.annotation.name,\n      datasourceId: this.id,\n      rawSql: this.templateSrv.replace(options.annotation.rawQuery, options.scopedVars, this.interpolateVariable),\n      format: 'table',\n    };\n\n    return this.backendSrv\n      .datasourceRequest({\n        url: '/api/tsdb/query',\n        method: 'POST',\n        data: {\n          from: options.range.from.valueOf().toString(),\n          to: options.range.to.valueOf().toString(),\n          queries: [query],\n        },\n      })\n      .then(data => this.responseParser.transformAnnotationResponse(options, data));\n  }\n\n  metricFindQuery(query, optionalOptions) {\n    let refId = 'tempvar';\n    if (optionalOptions && optionalOptions.variable && optionalOptions.variable.name) {\n      refId = optionalOptions.variable.name;\n    }\n\n    const interpolatedQuery = {\n      refId: refId,\n      datasourceId: this.id,\n      rawSql: this.templateSrv.replace(query, {}, this.interpolateVariable),\n      format: 'table',\n    };\n\n    return this.backendSrv\n      .datasourceRequest({\n        url: '/api/tsdb/query',\n        method: 'POST',\n        data: {\n          queries: [interpolatedQuery],\n        },\n      })\n      .then(data => this.responseParser.parseMetricFindQueryResult(refId, data));\n  }\n\n  testDatasource() {\n    return this.backendSrv\n      .datasourceRequest({\n        url: '/api/tsdb/query',\n        method: 'POST',\n        data: {\n          from: '5m',\n          to: 'now',\n          queries: [\n            {\n              refId: 'A',\n              intervalMs: 1,\n              maxDataPoints: 1,\n              datasourceId: this.id,\n              rawSql: 'SELECT 1',\n              format: 'table',\n            },\n          ],\n        },\n      })\n      .then(res => {\n        return { status: 'success', message: 'Database Connection OK' };\n      })\n      .catch(err => {\n        console.log(err);\n        if (err.data && err.data.message) {\n          return { status: 'error', message: err.data.message };\n        } else {\n          return { status: 'error', message: err.status };\n        }\n      });\n  }\n}\n","import { MssqlDatasource } from './datasource';\nimport { MssqlQueryCtrl } from './query_ctrl';\n\nclass MssqlConfigCtrl {\n  static templateUrl = 'partials/config.html';\n}\n\nconst defaultQuery = `SELECT\n    <time_column> as time,\n    <text_column> as text,\n    <tags_column> as tags\n  FROM\n    <table name>\n  WHERE\n    $__timeFilter(time_column)\n  ORDER BY\n    <time_column> ASC`;\n\nclass MssqlAnnotationsQueryCtrl {\n  static templateUrl = 'partials/annotations.editor.html';\n\n  annotation: any;\n\n  /** @ngInject */\n  constructor() {\n    this.annotation.rawQuery = this.annotation.rawQuery || defaultQuery;\n  }\n}\n\nexport {\n  MssqlDatasource,\n  MssqlDatasource as Datasource,\n  MssqlQueryCtrl as QueryCtrl,\n  MssqlConfigCtrl as ConfigCtrl,\n  MssqlAnnotationsQueryCtrl as AnnotationsQueryCtrl,\n};\n","import _ from 'lodash';\nimport { QueryCtrl } from 'app/plugins/sdk';\n\nexport interface MssqlQuery {\n  refId: string;\n  format: string;\n  alias: string;\n  rawSql: string;\n}\n\nexport interface QueryMeta {\n  sql: string;\n}\n\nconst defaultQuery = `SELECT\n  $__timeEpoch(<time_column>),\n  <value column> as value,\n  <series name column> as metric\nFROM\n  <table name>\nWHERE\n  $__timeFilter(time_column)\nORDER BY\n  <time_column> ASC`;\n\nexport class MssqlQueryCtrl extends QueryCtrl {\n  static templateUrl = 'partials/query.editor.html';\n\n  showLastQuerySQL: boolean;\n  formats: any[];\n  target: MssqlQuery;\n  lastQueryMeta: QueryMeta;\n  lastQueryError: string;\n  showHelp: boolean;\n\n  /** @ngInject */\n  constructor($scope, $injector) {\n    super($scope, $injector);\n\n    this.target.format = this.target.format || 'time_series';\n    this.target.alias = '';\n    this.formats = [{ text: 'Time series', value: 'time_series' }, { text: 'Table', value: 'table' }];\n\n    if (!this.target.rawSql) {\n      // special handling when in table panel\n      if (this.panelCtrl.panel.type === 'table') {\n        this.target.format = 'table';\n        this.target.rawSql = 'SELECT 1';\n      } else {\n        this.target.rawSql = defaultQuery;\n      }\n    }\n\n    this.panelCtrl.events.on('data-received', this.onDataReceived.bind(this), $scope);\n    this.panelCtrl.events.on('data-error', this.onDataError.bind(this), $scope);\n  }\n\n  onDataReceived(dataList) {\n    this.lastQueryMeta = null;\n    this.lastQueryError = null;\n\n    const anySeriesFromQuery = _.find(dataList, { refId: this.target.refId });\n    if (anySeriesFromQuery) {\n      this.lastQueryMeta = anySeriesFromQuery.meta;\n    }\n  }\n\n  onDataError(err) {\n    if (err.data && err.data.results) {\n      const queryRes = err.data.results[this.target.refId];\n      if (queryRes) {\n        this.lastQueryMeta = queryRes.meta;\n        this.lastQueryError = queryRes.error;\n      }\n    }\n  }\n}\n","import _ from 'lodash';\n\nclass TestDataDatasource {\n  id: any;\n\n  /** @ngInject */\n  constructor(instanceSettings, private backendSrv, private $q) {\n    this.id = instanceSettings.id;\n  }\n\n  query(options) {\n    const queries = _.filter(options.targets, item => {\n      return item.hide !== true;\n    }).map(item => {\n      return {\n        refId: item.refId,\n        scenarioId: item.scenarioId,\n        intervalMs: options.intervalMs,\n        maxDataPoints: options.maxDataPoints,\n        stringInput: item.stringInput,\n        points: item.points,\n        alias: item.alias,\n        datasourceId: this.id,\n      };\n    });\n\n    if (queries.length === 0) {\n      return this.$q.when({ data: [] });\n    }\n\n    return this.backendSrv\n      .post('/api/tsdb/query', {\n        from: options.range.from.valueOf().toString(),\n        to: options.range.to.valueOf().toString(),\n        queries: queries,\n      })\n      .then(res => {\n        const data = [];\n\n        if (res.results) {\n          _.forEach(res.results, queryRes => {\n            for (const series of queryRes.series) {\n              data.push({\n                target: series.name,\n                datapoints: series.points,\n              });\n            }\n          });\n        }\n\n        return { data: data };\n      });\n  }\n\n  annotationQuery(options) {\n    return this.backendSrv.get('/api/annotations', {\n      from: options.range.from.valueOf(),\n      to: options.range.to.valueOf(),\n      limit: options.limit,\n      type: options.type,\n    });\n  }\n}\n\nexport { TestDataDatasource };\n","import _ from 'lodash';\n\nimport { QueryCtrl } from 'app/plugins/sdk';\nimport moment from 'moment';\n\nexport class TestDataQueryCtrl extends QueryCtrl {\n  static templateUrl = 'partials/query.editor.html';\n\n  scenarioList: any;\n  scenario: any;\n  newPointValue: number;\n  newPointTime: any;\n  selectedPoint: any;\n\n  /** @ngInject */\n  constructor($scope, $injector, private backendSrv) {\n    super($scope, $injector);\n\n    this.target.scenarioId = this.target.scenarioId || 'random_walk';\n    this.scenarioList = [];\n    this.newPointTime = moment();\n    this.selectedPoint = { text: 'Select point', value: null };\n  }\n\n  getPoints() {\n    return _.map(this.target.points, (point, index) => {\n      return {\n        text: moment(point[1]).format('MMMM Do YYYY, H:mm:ss') + ' : ' + point[0],\n        value: index,\n      };\n    });\n  }\n\n  pointSelected(option) {\n    this.selectedPoint = option;\n  }\n\n  deletePoint() {\n    this.target.points.splice(this.selectedPoint.value, 1);\n    this.selectedPoint = { text: 'Select point', value: null };\n    this.refresh();\n  }\n\n  addPoint() {\n    this.target.points = this.target.points || [];\n    this.target.points.push([this.newPointValue, this.newPointTime.valueOf()]);\n    this.target.points = _.sortBy(this.target.points, p => p[1]);\n    this.refresh();\n  }\n\n  $onInit() {\n    return this.backendSrv.get('/api/tsdb/testdata/scenarios').then(res => {\n      this.scenarioList = res;\n      this.scenario = _.find(this.scenarioList, { id: this.target.scenarioId });\n    });\n  }\n\n  scenarioChanged() {\n    this.scenario = _.find(this.scenarioList, { id: this.target.scenarioId });\n    this.target.stringInput = this.scenario.stringInput;\n\n    if (this.target.scenarioId === 'manual_entry') {\n      this.target.points = this.target.points || [];\n    } else {\n      delete this.target.points;\n    }\n\n    this.refresh();\n  }\n}\n","import { TestDataDatasource } from './datasource';\nimport { TestDataQueryCtrl } from './query_ctrl';\n\nclass TestDataAnnotationsQueryCtrl {\n  annotation: any;\n\n  constructor() {}\n\n  static template = '<h2>test data</h2>';\n}\n\nexport {\n  TestDataDatasource,\n  TestDataDatasource as Datasource,\n  TestDataQueryCtrl as QueryCtrl,\n  TestDataAnnotationsQueryCtrl as AnnotationsQueryCtrl,\n};\n","import { stackdriverUnitMappings } from './constants';\nimport appEvents from 'app/core/app_events';\n\nexport default class StackdriverDatasource {\n  id: number;\n  url: string;\n  baseUrl: string;\n  projectName: string;\n\n  /** @ngInject */\n  constructor(instanceSettings, private backendSrv, private templateSrv, private timeSrv) {\n    this.baseUrl = `/stackdriver/`;\n    this.url = instanceSettings.url;\n    this.doRequest = this.doRequest;\n    this.id = instanceSettings.id;\n    this.projectName = instanceSettings.jsonData.defaultProject || '';\n  }\n\n  async getTimeSeries(options) {\n    const queries = options.targets\n      .filter(target => {\n        return !target.hide && target.metricType;\n      })\n      .map(t => {\n        if (!t.hasOwnProperty('aggregation')) {\n          t.aggregation = {\n            crossSeriesReducer: 'REDUCE_MEAN',\n            groupBys: [],\n          };\n        }\n        return {\n          refId: t.refId,\n          intervalMs: options.intervalMs,\n          datasourceId: this.id,\n          metricType: this.templateSrv.replace(t.metricType, options.scopedVars || {}),\n          primaryAggregation: this.templateSrv.replace(t.aggregation.crossSeriesReducer, options.scopedVars || {}),\n          perSeriesAligner: this.templateSrv.replace(t.aggregation.perSeriesAligner, options.scopedVars || {}),\n          alignmentPeriod: this.templateSrv.replace(t.aggregation.alignmentPeriod, options.scopedVars || {}),\n          groupBys: this.interpolateGroupBys(t.aggregation.groupBys, options.scopedVars),\n          view: t.view || 'FULL',\n          filters: (t.filters || []).map(f => {\n            return this.templateSrv.replace(f, options.scopedVars || {});\n          }),\n          aliasBy: this.templateSrv.replace(t.aliasBy, options.scopedVars || {}),\n          type: 'timeSeriesQuery',\n        };\n      });\n\n    const { data } = await this.backendSrv.datasourceRequest({\n      url: '/api/tsdb/query',\n      method: 'POST',\n      data: {\n        from: options.range.from.valueOf().toString(),\n        to: options.range.to.valueOf().toString(),\n        queries,\n      },\n    });\n    return data;\n  }\n\n  async getLabels(metricType, refId) {\n    return await this.getTimeSeries({\n      targets: [\n        {\n          refId: refId,\n          datasourceId: this.id,\n          metricType: this.templateSrv.replace(metricType),\n          aggregation: {\n            crossSeriesReducer: 'REDUCE_NONE',\n          },\n          view: 'HEADERS',\n        },\n      ],\n      range: this.timeSrv.timeRange(),\n    });\n  }\n\n  interpolateGroupBys(groupBys: string[], scopedVars): string[] {\n    let interpolatedGroupBys = [];\n    (groupBys || []).forEach(gb => {\n      const interpolated = this.templateSrv.replace(gb, scopedVars || {}, 'csv').split(',');\n      if (Array.isArray(interpolated)) {\n        interpolatedGroupBys = interpolatedGroupBys.concat(interpolated);\n      } else {\n        interpolatedGroupBys.push(interpolated);\n      }\n    });\n    return interpolatedGroupBys;\n  }\n\n  resolvePanelUnitFromTargets(targets: any[]) {\n    let unit;\n    if (targets.length > 0 && targets.every(t => t.unit === targets[0].unit)) {\n      if (stackdriverUnitMappings.hasOwnProperty(targets[0].unit)) {\n        unit = stackdriverUnitMappings[targets[0].unit];\n      }\n    }\n    return unit;\n  }\n\n  async query(options) {\n    const result = [];\n    const data = await this.getTimeSeries(options);\n    if (data.results) {\n      Object['values'](data.results).forEach(queryRes => {\n        if (!queryRes.series) {\n          return;\n        }\n        const unit = this.resolvePanelUnitFromTargets(options.targets);\n        queryRes.series.forEach(series => {\n          let timeSerie: any = {\n            target: series.name,\n            datapoints: series.points,\n            refId: queryRes.refId,\n            meta: queryRes.meta,\n          };\n          if (unit) {\n            timeSerie = { ...timeSerie, unit };\n          }\n          result.push(timeSerie);\n        });\n      });\n      return { data: result };\n    } else {\n      return { data: [] };\n    }\n  }\n\n  async annotationQuery(options) {\n    const annotation = options.annotation;\n    const queries = [\n      {\n        refId: 'annotationQuery',\n        datasourceId: this.id,\n        metricType: this.templateSrv.replace(annotation.target.metricType, options.scopedVars || {}),\n        primaryAggregation: 'REDUCE_NONE',\n        perSeriesAligner: 'ALIGN_NONE',\n        title: this.templateSrv.replace(annotation.target.title, options.scopedVars || {}),\n        text: this.templateSrv.replace(annotation.target.text, options.scopedVars || {}),\n        tags: this.templateSrv.replace(annotation.target.tags, options.scopedVars || {}),\n        view: 'FULL',\n        filters: (annotation.target.filters || []).map(f => {\n          return this.templateSrv.replace(f, options.scopedVars || {});\n        }),\n        type: 'annotationQuery',\n      },\n    ];\n\n    const { data } = await this.backendSrv.datasourceRequest({\n      url: '/api/tsdb/query',\n      method: 'POST',\n      data: {\n        from: options.range.from.valueOf().toString(),\n        to: options.range.to.valueOf().toString(),\n        queries,\n      },\n    });\n\n    const results = data.results['annotationQuery'].tables[0].rows.map(v => {\n      return {\n        annotation: annotation,\n        time: Date.parse(v[0]),\n        title: v[1],\n        tags: [],\n        text: v[3],\n      };\n    });\n\n    return results;\n  }\n\n  metricFindQuery(query) {\n    throw new Error('Template variables support is not yet imlemented');\n  }\n\n  testDatasource() {\n    const path = `v3/projects/${this.projectName}/metricDescriptors`;\n    return this.doRequest(`${this.baseUrl}${path}`)\n      .then(response => {\n        if (response.status === 200) {\n          return {\n            status: 'success',\n            message: 'Successfully queried the Stackdriver API.',\n            title: 'Success',\n          };\n        }\n\n        return {\n          status: 'error',\n          message: 'Returned http status code ' + response.status,\n        };\n      })\n      .catch(error => {\n        let message = 'Stackdriver: ';\n        message += error.statusText ? error.statusText + ': ' : '';\n\n        if (error.data && error.data.error && error.data.error.code) {\n          // 400, 401\n          message += error.data.error.code + '. ' + error.data.error.message;\n        } else {\n          message += 'Cannot connect to Stackdriver API';\n        }\n        return {\n          status: 'error',\n          message: message,\n        };\n      });\n  }\n\n  async getProjects() {\n    const response = await this.doRequest(`/cloudresourcemanager/v1/projects`);\n    return response.data.projects.map(p => ({ id: p.projectId, name: p.name }));\n  }\n\n  async getDefaultProject() {\n    try {\n      const projects = await this.getProjects();\n      if (projects && projects.length > 0) {\n        const test = projects.filter(p => p.id === this.projectName)[0];\n        return test;\n      } else {\n        throw new Error('No projects found');\n      }\n    } catch (error) {\n      let message = 'Projects cannot be fetched: ';\n      message += error.statusText ? error.statusText + ': ' : '';\n      if (error && error.data && error.data.error && error.data.error.message) {\n        if (error.data.error.code === 403) {\n          message += `\n            A list of projects could not be fetched from the Google Cloud Resource Manager API.\n            You might need to enable it first:\n            https://console.developers.google.com/apis/library/cloudresourcemanager.googleapis.com`;\n        } else {\n          message += error.data.error.code + '. ' + error.data.error.message;\n        }\n      } else {\n        message += 'Cannot connect to Stackdriver API';\n      }\n      appEvents.emit('ds-request-error', message);\n    }\n  }\n\n  async getMetricTypes(projectId: string) {\n    try {\n      const metricsApiPath = `v3/projects/${projectId}/metricDescriptors`;\n      const { data } = await this.doRequest(`${this.baseUrl}${metricsApiPath}`);\n\n      const metrics = data.metricDescriptors.map(m => {\n        const [service] = m.type.split('/');\n        const [serviceShortName] = service.split('.');\n        m.service = service;\n        m.serviceShortName = serviceShortName;\n        m.displayName = m.displayName || m.type;\n        return m;\n      });\n\n      return metrics;\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  async doRequest(url, maxRetries = 1) {\n    return this.backendSrv\n      .datasourceRequest({\n        url: this.url + url,\n        method: 'GET',\n      })\n      .catch(error => {\n        if (maxRetries > 0) {\n          return this.doRequest(url, maxRetries - 1);\n        }\n\n        throw error;\n      });\n  }\n}\n","import angular from 'angular';\nimport _ from 'lodash';\nimport * as options from './constants';\nimport kbn from 'app/core/utils/kbn';\n\nexport class StackdriverAggregation {\n  constructor() {\n    return {\n      templateUrl: 'public/app/plugins/datasource/stackdriver/partials/query.aggregation.html',\n      controller: 'StackdriverAggregationCtrl',\n      restrict: 'E',\n      scope: {\n        target: '=',\n        alignmentPeriod: '<',\n        refresh: '&',\n      },\n    };\n  }\n}\n\nexport class StackdriverAggregationCtrl {\n  alignmentPeriods: any[];\n  aggOptions: any[];\n  alignOptions: any[];\n  target: any;\n\n  /** @ngInject */\n  constructor(private $scope) {\n    this.$scope.ctrl = this;\n    this.target = $scope.target;\n    this.alignmentPeriods = options.alignmentPeriods;\n    this.aggOptions = options.aggOptions;\n    this.alignOptions = options.alignOptions;\n    this.setAggOptions();\n    this.setAlignOptions();\n    const self = this;\n    $scope.$on('metricTypeChanged', () => {\n      self.setAggOptions();\n      self.setAlignOptions();\n    });\n  }\n\n  setAlignOptions() {\n    this.alignOptions = !this.target.valueType\n      ? []\n      : options.alignOptions.filter(i => {\n          return (\n            i.valueTypes.indexOf(this.target.valueType) !== -1 && i.metricKinds.indexOf(this.target.metricKind) !== -1\n          );\n        });\n    if (!this.alignOptions.find(o => o.value === this.target.aggregation.perSeriesAligner)) {\n      this.target.aggregation.perSeriesAligner = this.alignOptions.length > 0 ? this.alignOptions[0].value : '';\n    }\n  }\n\n  setAggOptions() {\n    this.aggOptions = !this.target.metricKind\n      ? []\n      : options.aggOptions.filter(i => {\n          return (\n            i.valueTypes.indexOf(this.target.valueType) !== -1 && i.metricKinds.indexOf(this.target.metricKind) !== -1\n          );\n        });\n\n    if (!this.aggOptions.find(o => o.value === this.target.aggregation.crossSeriesReducer)) {\n      this.deselectAggregationOption('REDUCE_NONE');\n    }\n\n    if (this.target.aggregation.groupBys.length > 0) {\n      this.aggOptions = this.aggOptions.filter(o => o.value !== 'REDUCE_NONE');\n      this.deselectAggregationOption('REDUCE_NONE');\n    }\n  }\n\n  formatAlignmentText() {\n    const selectedAlignment = this.alignOptions.find(ap => ap.value === this.target.aggregation.perSeriesAligner);\n    return `${kbn.secondsToHms(this.$scope.alignmentPeriod)} interval (${selectedAlignment.text})`;\n  }\n\n  deselectAggregationOption(notValidOptionValue: string) {\n    const newValue = this.aggOptions.find(o => o.value !== notValidOptionValue);\n    this.target.aggregation.crossSeriesReducer = newValue ? newValue.value : '';\n  }\n}\n\nangular.module('grafana.controllers').directive('stackdriverAggregation', StackdriverAggregation);\nangular.module('grafana.controllers').controller('StackdriverAggregationCtrl', StackdriverAggregationCtrl);\n","export const DefaultRemoveFilterValue = '-- remove filter --';\nexport const DefaultFilterValue = 'select value';\n\nexport class FilterSegments {\n  filterSegments: any[];\n  removeSegment: any;\n\n  constructor(private uiSegmentSrv, private target, private getFilterKeysFunc, private getFilterValuesFunc) {}\n\n  buildSegmentModel() {\n    this.removeSegment = this.uiSegmentSrv.newSegment({ fake: true, value: DefaultRemoveFilterValue });\n\n    this.filterSegments = [];\n    this.target.filters.forEach((f, index) => {\n      switch (index % 4) {\n        case 0:\n          this.filterSegments.push(this.uiSegmentSrv.newKey(f));\n          break;\n        case 1:\n          this.filterSegments.push(this.uiSegmentSrv.newOperator(f));\n          break;\n        case 2:\n          this.filterSegments.push(this.uiSegmentSrv.newKeyValue(f));\n          break;\n        case 3:\n          this.filterSegments.push(this.uiSegmentSrv.newCondition(f));\n          break;\n      }\n    });\n    this.ensurePlusButton(this.filterSegments);\n  }\n\n  async getFilters(segment, index, hasNoFilterKeys) {\n    if (segment.type === 'condition') {\n      return [this.uiSegmentSrv.newSegment('AND')];\n    }\n\n    if (segment.type === 'operator') {\n      return this.uiSegmentSrv.newOperators(['=', '!=', '=~', '!=~']);\n    }\n\n    if (segment.type === 'key' || segment.type === 'plus-button') {\n      if (hasNoFilterKeys && segment.value && segment.value !== DefaultRemoveFilterValue) {\n        this.removeSegment.value = DefaultRemoveFilterValue;\n        return Promise.resolve([this.removeSegment]);\n      } else {\n        return this.getFilterKeysFunc(segment, DefaultRemoveFilterValue);\n      }\n    }\n\n    if (segment.type === 'value') {\n      const filterValues = this.getFilterValuesFunc(index);\n\n      if (filterValues.length > 0) {\n        return this.getValuesForFilterKey(filterValues);\n      }\n    }\n\n    return [];\n  }\n\n  getValuesForFilterKey(labels: any[]) {\n    const filterValues = labels.map(l => {\n      return this.uiSegmentSrv.newSegment({\n        value: `${l}`,\n        expandable: false,\n      });\n    });\n\n    return filterValues;\n  }\n\n  addNewFilterSegments(segment, index) {\n    if (index > 2) {\n      this.filterSegments.splice(index, 0, this.uiSegmentSrv.newCondition('AND'));\n    }\n    segment.type = 'key';\n    this.filterSegments.push(this.uiSegmentSrv.newOperator('='));\n    this.filterSegments.push(this.uiSegmentSrv.newFake(DefaultFilterValue, 'value', 'query-segment-value'));\n  }\n\n  removeFilterSegment(index) {\n    this.filterSegments.splice(index, 3);\n    // remove trailing condition\n    if (index > 2 && this.filterSegments[index - 1].type === 'condition') {\n      this.filterSegments.splice(index - 1, 1);\n    }\n\n    // remove condition if it is first segment\n    if (index === 0 && this.filterSegments.length > 0 && this.filterSegments[0].type === 'condition') {\n      this.filterSegments.splice(0, 1);\n    }\n  }\n\n  ensurePlusButton(segments) {\n    const count = segments.length;\n    const lastSegment = segments[Math.max(count - 1, 0)];\n\n    if (!lastSegment || lastSegment.type !== 'plus-button') {\n      segments.push(this.uiSegmentSrv.newPlusButton());\n    }\n  }\n\n  filterSegmentUpdated(segment, index) {\n    if (segment.type === 'plus-button') {\n      this.addNewFilterSegments(segment, index);\n    } else if (segment.type === 'key' && segment.value === DefaultRemoveFilterValue) {\n      this.removeFilterSegment(index);\n      this.ensurePlusButton(this.filterSegments);\n    } else if (segment.type === 'value' && segment.value !== DefaultFilterValue) {\n      this.ensurePlusButton(this.filterSegments);\n    }\n\n    return this.filterSegments.filter(s => s.type !== 'plus-button').map(seg => seg.value);\n  }\n}\n","import angular from 'angular';\nimport _ from 'lodash';\nimport { FilterSegments } from './filter_segments';\nimport appEvents from 'app/core/app_events';\n\nexport class StackdriverFilter {\n  /** @ngInject */\n  constructor() {\n    return {\n      templateUrl: 'public/app/plugins/datasource/stackdriver/partials/query.filter.html',\n      controller: 'StackdriverFilterCtrl',\n      controllerAs: 'ctrl',\n      restrict: 'E',\n      scope: {\n        target: '=',\n        datasource: '=',\n        refresh: '&',\n        defaultDropdownValue: '<',\n        defaultServiceValue: '<',\n        hideGroupBys: '<',\n      },\n    };\n  }\n}\n\nexport class StackdriverFilterCtrl {\n  metricLabels: { [key: string]: string[] };\n  resourceLabels: { [key: string]: string[] };\n  resourceTypes: string[];\n\n  defaultRemoveGroupByValue = '-- remove group by --';\n  resourceTypeValue = 'resource.type';\n  loadLabelsPromise: Promise<any>;\n\n  service: string;\n  metricType: string;\n  metricDescriptors: any[];\n  metrics: any[];\n  services: any[];\n  groupBySegments: any[];\n  filterSegments: FilterSegments;\n  removeSegment: any;\n  target: any;\n  datasource: any;\n\n  /** @ngInject */\n  constructor(private $scope, private uiSegmentSrv, private templateSrv, private $rootScope) {\n    this.datasource = $scope.datasource;\n    this.target = $scope.target;\n    this.metricType = $scope.defaultDropdownValue;\n    this.service = $scope.defaultServiceValue;\n\n    this.metricDescriptors = [];\n    this.metrics = [];\n    this.services = [];\n\n    this.getCurrentProject()\n      .then(this.loadMetricDescriptors.bind(this))\n      .then(this.getLabels.bind(this));\n\n    this.initSegments($scope.hideGroupBys);\n  }\n\n  initSegments(hideGroupBys: boolean) {\n    if (!hideGroupBys) {\n      this.groupBySegments = this.target.aggregation.groupBys.map(groupBy => {\n        return this.uiSegmentSrv.getSegmentForValue(groupBy);\n      });\n      this.ensurePlusButton(this.groupBySegments);\n    }\n\n    this.removeSegment = this.uiSegmentSrv.newSegment({ fake: true, value: '-- remove group by --' });\n\n    this.filterSegments = new FilterSegments(\n      this.uiSegmentSrv,\n      this.target,\n      this.getFilterKeys.bind(this),\n      this.getFilterValues.bind(this)\n    );\n    this.filterSegments.buildSegmentModel();\n  }\n\n  async getCurrentProject() {\n    this.target.project = await this.datasource.getDefaultProject();\n  }\n\n  async loadMetricDescriptors() {\n    if (this.target.project.id !== 'default') {\n      this.metricDescriptors = await this.datasource.getMetricTypes(this.target.project.id);\n      this.services = this.getServicesList();\n      this.metrics = this.getMetricsList();\n      return this.metricDescriptors;\n    } else {\n      return [];\n    }\n  }\n\n  getServicesList() {\n    const defaultValue = { value: this.$scope.defaultServiceValue, text: this.$scope.defaultServiceValue };\n    const services = this.metricDescriptors.map(m => {\n      return {\n        value: m.service,\n        text: m.serviceShortName,\n      };\n    });\n\n    if (services.find(m => m.value === this.target.service)) {\n      this.service = this.target.service;\n    }\n\n    return services.length > 0 ? [defaultValue, ..._.uniqBy(services, 'value')] : [];\n  }\n\n  getMetricsList() {\n    const metrics = this.metricDescriptors.map(m => {\n      return {\n        service: m.service,\n        value: m.type,\n        serviceShortName: m.serviceShortName,\n        text: m.displayName,\n        title: m.description,\n      };\n    });\n\n    let result;\n    if (this.target.service === this.$scope.defaultServiceValue) {\n      result = metrics.map(m => ({ ...m, text: `${m.service} - ${m.text}` }));\n    } else {\n      result = metrics.filter(m => m.service === this.target.service);\n    }\n\n    if (result.find(m => m.value === this.target.metricType)) {\n      this.metricType = this.target.metricType;\n    } else if (result.length > 0) {\n      this.metricType = this.target.metricType = result[0].value;\n    }\n    return result;\n  }\n\n  async getLabels() {\n    this.loadLabelsPromise = new Promise(async resolve => {\n      try {\n        const data = await this.datasource.getLabels(this.target.metricType, this.target.refId);\n        this.metricLabels = data.results[this.target.refId].meta.metricLabels;\n        this.resourceLabels = data.results[this.target.refId].meta.resourceLabels;\n        this.resourceTypes = data.results[this.target.refId].meta.resourceTypes;\n        resolve();\n      } catch (error) {\n        if (error.data && error.data.message) {\n          console.log(error.data.message);\n        } else {\n          console.log(error);\n        }\n        appEvents.emit('alert-error', ['Error', 'Error loading metric labels for ' + this.target.metricType]);\n        resolve();\n      }\n    });\n  }\n\n  onServiceChange() {\n    this.target.service = this.service;\n    this.metrics = this.getMetricsList();\n    this.setMetricType();\n    this.getLabels();\n    if (!this.metrics.find(m => m.value === this.target.metricType)) {\n      this.target.metricType = this.$scope.defaultDropdownValue;\n    } else {\n      this.$scope.refresh();\n    }\n  }\n\n  async onMetricTypeChange() {\n    this.setMetricType();\n    this.$scope.refresh();\n    this.getLabels();\n  }\n\n  setMetricType() {\n    this.target.metricType = this.metricType;\n    const { valueType, metricKind, unit } = this.metricDescriptors.find(m => m.type === this.target.metricType);\n    this.target.unit = unit;\n    this.target.valueType = valueType;\n    this.target.metricKind = metricKind;\n    this.$rootScope.$broadcast('metricTypeChanged');\n  }\n\n  async createLabelKeyElements() {\n    await this.loadLabelsPromise;\n\n    let elements = Object.keys(this.metricLabels || {}).map(l => {\n      return this.uiSegmentSrv.newSegment({\n        value: `metric.label.${l}`,\n        expandable: false,\n      });\n    });\n\n    elements = [\n      ...elements,\n      ...Object.keys(this.resourceLabels || {}).map(l => {\n        return this.uiSegmentSrv.newSegment({\n          value: `resource.label.${l}`,\n          expandable: false,\n        });\n      }),\n    ];\n\n    if (this.resourceTypes && this.resourceTypes.length > 0) {\n      elements = [\n        ...elements,\n        this.uiSegmentSrv.newSegment({\n          value: this.resourceTypeValue,\n          expandable: false,\n        }),\n      ];\n    }\n\n    return elements;\n  }\n\n  async getFilterKeys(segment, removeText?: string) {\n    let elements = await this.createLabelKeyElements();\n\n    if (this.target.filters.indexOf(this.resourceTypeValue) !== -1) {\n      elements = elements.filter(e => e.value !== this.resourceTypeValue);\n    }\n\n    const noValueOrPlusButton = !segment || segment.type === 'plus-button';\n    if (noValueOrPlusButton && elements.length === 0) {\n      return [];\n    }\n\n    this.removeSegment.value = removeText;\n    return [...elements, this.removeSegment];\n  }\n\n  async getGroupBys(segment) {\n    let elements = await this.createLabelKeyElements();\n\n    elements = elements.filter(e => this.target.aggregation.groupBys.indexOf(e.value) === -1);\n    const noValueOrPlusButton = !segment || segment.type === 'plus-button';\n    if (noValueOrPlusButton && elements.length === 0) {\n      return [];\n    }\n\n    this.removeSegment.value = this.defaultRemoveGroupByValue;\n    return [...elements, this.removeSegment];\n  }\n\n  groupByChanged(segment, index) {\n    if (segment.value === this.removeSegment.value) {\n      this.groupBySegments.splice(index, 1);\n    } else {\n      segment.type = 'value';\n    }\n\n    const reducer = (memo, seg) => {\n      if (!seg.fake) {\n        memo.push(seg.value);\n      }\n      return memo;\n    };\n\n    this.target.aggregation.groupBys = this.groupBySegments.reduce(reducer, []);\n    this.ensurePlusButton(this.groupBySegments);\n    this.$rootScope.$broadcast('metricTypeChanged');\n    this.$scope.refresh();\n  }\n\n  async getFilters(segment, index) {\n    const hasNoFilterKeys = this.metricLabels && Object.keys(this.metricLabels).length === 0;\n    return this.filterSegments.getFilters(segment, index, hasNoFilterKeys);\n  }\n\n  getFilterValues(index) {\n    const filterKey = this.templateSrv.replace(this.filterSegments.filterSegments[index - 2].value);\n    if (!filterKey || !this.metricLabels || Object.keys(this.metricLabels).length === 0) {\n      return [];\n    }\n\n    const shortKey = filterKey.substring(filterKey.indexOf('.label.') + 7);\n\n    if (filterKey.startsWith('metric.label.') && this.metricLabels.hasOwnProperty(shortKey)) {\n      return this.metricLabels[shortKey];\n    }\n\n    if (filterKey.startsWith('resource.label.') && this.resourceLabels.hasOwnProperty(shortKey)) {\n      return this.resourceLabels[shortKey];\n    }\n\n    if (filterKey === this.resourceTypeValue) {\n      return this.resourceTypes;\n    }\n\n    return [];\n  }\n\n  filterSegmentUpdated(segment, index) {\n    this.target.filters = this.filterSegments.filterSegmentUpdated(segment, index);\n    this.$scope.refresh();\n  }\n\n  ensurePlusButton(segments) {\n    const count = segments.length;\n    const lastSegment = segments[Math.max(count - 1, 0)];\n\n    if (!lastSegment || lastSegment.type !== 'plus-button') {\n      segments.push(this.uiSegmentSrv.newPlusButton());\n    }\n  }\n}\n\nangular.module('grafana.controllers').directive('stackdriverFilter', StackdriverFilter);\nangular.module('grafana.controllers').controller('StackdriverFilterCtrl', StackdriverFilterCtrl);\n","export class StackdriverConfigCtrl {\n  static templateUrl = 'public/app/plugins/datasource/stackdriver/partials/config.html';\n  datasourceSrv: any;\n  current: any;\n  jsonText: string;\n  validationErrors: string[] = [];\n  inputDataValid: boolean;\n\n  /** @ngInject */\n  constructor(datasourceSrv) {\n    this.datasourceSrv = datasourceSrv;\n    this.current.jsonData = this.current.jsonData || {};\n    this.current.secureJsonData = this.current.secureJsonData || {};\n    this.current.secureJsonFields = this.current.secureJsonFields || {};\n  }\n\n  save(jwt) {\n    this.current.secureJsonData.privateKey = jwt.private_key;\n    this.current.jsonData.tokenUri = jwt.token_uri;\n    this.current.jsonData.clientEmail = jwt.client_email;\n    this.current.jsonData.defaultProject = jwt.project_id;\n  }\n\n  validateJwt(jwt) {\n    this.resetValidationMessages();\n    if (!jwt.private_key || jwt.private_key.length === 0) {\n      this.validationErrors.push('Private key field missing in JWT file.');\n    }\n\n    if (!jwt.token_uri || jwt.token_uri.length === 0) {\n      this.validationErrors.push('Token URI field missing in JWT file.');\n    }\n\n    if (!jwt.client_email || jwt.client_email.length === 0) {\n      this.validationErrors.push('Client Email field missing in JWT file.');\n    }\n\n    if (this.validationErrors.length === 0) {\n      this.inputDataValid = true;\n      return true;\n    }\n\n    return false;\n  }\n\n  onUpload(json) {\n    this.jsonText = '';\n    if (this.validateJwt(json)) {\n      this.save(json);\n    }\n  }\n\n  onPasteJwt(e) {\n    try {\n      const json = JSON.parse(e.originalEvent.clipboardData.getData('text/plain') || this.jsonText);\n      if (this.validateJwt(json)) {\n        this.save(json);\n      }\n    } catch (error) {\n      this.resetValidationMessages();\n      this.validationErrors.push(`Invalid json: ${error.message}`);\n    }\n  }\n\n  resetValidationMessages() {\n    this.validationErrors = [];\n    this.inputDataValid = false;\n    this.jsonText = '';\n\n    this.current.jsonData = {};\n    this.current.secureJsonData = {};\n    this.current.secureJsonFields = {};\n  }\n}\n","import _ from 'lodash';\nimport { QueryCtrl } from 'app/plugins/sdk';\nimport './query_aggregation_ctrl';\nimport './query_filter_ctrl';\n\nexport interface QueryMeta {\n  alignmentPeriod: string;\n  rawQuery: string;\n  rawQueryString: string;\n  metricLabels: { [key: string]: string[] };\n  resourceLabels: { [key: string]: string[] };\n}\n\nexport class StackdriverQueryCtrl extends QueryCtrl {\n  static templateUrl = 'partials/query.editor.html';\n  target: {\n    project: {\n      id: string;\n      name: string;\n    };\n    unit: string;\n    metricType: string;\n    service: string;\n    refId: string;\n    aggregation: {\n      crossSeriesReducer: string;\n      alignmentPeriod: string;\n      perSeriesAligner: string;\n      groupBys: string[];\n    };\n    filters: string[];\n    aliasBy: string;\n    metricKind: any;\n    valueType: any;\n  };\n\n  defaultDropdownValue = 'Select Metric';\n  defaultServiceValue = 'All Services';\n\n  defaults = {\n    project: {\n      id: 'default',\n      name: 'loading project...',\n    },\n    metricType: this.defaultDropdownValue,\n    service: this.defaultServiceValue,\n    metric: '',\n    unit: '',\n    aggregation: {\n      crossSeriesReducer: 'REDUCE_MEAN',\n      alignmentPeriod: 'stackdriver-auto',\n      perSeriesAligner: 'ALIGN_MEAN',\n      groupBys: [],\n    },\n    filters: [],\n    showAggregationOptions: false,\n    aliasBy: '',\n    metricKind: '',\n    valueType: '',\n  };\n\n  showHelp: boolean;\n  showLastQuery: boolean;\n  lastQueryMeta: QueryMeta;\n  lastQueryError?: string;\n\n  /** @ngInject */\n  constructor($scope, $injector) {\n    super($scope, $injector);\n    _.defaultsDeep(this.target, this.defaults);\n\n    this.panelCtrl.events.on('data-received', this.onDataReceived.bind(this), $scope);\n    this.panelCtrl.events.on('data-error', this.onDataError.bind(this), $scope);\n  }\n\n  onDataReceived(dataList) {\n    this.lastQueryError = null;\n    this.lastQueryMeta = null;\n\n    const anySeriesFromQuery: any = _.find(dataList, { refId: this.target.refId });\n    if (anySeriesFromQuery) {\n      this.lastQueryMeta = anySeriesFromQuery.meta;\n      this.lastQueryMeta.rawQueryString = decodeURIComponent(this.lastQueryMeta.rawQuery);\n    }\n  }\n\n  onDataError(err) {\n    if (err.data && err.data.results) {\n      const queryRes = err.data.results[this.target.refId];\n      if (queryRes && queryRes.error) {\n        this.lastQueryMeta = queryRes.meta;\n        this.lastQueryMeta.rawQueryString = decodeURIComponent(this.lastQueryMeta.rawQuery);\n\n        let jsonBody;\n        try {\n          jsonBody = JSON.parse(queryRes.error);\n        } catch {\n          this.lastQueryError = queryRes.error;\n        }\n\n        this.lastQueryError = jsonBody.error.message;\n      }\n    }\n  }\n}\n","import _ from 'lodash';\nimport './query_filter_ctrl';\n\nexport class StackdriverAnnotationsQueryCtrl {\n  static templateUrl = 'partials/annotations.editor.html';\n  annotation: any;\n  datasource: any;\n\n  defaultDropdownValue = 'Select Metric';\n  defaultServiceValue = 'All Services';\n\n  defaults = {\n    project: {\n      id: 'default',\n      name: 'loading project...',\n    },\n    metricType: this.defaultDropdownValue,\n    service: this.defaultServiceValue,\n    metric: '',\n    filters: [],\n    metricKind: '',\n    valueType: '',\n  };\n\n  /** @ngInject */\n  constructor() {\n    this.annotation.target = this.annotation.target || {};\n    this.annotation.target.refId = 'annotationQuery';\n    _.defaultsDeep(this.annotation.target, this.defaults);\n  }\n}\n","import StackdriverDatasource from './datasource';\nimport { StackdriverQueryCtrl } from './query_ctrl';\nimport { StackdriverConfigCtrl } from './config_ctrl';\nimport { StackdriverAnnotationsQueryCtrl } from './annotations_query_ctrl';\n\nexport {\n  StackdriverDatasource as Datasource,\n  StackdriverQueryCtrl as QueryCtrl,\n  StackdriverConfigCtrl as ConfigCtrl,\n  StackdriverAnnotationsQueryCtrl as AnnotationsQueryCtrl,\n};\n","import _ from 'lodash';\nimport { PanelCtrl } from 'app/plugins/sdk';\nimport Remarkable from 'remarkable';\n\nexport class TextPanelCtrl extends PanelCtrl {\n  static templateUrl = `public/app/plugins/panel/text/module.html`;\n  static scrollable = true;\n\n  remarkable: any;\n  content: string;\n  // Set and populate defaults\n  panelDefaults = {\n    mode: 'markdown', // 'html', 'markdown', 'text'\n    content: '# title',\n  };\n\n  /** @ngInject */\n  constructor($scope, $injector, private templateSrv, private $sce) {\n    super($scope, $injector);\n\n    _.defaults(this.panel, this.panelDefaults);\n\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n    this.events.on('refresh', this.onRefresh.bind(this));\n    this.events.on('render', this.onRender.bind(this));\n\n    $scope.$watch(\n      'ctrl.panel.content',\n      _.throttle(() => {\n        this.render();\n      }, 1000)\n    );\n  }\n\n  onInitEditMode() {\n    this.addEditorTab('Options', 'public/app/plugins/panel/text/editor.html');\n    this.editorTabIndex = 1;\n\n    if (this.panel.mode === 'text') {\n      this.panel.mode = 'markdown';\n    }\n  }\n\n  onRefresh() {\n    this.render();\n  }\n\n  onRender() {\n    if (this.panel.mode === 'markdown') {\n      this.renderMarkdown(this.panel.content);\n    } else if (this.panel.mode === 'html') {\n      this.updateContent(this.panel.content);\n    }\n    this.renderingCompleted();\n  }\n\n  renderText(content) {\n    content = content\n      .replace(/&/g, '&amp;')\n      .replace(/>/g, '&gt;')\n      .replace(/</g, '&lt;')\n      .replace(/\\n/g, '<br/>');\n    this.updateContent(content);\n  }\n\n  renderMarkdown(content) {\n    if (!this.remarkable) {\n      this.remarkable = new Remarkable();\n    }\n\n    this.$scope.$applyAsync(() => {\n      this.updateContent(this.remarkable.render(content));\n    });\n  }\n\n  updateContent(html) {\n    try {\n      this.content = this.$sce.trustAsHtml(this.templateSrv.replace(html, this.panel.scopedVars));\n    } catch (e) {\n      console.log('Text panel error: ', e);\n      this.content = this.$sce.trustAsHtml(html);\n    }\n  }\n}\n\nexport { TextPanelCtrl as PanelCtrl };\n","import angular from 'angular';\nimport $ from 'jquery';\nimport _ from 'lodash';\nimport Drop from 'tether-drop';\n\n/** @ngInject */\nexport function createAnnotationToolip(element, event, plot) {\n  const injector = angular.element(document).injector();\n  const content = document.createElement('div');\n  content.innerHTML = '<annotation-tooltip event=\"event\" on-edit=\"onEdit()\"></annotation-tooltip>';\n\n  injector.invoke([\n    '$compile',\n    '$rootScope',\n    ($compile, $rootScope) => {\n      const eventManager = plot.getOptions().events.manager;\n      const tmpScope = $rootScope.$new(true);\n      tmpScope.event = event;\n      tmpScope.onEdit = () => {\n        eventManager.editEvent(event);\n      };\n\n      $compile(content)(tmpScope);\n      tmpScope.$digest();\n      tmpScope.$destroy();\n\n      const drop = new Drop({\n        target: element[0],\n        content: content,\n        position: 'bottom center',\n        classes: 'drop-popover drop-popover--annotation',\n        openOn: 'hover',\n        hoverCloseDelay: 200,\n        tetherOptions: {\n          constraints: [{ to: 'window', pin: true, attachment: 'both' }],\n        },\n      });\n\n      drop.open();\n\n      drop.on('close', () => {\n        setTimeout(() => {\n          drop.destroy();\n        });\n      });\n    },\n  ]);\n}\n\nlet markerElementToAttachTo = null;\n\n/** @ngInject */\nexport function createEditPopover(element, event, plot) {\n  const eventManager = plot.getOptions().events.manager;\n  if (eventManager.editorOpen) {\n    // update marker element to attach to (needed in case of legend on the right\n    // when there is a double render pass and the inital marker element is removed)\n    markerElementToAttachTo = element;\n    return;\n  }\n\n  // mark as openend\n  eventManager.editorOpened();\n  // set marker elment to attache to\n  markerElementToAttachTo = element;\n\n  // wait for element to be attached and positioned\n  setTimeout(() => {\n    const injector = angular.element(document).injector();\n    const content = document.createElement('div');\n    content.innerHTML = '<event-editor panel-ctrl=\"panelCtrl\" event=\"event\" close=\"close()\"></event-editor>';\n\n    injector.invoke([\n      '$compile',\n      '$rootScope',\n      ($compile, $rootScope) => {\n        const scope = $rootScope.$new(true);\n        let drop;\n\n        scope.event = event;\n        scope.panelCtrl = eventManager.panelCtrl;\n        scope.close = () => {\n          drop.close();\n        };\n\n        $compile(content)(scope);\n        scope.$digest();\n\n        drop = new Drop({\n          target: markerElementToAttachTo[0],\n          content: content,\n          position: 'bottom center',\n          classes: 'drop-popover drop-popover--form',\n          openOn: 'click',\n          tetherOptions: {\n            constraints: [{ to: 'window', pin: true, attachment: 'both' }],\n          },\n        });\n\n        drop.open();\n        eventManager.editorOpened();\n\n        drop.on('close', () => {\n          // need timeout here in order call drop.destroy\n          setTimeout(() => {\n            eventManager.editorClosed();\n            scope.$destroy();\n            drop.destroy();\n          });\n        });\n      },\n    ]);\n  }, 100);\n}\n\n/*\n * jquery.flot.events\n *\n * description: Flot plugin for adding events/markers to the plot\n * version: 0.2.5\n * authors:\n *    Alexander Wunschik <alex@wunschik.net>\n *    Joel Oughton <joeloughton@gmail.com>\n *    Nicolas Joseph <www.nicolasjoseph.com>\n *\n * website: https://github.com/mojoaxel/flot-events\n *\n * released under MIT License and GPLv2+\n */\n\n/**\n * A class that allows for the drawing an remove of some object\n */\nexport class DrawableEvent {\n  _object: any;\n  _drawFunc: any;\n  _clearFunc: any;\n  _moveFunc: any;\n  _position: any;\n  _width: any;\n  _height: any;\n\n  /** @ngInject */\n  constructor(object, drawFunc, clearFunc, moveFunc, left, top, width, height) {\n    this._object = object;\n    this._drawFunc = drawFunc;\n    this._clearFunc = clearFunc;\n    this._moveFunc = moveFunc;\n    this._position = { left: left, top: top };\n    this._width = width;\n    this._height = height;\n  }\n\n  width() {\n    return this._width;\n  }\n  height() {\n    return this._height;\n  }\n  position() {\n    return this._position;\n  }\n  draw() {\n    this._drawFunc(this._object);\n  }\n  clear() {\n    this._clearFunc(this._object);\n  }\n  getObject() {\n    return this._object;\n  }\n  moveTo(position) {\n    this._position = position;\n    this._moveFunc(this._object, this._position);\n  }\n}\n\n/**\n * Event class that stores options (eventType, min, max, title, description) and the object to draw.\n */\nexport class VisualEvent {\n  _parent: any;\n  _options: any;\n  _drawableEvent: any;\n  _hidden: any;\n\n  /** @ngInject */\n  constructor(options, drawableEvent) {\n    this._options = options;\n    this._drawableEvent = drawableEvent;\n    this._hidden = false;\n  }\n\n  visual() {\n    return this._drawableEvent;\n  }\n  getOptions() {\n    return this._options;\n  }\n  getParent() {\n    return this._parent;\n  }\n  isHidden() {\n    return this._hidden;\n  }\n  hide() {\n    this._hidden = true;\n  }\n  unhide() {\n    this._hidden = false;\n  }\n}\n\n/**\n * A Class that handles the event-markers inside the given plot\n */\nexport class EventMarkers {\n  _events: any;\n  _types: any;\n  _plot: any;\n  eventsEnabled: any;\n\n  /** @ngInject */\n  constructor(plot) {\n    this._events = [];\n    this._types = [];\n    this._plot = plot;\n    this.eventsEnabled = false;\n  }\n\n  getEvents() {\n    return this._events;\n  }\n\n  setTypes(types) {\n    return (this._types = types);\n  }\n\n  /**\n   * create internal objects for the given events\n   */\n  setupEvents(events) {\n    const parts = _.partition(events, 'isRegion');\n    const regions = parts[0];\n    events = parts[1];\n\n    $.each(events, (index, event) => {\n      const ve = new VisualEvent(event, this._buildDiv(event));\n      this._events.push(ve);\n    });\n\n    $.each(regions, (index, event) => {\n      const vre = new VisualEvent(event, this._buildRegDiv(event));\n      this._events.push(vre);\n    });\n\n    this._events.sort((a, b) => {\n      const ao = a.getOptions(),\n        bo = b.getOptions();\n      if (ao.min > bo.min) {\n        return 1;\n      }\n      if (ao.min < bo.min) {\n        return -1;\n      }\n      return 0;\n    });\n  }\n\n  /**\n   * draw the events to the plot\n   */\n  drawEvents() {\n    // var o = this._plot.getPlotOffset();\n\n    $.each(this._events, (index, event) => {\n      // check event is inside the graph range\n      if (this._insidePlot(event.getOptions().min) && !event.isHidden()) {\n        event.visual().draw();\n      } else {\n        event\n          .visual()\n          .getObject()\n          .hide();\n      }\n    });\n  }\n\n  /**\n   * update the position of the event-markers (e.g. after scrolling or zooming)\n   */\n  updateEvents() {\n    const o = this._plot.getPlotOffset();\n    let left;\n    let top;\n    const xaxis = this._plot.getXAxes()[this._plot.getOptions().events.xaxis - 1];\n\n    $.each(this._events, (index, event) => {\n      top = o.top + this._plot.height() - event.visual().height();\n      left = xaxis.p2c(event.getOptions().min) + o.left - event.visual().width() / 2;\n      event.visual().moveTo({ top: top, left: left });\n    });\n  }\n\n  /**\n   * remove all events from the plot\n   */\n  _clearEvents() {\n    $.each(this._events, (index, val) => {\n      val.visual().clear();\n    });\n    this._events = [];\n  }\n\n  /**\n   * create a DOM element for the given event\n   */\n  _buildDiv(event) {\n    const that = this;\n\n    const container = this._plot.getPlaceholder();\n    const o = this._plot.getPlotOffset();\n    const xaxis = this._plot.getXAxes()[this._plot.getOptions().events.xaxis - 1];\n    let top, left, color, markerSize, markerShow, lineStyle, lineWidth;\n    let markerTooltip;\n\n    // map the eventType to a types object\n    const eventTypeId = event.eventType;\n\n    if (this._types === null || !this._types[eventTypeId] || !this._types[eventTypeId].color) {\n      color = '#666';\n    } else {\n      color = this._types[eventTypeId].color;\n    }\n\n    if (this._types === null || !this._types[eventTypeId] || !this._types[eventTypeId].markerSize) {\n      markerSize = 8; //default marker size\n    } else {\n      markerSize = this._types[eventTypeId].markerSize;\n    }\n\n    if (this._types === null || !this._types[eventTypeId] || this._types[eventTypeId].markerShow === undefined) {\n      markerShow = true;\n    } else {\n      markerShow = this._types[eventTypeId].markerShow;\n    }\n\n    if (this._types === null || !this._types[eventTypeId] || this._types[eventTypeId].markerTooltip === undefined) {\n      markerTooltip = true;\n    } else {\n      markerTooltip = this._types[eventTypeId].markerTooltip;\n    }\n\n    if (this._types == null || !this._types[eventTypeId] || !this._types[eventTypeId].lineStyle) {\n      lineStyle = 'dashed'; //default line style\n    } else {\n      lineStyle = this._types[eventTypeId].lineStyle.toLowerCase();\n    }\n\n    if (this._types == null || !this._types[eventTypeId] || this._types[eventTypeId].lineWidth === undefined) {\n      lineWidth = 1; //default line width\n    } else {\n      lineWidth = this._types[eventTypeId].lineWidth;\n    }\n\n    let topOffset = xaxis.options.eventSectionHeight || 0;\n    topOffset = topOffset / 3;\n\n    top = o.top + this._plot.height() + topOffset;\n    left = xaxis.p2c(event.min) + o.left;\n\n    const line = $('<div class=\"events_line flot-temp-elem\"></div>')\n      .css({\n        position: 'absolute',\n        opacity: 0.8,\n        left: left + 'px',\n        top: 8,\n        width: lineWidth + 'px',\n        height: this._plot.height() + topOffset * 0.8,\n        'border-left-width': lineWidth + 'px',\n        'border-left-style': lineStyle,\n        'border-left-color': color,\n        color: color,\n      })\n      .appendTo(container);\n\n    if (markerShow) {\n      const marker = $('<div class=\"events_marker\"></div>').css({\n        position: 'absolute',\n        left: -markerSize - Math.round(lineWidth / 2) + 'px',\n        'font-size': 0,\n        'line-height': 0,\n        width: 0,\n        height: 0,\n        'border-left': markerSize + 'px solid transparent',\n        'border-right': markerSize + 'px solid transparent',\n      });\n\n      marker.appendTo(line);\n\n      if (\n        this._types[eventTypeId] &&\n        this._types[eventTypeId].position &&\n        this._types[eventTypeId].position.toUpperCase() === 'BOTTOM'\n      ) {\n        marker.css({\n          top: top - markerSize - 8 + 'px',\n          'border-top': 'none',\n          'border-bottom': markerSize + 'px solid ' + color,\n        });\n      } else {\n        marker.css({\n          top: '0px',\n          'border-top': markerSize + 'px solid ' + color,\n          'border-bottom': 'none',\n        });\n      }\n\n      marker.data({\n        event: event,\n      });\n\n      const mouseenter = function(this: any) {\n        createAnnotationToolip(marker, $(this).data('event'), that._plot);\n      };\n\n      if (event.editModel) {\n        createEditPopover(marker, event.editModel, that._plot);\n      }\n\n      const mouseleave = () => {\n        that._plot.clearSelection();\n      };\n\n      if (markerTooltip) {\n        marker.css({ cursor: 'help' });\n        marker.hover(mouseenter, mouseleave);\n      }\n    }\n\n    const drawableEvent = new DrawableEvent(\n      line,\n      function drawFunc(obj) {\n        obj.show();\n      },\n      obj => {\n        obj.remove();\n      },\n      (obj, position) => {\n        obj.css({\n          top: position.top,\n          left: position.left,\n        });\n      },\n      left,\n      top,\n      line.width(),\n      line.height()\n    );\n\n    return drawableEvent;\n  }\n\n  /**\n   * create a DOM element for the given region\n   */\n  _buildRegDiv(event) {\n    const that = this;\n\n    const container = this._plot.getPlaceholder();\n    const o = this._plot.getPlotOffset();\n    const xaxis = this._plot.getXAxes()[this._plot.getOptions().events.xaxis - 1];\n    let top, left, lineWidth, regionWidth, lineStyle, color, markerTooltip;\n\n    // map the eventType to a types object\n    const eventTypeId = event.eventType;\n\n    if (this._types === null || !this._types[eventTypeId] || !this._types[eventTypeId].color) {\n      color = '#666';\n    } else {\n      color = this._types[eventTypeId].color;\n    }\n\n    if (this._types === null || !this._types[eventTypeId] || this._types[eventTypeId].markerTooltip === undefined) {\n      markerTooltip = true;\n    } else {\n      markerTooltip = this._types[eventTypeId].markerTooltip;\n    }\n\n    if (this._types == null || !this._types[eventTypeId] || this._types[eventTypeId].lineWidth === undefined) {\n      lineWidth = 1; //default line width\n    } else {\n      lineWidth = this._types[eventTypeId].lineWidth;\n    }\n\n    if (this._types == null || !this._types[eventTypeId] || !this._types[eventTypeId].lineStyle) {\n      lineStyle = 'dashed'; //default line style\n    } else {\n      lineStyle = this._types[eventTypeId].lineStyle.toLowerCase();\n    }\n\n    const topOffset = 2;\n    top = o.top + this._plot.height() + topOffset;\n\n    const timeFrom = Math.min(event.min, event.timeEnd);\n    const timeTo = Math.max(event.min, event.timeEnd);\n    left = xaxis.p2c(timeFrom) + o.left;\n    const right = xaxis.p2c(timeTo) + o.left;\n    regionWidth = right - left;\n\n    _.each([left, right], position => {\n      const line = $('<div class=\"events_line flot-temp-elem\"></div>').css({\n        position: 'absolute',\n        opacity: 0.8,\n        left: position + 'px',\n        top: 8,\n        width: lineWidth + 'px',\n        height: this._plot.height() + topOffset,\n        'border-left-width': lineWidth + 'px',\n        'border-left-style': lineStyle,\n        'border-left-color': color,\n        color: color,\n      });\n      line.appendTo(container);\n    });\n\n    const region = $('<div class=\"events_marker region_marker flot-temp-elem\"></div>').css({\n      position: 'absolute',\n      opacity: 0.5,\n      left: left + 'px',\n      top: top,\n      width: Math.round(regionWidth + lineWidth) + 'px',\n      height: '0.5rem',\n      'border-left-color': color,\n      color: color,\n      'background-color': color,\n    });\n    region.appendTo(container);\n\n    region.data({\n      event: event,\n    });\n\n    const mouseenter = function(this: any) {\n      createAnnotationToolip(region, $(this).data('event'), that._plot);\n    };\n\n    if (event.editModel) {\n      createEditPopover(region, event.editModel, that._plot);\n    }\n\n    const mouseleave = () => {\n      that._plot.clearSelection();\n    };\n\n    if (markerTooltip) {\n      region.css({ cursor: 'help' });\n      region.hover(mouseenter, mouseleave);\n    }\n\n    const drawableEvent = new DrawableEvent(\n      region,\n      function drawFunc(obj) {\n        obj.show();\n      },\n      obj => {\n        obj.remove();\n      },\n      (obj, position) => {\n        obj.css({\n          top: position.top,\n          left: position.left,\n        });\n      },\n      left,\n      top,\n      region.width(),\n      region.height()\n    );\n\n    return drawableEvent;\n  }\n\n  /**\n   * check if the event is inside visible range\n   */\n  _insidePlot(x) {\n    const xaxis = this._plot.getXAxes()[this._plot.getOptions().events.xaxis - 1];\n    const xc = xaxis.p2c(x);\n    return xc > 0 && xc < xaxis.p2c(xaxis.max);\n  }\n}\n\n/**\n * initialize the plugin for the given plot\n */\n\n/** @ngInject */\nexport function init(this: any, plot) {\n  /*jshint validthis:true */\n  const that = this;\n  const eventMarkers = new EventMarkers(plot);\n\n  plot.getEvents = () => {\n    return eventMarkers._events;\n  };\n\n  plot.hideEvents = () => {\n    $.each(eventMarkers._events, (index, event) => {\n      event\n        .visual()\n        .getObject()\n        .hide();\n    });\n  };\n\n  plot.showEvents = () => {\n    plot.hideEvents();\n    $.each(eventMarkers._events, (index, event) => {\n      event.hide();\n    });\n\n    that.eventMarkers.drawEvents();\n  };\n\n  // change events on an existing plot\n  plot.setEvents = events => {\n    if (eventMarkers.eventsEnabled) {\n      eventMarkers.setupEvents(events);\n    }\n  };\n\n  plot.hooks.processOptions.push((plot, options) => {\n    // enable the plugin\n    if (options.events.data != null) {\n      eventMarkers.eventsEnabled = true;\n    }\n  });\n\n  plot.hooks.draw.push(plot => {\n    const options = plot.getOptions();\n\n    if (eventMarkers.eventsEnabled) {\n      // check for first run\n      if (eventMarkers.getEvents().length < 1) {\n        eventMarkers.setTypes(options.events.types);\n        eventMarkers.setupEvents(options.events.data);\n      } else {\n        eventMarkers.updateEvents();\n      }\n    }\n\n    eventMarkers.drawEvents();\n  });\n}\n\nconst defaultOptions = {\n  events: {\n    data: null,\n    types: null,\n    xaxis: 1,\n    position: 'BOTTOM',\n  },\n};\n\n$.plot.plugins.push({\n  init: init,\n  options: defaultOptions,\n  name: 'events',\n  version: '0.2.5',\n});\n","import $ from 'jquery';\nimport { appEvents } from 'app/core/core';\n\nexport default function GraphTooltip(this: any, elem, dashboard, scope, getSeriesFn) {\n  const self = this;\n  const ctrl = scope.ctrl;\n  const panel = ctrl.panel;\n\n  const $tooltip = $('<div class=\"graph-tooltip\">');\n\n  this.destroy = () => {\n    $tooltip.remove();\n  };\n\n  this.findHoverIndexFromDataPoints = (posX, series, last) => {\n    const ps = series.datapoints.pointsize;\n    const initial = last * ps;\n    const len = series.datapoints.points.length;\n    let j;\n    for (j = initial; j < len; j += ps) {\n      // Special case of a non stepped line, highlight the very last point just before a null point\n      if (\n        (!series.lines.steps && series.datapoints.points[initial] != null && series.datapoints.points[j] == null) ||\n        //normal case\n        series.datapoints.points[j] > posX\n      ) {\n        return Math.max(j - ps, 0) / ps;\n      }\n    }\n    return j / ps - 1;\n  };\n\n  this.findHoverIndexFromData = (posX, series) => {\n    let lower = 0;\n    let upper = series.data.length - 1;\n    let middle;\n    while (true) {\n      if (lower > upper) {\n        return Math.max(upper, 0);\n      }\n      middle = Math.floor((lower + upper) / 2);\n      if (series.data[middle][0] === posX) {\n        return middle;\n      } else if (series.data[middle][0] < posX) {\n        lower = middle + 1;\n      } else {\n        upper = middle - 1;\n      }\n    }\n  };\n\n  this.renderAndShow = (absoluteTime, innerHtml, pos, xMode) => {\n    if (xMode === 'time') {\n      innerHtml = '<div class=\"graph-tooltip-time\">' + absoluteTime + '</div>' + innerHtml;\n    }\n    $tooltip.html(innerHtml).place_tt(pos.pageX + 20, pos.pageY);\n  };\n\n  this.getMultiSeriesPlotHoverInfo = function(seriesList, pos) {\n    let value, i, series, hoverIndex, hoverDistance, pointTime, yaxis;\n    // 3 sub-arrays, 1st for hidden series, 2nd for left yaxis, 3rd for right yaxis.\n    let results: any = [[], [], []];\n\n    //now we know the current X (j) position for X and Y values\n    let lastValue = 0; //needed for stacked values\n\n    let minDistance, minTime;\n\n    for (i = 0; i < seriesList.length; i++) {\n      series = seriesList[i];\n\n      if (!series.data.length || (panel.legend.hideEmpty && series.allIsNull)) {\n        // Init value so that it does not brake series sorting\n        results[0].push({ hidden: true, value: 0 });\n        continue;\n      }\n\n      if (!series.data.length || (panel.legend.hideZero && series.allIsZero)) {\n        // Init value so that it does not brake series sorting\n        results[0].push({ hidden: true, value: 0 });\n        continue;\n      }\n\n      if (series.hideTooltip) {\n        results[0].push({ hidden: true, value: 0 });\n        continue;\n      }\n\n      hoverIndex = this.findHoverIndexFromData(pos.x, series);\n      hoverDistance = pos.x - series.data[hoverIndex][0];\n      pointTime = series.data[hoverIndex][0];\n\n      // Take the closest point before the cursor, or if it does not exist, the closest after\n      if (\n        !minDistance ||\n        (hoverDistance >= 0 && (hoverDistance < minDistance || minDistance < 0)) ||\n        (hoverDistance < 0 && hoverDistance > minDistance)\n      ) {\n        minDistance = hoverDistance;\n        minTime = pointTime;\n      }\n\n      if (series.stack) {\n        if (panel.tooltip.value_type === 'individual') {\n          value = series.data[hoverIndex][1];\n        } else if (!series.stack) {\n          value = series.data[hoverIndex][1];\n        } else {\n          lastValue += series.data[hoverIndex][1];\n          value = lastValue;\n        }\n      } else {\n        value = series.data[hoverIndex][1];\n      }\n\n      // Highlighting multiple Points depending on the plot type\n      if (series.lines.steps || series.stack) {\n        // stacked and steppedLine plots can have series with different length.\n        // Stacked series can increase its length on each new stacked serie if null points found,\n        // to speed the index search we begin always on the last found hoverIndex.\n        hoverIndex = this.findHoverIndexFromDataPoints(pos.x, series, hoverIndex);\n      }\n\n      // Be sure we have a yaxis so that it does not brake series sorting\n      yaxis = 0;\n      if (series.yaxis) {\n        yaxis = series.yaxis.n;\n      }\n\n      results[yaxis].push({\n        value: value,\n        hoverIndex: hoverIndex,\n        color: series.color,\n        label: series.aliasEscaped,\n        time: pointTime,\n        distance: hoverDistance,\n        index: i,\n      });\n    }\n\n    // Contat the 3 sub-arrays\n    results = results[0].concat(results[1], results[2]);\n\n    // Time of the point closer to pointer\n    results.time = minTime;\n\n    return results;\n  };\n\n  elem.mouseleave(() => {\n    if (panel.tooltip.shared) {\n      const plot = elem.data().plot;\n      if (plot) {\n        $tooltip.detach();\n        plot.unhighlight();\n      }\n    }\n    appEvents.emit('graph-hover-clear');\n  });\n\n  elem.bind('plothover', (event, pos, item) => {\n    self.show(pos, item);\n\n    // broadcast to other graph panels that we are hovering!\n    pos.panelRelY = (pos.pageY - elem.offset().top) / elem.height();\n    appEvents.emit('graph-hover', { pos: pos, panel: panel });\n  });\n\n  elem.bind('plotclick', (event, pos, item) => {\n    appEvents.emit('graph-click', { pos: pos, panel: panel, item: item });\n  });\n\n  this.clear = plot => {\n    $tooltip.detach();\n    plot.clearCrosshair();\n    plot.unhighlight();\n  };\n\n  this.show = (pos, item) => {\n    const plot = elem.data().plot;\n    const plotData = plot.getData();\n    const xAxes = plot.getXAxes();\n    const xMode = xAxes[0].options.mode;\n    const seriesList = getSeriesFn();\n    let allSeriesMode = panel.tooltip.shared;\n    let group, value, absoluteTime, hoverInfo, i, series, seriesHtml, tooltipFormat;\n\n    // if panelRelY is defined another panel wants us to show a tooltip\n    // get pageX from position on x axis and pageY from relative position in original panel\n    if (pos.panelRelY) {\n      const pointOffset = plot.pointOffset({ x: pos.x });\n      if (Number.isNaN(pointOffset.left) || pointOffset.left < 0 || pointOffset.left > elem.width()) {\n        self.clear(plot);\n        return;\n      }\n      pos.pageX = elem.offset().left + pointOffset.left;\n      pos.pageY = elem.offset().top + elem.height() * pos.panelRelY;\n      const isVisible =\n        pos.pageY >= $(window).scrollTop() && pos.pageY <= $(window).innerHeight() + $(window).scrollTop();\n      if (!isVisible) {\n        self.clear(plot);\n        return;\n      }\n      plot.setCrosshair(pos);\n      allSeriesMode = true;\n\n      if (dashboard.sharedCrosshairModeOnly()) {\n        // if only crosshair mode we are done\n        return;\n      }\n    }\n\n    if (seriesList.length === 0) {\n      return;\n    }\n\n    if (seriesList[0].hasMsResolution) {\n      tooltipFormat = 'YYYY-MM-DD HH:mm:ss.SSS';\n    } else {\n      tooltipFormat = 'YYYY-MM-DD HH:mm:ss';\n    }\n\n    if (allSeriesMode) {\n      plot.unhighlight();\n\n      const seriesHoverInfo = self.getMultiSeriesPlotHoverInfo(plotData, pos);\n\n      seriesHtml = '';\n\n      absoluteTime = dashboard.formatDate(seriesHoverInfo.time, tooltipFormat);\n\n      // Dynamically reorder the hovercard for the current time point if the\n      // option is enabled.\n      if (panel.tooltip.sort === 2) {\n        seriesHoverInfo.sort((a, b) => {\n          return b.value - a.value;\n        });\n      } else if (panel.tooltip.sort === 1) {\n        seriesHoverInfo.sort((a, b) => {\n          return a.value - b.value;\n        });\n      }\n\n      for (i = 0; i < seriesHoverInfo.length; i++) {\n        hoverInfo = seriesHoverInfo[i];\n\n        if (hoverInfo.hidden) {\n          continue;\n        }\n\n        let highlightClass = '';\n        if (item && hoverInfo.index === item.seriesIndex) {\n          highlightClass = 'graph-tooltip-list-item--highlight';\n        }\n\n        series = seriesList[hoverInfo.index];\n\n        value = series.formatValue(hoverInfo.value);\n\n        seriesHtml +=\n          '<div class=\"graph-tooltip-list-item ' + highlightClass + '\"><div class=\"graph-tooltip-series-name\">';\n        seriesHtml +=\n          '<i class=\"fa fa-minus\" style=\"color:' + hoverInfo.color + ';\"></i> ' + hoverInfo.label + ':</div>';\n        seriesHtml += '<div class=\"graph-tooltip-value\">' + value + '</div></div>';\n        plot.highlight(hoverInfo.index, hoverInfo.hoverIndex);\n      }\n\n      self.renderAndShow(absoluteTime, seriesHtml, pos, xMode);\n    } else if (item) {\n      // single series tooltip\n      series = seriesList[item.seriesIndex];\n      group = '<div class=\"graph-tooltip-list-item\"><div class=\"graph-tooltip-series-name\">';\n      group +=\n        '<i class=\"fa fa-minus\" style=\"color:' + item.series.color + ';\"></i> ' + series.aliasEscaped + ':</div>';\n\n      if (panel.stack && panel.tooltip.value_type === 'individual') {\n        value = item.datapoint[1] - item.datapoint[2];\n      } else {\n        value = item.datapoint[1];\n      }\n\n      value = series.formatValue(value);\n\n      absoluteTime = dashboard.formatDate(item.datapoint[0], tooltipFormat);\n\n      group += '<div class=\"graph-tooltip-value\">' + value + '</div>';\n\n      self.renderAndShow(absoluteTime, group, pos, xMode);\n    } else {\n      // no hit\n      $tooltip.detach();\n    }\n  };\n}\n","import 'vendor/flot/jquery.flot';\nimport $ from 'jquery';\nimport _ from 'lodash';\n\nexport class ThresholdManager {\n  plot: any;\n  placeholder: any;\n  height: any;\n  thresholds: any;\n  needsCleanup: boolean;\n  hasSecondYAxis: any;\n\n  constructor(private panelCtrl) {}\n\n  getHandleHtml(handleIndex, model, valueStr) {\n    let stateClass = model.colorMode;\n    if (model.colorMode === 'custom') {\n      stateClass = 'critical';\n    }\n\n    return `\n    <div class=\"alert-handle-wrapper alert-handle-wrapper--T${handleIndex}\">\n      <div class=\"alert-handle-line alert-handle-line--${stateClass}\">\n      </div>\n      <div class=\"alert-handle\" data-handle-index=\"${handleIndex}\">\n        <i class=\"icon-gf icon-gf-${stateClass} alert-state-${stateClass}\"></i>\n        <span class=\"alert-handle-value\">${valueStr}<i class=\"alert-handle-grip\"></i></span>\n      </div>\n    </div>`;\n  }\n\n  initDragging(evt) {\n    const handleElem = $(evt.currentTarget).parents('.alert-handle-wrapper');\n    const handleIndex = $(evt.currentTarget).data('handleIndex');\n\n    let lastY = null;\n    let posTop;\n    const plot = this.plot;\n    const panelCtrl = this.panelCtrl;\n    const model = this.thresholds[handleIndex];\n\n    function dragging(evt) {\n      if (lastY === null) {\n        lastY = evt.clientY;\n      } else {\n        const diff = evt.clientY - lastY;\n        posTop = posTop + diff;\n        lastY = evt.clientY;\n        handleElem.css({ top: posTop + diff });\n      }\n    }\n\n    function stopped() {\n      // calculate graph level\n      let graphValue = plot.c2p({ left: 0, top: posTop }).y;\n      graphValue = parseInt(graphValue.toFixed(0), 10);\n      model.value = graphValue;\n\n      handleElem.off('mousemove', dragging);\n      handleElem.off('mouseup', dragging);\n      handleElem.off('mouseleave', dragging);\n\n      // trigger digest and render\n      panelCtrl.$scope.$apply(() => {\n        panelCtrl.render();\n        panelCtrl.events.emit('threshold-changed', {\n          threshold: model,\n          handleIndex: handleIndex,\n        });\n      });\n    }\n\n    lastY = null;\n    posTop = handleElem.position().top;\n\n    handleElem.on('mousemove', dragging);\n    handleElem.on('mouseup', stopped);\n    handleElem.on('mouseleave', stopped);\n  }\n\n  cleanUp() {\n    this.placeholder.find('.alert-handle-wrapper').remove();\n    this.needsCleanup = false;\n  }\n\n  renderHandle(handleIndex, defaultHandleTopPos) {\n    const model = this.thresholds[handleIndex];\n    const value = model.value;\n    let valueStr = value;\n    let handleTopPos = 0;\n\n    // handle no value\n    if (!_.isNumber(value)) {\n      valueStr = '';\n      handleTopPos = defaultHandleTopPos;\n    } else {\n      const valueCanvasPos = this.plot.p2c({ x: 0, y: value });\n      handleTopPos = Math.round(Math.min(Math.max(valueCanvasPos.top, 0), this.height) - 6);\n    }\n\n    const handleElem = $(this.getHandleHtml(handleIndex, model, valueStr));\n    this.placeholder.append(handleElem);\n\n    handleElem.toggleClass('alert-handle-wrapper--no-value', valueStr === '');\n    handleElem.css({ top: handleTopPos });\n  }\n\n  shouldDrawHandles() {\n    return !this.hasSecondYAxis && this.panelCtrl.editingThresholds && this.panelCtrl.panel.thresholds.length > 0;\n  }\n\n  prepare(elem, data) {\n    this.hasSecondYAxis = false;\n    for (let i = 0; i < data.length; i++) {\n      if (data[i].yaxis > 1) {\n        this.hasSecondYAxis = true;\n        break;\n      }\n    }\n\n    if (this.shouldDrawHandles()) {\n      const thresholdMargin = this.panelCtrl.panel.thresholds.length > 1 ? '220px' : '110px';\n      elem.css('margin-right', thresholdMargin);\n    } else if (this.needsCleanup) {\n      elem.css('margin-right', '0');\n    }\n  }\n\n  draw(plot) {\n    this.thresholds = this.panelCtrl.panel.thresholds;\n    this.plot = plot;\n    this.placeholder = plot.getPlaceholder();\n\n    if (this.needsCleanup) {\n      this.cleanUp();\n    }\n\n    if (!this.shouldDrawHandles()) {\n      return;\n    }\n\n    this.height = plot.height();\n\n    if (this.thresholds.length > 0) {\n      this.renderHandle(0, 10);\n    }\n    if (this.thresholds.length > 1) {\n      this.renderHandle(1, this.height - 30);\n    }\n\n    this.placeholder.off('mousedown', '.alert-handle');\n    this.placeholder.on('mousedown', '.alert-handle', this.initDragging.bind(this));\n    this.needsCleanup = true;\n  }\n\n  addFlotOptions(options, panel) {\n    if (!panel.thresholds || panel.thresholds.length === 0) {\n      return;\n    }\n\n    let gtLimit = Infinity;\n    let ltLimit = -Infinity;\n    let i, threshold, other;\n\n    for (i = 0; i < panel.thresholds.length; i++) {\n      threshold = panel.thresholds[i];\n      if (!_.isNumber(threshold.value)) {\n        continue;\n      }\n\n      let limit;\n      switch (threshold.op) {\n        case 'gt': {\n          limit = gtLimit;\n          // if next threshold is less then op and greater value, then use that as limit\n          if (panel.thresholds.length > i + 1) {\n            other = panel.thresholds[i + 1];\n            if (other.value > threshold.value) {\n              limit = other.value;\n              ltLimit = limit;\n            }\n          }\n          break;\n        }\n        case 'lt': {\n          limit = ltLimit;\n          // if next threshold is less then op and greater value, then use that as limit\n          if (panel.thresholds.length > i + 1) {\n            other = panel.thresholds[i + 1];\n            if (other.value < threshold.value) {\n              limit = other.value;\n              gtLimit = limit;\n            }\n          }\n          break;\n        }\n      }\n\n      let fillColor, lineColor;\n      switch (threshold.colorMode) {\n        case 'critical': {\n          fillColor = 'rgba(234, 112, 112, 0.12)';\n          lineColor = 'rgba(237, 46, 24, 0.60)';\n          break;\n        }\n        case 'warning': {\n          fillColor = 'rgba(235, 138, 14, 0.12)';\n          lineColor = 'rgba(247, 149, 32, 0.60)';\n          break;\n        }\n        case 'ok': {\n          fillColor = 'rgba(11, 237, 50, 0.090)';\n          lineColor = 'rgba(6,163,69, 0.60)';\n          break;\n        }\n        case 'custom': {\n          fillColor = threshold.fillColor;\n          lineColor = threshold.lineColor;\n          break;\n        }\n      }\n\n      // fill\n      if (threshold.fill) {\n        if (threshold.yaxis === 'right' && this.hasSecondYAxis) {\n          options.grid.markings.push({\n            y2axis: { from: threshold.value, to: limit },\n            color: fillColor,\n          });\n        } else {\n          options.grid.markings.push({\n            yaxis: { from: threshold.value, to: limit },\n            color: fillColor,\n          });\n        }\n      }\n      if (threshold.line) {\n        if (threshold.yaxis === 'right' && this.hasSecondYAxis) {\n          options.grid.markings.push({\n            y2axis: { from: threshold.value, to: threshold.value },\n            color: lineColor,\n          });\n        } else {\n          options.grid.markings.push({\n            yaxis: { from: threshold.value, to: threshold.value },\n            color: lineColor,\n          });\n        }\n      }\n    }\n  }\n}\n","import _ from 'lodash';\n\n/**\n * To align two Y axes by Y level\n * @param yAxes data [{min: min_y1, min: max_y1}, {min: min_y2, max: max_y2}]\n * @param level Y level\n */\nexport function alignYLevel(yAxes, level) {\n  if (isNaN(level) || !checkCorrectAxis(yAxes)) {\n    return;\n  }\n\n  const [yLeft, yRight] = yAxes;\n  moveLevelToZero(yLeft, yRight, level);\n\n  expandStuckValues(yLeft, yRight);\n\n  // one of graphs on zero\n  const zero = yLeft.min === 0 || yRight.min === 0 || yLeft.max === 0 || yRight.max === 0;\n\n  const oneSide = checkOneSide(yLeft, yRight);\n\n  if (zero && oneSide) {\n    yLeft.min = yLeft.max > 0 ? 0 : yLeft.min;\n    yLeft.max = yLeft.max > 0 ? yLeft.max : 0;\n    yRight.min = yRight.max > 0 ? 0 : yRight.min;\n    yRight.max = yRight.max > 0 ? yRight.max : 0;\n  } else {\n    if (checkOppositeSides(yLeft, yRight)) {\n      if (yLeft.min >= 0) {\n        yLeft.min = -yLeft.max;\n        yRight.max = -yRight.min;\n      } else {\n        yLeft.max = -yLeft.min;\n        yRight.min = -yRight.max;\n      }\n    } else {\n      const rate = getRate(yLeft, yRight);\n\n      if (oneSide) {\n        // all graphs above the Y level\n        if (yLeft.min > 0) {\n          yLeft.min = yLeft.max / rate;\n          yRight.min = yRight.max / rate;\n        } else {\n          yLeft.max = yLeft.min / rate;\n          yRight.max = yRight.min / rate;\n        }\n      } else {\n        if (checkTwoCross(yLeft, yRight)) {\n          yLeft.min = yRight.min ? yRight.min * rate : yLeft.min;\n          yRight.min = yLeft.min ? yLeft.min / rate : yRight.min;\n          yLeft.max = yRight.max ? yRight.max * rate : yLeft.max;\n          yRight.max = yLeft.max ? yLeft.max / rate : yRight.max;\n        } else {\n          yLeft.min = yLeft.min > 0 ? yRight.min * rate : yLeft.min;\n          yRight.min = yRight.min > 0 ? yLeft.min / rate : yRight.min;\n          yLeft.max = yLeft.max < 0 ? yRight.max * rate : yLeft.max;\n          yRight.max = yRight.max < 0 ? yLeft.max / rate : yRight.max;\n        }\n      }\n    }\n  }\n\n  restoreLevelFromZero(yLeft, yRight, level);\n}\n\nfunction expandStuckValues(yLeft, yRight) {\n  // wide Y min and max using increased wideFactor\n  const wideFactor = 0.25;\n  if (yLeft.max === yLeft.min) {\n    yLeft.min -= wideFactor;\n    yLeft.max += wideFactor;\n  }\n  if (yRight.max === yRight.min) {\n    yRight.min -= wideFactor;\n    yRight.max += wideFactor;\n  }\n}\n\nfunction moveLevelToZero(yLeft, yRight, level) {\n  if (level !== 0) {\n    yLeft.min -= level;\n    yLeft.max -= level;\n    yRight.min -= level;\n    yRight.max -= level;\n  }\n}\n\nfunction restoreLevelFromZero(yLeft, yRight, level) {\n  if (level !== 0) {\n    yLeft.min += level;\n    yLeft.max += level;\n    yRight.min += level;\n    yRight.max += level;\n  }\n}\n\nfunction checkCorrectAxis(axis) {\n  return axis.length === 2 && checkCorrectAxes(axis[0]) && checkCorrectAxes(axis[1]);\n}\n\nfunction checkCorrectAxes(axes) {\n  return 'min' in axes && 'max' in axes;\n}\n\nfunction checkOneSide(yLeft, yRight) {\n  // on the one hand with respect to zero\n  return (yLeft.min >= 0 && yRight.min >= 0) || (yLeft.max <= 0 && yRight.max <= 0);\n}\n\nfunction checkTwoCross(yLeft, yRight) {\n  // both across zero\n  return yLeft.min <= 0 && yLeft.max >= 0 && yRight.min <= 0 && yRight.max >= 0;\n}\n\nfunction checkOppositeSides(yLeft, yRight) {\n  // on the opposite sides with respect to zero\n  return (yLeft.min >= 0 && yRight.max <= 0) || (yLeft.max <= 0 && yRight.min >= 0);\n}\n\nfunction getRate(yLeft, yRight) {\n  let rateLeft, rateRight, rate;\n  if (checkTwoCross(yLeft, yRight)) {\n    rateLeft = yRight.min ? yLeft.min / yRight.min : 0;\n    rateRight = yRight.max ? yLeft.max / yRight.max : 0;\n  } else {\n    if (checkOneSide(yLeft, yRight)) {\n      const absLeftMin = Math.abs(yLeft.min);\n      const absLeftMax = Math.abs(yLeft.max);\n      const absRightMin = Math.abs(yRight.min);\n      const absRightMax = Math.abs(yRight.max);\n      const upLeft = _.max([absLeftMin, absLeftMax]);\n      const downLeft = _.min([absLeftMin, absLeftMax]);\n      const upRight = _.max([absRightMin, absRightMax]);\n      const downRight = _.min([absRightMin, absRightMax]);\n\n      rateLeft = downLeft ? upLeft / downLeft : upLeft;\n      rateRight = downRight ? upRight / downRight : upRight;\n    } else {\n      if (yLeft.min > 0 || yRight.min > 0) {\n        rateLeft = yLeft.max / yRight.max;\n        rateRight = 0;\n      } else {\n        rateLeft = 0;\n        rateRight = yLeft.min / yRight.min;\n      }\n    }\n  }\n\n  rate = rateLeft > rateRight ? rateLeft : rateRight;\n\n  return rate;\n}\n","import _ from 'lodash';\nimport TimeSeries from 'app/core/time_series2';\n\n/**\n * Convert series into array of series values.\n * @param data Array of series\n */\nexport function getSeriesValues(dataList: TimeSeries[]): number[] {\n  const VALUE_INDEX = 0;\n  const values = [];\n\n  // Count histogam stats\n  for (let i = 0; i < dataList.length; i++) {\n    const series = dataList[i];\n    const datapoints = series.datapoints;\n    for (let j = 0; j < datapoints.length; j++) {\n      if (datapoints[j][VALUE_INDEX] !== null) {\n        values.push(datapoints[j][VALUE_INDEX]);\n      }\n    }\n  }\n\n  return values;\n}\n\n/**\n * Convert array of values into timeseries-like histogram:\n * [[val_1, count_1], [val_2, count_2], ..., [val_n, count_n]]\n * @param values\n * @param bucketSize\n */\nexport function convertValuesToHistogram(values: number[], bucketSize: number, min: number, max: number): any[] {\n  const histogram = {};\n\n  const minBound = getBucketBound(min, bucketSize);\n  const maxBound = getBucketBound(max, bucketSize);\n  let bound = minBound;\n  let n = 0;\n  while (bound <= maxBound) {\n    histogram[bound] = 0;\n    bound = minBound + bucketSize * n;\n    n++;\n  }\n\n  for (let i = 0; i < values.length; i++) {\n    const bound = getBucketBound(values[i], bucketSize);\n    histogram[bound] = histogram[bound] + 1;\n  }\n\n  const histogamSeries = _.map(histogram, (count, bound) => {\n    return [Number(bound), count];\n  });\n\n  // Sort by Y axis values\n  return _.sortBy(histogamSeries, point => point[0]);\n}\n\n/**\n * Convert series into array of histogram data.\n * @param data Array of series\n * @param bucketSize\n */\nexport function convertToHistogramData(\n  data: any,\n  bucketSize: number,\n  hiddenSeries: any,\n  min: number,\n  max: number\n): any[] {\n  return data.map(series => {\n    const values = getSeriesValues([series]);\n    series.histogram = true;\n    if (!hiddenSeries[series.alias]) {\n      const histogram = convertValuesToHistogram(values, bucketSize, min, max);\n      series.data = histogram;\n    } else {\n      series.data = [];\n    }\n    return series;\n  });\n}\n\nfunction getBucketBound(value: number, bucketSize: number): number {\n  return Math.floor(value / bucketSize) * bucketSize;\n}\n","import 'vendor/flot/jquery.flot';\nimport 'vendor/flot/jquery.flot.selection';\nimport 'vendor/flot/jquery.flot.time';\nimport 'vendor/flot/jquery.flot.stack';\nimport 'vendor/flot/jquery.flot.stackpercent';\nimport 'vendor/flot/jquery.flot.fillbelow';\nimport 'vendor/flot/jquery.flot.crosshair';\nimport 'vendor/flot/jquery.flot.dashes';\nimport './jquery.flot.events';\n\nimport $ from 'jquery';\nimport _ from 'lodash';\nimport moment from 'moment';\nimport kbn from 'app/core/utils/kbn';\nimport { tickStep } from 'app/core/utils/ticks';\nimport { appEvents, coreModule, updateLegendValues } from 'app/core/core';\nimport GraphTooltip from './graph_tooltip';\nimport { ThresholdManager } from './threshold_manager';\nimport { EventManager } from 'app/features/annotations/all';\nimport { convertToHistogramData } from './histogram';\nimport { alignYLevel } from './align_yaxes';\nimport config from 'app/core/config';\n\nimport { GraphCtrl } from './module';\n\nclass GraphElement {\n  ctrl: GraphCtrl;\n  tooltip: any;\n  dashboard: any;\n  annotations: object[];\n  panel: any;\n  plot: any;\n  sortedSeries: any[];\n  data: any[];\n  panelWidth: number;\n  eventManager: EventManager;\n  thresholdManager: ThresholdManager;\n\n  constructor(private scope, private elem, private timeSrv) {\n    this.ctrl = scope.ctrl;\n    this.dashboard = this.ctrl.dashboard;\n    this.panel = this.ctrl.panel;\n    this.annotations = [];\n\n    this.panelWidth = 0;\n    this.eventManager = new EventManager(this.ctrl);\n    this.thresholdManager = new ThresholdManager(this.ctrl);\n    this.tooltip = new GraphTooltip(this.elem, this.ctrl.dashboard, this.scope, () => {\n      return this.sortedSeries;\n    });\n\n    // panel events\n    this.ctrl.events.on('panel-teardown', this.onPanelteardown.bind(this));\n\n    /**\n     * Split graph rendering into two parts.\n     * First, calculate series stats in buildFlotPairs() function. Then legend rendering started\n     * (see ctrl.events.on('render') in legend.ts).\n     * When legend is rendered it emits 'legend-rendering-complete' and graph rendered.\n     */\n    this.ctrl.events.on('render', this.onRender.bind(this));\n    this.ctrl.events.on('legend-rendering-complete', this.onLegendRenderingComplete.bind(this));\n\n    // global events\n    appEvents.on('graph-hover', this.onGraphHover.bind(this), scope);\n\n    appEvents.on('graph-hover-clear', this.onGraphHoverClear.bind(this), scope);\n\n    this.elem.bind('plotselected', this.onPlotSelected.bind(this));\n\n    this.elem.bind('plotclick', this.onPlotClick.bind(this));\n    scope.$on('$destroy', this.onScopeDestroy.bind(this));\n  }\n\n  onRender(renderData) {\n    this.data = renderData || this.data;\n    if (!this.data) {\n      return;\n    }\n    this.annotations = this.ctrl.annotations || [];\n    this.buildFlotPairs(this.data);\n    const graphHeight = this.elem.height();\n    updateLegendValues(this.data, this.panel, graphHeight);\n\n    this.ctrl.events.emit('render-legend');\n  }\n\n  onGraphHover(evt) {\n    // ignore other graph hover events if shared tooltip is disabled\n    if (!this.dashboard.sharedTooltipModeEnabled()) {\n      return;\n    }\n\n    // ignore if we are the emitter\n    if (!this.plot || evt.panel.id === this.panel.id || this.ctrl.otherPanelInFullscreenMode()) {\n      return;\n    }\n\n    this.tooltip.show(evt.pos);\n  }\n\n  onPanelteardown() {\n    this.thresholdManager = null;\n\n    if (this.plot) {\n      this.plot.destroy();\n      this.plot = null;\n    }\n  }\n\n  onLegendRenderingComplete() {\n    this.render_panel();\n  }\n\n  onGraphHoverClear(event, info) {\n    if (this.plot) {\n      this.tooltip.clear(this.plot);\n    }\n  }\n\n  onPlotSelected(event, ranges) {\n    if (this.panel.xaxis.mode !== 'time') {\n      // Skip if panel in histogram or series mode\n      this.plot.clearSelection();\n      return;\n    }\n\n    if ((ranges.ctrlKey || ranges.metaKey) && (this.dashboard.meta.canEdit || this.dashboard.meta.canMakeEditable)) {\n      // Add annotation\n      setTimeout(() => {\n        this.eventManager.updateTime(ranges.xaxis);\n      }, 100);\n    } else {\n      this.scope.$apply(() => {\n        this.timeSrv.setTime({\n          from: moment.utc(ranges.xaxis.from),\n          to: moment.utc(ranges.xaxis.to),\n        });\n      });\n    }\n  }\n\n  onPlotClick(event, pos, item) {\n    if (this.panel.xaxis.mode !== 'time') {\n      // Skip if panel in histogram or series mode\n      return;\n    }\n\n    if ((pos.ctrlKey || pos.metaKey) && (this.dashboard.meta.canEdit || this.dashboard.meta.canMakeEditable)) {\n      // Skip if range selected (added in \"plotselected\" event handler)\n      const isRangeSelection = pos.x !== pos.x1;\n      if (!isRangeSelection) {\n        setTimeout(() => {\n          this.eventManager.updateTime({ from: pos.x, to: null });\n        }, 100);\n      }\n    }\n  }\n\n  onScopeDestroy() {\n    this.tooltip.destroy();\n    this.elem.off();\n    this.elem.remove();\n  }\n\n  shouldAbortRender() {\n    if (!this.data) {\n      return true;\n    }\n\n    if (this.panelWidth === 0) {\n      return true;\n    }\n\n    return false;\n  }\n\n  drawHook(plot) {\n    // add left axis labels\n    if (this.panel.yaxes[0].label && this.panel.yaxes[0].show) {\n      $(\"<div class='axisLabel left-yaxis-label flot-temp-elem'></div>\")\n        .text(this.panel.yaxes[0].label)\n        .appendTo(this.elem);\n    }\n\n    // add right axis labels\n    if (this.panel.yaxes[1].label && this.panel.yaxes[1].show) {\n      $(\"<div class='axisLabel right-yaxis-label flot-temp-elem'></div>\")\n        .text(this.panel.yaxes[1].label)\n        .appendTo(this.elem);\n    }\n\n    if (this.ctrl.dataWarning) {\n      $(`<div class=\"datapoints-warning flot-temp-elem\">${this.ctrl.dataWarning.title}</div>`).appendTo(this.elem);\n    }\n\n    this.thresholdManager.draw(plot);\n  }\n\n  processOffsetHook(plot, gridMargin) {\n    const left = this.panel.yaxes[0];\n    const right = this.panel.yaxes[1];\n    if (left.show && left.label) {\n      gridMargin.left = 20;\n    }\n    if (right.show && right.label) {\n      gridMargin.right = 20;\n    }\n\n    // apply y-axis min/max options\n    const yaxis = plot.getYAxes();\n    for (let i = 0; i < yaxis.length; i++) {\n      const axis = yaxis[i];\n      const panelOptions = this.panel.yaxes[i];\n      axis.options.max = axis.options.max !== null ? axis.options.max : panelOptions.max;\n      axis.options.min = axis.options.min !== null ? axis.options.min : panelOptions.min;\n    }\n  }\n\n  processRangeHook(plot) {\n    const yAxes = plot.getYAxes();\n    const align = this.panel.yaxis.align || false;\n\n    if (yAxes.length > 1 && align === true) {\n      const level = this.panel.yaxis.alignLevel || 0;\n      alignYLevel(yAxes, parseFloat(level));\n    }\n  }\n\n  // Series could have different timeSteps,\n  // let's find the smallest one so that bars are correctly rendered.\n  // In addition, only take series which are rendered as bars for this.\n  getMinTimeStepOfSeries(data) {\n    let min = Number.MAX_VALUE;\n\n    for (let i = 0; i < data.length; i++) {\n      if (!data[i].stats.timeStep) {\n        continue;\n      }\n      if (this.panel.bars) {\n        if (data[i].bars && data[i].bars.show === false) {\n          continue;\n        }\n      } else {\n        if (typeof data[i].bars === 'undefined' || typeof data[i].bars.show === 'undefined' || !data[i].bars.show) {\n          continue;\n        }\n      }\n\n      if (data[i].stats.timeStep < min) {\n        min = data[i].stats.timeStep;\n      }\n    }\n\n    return min;\n  }\n\n  // Function for rendering panel\n  render_panel() {\n    this.panelWidth = this.elem.width();\n    if (this.shouldAbortRender()) {\n      return;\n    }\n\n    // give space to alert editing\n    this.thresholdManager.prepare(this.elem, this.data);\n\n    // un-check dashes if lines are unchecked\n    this.panel.dashes = this.panel.lines ? this.panel.dashes : false;\n\n    // Populate element\n    const options: any = this.buildFlotOptions(this.panel);\n    this.prepareXAxis(options, this.panel);\n    this.configureYAxisOptions(this.data, options);\n    this.thresholdManager.addFlotOptions(options, this.panel);\n    this.eventManager.addFlotEvents(this.annotations, options);\n\n    this.sortedSeries = this.sortSeries(this.data, this.panel);\n    this.callPlot(options, true);\n  }\n\n  buildFlotPairs(data) {\n    for (let i = 0; i < data.length; i++) {\n      const series = data[i];\n      series.data = series.getFlotPairs(series.nullPointMode || this.panel.nullPointMode);\n\n      // if hidden remove points and disable stack\n      if (this.ctrl.hiddenSeries[series.alias]) {\n        series.data = [];\n        series.stack = false;\n      }\n    }\n  }\n\n  prepareXAxis(options, panel) {\n    switch (panel.xaxis.mode) {\n      case 'series': {\n        options.series.bars.barWidth = 0.7;\n        options.series.bars.align = 'center';\n\n        for (let i = 0; i < this.data.length; i++) {\n          const series = this.data[i];\n          series.data = [[i + 1, series.stats[panel.xaxis.values[0]]]];\n        }\n\n        this.addXSeriesAxis(options);\n        break;\n      }\n      case 'histogram': {\n        let bucketSize: number;\n\n        if (this.data.length) {\n          const histMin = _.min(_.map(this.data, s => s.stats.min));\n          const histMax = _.max(_.map(this.data, s => s.stats.max));\n          const ticks = panel.xaxis.buckets || this.panelWidth / 50;\n          bucketSize = tickStep(histMin, histMax, ticks);\n          options.series.bars.barWidth = bucketSize * 0.8;\n          this.data = convertToHistogramData(this.data, bucketSize, this.ctrl.hiddenSeries, histMin, histMax);\n        } else {\n          bucketSize = 0;\n        }\n\n        this.addXHistogramAxis(options, bucketSize);\n        break;\n      }\n      case 'table': {\n        options.series.bars.barWidth = 0.7;\n        options.series.bars.align = 'center';\n        this.addXTableAxis(options);\n        break;\n      }\n      default: {\n        options.series.bars.barWidth = this.getMinTimeStepOfSeries(this.data) / 1.5;\n        this.addTimeAxis(options);\n        break;\n      }\n    }\n  }\n\n  callPlot(options, incrementRenderCounter) {\n    try {\n      this.plot = $.plot(this.elem, this.sortedSeries, options);\n      if (this.ctrl.renderError) {\n        delete this.ctrl.error;\n        delete this.ctrl.inspector;\n      }\n    } catch (e) {\n      console.log('flotcharts error', e);\n      this.ctrl.error = e.message || 'Render Error';\n      this.ctrl.renderError = true;\n      this.ctrl.inspector = { error: e };\n    }\n\n    if (incrementRenderCounter) {\n      this.ctrl.renderingCompleted();\n    }\n  }\n\n  buildFlotOptions(panel) {\n    let gridColor = '#c8c8c8';\n    if (config.bootData.user.lightTheme === true) {\n      gridColor = '#a1a1a1';\n    }\n    const stack = panel.stack ? true : null;\n    const options = {\n      hooks: {\n        draw: [this.drawHook.bind(this)],\n        processOffset: [this.processOffsetHook.bind(this)],\n        processRange: [this.processRangeHook.bind(this)],\n      },\n      legend: { show: false },\n      series: {\n        stackpercent: panel.stack ? panel.percentage : false,\n        stack: panel.percentage ? null : stack,\n        lines: {\n          show: panel.lines,\n          zero: false,\n          fill: this.translateFillOption(panel.fill),\n          lineWidth: panel.dashes ? 0 : panel.linewidth,\n          steps: panel.steppedLine,\n        },\n        dashes: {\n          show: panel.dashes,\n          lineWidth: panel.linewidth,\n          dashLength: [panel.dashLength, panel.spaceLength],\n        },\n        bars: {\n          show: panel.bars,\n          fill: 1,\n          barWidth: 1,\n          zero: false,\n          lineWidth: 0,\n        },\n        points: {\n          show: panel.points,\n          fill: 1,\n          fillColor: false,\n          radius: panel.points ? panel.pointradius : 2,\n        },\n        shadowSize: 0,\n      },\n      yaxes: [],\n      xaxis: {},\n      grid: {\n        minBorderMargin: 0,\n        markings: [],\n        backgroundColor: null,\n        borderWidth: 0,\n        hoverable: true,\n        clickable: true,\n        color: gridColor,\n        margin: { left: 0, right: 0 },\n        labelMarginX: 0,\n      },\n      selection: {\n        mode: 'x',\n        color: '#666',\n      },\n      crosshair: {\n        mode: 'x',\n      },\n    };\n    return options;\n  }\n\n  sortSeries(series, panel) {\n    const sortBy = panel.legend.sort;\n    const sortOrder = panel.legend.sortDesc;\n    const haveSortBy = sortBy !== null && sortBy !== undefined;\n    const haveSortOrder = sortOrder !== null && sortOrder !== undefined;\n    const shouldSortBy = panel.stack && haveSortBy && haveSortOrder;\n    const sortDesc = panel.legend.sortDesc === true ? -1 : 1;\n\n    if (shouldSortBy) {\n      return _.sortBy(series, s => s.stats[sortBy] * sortDesc);\n    } else {\n      return _.sortBy(series, s => s.zindex);\n    }\n  }\n\n  translateFillOption(fill) {\n    if (this.panel.percentage && this.panel.stack) {\n      return fill === 0 ? 0.001 : fill / 10;\n    } else {\n      return fill / 10;\n    }\n  }\n\n  addTimeAxis(options) {\n    const ticks = this.panelWidth / 100;\n    const min = _.isUndefined(this.ctrl.range.from) ? null : this.ctrl.range.from.valueOf();\n    const max = _.isUndefined(this.ctrl.range.to) ? null : this.ctrl.range.to.valueOf();\n\n    options.xaxis = {\n      timezone: this.dashboard.getTimezone(),\n      show: this.panel.xaxis.show,\n      mode: 'time',\n      min: min,\n      max: max,\n      label: 'Datetime',\n      ticks: ticks,\n      timeformat: this.time_format(ticks, min, max),\n    };\n  }\n\n  addXSeriesAxis(options) {\n    const ticks = _.map(this.data, (series, index) => {\n      return [index + 1, series.alias];\n    });\n\n    options.xaxis = {\n      timezone: this.dashboard.getTimezone(),\n      show: this.panel.xaxis.show,\n      mode: null,\n      min: 0,\n      max: ticks.length + 1,\n      label: 'Datetime',\n      ticks: ticks,\n    };\n  }\n\n  addXHistogramAxis(options, bucketSize) {\n    let ticks, min, max;\n    const defaultTicks = this.panelWidth / 50;\n\n    if (this.data.length && bucketSize) {\n      const tickValues = [];\n      for (const d of this.data) {\n        for (const point of d.data) {\n          tickValues[point[0]] = true;\n        }\n      }\n      ticks = Object.keys(tickValues).map(v => Number(v));\n      min = _.min(ticks);\n      max = _.max(ticks);\n\n      // Adjust tick step\n      let tickStep = bucketSize;\n      let ticksNum = Math.floor((max - min) / tickStep);\n      while (ticksNum > defaultTicks) {\n        tickStep = tickStep * 2;\n        ticksNum = Math.ceil((max - min) / tickStep);\n      }\n\n      // Expand ticks for pretty view\n      min = Math.floor(min / tickStep) * tickStep;\n      // 1.01 is 101% - ensure we have enough space for last bar\n      max = Math.ceil(max * 1.01 / tickStep) * tickStep;\n\n      ticks = [];\n      for (let i = min; i <= max; i += tickStep) {\n        ticks.push(i);\n      }\n    } else {\n      // Set defaults if no data\n      ticks = defaultTicks / 2;\n      min = 0;\n      max = 1;\n    }\n\n    options.xaxis = {\n      timezone: this.dashboard.getTimezone(),\n      show: this.panel.xaxis.show,\n      mode: null,\n      min: min,\n      max: max,\n      label: 'Histogram',\n      ticks: ticks,\n    };\n\n    // Use 'short' format for histogram values\n    this.configureAxisMode(options.xaxis, 'short');\n  }\n\n  addXTableAxis(options) {\n    let ticks = _.map(this.data, (series, seriesIndex) => {\n      return _.map(series.datapoints, (point, pointIndex) => {\n        const tickIndex = seriesIndex * series.datapoints.length + pointIndex;\n        return [tickIndex + 1, point[1]];\n      });\n    });\n    ticks = _.flatten(ticks, true);\n\n    options.xaxis = {\n      timezone: this.dashboard.getTimezone(),\n      show: this.panel.xaxis.show,\n      mode: null,\n      min: 0,\n      max: ticks.length + 1,\n      label: 'Datetime',\n      ticks: ticks,\n    };\n  }\n\n  configureYAxisOptions(data, options) {\n    const defaults = {\n      position: 'left',\n      show: this.panel.yaxes[0].show,\n      index: 1,\n      logBase: this.panel.yaxes[0].logBase || 1,\n      min: this.parseNumber(this.panel.yaxes[0].min),\n      max: this.parseNumber(this.panel.yaxes[0].max),\n      tickDecimals: this.panel.yaxes[0].decimals,\n    };\n\n    options.yaxes.push(defaults);\n\n    if (_.find(data, { yaxis: 2 })) {\n      const secondY = _.clone(defaults);\n      secondY.index = 2;\n      secondY.show = this.panel.yaxes[1].show;\n      secondY.logBase = this.panel.yaxes[1].logBase || 1;\n      secondY.position = 'right';\n      secondY.min = this.parseNumber(this.panel.yaxes[1].min);\n      secondY.max = this.parseNumber(this.panel.yaxes[1].max);\n      secondY.tickDecimals = this.panel.yaxes[1].decimals;\n      options.yaxes.push(secondY);\n\n      this.applyLogScale(options.yaxes[1], data);\n      this.configureAxisMode(\n        options.yaxes[1],\n        this.panel.percentage && this.panel.stack ? 'percent' : this.panel.yaxes[1].format\n      );\n    }\n    this.applyLogScale(options.yaxes[0], data);\n    this.configureAxisMode(\n      options.yaxes[0],\n      this.panel.percentage && this.panel.stack ? 'percent' : this.panel.yaxes[0].format\n    );\n  }\n\n  parseNumber(value: any) {\n    if (value === null || typeof value === 'undefined') {\n      return null;\n    }\n\n    return _.toNumber(value);\n  }\n\n  applyLogScale(axis, data) {\n    if (axis.logBase === 1) {\n      return;\n    }\n\n    const minSetToZero = axis.min === 0;\n\n    if (axis.min < Number.MIN_VALUE) {\n      axis.min = null;\n    }\n    if (axis.max < Number.MIN_VALUE) {\n      axis.max = null;\n    }\n\n    let series, i;\n    let max = axis.max,\n      min = axis.min;\n\n    for (i = 0; i < data.length; i++) {\n      series = data[i];\n      if (series.yaxis === axis.index) {\n        if (!max || max < series.stats.max) {\n          max = series.stats.max;\n        }\n        if (!min || min > series.stats.logmin) {\n          min = series.stats.logmin;\n        }\n      }\n    }\n\n    axis.transform = v => {\n      return v < Number.MIN_VALUE ? null : Math.log(v) / Math.log(axis.logBase);\n    };\n    axis.inverseTransform = v => {\n      return Math.pow(axis.logBase, v);\n    };\n\n    if (!max && !min) {\n      max = axis.inverseTransform(+2);\n      min = axis.inverseTransform(-2);\n    } else if (!max) {\n      max = min * axis.inverseTransform(+4);\n    } else if (!min) {\n      min = max * axis.inverseTransform(-4);\n    }\n\n    if (axis.min) {\n      min = axis.inverseTransform(Math.ceil(axis.transform(axis.min)));\n    } else {\n      min = axis.min = axis.inverseTransform(Math.floor(axis.transform(min)));\n    }\n    if (axis.max) {\n      max = axis.inverseTransform(Math.floor(axis.transform(axis.max)));\n    } else {\n      max = axis.max = axis.inverseTransform(Math.ceil(axis.transform(max)));\n    }\n\n    if (!min || min < Number.MIN_VALUE || !max || max < Number.MIN_VALUE) {\n      return;\n    }\n\n    if (Number.isFinite(min) && Number.isFinite(max)) {\n      if (minSetToZero) {\n        axis.min = 0.1;\n        min = 1;\n      }\n\n      axis.ticks = this.generateTicksForLogScaleYAxis(min, max, axis.logBase);\n      if (minSetToZero) {\n        axis.ticks.unshift(0.1);\n      }\n      if (axis.ticks[axis.ticks.length - 1] > axis.max) {\n        axis.max = axis.ticks[axis.ticks.length - 1];\n      }\n    } else {\n      axis.ticks = [1, 2];\n      delete axis.min;\n      delete axis.max;\n    }\n  }\n\n  generateTicksForLogScaleYAxis(min, max, logBase) {\n    let ticks = [];\n\n    let nextTick;\n    for (nextTick = min; nextTick <= max; nextTick *= logBase) {\n      ticks.push(nextTick);\n    }\n\n    const maxNumTicks = Math.ceil(this.ctrl.height / 25);\n    const numTicks = ticks.length;\n    if (numTicks > maxNumTicks) {\n      const factor = Math.ceil(numTicks / maxNumTicks) * logBase;\n      ticks = [];\n\n      for (nextTick = min; nextTick <= max * factor; nextTick *= factor) {\n        ticks.push(nextTick);\n      }\n    }\n\n    return ticks;\n  }\n\n  configureAxisMode(axis, format) {\n    axis.tickFormatter = (val, axis) => {\n      if (!kbn.valueFormats[format]) {\n        throw new Error(`Unit '${format}' is not supported`);\n      }\n      return kbn.valueFormats[format](val, axis.tickDecimals, axis.scaledDecimals);\n    };\n  }\n\n  time_format(ticks, min, max) {\n    if (min && max && ticks) {\n      const range = max - min;\n      const secPerTick = range / ticks / 1000;\n      // Need have 10 milisecond margin on the day range\n      // As sometimes last 24 hour dashboard evaluates to more than 86400000\n      const oneDay = 86400010;\n      const oneYear = 31536000000;\n\n      if (secPerTick <= 45) {\n        return '%H:%M:%S';\n      }\n      if (secPerTick <= 7200 || range <= oneDay) {\n        return '%H:%M';\n      }\n      if (secPerTick <= 80000) {\n        return '%m/%d %H:%M';\n      }\n      if (secPerTick <= 2419200 || range <= oneYear) {\n        return '%m/%d';\n      }\n      return '%Y-%m';\n    }\n\n    return '%H:%M';\n  }\n}\n\n/** @ngInject */\nfunction graphDirective(timeSrv, popoverSrv, contextSrv) {\n  return {\n    restrict: 'A',\n    template: '',\n    link: (scope, elem) => {\n      return new GraphElement(scope, elem, timeSrv);\n    },\n  };\n}\n\ncoreModule.directive('grafanaGraph', graphDirective);\nexport { GraphElement, graphDirective };\n","import angular from 'angular';\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport baron from 'baron';\n\nconst module = angular.module('grafana.directives');\n\nmodule.directive('graphLegend', (popoverSrv, $timeout) => {\n  return {\n    link: (scope, elem) => {\n      let firstRender = true;\n      const ctrl = scope.ctrl;\n      const panel = ctrl.panel;\n      let data;\n      let seriesList;\n      let i;\n      let legendScrollbar;\n      const legendRightDefaultWidth = 10;\n      const legendElem = elem.parent();\n\n      scope.$on('$destroy', () => {\n        destroyScrollbar();\n      });\n\n      ctrl.events.on('render-legend', () => {\n        data = ctrl.seriesList;\n        if (data) {\n          render();\n        }\n        ctrl.events.emit('legend-rendering-complete');\n      });\n\n      function getSeriesIndexForElement(el) {\n        return el.parents('[data-series-index]').data('series-index');\n      }\n\n      function openColorSelector(e) {\n        // if we clicked inside poup container ignore click\n        if ($(e.target).parents('.popover').length) {\n          return;\n        }\n\n        const el = $(e.currentTarget).find('.fa-minus');\n        const index = getSeriesIndexForElement(el);\n        const series = seriesList[index];\n\n        $timeout(() => {\n          popoverSrv.show({\n            element: el[0],\n            position: 'bottom left',\n            targetAttachment: 'top left',\n            template:\n              '<series-color-picker series=\"series\" onToggleAxis=\"toggleAxis\" onColorChange=\"colorSelected\">' +\n              '</series-color-picker>',\n            openOn: 'hover',\n            model: {\n              series: series,\n              toggleAxis: () => {\n                ctrl.toggleAxis(series);\n              },\n              colorSelected: color => {\n                ctrl.changeSeriesColor(series, color);\n              },\n            },\n          });\n        });\n      }\n\n      function toggleSeries(e) {\n        const el = $(e.currentTarget);\n        const index = getSeriesIndexForElement(el);\n        const seriesInfo = seriesList[index];\n        const scrollPosition = legendScrollbar.scroller.scrollTop;\n        ctrl.toggleSeries(seriesInfo, e);\n        legendScrollbar.scroller.scrollTop = scrollPosition;\n      }\n\n      function sortLegend(e) {\n        const el = $(e.currentTarget);\n        const stat = el.data('stat');\n\n        if (stat !== panel.legend.sort) {\n          panel.legend.sortDesc = null;\n        }\n\n        // if already sort ascending, disable sorting\n        if (panel.legend.sortDesc === false) {\n          panel.legend.sort = null;\n          panel.legend.sortDesc = null;\n          ctrl.render();\n          return;\n        }\n\n        panel.legend.sortDesc = !panel.legend.sortDesc;\n        panel.legend.sort = stat;\n        ctrl.render();\n      }\n\n      function getTableHeaderHtml(statName) {\n        if (!panel.legend[statName]) {\n          return '';\n        }\n        let html = '<th class=\"pointer\" data-stat=\"' + statName + '\">' + statName;\n\n        if (panel.legend.sort === statName) {\n          const cssClass = panel.legend.sortDesc ? 'fa fa-caret-down' : 'fa fa-caret-up';\n          html += ' <span class=\"' + cssClass + '\"></span>';\n        }\n\n        return html + '</th>';\n      }\n\n      function render() {\n        const legendWidth = legendElem.width();\n        if (!ctrl.panel.legend.show) {\n          elem.empty();\n          firstRender = true;\n          return;\n        }\n\n        if (firstRender) {\n          elem.on('click', '.graph-legend-icon', openColorSelector);\n          elem.on('click', '.graph-legend-alias', toggleSeries);\n          elem.on('click', 'th', sortLegend);\n          firstRender = false;\n        }\n\n        seriesList = data;\n\n        elem.empty();\n\n        // Set min-width if side style and there is a value, otherwise remove the CSS property\n        // Set width so it works with IE11\n        const width: any = panel.legend.rightSide && panel.legend.sideWidth ? panel.legend.sideWidth + 'px' : '';\n        const ieWidth: any = panel.legend.rightSide && panel.legend.sideWidth ? panel.legend.sideWidth - 1 + 'px' : '';\n        legendElem.css('min-width', width);\n        legendElem.css('width', ieWidth);\n\n        elem.toggleClass('graph-legend-table', panel.legend.alignAsTable === true);\n\n        let tableHeaderElem;\n        if (panel.legend.alignAsTable) {\n          let header = '<tr>';\n          header += '<th colspan=\"2\" style=\"text-align:left\"></th>';\n          if (panel.legend.values) {\n            header += getTableHeaderHtml('min');\n            header += getTableHeaderHtml('max');\n            header += getTableHeaderHtml('avg');\n            header += getTableHeaderHtml('current');\n            header += getTableHeaderHtml('total');\n          }\n          header += '</tr>';\n          tableHeaderElem = $(header);\n        }\n\n        if (panel.legend.sort) {\n          seriesList = _.sortBy(seriesList, series => {\n            let sort = series.stats[panel.legend.sort];\n            if (sort === null) {\n              sort = -Infinity;\n            }\n            return sort;\n          });\n          if (panel.legend.sortDesc) {\n            seriesList = seriesList.reverse();\n          }\n        }\n\n        // render first time for getting proper legend height\n        if (!panel.legend.rightSide || (panel.legend.rightSide && legendWidth !== legendRightDefaultWidth)) {\n          renderLegendElement(tableHeaderElem);\n          elem.empty();\n        }\n\n        renderLegendElement(tableHeaderElem);\n      }\n\n      function renderSeriesLegendElements() {\n        const seriesElements = [];\n        for (i = 0; i < seriesList.length; i++) {\n          const series = seriesList[i];\n\n          if (series.hideFromLegend(panel.legend)) {\n            continue;\n          }\n\n          let html = '<div class=\"graph-legend-series';\n\n          if (series.yaxis === 2) {\n            html += ' graph-legend-series--right-y';\n          }\n          if (ctrl.hiddenSeries[series.alias]) {\n            html += ' graph-legend-series-hidden';\n          }\n          html += '\" data-series-index=\"' + i + '\">';\n          html += '<div class=\"graph-legend-icon\">';\n          html += '<i class=\"fa fa-minus pointer\" style=\"color:' + series.color + '\"></i>';\n          html += '</div>';\n\n          html +=\n            '<a class=\"graph-legend-alias pointer\" title=\"' + series.aliasEscaped + '\">' + series.aliasEscaped + '</a>';\n\n          if (panel.legend.values) {\n            const avg = series.formatValue(series.stats.avg);\n            const current = series.formatValue(series.stats.current);\n            const min = series.formatValue(series.stats.min);\n            const max = series.formatValue(series.stats.max);\n            const total = series.formatValue(series.stats.total);\n\n            if (panel.legend.min) {\n              html += '<div class=\"graph-legend-value min\">' + min + '</div>';\n            }\n            if (panel.legend.max) {\n              html += '<div class=\"graph-legend-value max\">' + max + '</div>';\n            }\n            if (panel.legend.avg) {\n              html += '<div class=\"graph-legend-value avg\">' + avg + '</div>';\n            }\n            if (panel.legend.current) {\n              html += '<div class=\"graph-legend-value current\">' + current + '</div>';\n            }\n            if (panel.legend.total) {\n              html += '<div class=\"graph-legend-value total\">' + total + '</div>';\n            }\n          }\n\n          html += '</div>';\n          seriesElements.push($(html));\n        }\n        return seriesElements;\n      }\n\n      function renderLegendElement(tableHeaderElem) {\n        const legendWidth = elem.width();\n\n        const seriesElements = renderSeriesLegendElements();\n\n        if (panel.legend.alignAsTable) {\n          const tbodyElem = $('<tbody></tbody>');\n          tbodyElem.append(tableHeaderElem);\n          tbodyElem.append(seriesElements);\n          elem.append(tbodyElem);\n          tbodyElem.wrap('<div class=\"graph-legend-scroll\"></div>');\n        } else {\n          elem.append('<div class=\"graph-legend-scroll\"></div>');\n          elem.find('.graph-legend-scroll').append(seriesElements);\n        }\n\n        if (!panel.legend.rightSide || (panel.legend.rightSide && legendWidth !== legendRightDefaultWidth)) {\n          addScrollbar();\n        } else {\n          destroyScrollbar();\n        }\n      }\n\n      function addScrollbar() {\n        const scrollRootClass = 'baron baron__root';\n        const scrollerClass = 'baron__scroller';\n        const scrollBarHTML = `\n          <div class=\"baron__track\">\n            <div class=\"baron__bar\"></div>\n          </div>\n        `;\n\n        const scrollRoot = elem;\n        const scroller = elem.find('.graph-legend-scroll');\n\n        // clear existing scroll bar track to prevent duplication\n        scrollRoot.find('.baron__track').remove();\n\n        scrollRoot.addClass(scrollRootClass);\n        $(scrollBarHTML).appendTo(scrollRoot);\n        scroller.addClass(scrollerClass);\n\n        const scrollbarParams = {\n          root: scrollRoot[0],\n          scroller: scroller[0],\n          bar: '.baron__bar',\n          track: '.baron__track',\n          barOnCls: '_scrollbar',\n          scrollingCls: '_scrolling',\n        };\n\n        if (!legendScrollbar) {\n          legendScrollbar = baron(scrollbarParams);\n        } else {\n          destroyScrollbar();\n          legendScrollbar = baron(scrollbarParams);\n        }\n\n        // #11830 - compensates for Firefox scrollbar calculation error in the baron framework\n        scroller[0].style.marginRight = '-' + (scroller[0].offsetWidth - scroller[0].clientWidth) + 'px';\n\n        legendScrollbar.scroll();\n      }\n\n      function destroyScrollbar() {\n        if (legendScrollbar) {\n          legendScrollbar.dispose();\n          legendScrollbar = undefined;\n        }\n      }\n    },\n  };\n});\n","import _ from 'lodash';\nimport angular from 'angular';\n\n/** @ngInject */\nexport function SeriesOverridesCtrl($scope, $element, popoverSrv) {\n  $scope.overrideMenu = [];\n  $scope.currentOverrides = [];\n  $scope.override = $scope.override || {};\n\n  $scope.addOverrideOption = (name, propertyName, values) => {\n    const option = {\n      text: name,\n      propertyName: propertyName,\n      index: $scope.overrideMenu.lenght,\n      values: values,\n      submenu: _.map(values, value => {\n        return { text: String(value), value: value };\n      }),\n    };\n\n    $scope.overrideMenu.push(option);\n  };\n\n  $scope.setOverride = (item, subItem) => {\n    // handle color overrides\n    if (item.propertyName === 'color') {\n      $scope.openColorSelector($scope.override['color']);\n      return;\n    }\n\n    $scope.override[item.propertyName] = subItem.value;\n\n    // automatically disable lines for this series and the fill below to series\n    // can be removed by the user if they still want lines\n    if (item.propertyName === 'fillBelowTo') {\n      $scope.override['lines'] = false;\n      $scope.ctrl.addSeriesOverride({ alias: subItem.value, lines: false });\n    }\n\n    $scope.updateCurrentOverrides();\n    $scope.ctrl.render();\n  };\n\n  $scope.colorSelected = color => {\n    $scope.override['color'] = color;\n    $scope.updateCurrentOverrides();\n    $scope.ctrl.render();\n  };\n\n  $scope.openColorSelector = color => {\n    const fakeSeries = { color: color };\n    popoverSrv.show({\n      element: $element.find('.dropdown')[0],\n      position: 'top center',\n      openOn: 'click',\n      template: '<series-color-picker series=\"series\" onColorChange=\"colorSelected\" />',\n      model: {\n        autoClose: true,\n        colorSelected: $scope.colorSelected,\n        series: fakeSeries,\n      },\n      onClose: () => {\n        $scope.ctrl.render();\n      },\n    });\n  };\n\n  $scope.removeOverride = option => {\n    delete $scope.override[option.propertyName];\n    $scope.updateCurrentOverrides();\n    $scope.ctrl.refresh();\n  };\n\n  $scope.getSeriesNames = () => {\n    return _.map($scope.ctrl.seriesList, series => {\n      return series.alias;\n    });\n  };\n\n  $scope.updateCurrentOverrides = () => {\n    $scope.currentOverrides = [];\n    _.each($scope.overrideMenu, option => {\n      const value = $scope.override[option.propertyName];\n      if (_.isUndefined(value)) {\n        return;\n      }\n      $scope.currentOverrides.push({\n        name: option.text,\n        propertyName: option.propertyName,\n        value: String(value),\n      });\n    });\n  };\n\n  $scope.addOverrideOption('Bars', 'bars', [true, false]);\n  $scope.addOverrideOption('Lines', 'lines', [true, false]);\n  $scope.addOverrideOption('Line fill', 'fill', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]);\n  $scope.addOverrideOption('Line width', 'linewidth', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]);\n  $scope.addOverrideOption('Null point mode', 'nullPointMode', ['connected', 'null', 'null as zero']);\n  $scope.addOverrideOption('Fill below to', 'fillBelowTo', $scope.getSeriesNames());\n  $scope.addOverrideOption('Staircase line', 'steppedLine', [true, false]);\n  $scope.addOverrideOption('Dashes', 'dashes', [true, false]);\n  $scope.addOverrideOption('Dash Length', 'dashLength', [\n    1,\n    2,\n    3,\n    4,\n    5,\n    6,\n    7,\n    8,\n    9,\n    10,\n    11,\n    12,\n    13,\n    14,\n    15,\n    16,\n    17,\n    18,\n    19,\n    20,\n  ]);\n  $scope.addOverrideOption('Dash Space', 'spaceLength', [\n    1,\n    2,\n    3,\n    4,\n    5,\n    6,\n    7,\n    8,\n    9,\n    10,\n    11,\n    12,\n    13,\n    14,\n    15,\n    16,\n    17,\n    18,\n    19,\n    20,\n  ]);\n  $scope.addOverrideOption('Points', 'points', [true, false]);\n  $scope.addOverrideOption('Points Radius', 'pointradius', [1, 2, 3, 4, 5]);\n  $scope.addOverrideOption('Stack', 'stack', [true, false, 'A', 'B', 'C', 'D']);\n  $scope.addOverrideOption('Color', 'color', ['change']);\n  $scope.addOverrideOption('Y-axis', 'yaxis', [1, 2]);\n  $scope.addOverrideOption('Z-index', 'zindex', [-3, -2, -1, 0, 1, 2, 3]);\n  $scope.addOverrideOption('Transform', 'transform', ['negative-Y']);\n  $scope.addOverrideOption('Legend', 'legend', [true, false]);\n  $scope.addOverrideOption('Hide in tooltip', 'hideTooltip', [true, false]);\n  $scope.updateCurrentOverrides();\n}\n\nangular.module('grafana.controllers').controller('SeriesOverridesCtrl', SeriesOverridesCtrl);\n","import coreModule from 'app/core/core_module';\n\nexport class ThresholdFormCtrl {\n  panelCtrl: any;\n  panel: any;\n  disabled: boolean;\n\n  /** @ngInject */\n  constructor($scope) {\n    this.panel = this.panelCtrl.panel;\n\n    if (this.panel.alert) {\n      this.disabled = true;\n    }\n\n    const unbindDestroy = $scope.$on('$destroy', () => {\n      this.panelCtrl.editingThresholds = false;\n      this.panelCtrl.render();\n      unbindDestroy();\n    });\n\n    this.panelCtrl.editingThresholds = true;\n  }\n\n  addThreshold() {\n    this.panel.thresholds.push({\n      value: undefined,\n      colorMode: 'critical',\n      op: 'gt',\n      fill: true,\n      line: true,\n      yaxis: 'left',\n    });\n    this.panelCtrl.render();\n  }\n\n  removeThreshold(index) {\n    this.panel.thresholds.splice(index, 1);\n    this.panelCtrl.render();\n  }\n\n  render() {\n    this.panelCtrl.render();\n  }\n\n  onFillColorChange(index) {\n    return newColor => {\n      this.panel.thresholds[index].fillColor = newColor;\n      this.render();\n    };\n  }\n\n  onLineColorChange(index) {\n    return newColor => {\n      this.panel.thresholds[index].lineColor = newColor;\n      this.render();\n    };\n  }\n}\n\nconst template = `\n<div class=\"gf-form-group\">\n  <h5>Thresholds</h5>\n  <p class=\"muted\" ng-show=\"ctrl.disabled\">\n    Visual thresholds options <strong>disabled.</strong>\n    Visit the Alert tab update your thresholds. <br>\n    To re-enable thresholds, the alert rule must be deleted from this panel.\n  </p>\n  <div ng-class=\"{'thresholds-form-disabled': ctrl.disabled}\">\n    <div class=\"gf-form-inline\" ng-repeat=\"threshold in ctrl.panel.thresholds\">\n      <div class=\"gf-form\">\n        <label class=\"gf-form-label\">T{{$index+1}}</label>\n      </div>\n\n      <div class=\"gf-form\">\n        <div class=\"gf-form-select-wrapper\">\n          <select class=\"gf-form-input\" ng-model=\"threshold.op\"\n                  ng-options=\"f for f in ['gt', 'lt']\" ng-change=\"ctrl.render()\" ng-disabled=\"ctrl.disabled\"></select>\n        </div>\n        <input type=\"number\" ng-model=\"threshold.value\" class=\"gf-form-input width-8\"\n               ng-change=\"ctrl.render()\" placeholder=\"value\" ng-disabled=\"ctrl.disabled\">\n      </div>\n\n      <div class=\"gf-form\">\n        <label class=\"gf-form-label\">Color</label>\n        <div class=\"gf-form-select-wrapper\">\n          <select class=\"gf-form-input\" ng-model=\"threshold.colorMode\"\n                  ng-options=\"f for f in ['custom', 'critical', 'warning', 'ok']\" ng-change=\"ctrl.render()\" ng-disabled=\"ctrl.disabled\">\n          </select>\n        </div>\n      </div>\n\n      <gf-form-switch class=\"gf-form\" label=\"Fill\" checked=\"threshold.fill\"\n                      on-change=\"ctrl.render()\" ng-disabled=\"ctrl.disabled\"></gf-form-switch>\n\n      <div class=\"gf-form\" ng-if=\"threshold.fill && threshold.colorMode === 'custom'\">\n        <label class=\"gf-form-label\">Fill color</label>\n        <span class=\"gf-form-label\">\n          <color-picker color=\"threshold.fillColor\" onChange=\"ctrl.onFillColorChange($index)\"></color-picker>\n        </span>\n      </div>\n\n      <gf-form-switch class=\"gf-form\" label=\"Line\" checked=\"threshold.line\"\n                      on-change=\"ctrl.render()\" ng-disabled=\"ctrl.disabled\"></gf-form-switch>\n\n      <div class=\"gf-form\" ng-if=\"threshold.line && threshold.colorMode === 'custom'\">\n        <label class=\"gf-form-label\">Line color</label>\n        <span class=\"gf-form-label\">\n          <color-picker color=\"threshold.lineColor\" onChange=\"ctrl.onLineColorChange($index)\"></color-picker>\n        </span>\n      </div>\n\n      <div class=\"gf-form\">\n        <label class=\"gf-form-label\">Y-Axis</label>\n        <div class=\"gf-form-select-wrapper\">\n          <select class=\"gf-form-input\" ng-model=\"threshold.yaxis\"\n                  ng-init=\"threshold.yaxis = threshold.yaxis === 'left' || threshold.yaxis === 'right' ? threshold.yaxis : 'left'\"\n                  ng-options=\"f for f in ['left', 'right']\" ng-change=\"ctrl.render()\" ng-disabled=\"ctrl.disabled\">\n          </select>\n        </div>\n      </div>\n\n      <div class=\"gf-form\">\n        <label class=\"gf-form-label\">\n          <a class=\"pointer\" ng-click=\"ctrl.removeThreshold($index)\" ng-disabled=\"ctrl.disabled\">\n            <i class=\"fa fa-trash\"></i>\n          </a>\n        </label>\n      </div>\n    </div>\n\n    <div class=\"gf-form-button-row\">\n      <button class=\"btn btn-inverse\" ng-click=\"ctrl.addThreshold()\" ng-disabled=\"ctrl.disabled\">\n        <i class=\"fa fa-plus\"></i>&nbsp;Add Threshold\n      </button>\n    </div>\n  </div>\n</div>\n`;\n\ncoreModule.directive('graphThresholdForm', () => {\n  return {\n    restrict: 'E',\n    template: template,\n    controller: ThresholdFormCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: {\n      panelCtrl: '=',\n    },\n  };\n});\n","const template = `\n<div class=\"graph-panel\" ng-class=\"{'graph-panel--legend-right': ctrl.panel.legend.rightSide}\">\n  <div class=\"graph-panel__chart\" grafana-graph ng-dblclick=\"ctrl.zoomOut()\">\n  </div>\n\n  <div class=\"graph-legend\">\n    <div class=\"graph-legend-content\" graph-legend></div>\n  </div>\n</div>\n`;\n\nexport default template;\n","import _ from 'lodash';\nimport TimeSeries from 'app/core/time_series2';\nimport colors from 'app/core/utils/colors';\n\nexport class DataProcessor {\n  constructor(private panel) {}\n\n  getSeriesList(options) {\n    if (!options.dataList || options.dataList.length === 0) {\n      return [];\n    }\n\n    // auto detect xaxis mode\n    let firstItem;\n    if (options.dataList && options.dataList.length > 0) {\n      firstItem = options.dataList[0];\n      const autoDetectMode = this.getAutoDetectXAxisMode(firstItem);\n      if (this.panel.xaxis.mode !== autoDetectMode) {\n        this.panel.xaxis.mode = autoDetectMode;\n        this.setPanelDefaultsForNewXAxisMode();\n      }\n    }\n\n    switch (this.panel.xaxis.mode) {\n      case 'series':\n      case 'time': {\n        return options.dataList.map((item, index) => {\n          return this.timeSeriesHandler(item, index, options);\n        });\n      }\n      case 'histogram': {\n        let histogramDataList;\n        if (this.panel.stack) {\n          histogramDataList = options.dataList;\n        } else {\n          histogramDataList = [\n            {\n              target: 'count',\n              datapoints: _.concat([], _.flatten(_.map(options.dataList, 'datapoints'))),\n            },\n          ];\n        }\n        return histogramDataList.map((item, index) => {\n          return this.timeSeriesHandler(item, index, options);\n        });\n      }\n      case 'field': {\n        return this.customHandler(firstItem);\n      }\n    }\n  }\n\n  getAutoDetectXAxisMode(firstItem) {\n    switch (firstItem.type) {\n      case 'docs':\n        return 'field';\n      case 'table':\n        return 'field';\n      default: {\n        if (this.panel.xaxis.mode === 'series') {\n          return 'series';\n        }\n        if (this.panel.xaxis.mode === 'histogram') {\n          return 'histogram';\n        }\n        return 'time';\n      }\n    }\n  }\n\n  setPanelDefaultsForNewXAxisMode() {\n    switch (this.panel.xaxis.mode) {\n      case 'time': {\n        this.panel.bars = false;\n        this.panel.lines = true;\n        this.panel.points = false;\n        this.panel.legend.show = true;\n        this.panel.tooltip.shared = true;\n        this.panel.xaxis.values = [];\n        break;\n      }\n      case 'series': {\n        this.panel.bars = true;\n        this.panel.lines = false;\n        this.panel.points = false;\n        this.panel.stack = false;\n        this.panel.legend.show = false;\n        this.panel.tooltip.shared = false;\n        this.panel.xaxis.values = ['total'];\n        break;\n      }\n      case 'histogram': {\n        this.panel.bars = true;\n        this.panel.lines = false;\n        this.panel.points = false;\n        this.panel.stack = false;\n        this.panel.legend.show = false;\n        this.panel.tooltip.shared = false;\n        break;\n      }\n    }\n  }\n\n  timeSeriesHandler(seriesData, index, options) {\n    const datapoints = seriesData.datapoints || [];\n    const alias = seriesData.target;\n\n    const colorIndex = index % colors.length;\n    const color = this.panel.aliasColors[alias] || colors[colorIndex];\n\n    const series = new TimeSeries({\n      datapoints: datapoints,\n      alias: alias,\n      color: color,\n      unit: seriesData.unit,\n    });\n\n    if (datapoints && datapoints.length > 0) {\n      const last = datapoints[datapoints.length - 1][1];\n      const from = options.range.from;\n      if (last - from < -10000) {\n        series.isOutsideRange = true;\n      }\n    }\n\n    return series;\n  }\n\n  customHandler(dataItem) {\n    const nameField = this.panel.xaxis.name;\n    if (!nameField) {\n      throw {\n        message: 'No field name specified to use for x-axis, check your axes settings',\n      };\n    }\n    return [];\n  }\n\n  validateXAxisSeriesValue() {\n    switch (this.panel.xaxis.mode) {\n      case 'series': {\n        if (this.panel.xaxis.values.length === 0) {\n          this.panel.xaxis.values = ['total'];\n          return;\n        }\n\n        const validOptions = this.getXAxisValueOptions({});\n        const found = _.find(validOptions, { value: this.panel.xaxis.values[0] });\n        if (!found) {\n          this.panel.xaxis.values = ['total'];\n        }\n        return;\n      }\n    }\n  }\n\n  getDataFieldNames(dataList, onlyNumbers) {\n    if (dataList.length === 0) {\n      return [];\n    }\n\n    const fields = [];\n    const firstItem = dataList[0];\n    const fieldParts = [];\n\n    function getPropertiesRecursive(obj) {\n      _.forEach(obj, (value, key) => {\n        if (_.isObject(value)) {\n          fieldParts.push(key);\n          getPropertiesRecursive(value);\n        } else {\n          if (!onlyNumbers || _.isNumber(value)) {\n            const field = fieldParts.concat(key).join('.');\n            fields.push(field);\n          }\n        }\n      });\n      fieldParts.pop();\n    }\n\n    if (firstItem.type === 'docs') {\n      if (firstItem.datapoints.length === 0) {\n        return [];\n      }\n      getPropertiesRecursive(firstItem.datapoints[0]);\n    }\n\n    return fields;\n  }\n\n  getXAxisValueOptions(options) {\n    switch (this.panel.xaxis.mode) {\n      case 'series': {\n        return [\n          { text: 'Avg', value: 'avg' },\n          { text: 'Min', value: 'min' },\n          { text: 'Max', value: 'max' },\n          { text: 'Total', value: 'total' },\n          { text: 'Count', value: 'count' },\n        ];\n      }\n    }\n\n    return [];\n  }\n\n  pluckDeep(obj: any, property: string) {\n    const propertyParts = property.split('.');\n    let value = obj;\n    for (let i = 0; i < propertyParts.length; ++i) {\n      if (value[propertyParts[i]]) {\n        value = value[propertyParts[i]];\n      } else {\n        return undefined;\n      }\n    }\n    return value;\n  }\n}\n","import './graph';\nimport './legend';\nimport './series_overrides_ctrl';\nimport './thresholds_form';\n\nimport template from './template';\nimport _ from 'lodash';\nimport config from 'app/core/config';\nimport { MetricsPanelCtrl, alertTab } from 'app/plugins/sdk';\nimport { DataProcessor } from './data_processor';\nimport { axesEditorComponent } from './axes_editor';\n\nclass GraphCtrl extends MetricsPanelCtrl {\n  static template = template;\n\n  renderError: boolean;\n  hiddenSeries: any = {};\n  seriesList: any = [];\n  dataList: any = [];\n  annotations: any = [];\n  alertState: any;\n\n  annotationsPromise: any;\n  dataWarning: any;\n  colors: any = [];\n  subTabIndex: number;\n  processor: DataProcessor;\n\n  panelDefaults = {\n    // datasource name, null = default datasource\n    datasource: null,\n    // sets client side (flot) or native graphite png renderer (png)\n    renderer: 'flot',\n    yaxes: [\n      {\n        label: null,\n        show: true,\n        logBase: 1,\n        min: null,\n        max: null,\n        format: 'short',\n      },\n      {\n        label: null,\n        show: true,\n        logBase: 1,\n        min: null,\n        max: null,\n        format: 'short',\n      },\n    ],\n    xaxis: {\n      show: true,\n      mode: 'time',\n      name: null,\n      values: [],\n      buckets: null,\n    },\n    yaxis: {\n      align: false,\n      alignLevel: null,\n    },\n    // show/hide lines\n    lines: true,\n    // fill factor\n    fill: 1,\n    // line width in pixels\n    linewidth: 1,\n    // show/hide dashed line\n    dashes: false,\n    // length of a dash\n    dashLength: 10,\n    // length of space between two dashes\n    spaceLength: 10,\n    // show hide points\n    points: false,\n    // point radius in pixels\n    pointradius: 5,\n    // show hide bars\n    bars: false,\n    // enable/disable stacking\n    stack: false,\n    // stack percentage mode\n    percentage: false,\n    // legend options\n    legend: {\n      show: true, // disable/enable legend\n      values: false, // disable/enable legend values\n      min: false,\n      max: false,\n      current: false,\n      total: false,\n      avg: false,\n    },\n    // how null points should be handled\n    nullPointMode: 'null',\n    // staircase line mode\n    steppedLine: false,\n    // tooltip options\n    tooltip: {\n      value_type: 'individual',\n      shared: true,\n      sort: 0,\n    },\n    // time overrides\n    timeFrom: null,\n    timeShift: null,\n    // metric queries\n    targets: [{}],\n    // series color overrides\n    aliasColors: {},\n    // other style overrides\n    seriesOverrides: [],\n    thresholds: [],\n  };\n\n  /** @ngInject */\n  constructor($scope, $injector, private annotationsSrv) {\n    super($scope, $injector);\n\n    _.defaults(this.panel, this.panelDefaults);\n    _.defaults(this.panel.tooltip, this.panelDefaults.tooltip);\n    _.defaults(this.panel.legend, this.panelDefaults.legend);\n    _.defaults(this.panel.xaxis, this.panelDefaults.xaxis);\n\n    this.processor = new DataProcessor(this.panel);\n\n    this.events.on('render', this.onRender.bind(this));\n    this.events.on('data-received', this.onDataReceived.bind(this));\n    this.events.on('data-error', this.onDataError.bind(this));\n    this.events.on('data-snapshot-load', this.onDataSnapshotLoad.bind(this));\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n    this.events.on('init-panel-actions', this.onInitPanelActions.bind(this));\n  }\n\n  onInitEditMode() {\n    this.addEditorTab('Axes', axesEditorComponent, 2);\n    this.addEditorTab('Legend', 'public/app/plugins/panel/graph/tab_legend.html', 3);\n    this.addEditorTab('Display', 'public/app/plugins/panel/graph/tab_display.html', 4);\n\n    if (config.alertingEnabled) {\n      this.addEditorTab('Alert', alertTab, 5);\n    }\n\n    this.subTabIndex = 0;\n  }\n\n  onInitPanelActions(actions) {\n    actions.push({ text: 'Export CSV', click: 'ctrl.exportCsv()' });\n    actions.push({ text: 'Toggle legend', click: 'ctrl.toggleLegend()' });\n  }\n\n  issueQueries(datasource) {\n    this.annotationsPromise = this.annotationsSrv.getAnnotations({\n      dashboard: this.dashboard,\n      panel: this.panel,\n      range: this.range,\n    });\n    return super.issueQueries(datasource);\n  }\n\n  zoomOut(evt) {\n    this.publishAppEvent('zoom-out', 2);\n  }\n\n  onDataSnapshotLoad(snapshotData) {\n    this.annotationsPromise = this.annotationsSrv.getAnnotations({\n      dashboard: this.dashboard,\n      panel: this.panel,\n      range: this.range,\n    });\n    this.onDataReceived(snapshotData);\n  }\n\n  onDataError(err) {\n    this.seriesList = [];\n    this.annotations = [];\n    this.render([]);\n  }\n\n  onDataReceived(dataList) {\n    this.dataList = dataList;\n    this.seriesList = this.processor.getSeriesList({\n      dataList: dataList,\n      range: this.range,\n    });\n\n    this.dataWarning = null;\n    const datapointsCount = this.seriesList.reduce((prev, series) => {\n      return prev + series.datapoints.length;\n    }, 0);\n\n    if (datapointsCount === 0) {\n      this.dataWarning = {\n        title: 'No data points',\n        tip: 'No datapoints returned from data query',\n      };\n    } else {\n      for (const series of this.seriesList) {\n        if (series.isOutsideRange) {\n          this.dataWarning = {\n            title: 'Data points outside time range',\n            tip: 'Can be caused by timezone mismatch or missing time filter in query',\n          };\n          break;\n        }\n      }\n    }\n\n    this.annotationsPromise.then(\n      result => {\n        this.loading = false;\n        this.alertState = result.alertState;\n        this.annotations = result.annotations;\n        this.render(this.seriesList);\n      },\n      () => {\n        this.loading = false;\n        this.render(this.seriesList);\n      }\n    );\n  }\n\n  onRender() {\n    if (!this.seriesList) {\n      return;\n    }\n\n    for (const series of this.seriesList) {\n      series.applySeriesOverrides(this.panel.seriesOverrides);\n\n      if (series.unit) {\n        this.panel.yaxes[series.yaxis - 1].format = series.unit;\n      }\n    }\n  }\n\n  changeSeriesColor(series, color) {\n    series.setColor(color);\n    this.panel.aliasColors[series.alias] = series.color;\n    this.render();\n  }\n\n  toggleSeries(serie, event) {\n    if (event.ctrlKey || event.metaKey || event.shiftKey) {\n      if (this.hiddenSeries[serie.alias]) {\n        delete this.hiddenSeries[serie.alias];\n      } else {\n        this.hiddenSeries[serie.alias] = true;\n      }\n    } else {\n      this.toggleSeriesExclusiveMode(serie);\n    }\n    this.render();\n  }\n\n  toggleSeriesExclusiveMode(serie) {\n    const hidden = this.hiddenSeries;\n\n    if (hidden[serie.alias]) {\n      delete hidden[serie.alias];\n    }\n\n    // check if every other series is hidden\n    const alreadyExclusive = _.every(this.seriesList, value => {\n      if (value.alias === serie.alias) {\n        return true;\n      }\n\n      return hidden[value.alias];\n    });\n\n    if (alreadyExclusive) {\n      // remove all hidden series\n      _.each(this.seriesList, value => {\n        delete this.hiddenSeries[value.alias];\n      });\n    } else {\n      // hide all but this serie\n      _.each(this.seriesList, value => {\n        if (value.alias === serie.alias) {\n          return;\n        }\n\n        this.hiddenSeries[value.alias] = true;\n      });\n    }\n  }\n\n  toggleAxis(info) {\n    let override = _.find(this.panel.seriesOverrides, { alias: info.alias });\n    if (!override) {\n      override = { alias: info.alias };\n      this.panel.seriesOverrides.push(override);\n    }\n    info.yaxis = override.yaxis = info.yaxis === 2 ? 1 : 2;\n    this.render();\n  }\n\n  addSeriesOverride(override) {\n    this.panel.seriesOverrides.push(override || {});\n  }\n\n  removeSeriesOverride(override) {\n    this.panel.seriesOverrides = _.without(this.panel.seriesOverrides, override);\n    this.render();\n  }\n\n  toggleLegend() {\n    this.panel.legend.show = !this.panel.legend.show;\n    this.refresh();\n  }\n\n  legendValuesOptionChanged() {\n    const legend = this.panel.legend;\n    legend.values = legend.min || legend.max || legend.avg || legend.current || legend.total;\n    this.render();\n  }\n\n  exportCsv() {\n    const scope = this.$scope.$new(true);\n    scope.seriesList = this.seriesList;\n    this.publishAppEvent('show-modal', {\n      templateHtml: '<export-data-modal data=\"seriesList\"></export-data-modal>',\n      scope,\n      modalClass: 'modal--narrow',\n    });\n  }\n}\n\nexport { GraphCtrl, GraphCtrl as PanelCtrl };\n","import kbn from 'app/core/utils/kbn';\n\nexport class AxesEditorCtrl {\n  panel: any;\n  panelCtrl: any;\n  unitFormats: any;\n  logScales: any;\n  xAxisModes: any;\n  xAxisStatOptions: any;\n  xNameSegment: any;\n\n  /** @ngInject */\n  constructor(private $scope, private $q) {\n    this.panelCtrl = $scope.ctrl;\n    this.panel = this.panelCtrl.panel;\n    this.$scope.ctrl = this;\n\n    this.unitFormats = kbn.getUnitFormats();\n\n    this.logScales = {\n      linear: 1,\n      'log (base 2)': 2,\n      'log (base 10)': 10,\n      'log (base 32)': 32,\n      'log (base 1024)': 1024,\n    };\n\n    this.xAxisModes = {\n      Time: 'time',\n      Series: 'series',\n      Histogram: 'histogram',\n      // 'Data field': 'field',\n    };\n\n    this.xAxisStatOptions = [\n      { text: 'Avg', value: 'avg' },\n      { text: 'Min', value: 'min' },\n      { text: 'Max', value: 'max' },\n      { text: 'Total', value: 'total' },\n      { text: 'Count', value: 'count' },\n      { text: 'Current', value: 'current' },\n    ];\n\n    if (this.panel.xaxis.mode === 'custom') {\n      if (!this.panel.xaxis.name) {\n        this.panel.xaxis.name = 'specify field';\n      }\n    }\n  }\n\n  setUnitFormat(axis, subItem) {\n    axis.format = subItem.value;\n    this.panelCtrl.render();\n  }\n\n  render() {\n    this.panelCtrl.render();\n  }\n\n  xAxisModeChanged() {\n    this.panelCtrl.processor.setPanelDefaultsForNewXAxisMode();\n    this.panelCtrl.onDataReceived(this.panelCtrl.dataList);\n  }\n\n  xAxisValueChanged() {\n    this.panelCtrl.onDataReceived(this.panelCtrl.dataList);\n  }\n\n  getDataFieldNames(onlyNumbers) {\n    const props = this.panelCtrl.processor.getDataFieldNames(this.panelCtrl.dataList, onlyNumbers);\n    const items = props.map(prop => {\n      return { text: prop, value: prop };\n    });\n\n    return this.$q.when(items);\n  }\n}\n\n/** @ngInject */\nexport function axesEditorComponent() {\n  'use strict';\n  return {\n    restrict: 'E',\n    scope: true,\n    templateUrl: 'public/app/plugins/panel/graph/axes_editor.html',\n    controller: AxesEditorCtrl,\n  };\n}\n","import _ from 'lodash';\nimport { PanelCtrl } from 'app/plugins/sdk';\nimport impressionSrv from 'app/core/services/impression_srv';\n\nclass DashListCtrl extends PanelCtrl {\n  static templateUrl = 'module.html';\n  static scrollable = true;\n\n  groups: any[];\n  modes: any[];\n\n  panelDefaults = {\n    query: '',\n    limit: 10,\n    tags: [],\n    recent: false,\n    search: false,\n    starred: true,\n    headings: true,\n    folderId: null,\n  };\n\n  /** @ngInject */\n  constructor($scope, $injector, private backendSrv, private dashboardSrv) {\n    super($scope, $injector);\n    _.defaults(this.panel, this.panelDefaults);\n\n    if (this.panel.tag) {\n      this.panel.tags = [this.panel.tag];\n      delete this.panel.tag;\n    }\n\n    this.events.on('refresh', this.onRefresh.bind(this));\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n\n    this.groups = [\n      { list: [], show: false, header: 'Starred dashboards' },\n      { list: [], show: false, header: 'Recently viewed dashboards' },\n      { list: [], show: false, header: 'Search' },\n    ];\n\n    // update capability\n    if (this.panel.mode) {\n      if (this.panel.mode === 'starred') {\n        this.panel.starred = true;\n        this.panel.headings = false;\n      }\n      if (this.panel.mode === 'recently viewed') {\n        this.panel.recent = true;\n        this.panel.starred = false;\n        this.panel.headings = false;\n      }\n      if (this.panel.mode === 'search') {\n        this.panel.search = true;\n        this.panel.starred = false;\n        this.panel.headings = false;\n      }\n      delete this.panel.mode;\n    }\n  }\n\n  onInitEditMode() {\n    this.editorTabIndex = 1;\n    this.modes = ['starred', 'search', 'recently viewed'];\n    this.addEditorTab('Options', 'public/app/plugins/panel/dashlist/editor.html');\n  }\n\n  onRefresh() {\n    const promises = [];\n\n    promises.push(this.getRecentDashboards());\n    promises.push(this.getStarred());\n    promises.push(this.getSearch());\n\n    return Promise.all(promises).then(this.renderingCompleted.bind(this));\n  }\n\n  getSearch() {\n    this.groups[2].show = this.panel.search;\n    if (!this.panel.search) {\n      return Promise.resolve();\n    }\n\n    const params = {\n      limit: this.panel.limit,\n      query: this.panel.query,\n      tag: this.panel.tags,\n      folderIds: this.panel.folderId,\n      type: 'dash-db',\n    };\n\n    return this.backendSrv.search(params).then(result => {\n      this.groups[2].list = result;\n    });\n  }\n\n  getStarred() {\n    this.groups[0].show = this.panel.starred;\n    if (!this.panel.starred) {\n      return Promise.resolve();\n    }\n\n    const params = { limit: this.panel.limit, starred: 'true' };\n    return this.backendSrv.search(params).then(result => {\n      this.groups[0].list = result;\n    });\n  }\n\n  starDashboard(dash, evt) {\n    this.dashboardSrv.starDashboard(dash.id, dash.isStarred).then(newState => {\n      dash.isStarred = newState;\n    });\n\n    if (evt) {\n      evt.stopPropagation();\n      evt.preventDefault();\n    }\n  }\n\n  getRecentDashboards() {\n    this.groups[1].show = this.panel.recent;\n    if (!this.panel.recent) {\n      return Promise.resolve();\n    }\n\n    const dashIds = _.take(impressionSrv.getDashboardOpened(), this.panel.limit);\n    return this.backendSrv.search({ dashboardIds: dashIds, limit: this.panel.limit }).then(result => {\n      this.groups[1].list = dashIds\n        .map(orderId => {\n          return _.find(result, dashboard => {\n            return dashboard.id === orderId;\n          });\n        })\n        .filter(el => {\n          return el !== undefined;\n        });\n    });\n  }\n\n  onFolderChange(folder: any) {\n    this.panel.folderId = folder.id;\n    this.refresh();\n  }\n}\n\nexport { DashListCtrl, DashListCtrl as PanelCtrl };\n","import _ from 'lodash';\nimport { PanelCtrl } from '../../../features/panel/panel_ctrl';\n\nclass PluginListCtrl extends PanelCtrl {\n  static templateUrl = 'module.html';\n  static scrollable = true;\n\n  pluginList: any[];\n  viewModel: any;\n\n  // Set and populate defaults\n  panelDefaults = {};\n\n  /** @ngInject */\n  constructor($scope, $injector, private backendSrv) {\n    super($scope, $injector);\n\n    _.defaults(this.panel, this.panelDefaults);\n\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n    this.pluginList = [];\n    this.viewModel = [\n      { header: 'Installed Apps', list: [], type: 'app' },\n      { header: 'Installed Panels', list: [], type: 'panel' },\n      { header: 'Installed Datasources', list: [], type: 'datasource' },\n    ];\n\n    this.update();\n  }\n\n  onInitEditMode() {\n    this.editorTabIndex = 1;\n    this.addEditorTab('Options', 'public/app/plugins/panel/pluginlist/editor.html');\n  }\n\n  gotoPlugin(plugin, evt) {\n    if (evt) {\n      evt.stopPropagation();\n    }\n    this.$location.url(`plugins/${plugin.id}/edit`);\n  }\n\n  updateAvailable(plugin, $event) {\n    $event.stopPropagation();\n    $event.preventDefault();\n\n    const modalScope = this.$scope.$new(true);\n    modalScope.plugin = plugin;\n\n    this.publishAppEvent('show-modal', {\n      src: 'public/app/features/plugins/partials/update_instructions.html',\n      scope: modalScope,\n    });\n  }\n\n  update() {\n    this.backendSrv.get('api/plugins', { embedded: 0, core: 0 }).then(plugins => {\n      this.pluginList = plugins;\n      this.viewModel[0].list = _.filter(plugins, { type: 'app' });\n      this.viewModel[1].list = _.filter(plugins, { type: 'panel' });\n      this.viewModel[2].list = _.filter(plugins, { type: 'datasource' });\n\n      for (const plugin of this.pluginList) {\n        if (plugin.hasUpdate) {\n          plugin.state = 'has-update';\n        } else if (!plugin.enabled) {\n          plugin.state = 'not-enabled';\n        }\n      }\n    });\n  }\n}\n\nexport { PluginListCtrl, PluginListCtrl as PanelCtrl };\n","import _ from 'lodash';\nimport moment from 'moment';\nimport alertDef from '../../../features/alerting/state/alertDef';\nimport { PanelCtrl } from 'app/plugins/sdk';\n\nimport * as dateMath from 'app/core/utils/datemath';\n\nclass AlertListPanel extends PanelCtrl {\n  static templateUrl = 'module.html';\n  static scrollable = true;\n\n  showOptions = [{ text: 'Current state', value: 'current' }, { text: 'Recent state changes', value: 'changes' }];\n\n  sortOrderOptions = [\n    { text: 'Alphabetical (asc)', value: 1 },\n    { text: 'Alphabetical (desc)', value: 2 },\n    { text: 'Importance', value: 3 },\n  ];\n\n  stateFilter: any = {};\n  currentAlerts: any = [];\n  alertHistory: any = [];\n  noAlertsMessage: string;\n\n  // Set and populate defaults\n  panelDefaults = {\n    show: 'current',\n    limit: 10,\n    stateFilter: [],\n    onlyAlertsOnDashboard: false,\n    sortOrder: 1,\n    dashboardFilter: '',\n    nameFilter: '',\n    folderId: null,\n  };\n\n  /** @ngInject */\n  constructor($scope, $injector, private backendSrv) {\n    super($scope, $injector);\n    _.defaults(this.panel, this.panelDefaults);\n\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n    this.events.on('refresh', this.onRefresh.bind(this));\n\n    for (const key in this.panel.stateFilter) {\n      this.stateFilter[this.panel.stateFilter[key]] = true;\n    }\n  }\n\n  sortResult(alerts) {\n    if (this.panel.sortOrder === 3) {\n      return _.sortBy(alerts, a => {\n        return alertDef.alertStateSortScore[a.state];\n      });\n    }\n\n    const result = _.sortBy(alerts, a => {\n      return a.name.toLowerCase();\n    });\n    if (this.panel.sortOrder === 2) {\n      result.reverse();\n    }\n\n    return result;\n  }\n\n  updateStateFilter() {\n    const result = [];\n\n    for (const key in this.stateFilter) {\n      if (this.stateFilter[key]) {\n        result.push(key);\n      }\n    }\n\n    this.panel.stateFilter = result;\n    this.onRefresh();\n  }\n\n  onRefresh() {\n    let getAlertsPromise;\n\n    if (this.panel.show === 'current') {\n      getAlertsPromise = this.getCurrentAlertState();\n    }\n\n    if (this.panel.show === 'changes') {\n      getAlertsPromise = this.getStateChanges();\n    }\n\n    getAlertsPromise.then(() => {\n      this.renderingCompleted();\n    });\n  }\n\n  onFolderChange(folder: any) {\n    this.panel.folderId = folder.id;\n    this.refresh();\n  }\n\n  getStateChanges() {\n    const params: any = {\n      limit: this.panel.limit,\n      type: 'alert',\n      newState: this.panel.stateFilter,\n    };\n\n    if (this.panel.onlyAlertsOnDashboard) {\n      params.dashboardId = this.dashboard.id;\n    }\n\n    params.from = dateMath.parse(this.dashboard.time.from).unix() * 1000;\n    params.to = dateMath.parse(this.dashboard.time.to).unix() * 1000;\n\n    return this.backendSrv.get(`/api/annotations`, params).then(res => {\n      this.alertHistory = _.map(res, al => {\n        al.time = this.dashboard.formatDate(al.time, 'MMM D, YYYY HH:mm:ss');\n        al.stateModel = alertDef.getStateDisplayModel(al.newState);\n        al.info = alertDef.getAlertAnnotationInfo(al);\n        return al;\n      });\n\n      this.noAlertsMessage = this.alertHistory.length === 0 ? 'No alerts in current time range' : '';\n\n      return this.alertHistory;\n    });\n  }\n\n  getCurrentAlertState() {\n    const params: any = {\n      state: this.panel.stateFilter,\n    };\n\n    if (this.panel.nameFilter) {\n      params.query = this.panel.nameFilter;\n    }\n\n    if (this.panel.folderId >= 0) {\n      params.folderId = this.panel.folderId;\n    }\n\n    if (this.panel.dashboardFilter) {\n      params.dashboardQuery = this.panel.dashboardFilter;\n    }\n\n    if (this.panel.onlyAlertsOnDashboard) {\n      params.dashboardId = this.dashboard.id;\n    }\n\n    if (this.panel.dashboardTags) {\n      params.dashboardTag = this.panel.dashboardTags;\n    }\n\n    return this.backendSrv.get(`/api/alerts`, params).then(res => {\n      this.currentAlerts = this.sortResult(\n        _.map(res, al => {\n          al.stateModel = alertDef.getStateDisplayModel(al.state);\n          al.newStateDateAgo = moment(al.newStateDate)\n            .locale('en')\n            .fromNow(true);\n          return al;\n        })\n      );\n      if (this.currentAlerts.length > this.panel.limit) {\n        this.currentAlerts = this.currentAlerts.slice(0, this.panel.limit);\n      }\n      this.noAlertsMessage = this.currentAlerts.length === 0 ? 'No alerts' : '';\n\n      return this.currentAlerts;\n    });\n  }\n\n  onInitEditMode() {\n    this.addEditorTab('Options', 'public/app/plugins/panel/alertlist/editor.html');\n  }\n}\n\nexport { AlertListPanel, AlertListPanel as PanelCtrl };\n","import * as d3 from 'd3';\nimport * as d3ScaleChromatic from 'd3-scale-chromatic';\n\nexport function getColorScale(colorScheme: any, lightTheme: boolean, maxValue: number, minValue = 0): (d: any) => any {\n  const colorInterpolator = d3ScaleChromatic[colorScheme.value];\n  const colorScaleInverted = colorScheme.invert === 'always' || colorScheme.invert === (lightTheme ? 'light' : 'dark');\n\n  const start = colorScaleInverted ? maxValue : minValue;\n  const end = colorScaleInverted ? minValue : maxValue;\n\n  return d3.scaleSequential(colorInterpolator).domain([start, end]);\n}\n\nexport function getOpacityScale(options, maxValue, minValue = 0) {\n  let legendOpacityScale;\n  if (options.colorScale === 'linear') {\n    legendOpacityScale = d3\n      .scaleLinear()\n      .domain([minValue, maxValue])\n      .range([0, 1]);\n  } else if (options.colorScale === 'sqrt') {\n    legendOpacityScale = d3\n      .scalePow()\n      .exponent(options.exponent)\n      .domain([minValue, maxValue])\n      .range([0, 1]);\n  }\n  return legendOpacityScale;\n}\n","import angular from 'angular';\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport * as d3 from 'd3';\nimport { contextSrv } from 'app/core/core';\nimport { tickStep } from 'app/core/utils/ticks';\nimport { getColorScale, getOpacityScale } from './color_scale';\n\nconst module = angular.module('grafana.directives');\n\nconst LEGEND_HEIGHT_PX = 6;\nconst LEGEND_WIDTH_PX = 100;\nconst LEGEND_TICK_SIZE = 0;\nconst LEGEND_VALUE_MARGIN = 0;\n\n/**\n * Color legend for heatmap editor.\n */\nmodule.directive('colorLegend', () => {\n  return {\n    restrict: 'E',\n    template: '<div class=\"heatmap-color-legend\"><svg width=\"16.5rem\" height=\"24px\"></svg></div>',\n    link: (scope, elem, attrs) => {\n      const ctrl = scope.ctrl;\n      const panel = scope.ctrl.panel;\n\n      render();\n\n      ctrl.events.on('render', () => {\n        render();\n      });\n\n      function render() {\n        const legendElem = $(elem).find('svg');\n        const legendWidth = Math.floor(legendElem.outerWidth());\n\n        if (panel.color.mode === 'spectrum') {\n          const colorScheme = _.find(ctrl.colorSchemes, {\n            value: panel.color.colorScheme,\n          });\n          const colorScale = getColorScale(colorScheme, contextSrv.user.lightTheme, legendWidth);\n          drawSimpleColorLegend(elem, colorScale);\n        } else if (panel.color.mode === 'opacity') {\n          const colorOptions = panel.color;\n          drawSimpleOpacityLegend(elem, colorOptions);\n        }\n      }\n    },\n  };\n});\n\n/**\n * Heatmap legend with scale values.\n */\nmodule.directive('heatmapLegend', () => {\n  return {\n    restrict: 'E',\n    template: `<div class=\"heatmap-color-legend\"><svg width=\"${LEGEND_WIDTH_PX}px\" height=\"${LEGEND_HEIGHT_PX}px\"></svg></div>`,\n    link: (scope, elem, attrs) => {\n      const ctrl = scope.ctrl;\n      const panel = scope.ctrl.panel;\n\n      render();\n      ctrl.events.on('render', () => {\n        render();\n      });\n\n      function render() {\n        clearLegend(elem);\n        if (!_.isEmpty(ctrl.data) && !_.isEmpty(ctrl.data.cards)) {\n          const rangeFrom = 0;\n          const rangeTo = ctrl.data.cardStats.max;\n          const maxValue = panel.color.max || rangeTo;\n          const minValue = panel.color.min || 0;\n\n          if (panel.color.mode === 'spectrum') {\n            const colorScheme = _.find(ctrl.colorSchemes, {\n              value: panel.color.colorScheme,\n            });\n            drawColorLegend(elem, colorScheme, rangeFrom, rangeTo, maxValue, minValue);\n          } else if (panel.color.mode === 'opacity') {\n            const colorOptions = panel.color;\n            drawOpacityLegend(elem, colorOptions, rangeFrom, rangeTo, maxValue, minValue);\n          }\n        }\n      }\n    },\n  };\n});\n\nfunction drawColorLegend(elem, colorScheme, rangeFrom, rangeTo, maxValue, minValue) {\n  const legendElem = $(elem).find('svg');\n  const legend = d3.select(legendElem.get(0));\n  clearLegend(elem);\n\n  const legendWidth = Math.floor(legendElem.outerWidth()) - 30;\n  const legendHeight = legendElem.attr('height');\n\n  let rangeStep = 1;\n  if (rangeTo - rangeFrom > legendWidth) {\n    rangeStep = Math.floor((rangeTo - rangeFrom) / legendWidth);\n  }\n  const widthFactor = legendWidth / (rangeTo - rangeFrom);\n  const valuesRange = d3.range(rangeFrom, rangeTo, rangeStep);\n\n  const colorScale = getColorScale(colorScheme, contextSrv.user.lightTheme, maxValue, minValue);\n  legend\n    .selectAll('.heatmap-color-legend-rect')\n    .data(valuesRange)\n    .enter()\n    .append('rect')\n    .attr('x', d => d * widthFactor)\n    .attr('y', 0)\n    .attr('width', rangeStep * widthFactor + 1) // Overlap rectangles to prevent gaps\n    .attr('height', legendHeight)\n    .attr('stroke-width', 0)\n    .attr('fill', d => colorScale(d));\n\n  drawLegendValues(elem, colorScale, rangeFrom, rangeTo, maxValue, minValue, legendWidth);\n}\n\nfunction drawOpacityLegend(elem, options, rangeFrom, rangeTo, maxValue, minValue) {\n  const legendElem = $(elem).find('svg');\n  const legend = d3.select(legendElem.get(0));\n  clearLegend(elem);\n\n  const legendWidth = Math.floor(legendElem.outerWidth()) - 30;\n  const legendHeight = legendElem.attr('height');\n\n  let rangeStep = 1;\n  if (rangeTo - rangeFrom > legendWidth) {\n    rangeStep = Math.floor((rangeTo - rangeFrom) / legendWidth);\n  }\n  const widthFactor = legendWidth / (rangeTo - rangeFrom);\n  const valuesRange = d3.range(rangeFrom, rangeTo, rangeStep);\n\n  const opacityScale = getOpacityScale(options, maxValue, minValue);\n  legend\n    .selectAll('.heatmap-opacity-legend-rect')\n    .data(valuesRange)\n    .enter()\n    .append('rect')\n    .attr('x', d => d * widthFactor)\n    .attr('y', 0)\n    .attr('width', rangeStep * widthFactor)\n    .attr('height', legendHeight)\n    .attr('stroke-width', 0)\n    .attr('fill', options.cardColor)\n    .style('opacity', d => opacityScale(d));\n\n  drawLegendValues(elem, opacityScale, rangeFrom, rangeTo, maxValue, minValue, legendWidth);\n}\n\nfunction drawLegendValues(elem, colorScale, rangeFrom, rangeTo, maxValue, minValue, legendWidth) {\n  const legendElem = $(elem).find('svg');\n  const legend = d3.select(legendElem.get(0));\n\n  if (legendWidth <= 0 || legendElem.get(0).childNodes.length === 0) {\n    return;\n  }\n\n  const legendValueScale = d3\n    .scaleLinear()\n    .domain([0, rangeTo])\n    .range([0, legendWidth]);\n\n  const ticks = buildLegendTicks(0, rangeTo, maxValue, minValue);\n  const xAxis = d3\n    .axisBottom(legendValueScale)\n    .tickValues(ticks)\n    .tickSize(LEGEND_TICK_SIZE);\n\n  const colorRect = legendElem.find(':first-child');\n  const posY = getSvgElemHeight(legendElem) + LEGEND_VALUE_MARGIN;\n  const posX = getSvgElemX(colorRect);\n\n  d3\n    .select(legendElem.get(0))\n    .append('g')\n    .attr('class', 'axis')\n    .attr('transform', 'translate(' + posX + ',' + posY + ')')\n    .call(xAxis);\n\n  legend\n    .select('.axis')\n    .select('.domain')\n    .remove();\n}\n\nfunction drawSimpleColorLegend(elem, colorScale) {\n  const legendElem = $(elem).find('svg');\n  clearLegend(elem);\n\n  const legendWidth = Math.floor(legendElem.outerWidth());\n  const legendHeight = legendElem.attr('height');\n\n  if (legendWidth) {\n    const valuesNumber = Math.floor(legendWidth / 2);\n    const rangeStep = Math.floor(legendWidth / valuesNumber);\n    const valuesRange = d3.range(0, legendWidth, rangeStep);\n\n    const legend = d3.select(legendElem.get(0));\n    const legendRects = legend.selectAll('.heatmap-color-legend-rect').data(valuesRange);\n\n    legendRects\n      .enter()\n      .append('rect')\n      .attr('x', d => d)\n      .attr('y', 0)\n      .attr('width', rangeStep + 1) // Overlap rectangles to prevent gaps\n      .attr('height', legendHeight)\n      .attr('stroke-width', 0)\n      .attr('fill', d => colorScale(d));\n  }\n}\n\nfunction drawSimpleOpacityLegend(elem, options) {\n  const legendElem = $(elem).find('svg');\n  clearLegend(elem);\n\n  const legend = d3.select(legendElem.get(0));\n  const legendWidth = Math.floor(legendElem.outerWidth());\n  const legendHeight = legendElem.attr('height');\n\n  if (legendWidth) {\n    let legendOpacityScale;\n    if (options.colorScale === 'linear') {\n      legendOpacityScale = d3\n        .scaleLinear()\n        .domain([0, legendWidth])\n        .range([0, 1]);\n    } else if (options.colorScale === 'sqrt') {\n      legendOpacityScale = d3\n        .scalePow()\n        .exponent(options.exponent)\n        .domain([0, legendWidth])\n        .range([0, 1]);\n    }\n\n    const rangeStep = 10;\n    const valuesRange = d3.range(0, legendWidth, rangeStep);\n    const legendRects = legend.selectAll('.heatmap-opacity-legend-rect').data(valuesRange);\n\n    legendRects\n      .enter()\n      .append('rect')\n      .attr('x', d => d)\n      .attr('y', 0)\n      .attr('width', rangeStep)\n      .attr('height', legendHeight)\n      .attr('stroke-width', 0)\n      .attr('fill', options.cardColor)\n      .style('opacity', d => legendOpacityScale(d));\n  }\n}\n\nfunction clearLegend(elem) {\n  const legendElem = $(elem).find('svg');\n  legendElem.empty();\n}\n\nfunction getSvgElemX(elem) {\n  const svgElem = elem.get(0);\n  if (svgElem && svgElem.x && svgElem.x.baseVal) {\n    return svgElem.x.baseVal.value;\n  } else {\n    return 0;\n  }\n}\n\nfunction getSvgElemHeight(elem) {\n  const svgElem = elem.get(0);\n  if (svgElem && svgElem.height && svgElem.height.baseVal) {\n    return svgElem.height.baseVal.value;\n  } else {\n    return 0;\n  }\n}\n\nfunction buildLegendTicks(rangeFrom, rangeTo, maxValue, minValue) {\n  const range = rangeTo - rangeFrom;\n  const tickStepSize = tickStep(rangeFrom, rangeTo, 3);\n  const ticksNum = Math.round(range / tickStepSize);\n  let ticks = [];\n\n  for (let i = 0; i < ticksNum; i++) {\n    const current = tickStepSize * i;\n    // Add user-defined min and max if it had been set\n    if (isValueCloseTo(minValue, current, tickStepSize)) {\n      ticks.push(minValue);\n      continue;\n    } else if (minValue < current) {\n      ticks.push(minValue);\n    }\n    if (isValueCloseTo(maxValue, current, tickStepSize)) {\n      ticks.push(maxValue);\n      continue;\n    } else if (maxValue < current) {\n      ticks.push(maxValue);\n    }\n    ticks.push(tickStepSize * i);\n  }\n  if (!isValueCloseTo(maxValue, rangeTo, tickStepSize)) {\n    ticks.push(maxValue);\n  }\n  ticks.push(rangeTo);\n  ticks = _.sortBy(_.uniq(ticks));\n  return ticks;\n}\n\nfunction isValueCloseTo(val, valueTo, step) {\n  const diff = Math.abs(val - valueTo);\n  return diff < step * 0.3;\n}\n","export class HeatmapDisplayEditorCtrl {\n  panel: any;\n  panelCtrl: any;\n\n  /** @ngInject */\n  constructor($scope) {\n    $scope.editor = this;\n    this.panelCtrl = $scope.ctrl;\n    this.panel = this.panelCtrl.panel;\n\n    this.panelCtrl.render();\n  }\n}\n\n/** @ngInject */\nexport function heatmapDisplayEditor() {\n  'use strict';\n  return {\n    restrict: 'E',\n    scope: true,\n    templateUrl: 'public/app/plugins/panel/heatmap/partials/display_editor.html',\n    controller: HeatmapDisplayEditorCtrl,\n  };\n}\n","import _ from 'lodash';\n\nconst VALUE_INDEX = 0;\nconst TIME_INDEX = 1;\n\ninterface XBucket {\n  x: number;\n  buckets: any;\n}\n\ninterface YBucket {\n  y: number;\n  values: number[];\n}\n\n/**\n * Convert histogram represented by the list of series to heatmap object.\n * @param seriesList List of time series\n */\nfunction histogramToHeatmap(seriesList) {\n  const heatmap = {};\n\n  for (let i = 0; i < seriesList.length; i++) {\n    const series = seriesList[i];\n    const bound = i;\n    if (isNaN(bound)) {\n      return heatmap;\n    }\n\n    for (const point of series.datapoints) {\n      const count = point[VALUE_INDEX];\n      const time = point[TIME_INDEX];\n\n      if (!_.isNumber(count)) {\n        continue;\n      }\n\n      let bucket = heatmap[time];\n      if (!bucket) {\n        bucket = heatmap[time] = { x: time, buckets: {} };\n      }\n\n      bucket.buckets[bound] = {\n        y: bound,\n        count: count,\n        bounds: {\n          top: null,\n          bottom: bound,\n        },\n        values: [],\n        points: [],\n      };\n    }\n  }\n\n  return heatmap;\n}\n\n/**\n * Sort series representing histogram by label value.\n */\nfunction sortSeriesByLabel(s1, s2) {\n  let label1, label2;\n\n  try {\n    // fail if not integer. might happen with bad queries\n    label1 = parseHistogramLabel(s1.label);\n    label2 = parseHistogramLabel(s2.label);\n  } catch (err) {\n    console.log(err.message || err);\n    return 0;\n  }\n\n  if (label1 > label2) {\n    return 1;\n  }\n\n  if (label1 < label2) {\n    return -1;\n  }\n\n  return 0;\n}\n\nfunction parseHistogramLabel(label: string): number {\n  if (label === '+Inf' || label === 'inf') {\n    return +Infinity;\n  }\n  const value = Number(label);\n  if (isNaN(value)) {\n    throw new Error(`Error parsing histogram label: ${label} is not a number`);\n  }\n  return value;\n}\n\n/**\n * Convert buckets into linear array of \"cards\" - objects, represented heatmap elements.\n * @param  {Object} buckets\n * @return {Array}          Array of \"card\" objects\n */\nfunction convertToCards(buckets) {\n  let min = 0,\n    max = 0;\n  const cards = [];\n  _.forEach(buckets, xBucket => {\n    _.forEach(xBucket.buckets, yBucket => {\n      const card = {\n        x: xBucket.x,\n        y: yBucket.y,\n        yBounds: yBucket.bounds,\n        values: yBucket.values,\n        count: yBucket.count,\n      };\n      cards.push(card);\n\n      if (cards.length === 1) {\n        min = yBucket.count;\n        max = yBucket.count;\n      }\n\n      min = yBucket.count < min ? yBucket.count : min;\n      max = yBucket.count > max ? yBucket.count : max;\n    });\n  });\n\n  const cardStats = { min, max };\n  return { cards, cardStats };\n}\n\n/**\n * Special method for log scales. When series converted into buckets with log scale,\n * for simplification, 0 values are converted into 0, not into -Infinity. On the other hand, we mean\n * that all values less than series minimum, is 0 values, and we create special \"minimum\" bucket for\n * that values (actually, there're no values less than minimum, so this bucket is empty).\n *  8-16|    | ** |    |  * |  **|\n *   4-8|  * |*  *|*   |** *| *  |\n *   2-4| * *|    | ***|    |*   |\n *   1-2|*   |    |    |    |    | This bucket contains minimum series value\n * 0.5-1|____|____|____|____|____| This bucket should be displayed as 0 on graph\n *     0|____|____|____|____|____| This bucket is for 0 values (should actually be -Infinity)\n * So we should merge two bottom buckets into one (0-value bucket).\n *\n * @param  {Object} buckets  Heatmap buckets\n * @param  {Number} minValue Minimum series value\n * @return {Object}          Transformed buckets\n */\nfunction mergeZeroBuckets(buckets, minValue) {\n  _.forEach(buckets, xBucket => {\n    const yBuckets = xBucket.buckets;\n\n    const emptyBucket = {\n      bounds: { bottom: 0, top: 0 },\n      values: [],\n      points: [],\n      count: 0,\n    };\n\n    const nullBucket = yBuckets[0] || emptyBucket;\n    const minBucket = yBuckets[minValue] || emptyBucket;\n\n    const newBucket = {\n      y: 0,\n      bounds: { bottom: minValue, top: minBucket.bounds.top || minValue },\n      values: [],\n      points: [],\n      count: 0,\n    };\n\n    newBucket.points = nullBucket.points.concat(minBucket.points);\n    newBucket.values = nullBucket.values.concat(minBucket.values);\n    newBucket.count = newBucket.values.length;\n\n    if (newBucket.count === 0) {\n      return;\n    }\n\n    delete yBuckets[minValue];\n    yBuckets[0] = newBucket;\n  });\n\n  return buckets;\n}\n\n/**\n * Convert set of time series into heatmap buckets\n * @return {Object}    Heatmap object:\n * {\n *   xBucketBound_1: {\n *     x: xBucketBound_1,\n *     buckets: {\n *       yBucketBound_1: {\n *         y: yBucketBound_1,\n *         bounds: {bottom, top}\n *         values: [val_1, val_2, ..., val_K],\n *         points: [[val_Y, val_X, series_name], ..., [...]],\n *         seriesStat: {seriesName_1: val_1, seriesName_2: val_2}\n *       },\n *       ...\n *       yBucketBound_M: {}\n *     },\n *     values: [val_1, val_2, ..., val_K],\n *     points: [\n *       [val_Y, val_X, series_name], (point_1)\n *       ...\n *       [...] (point_K)\n *     ]\n *   },\n *   xBucketBound_2: {},\n *   ...\n *   xBucketBound_N: {}\n * }\n */\nfunction convertToHeatMap(seriesList, yBucketSize, xBucketSize, logBase = 1) {\n  const heatmap = {};\n\n  for (const series of seriesList) {\n    const datapoints = series.datapoints;\n    const seriesName = series.label;\n\n    // Slice series into X axis buckets\n    // |    | ** |    |  * |  **|\n    // |  * |*  *|*   |** *| *  |\n    // |** *|    | ***|    |*   |\n    // |____|____|____|____|____|_\n    //\n    _.forEach(datapoints, point => {\n      const bucketBound = getBucketBound(point[TIME_INDEX], xBucketSize);\n      pushToXBuckets(heatmap, point, bucketBound, seriesName);\n    });\n  }\n\n  // Slice X axis buckets into Y (value) buckets\n  // |  **|     |2|,\n  // | *  | --\\ |1|,\n  // |*   | --/ |1|,\n  // |____|     |0|\n  //\n  _.forEach(heatmap, xBucket => {\n    if (logBase !== 1) {\n      xBucket.buckets = convertToLogScaleValueBuckets(xBucket, yBucketSize, logBase);\n    } else {\n      xBucket.buckets = convertToValueBuckets(xBucket, yBucketSize);\n    }\n  });\n\n  return heatmap;\n}\n\nfunction pushToXBuckets(buckets, point, bucketNum, seriesName) {\n  const value = point[VALUE_INDEX];\n  if (value === null || value === undefined || isNaN(value)) {\n    return;\n  }\n\n  // Add series name to point for future identification\n  const pointExt = _.concat(point, seriesName);\n\n  if (buckets[bucketNum] && buckets[bucketNum].values) {\n    buckets[bucketNum].values.push(value);\n    buckets[bucketNum].points.push(pointExt);\n  } else {\n    buckets[bucketNum] = {\n      x: bucketNum,\n      values: [value],\n      points: [pointExt],\n    };\n  }\n}\n\nfunction pushToYBuckets(buckets, bucketNum, value, point, bounds) {\n  let count = 1;\n  // Use the 3rd argument as scale/count\n  if (point.length > 3) {\n    count = parseInt(point[2], 10);\n  }\n  if (buckets[bucketNum]) {\n    buckets[bucketNum].values.push(value);\n    buckets[bucketNum].points.push(point);\n    buckets[bucketNum].count += count;\n  } else {\n    buckets[bucketNum] = {\n      y: bucketNum,\n      bounds: bounds,\n      values: [value],\n      points: [point],\n      count: count,\n    };\n  }\n}\n\nfunction getValueBucketBound(value, yBucketSize, logBase) {\n  if (logBase === 1) {\n    return getBucketBound(value, yBucketSize);\n  } else {\n    return getLogScaleBucketBound(value, yBucketSize, logBase);\n  }\n}\n\n/**\n * Find bucket for given value (for linear scale)\n */\nfunction getBucketBounds(value, bucketSize) {\n  let bottom, top;\n  bottom = Math.floor(value / bucketSize) * bucketSize;\n  top = (Math.floor(value / bucketSize) + 1) * bucketSize;\n\n  return { bottom, top };\n}\n\nfunction getBucketBound(value, bucketSize) {\n  const bounds = getBucketBounds(value, bucketSize);\n  return bounds.bottom;\n}\n\nfunction convertToValueBuckets(xBucket, bucketSize) {\n  const values = xBucket.values;\n  const points = xBucket.points;\n  const buckets = {};\n\n  _.forEach(values, (val, index) => {\n    const bounds = getBucketBounds(val, bucketSize);\n    const bucketNum = bounds.bottom;\n    pushToYBuckets(buckets, bucketNum, val, points[index], bounds);\n  });\n\n  return buckets;\n}\n\n/**\n * Find bucket for given value (for log scales)\n */\nfunction getLogScaleBucketBounds(value, yBucketSplitFactor, logBase) {\n  let top, bottom;\n  if (value === 0) {\n    return { bottom: 0, top: 0 };\n  }\n\n  const valueLog = logp(value, logBase);\n  let pow, powTop;\n  if (yBucketSplitFactor === 1 || !yBucketSplitFactor) {\n    pow = Math.floor(valueLog);\n    powTop = pow + 1;\n  } else {\n    const additionalBucketSize = 1 / yBucketSplitFactor;\n    let additionalLog = valueLog - Math.floor(valueLog);\n    additionalLog = Math.floor(additionalLog / additionalBucketSize) * additionalBucketSize;\n    pow = Math.floor(valueLog) + additionalLog;\n    powTop = pow + additionalBucketSize;\n  }\n  bottom = Math.pow(logBase, pow);\n  top = Math.pow(logBase, powTop);\n\n  return { bottom, top };\n}\n\nfunction getLogScaleBucketBound(value, yBucketSplitFactor, logBase) {\n  const bounds = getLogScaleBucketBounds(value, yBucketSplitFactor, logBase);\n  return bounds.bottom;\n}\n\nfunction convertToLogScaleValueBuckets(xBucket, yBucketSplitFactor, logBase) {\n  const values = xBucket.values;\n  const points = xBucket.points;\n\n  const buckets = {};\n  _.forEach(values, (val, index) => {\n    const bounds = getLogScaleBucketBounds(val, yBucketSplitFactor, logBase);\n    const bucketNum = bounds.bottom;\n    pushToYBuckets(buckets, bucketNum, val, points[index], bounds);\n  });\n\n  return buckets;\n}\n\n/**\n * Logarithm for custom base\n * @param value\n * @param base logarithm base\n */\nfunction logp(value, base) {\n  return Math.log(value) / Math.log(base);\n}\n\n/**\n * Calculate size of Y bucket from given buckets bounds.\n * @param bounds Array of Y buckets bounds\n * @param logBase Logarithm base\n */\nfunction calculateBucketSize(bounds: number[], logBase = 1): number {\n  let bucketSize = Infinity;\n\n  if (bounds.length === 0) {\n    return 0;\n  } else if (bounds.length === 1) {\n    return bounds[0];\n  } else {\n    bounds = _.sortBy(bounds);\n    for (let i = 1; i < bounds.length; i++) {\n      const distance = getDistance(bounds[i], bounds[i - 1], logBase);\n      bucketSize = distance < bucketSize ? distance : bucketSize;\n    }\n  }\n\n  return bucketSize;\n}\n\n/**\n * Calculate distance between two numbers in given scale (linear or logarithmic).\n * @param a\n * @param b\n * @param logBase\n */\nfunction getDistance(a: number, b: number, logBase = 1): number {\n  if (logBase === 1) {\n    // Linear distance\n    return Math.abs(b - a);\n  } else {\n    // logarithmic distance\n    const ratio = Math.max(a, b) / Math.min(a, b);\n    return logp(ratio, logBase);\n  }\n}\n\n/**\n * Compare two heatmap data objects\n * @param objA\n * @param objB\n */\nfunction isHeatmapDataEqual(objA: any, objB: any): boolean {\n  let isEql = !emptyXOR(objA, objB);\n\n  _.forEach(objA, (xBucket: XBucket, x) => {\n    if (objB[x]) {\n      if (emptyXOR(xBucket.buckets, objB[x].buckets)) {\n        isEql = false;\n        return false;\n      }\n\n      _.forEach(xBucket.buckets, (yBucket: YBucket, y) => {\n        if (objB[x].buckets && objB[x].buckets[y]) {\n          if (objB[x].buckets[y].values) {\n            isEql = _.isEqual(_.sortBy(yBucket.values), _.sortBy(objB[x].buckets[y].values));\n            if (!isEql) {\n              return false;\n            } else {\n              return true;\n            }\n          } else {\n            isEql = false;\n            return false;\n          }\n        } else {\n          isEql = false;\n          return false;\n        }\n      });\n\n      if (!isEql) {\n        return false;\n      } else {\n        return true;\n      }\n    } else {\n      isEql = false;\n      return false;\n    }\n  });\n\n  return isEql;\n}\n\nfunction emptyXOR(foo: any, bar: any): boolean {\n  return (_.isEmpty(foo) || _.isEmpty(bar)) && !(_.isEmpty(foo) && _.isEmpty(bar));\n}\n\nexport {\n  convertToHeatMap,\n  histogramToHeatmap,\n  convertToCards,\n  mergeZeroBuckets,\n  getValueBucketBound,\n  isHeatmapDataEqual,\n  calculateBucketSize,\n  sortSeriesByLabel,\n};\n","import kbn from 'app/core/utils/kbn';\n\nexport class AxesEditorCtrl {\n  panel: any;\n  panelCtrl: any;\n  unitFormats: any;\n  logScales: any;\n  dataFormats: any;\n  yBucketBoundModes: any;\n\n  /** @ngInject */\n  constructor($scope, uiSegmentSrv) {\n    $scope.editor = this;\n    this.panelCtrl = $scope.ctrl;\n    this.panel = this.panelCtrl.panel;\n    this.unitFormats = kbn.getUnitFormats();\n\n    this.logScales = {\n      linear: 1,\n      'log (base 2)': 2,\n      'log (base 10)': 10,\n      'log (base 32)': 32,\n      'log (base 1024)': 1024,\n    };\n\n    this.dataFormats = {\n      'Time series': 'timeseries',\n      'Time series buckets': 'tsbuckets',\n    };\n\n    this.yBucketBoundModes = {\n      Auto: 'auto',\n      Upper: 'upper',\n      Lower: 'lower',\n    };\n  }\n\n  setUnitFormat(subItem) {\n    this.panel.yAxis.format = subItem.value;\n    this.panelCtrl.render();\n  }\n}\n\n/** @ngInject */\nexport function axesEditor() {\n  'use strict';\n  return {\n    restrict: 'E',\n    scope: true,\n    templateUrl: 'public/app/plugins/panel/heatmap/partials/axes_editor.html',\n    controller: AxesEditorCtrl,\n  };\n}\n","import * as d3 from 'd3';\nimport $ from 'jquery';\nimport _ from 'lodash';\nimport kbn from 'app/core/utils/kbn';\nimport { getValueBucketBound } from './heatmap_data_converter';\n\nconst TOOLTIP_PADDING_X = 30;\nconst TOOLTIP_PADDING_Y = 5;\nconst HISTOGRAM_WIDTH = 160;\nconst HISTOGRAM_HEIGHT = 40;\n\nexport class HeatmapTooltip {\n  tooltip: any;\n  scope: any;\n  dashboard: any;\n  panelCtrl: any;\n  panel: any;\n  heatmapPanel: any;\n  mouseOverBucket: boolean;\n  originalFillColor: any;\n\n  constructor(elem, scope) {\n    this.scope = scope;\n    this.dashboard = scope.ctrl.dashboard;\n    this.panelCtrl = scope.ctrl;\n    this.panel = scope.ctrl.panel;\n    this.heatmapPanel = elem;\n    this.mouseOverBucket = false;\n    this.originalFillColor = null;\n\n    elem.on('mouseleave', this.onMouseLeave.bind(this));\n  }\n\n  onMouseLeave() {\n    this.destroy();\n  }\n\n  onMouseMove(e) {\n    if (!this.panel.tooltip.show) {\n      return;\n    }\n\n    this.move(e);\n  }\n\n  add() {\n    this.tooltip = d3\n      .select('body')\n      .append('div')\n      .attr('class', 'heatmap-tooltip graph-tooltip grafana-tooltip');\n  }\n\n  destroy() {\n    if (this.tooltip) {\n      this.tooltip.remove();\n    }\n\n    this.tooltip = null;\n  }\n\n  show(pos, data) {\n    if (!this.panel.tooltip.show || !data) {\n      return;\n    }\n    // shared tooltip mode\n    if (pos.panelRelY) {\n      return;\n    }\n\n    const { xBucketIndex, yBucketIndex } = this.getBucketIndexes(pos, data);\n\n    if (!data.buckets[xBucketIndex]) {\n      this.destroy();\n      return;\n    }\n\n    if (!this.tooltip) {\n      this.add();\n    }\n\n    let boundBottom, boundTop, valuesNumber;\n    const xData = data.buckets[xBucketIndex];\n    // Search in special 'zero' bucket also\n    const yData = _.find(xData.buckets, (bucket, bucketIndex) => {\n      return bucket.bounds.bottom === yBucketIndex || bucketIndex === yBucketIndex.toString();\n    });\n\n    const tooltipTimeFormat = 'YYYY-MM-DD HH:mm:ss';\n    const time = this.dashboard.formatDate(xData.x, tooltipTimeFormat);\n\n    // Decimals override. Code from panel/graph/graph.ts\n    let countValueFormatter, bucketBoundFormatter;\n    if (_.isNumber(this.panel.tooltipDecimals)) {\n      countValueFormatter = this.countValueFormatter(this.panel.tooltipDecimals, null);\n      bucketBoundFormatter = this.panelCtrl.tickValueFormatter(this.panelCtrl.decimals, null);\n    } else {\n      // auto decimals\n      // legend and tooltip gets one more decimal precision\n      // than graph legend ticks\n      const decimals = (this.panelCtrl.decimals || -1) + 1;\n      countValueFormatter = this.countValueFormatter(decimals, this.panelCtrl.scaledDecimals + 2);\n      bucketBoundFormatter = this.panelCtrl.tickValueFormatter(decimals, this.panelCtrl.scaledDecimals + 2);\n    }\n\n    let tooltipHtml = `<div class=\"graph-tooltip-time\">${time}</div>\n      <div class=\"heatmap-histogram\"></div>`;\n\n    if (yData) {\n      if (yData.bounds) {\n        if (data.tsBuckets) {\n          // Use Y-axis labels\n          const tickFormatter = valIndex => {\n            return data.tsBucketsFormatted ? data.tsBucketsFormatted[valIndex] : data.tsBuckets[valIndex];\n          };\n\n          boundBottom = tickFormatter(yBucketIndex);\n          boundTop = yBucketIndex < data.tsBuckets.length - 1 ? tickFormatter(yBucketIndex + 1) : '';\n        } else {\n          // Display 0 if bucket is a special 'zero' bucket\n          const bottom = yData.y ? yData.bounds.bottom : 0;\n          boundBottom = bucketBoundFormatter(bottom);\n          boundTop = bucketBoundFormatter(yData.bounds.top);\n        }\n        valuesNumber = countValueFormatter(yData.count);\n        tooltipHtml += `<div>\n          bucket: <b>${boundBottom} - ${boundTop}</b> <br>\n          count: <b>${valuesNumber}</b> <br>\n        </div>`;\n      } else {\n        // currently no bounds for pre bucketed data\n        tooltipHtml += `<div>count: <b>${yData.count}</b><br></div>`;\n      }\n    } else {\n      if (!this.panel.tooltip.showHistogram) {\n        this.destroy();\n        return;\n      }\n      boundBottom = yBucketIndex;\n      boundTop = '';\n      valuesNumber = 0;\n    }\n\n    this.tooltip.html(tooltipHtml);\n\n    if (this.panel.tooltip.showHistogram) {\n      this.addHistogram(xData);\n    }\n\n    this.move(pos);\n  }\n\n  getBucketIndexes(pos, data) {\n    const xBucketIndex = this.getXBucketIndex(pos.x, data);\n    const yBucketIndex = this.getYBucketIndex(pos.y, data);\n    return { xBucketIndex, yBucketIndex };\n  }\n\n  getXBucketIndex(x, data) {\n    // First try to find X bucket by checking x pos is in the\n    // [bucket.x, bucket.x + xBucketSize] interval\n    const xBucket = _.find(data.buckets, bucket => {\n      return x > bucket.x && x - bucket.x <= data.xBucketSize;\n    });\n    return xBucket ? xBucket.x : getValueBucketBound(x, data.xBucketSize, 1);\n  }\n\n  getYBucketIndex(y, data) {\n    if (data.tsBuckets) {\n      return Math.floor(y);\n    }\n    const yBucketIndex = getValueBucketBound(y, data.yBucketSize, this.panel.yAxis.logBase);\n    return yBucketIndex;\n  }\n\n  getSharedTooltipPos(pos) {\n    // get pageX from position on x axis and pageY from relative position in original panel\n    pos.pageX = this.heatmapPanel.offset().left + this.scope.xScale(pos.x);\n    pos.pageY = this.heatmapPanel.offset().top + this.scope.chartHeight * pos.panelRelY;\n    return pos;\n  }\n\n  addHistogram(data) {\n    const xBucket = this.scope.ctrl.data.buckets[data.x];\n    const yBucketSize = this.scope.ctrl.data.yBucketSize;\n    let min, max, ticks;\n    if (this.scope.ctrl.data.tsBuckets) {\n      min = 0;\n      max = this.scope.ctrl.data.tsBuckets.length - 1;\n      ticks = this.scope.ctrl.data.tsBuckets.length;\n    } else {\n      min = this.scope.ctrl.data.yAxis.min;\n      max = this.scope.ctrl.data.yAxis.max;\n      ticks = this.scope.ctrl.data.yAxis.ticks;\n    }\n    let histogramData = _.map(xBucket.buckets, bucket => {\n      const count = bucket.count !== undefined ? bucket.count : bucket.values.length;\n      return [bucket.bounds.bottom, count];\n    });\n    histogramData = _.filter(histogramData, d => {\n      return d[0] >= min && d[0] <= max;\n    });\n\n    const scale = this.scope.yScale.copy();\n    const histXScale = scale.domain([min, max]).range([0, HISTOGRAM_WIDTH]);\n\n    let barWidth;\n    if (this.panel.yAxis.logBase === 1) {\n      barWidth = Math.floor(HISTOGRAM_WIDTH / (max - min) * yBucketSize * 0.9);\n    } else {\n      const barNumberFactor = yBucketSize ? yBucketSize : 1;\n      barWidth = Math.floor(HISTOGRAM_WIDTH / ticks / barNumberFactor * 0.9);\n    }\n    barWidth = Math.max(barWidth, 1);\n\n    // Normalize histogram Y axis\n    const histogramDomain = _.reduce(_.map(histogramData, d => d[1]), (sum, val) => sum + val, 0);\n    const histYScale = d3\n      .scaleLinear()\n      .domain([0, histogramDomain])\n      .range([0, HISTOGRAM_HEIGHT]);\n\n    const histogram = this.tooltip\n      .select('.heatmap-histogram')\n      .append('svg')\n      .attr('width', HISTOGRAM_WIDTH)\n      .attr('height', HISTOGRAM_HEIGHT);\n\n    histogram\n      .selectAll('.bar')\n      .data(histogramData)\n      .enter()\n      .append('rect')\n      .attr('x', d => {\n        return histXScale(d[0]);\n      })\n      .attr('width', barWidth)\n      .attr('y', d => {\n        return HISTOGRAM_HEIGHT - histYScale(d[1]);\n      })\n      .attr('height', d => {\n        return histYScale(d[1]);\n      });\n  }\n\n  move(pos) {\n    if (!this.tooltip) {\n      return;\n    }\n\n    const elem = $(this.tooltip.node())[0];\n    const tooltipWidth = elem.clientWidth;\n    const tooltipHeight = elem.clientHeight;\n\n    let left = pos.pageX + TOOLTIP_PADDING_X;\n    let top = pos.pageY + TOOLTIP_PADDING_Y;\n\n    if (pos.pageX + tooltipWidth + 40 > window.innerWidth) {\n      left = pos.pageX - tooltipWidth - TOOLTIP_PADDING_X;\n    }\n\n    if (pos.pageY - window.pageYOffset + tooltipHeight + 20 > window.innerHeight) {\n      top = pos.pageY - tooltipHeight - TOOLTIP_PADDING_Y;\n    }\n\n    return this.tooltip.style('left', left + 'px').style('top', top + 'px');\n  }\n\n  countValueFormatter(decimals, scaledDecimals = null) {\n    const format = 'short';\n    return value => {\n      return kbn.valueFormats[format](value, decimals, scaledDecimals);\n    };\n  }\n}\n","import _ from 'lodash';\nimport $ from 'jquery';\nimport moment from 'moment';\nimport * as d3 from 'd3';\nimport kbn from 'app/core/utils/kbn';\nimport { appEvents, contextSrv } from 'app/core/core';\nimport * as ticksUtils from 'app/core/utils/ticks';\nimport { HeatmapTooltip } from './heatmap_tooltip';\nimport { mergeZeroBuckets } from './heatmap_data_converter';\nimport { getColorScale, getOpacityScale } from './color_scale';\n\nconst MIN_CARD_SIZE = 1,\n  CARD_PADDING = 1,\n  CARD_ROUND = 0,\n  DATA_RANGE_WIDING_FACTOR = 1.2,\n  DEFAULT_X_TICK_SIZE_PX = 100,\n  DEFAULT_Y_TICK_SIZE_PX = 50,\n  X_AXIS_TICK_PADDING = 10,\n  Y_AXIS_TICK_PADDING = 5,\n  MIN_SELECTION_WIDTH = 2;\n\nexport default function rendering(scope, elem, attrs, ctrl) {\n  return new HeatmapRenderer(scope, elem, attrs, ctrl);\n}\nexport class HeatmapRenderer {\n  width: number;\n  height: number;\n  yScale: any;\n  xScale: any;\n  chartWidth: number;\n  chartHeight: number;\n  chartTop: number;\n  chartBottom: number;\n  yAxisWidth: number;\n  xAxisHeight: number;\n  cardPadding: number;\n  cardRound: number;\n  cardWidth: number;\n  cardHeight: number;\n  colorScale: any;\n  opacityScale: any;\n  mouseUpHandler: any;\n  data: any;\n  panel: any;\n  $heatmap: any;\n  tooltip: HeatmapTooltip;\n  heatmap: any;\n  timeRange: any;\n\n  selection: any;\n  padding: any;\n  margin: any;\n  dataRangeWidingFactor: number;\n  constructor(private scope, private elem, attrs, private ctrl) {\n    // $heatmap is JQuery object, but heatmap is D3\n    this.$heatmap = this.elem.find('.heatmap-panel');\n    this.tooltip = new HeatmapTooltip(this.$heatmap, this.scope);\n\n    this.selection = {\n      active: false,\n      x1: -1,\n      x2: -1,\n    };\n\n    this.padding = { left: 0, right: 0, top: 0, bottom: 0 };\n    this.margin = { left: 25, right: 15, top: 10, bottom: 20 };\n    this.dataRangeWidingFactor = DATA_RANGE_WIDING_FACTOR;\n\n    this.ctrl.events.on('render', this.onRender.bind(this));\n\n    this.ctrl.tickValueFormatter = this.tickValueFormatter.bind(this);\n\n    /////////////////////////////\n    // Selection and crosshair //\n    /////////////////////////////\n\n    // Shared crosshair and tooltip\n    appEvents.on('graph-hover', this.onGraphHover.bind(this), this.scope);\n\n    appEvents.on('graph-hover-clear', this.onGraphHoverClear.bind(this), this.scope);\n\n    // Register selection listeners\n    this.$heatmap.on('mousedown', this.onMouseDown.bind(this));\n    this.$heatmap.on('mousemove', this.onMouseMove.bind(this));\n    this.$heatmap.on('mouseleave', this.onMouseLeave.bind(this));\n  }\n\n  onGraphHoverClear() {\n    this.clearCrosshair();\n  }\n\n  onGraphHover(event) {\n    this.drawSharedCrosshair(event.pos);\n  }\n\n  onRender() {\n    this.render();\n    this.ctrl.renderingCompleted();\n  }\n\n  setElementHeight() {\n    try {\n      let height = this.ctrl.height || this.panel.height || this.ctrl.row.height;\n      if (_.isString(height)) {\n        height = parseInt(height.replace('px', ''), 10);\n      }\n\n      height -= this.panel.legend.show ? 28 : 11; // bottom padding and space for legend\n\n      this.$heatmap.css('height', height + 'px');\n\n      return true;\n    } catch (e) {\n      // IE throws errors sometimes\n      return false;\n    }\n  }\n\n  getYAxisWidth(elem) {\n    const axisText = elem.selectAll('.axis-y text').nodes();\n    const maxTextWidth = _.max(\n      _.map(axisText, text => {\n        // Use SVG getBBox method\n        return text.getBBox().width;\n      })\n    );\n\n    return maxTextWidth;\n  }\n\n  getXAxisHeight(elem) {\n    const axisLine = elem.select('.axis-x line');\n    if (!axisLine.empty()) {\n      const axisLinePosition = parseFloat(elem.select('.axis-x line').attr('y2'));\n      const canvasWidth = parseFloat(elem.attr('height'));\n      return canvasWidth - axisLinePosition;\n    } else {\n      // Default height\n      return 30;\n    }\n  }\n\n  addXAxis() {\n    this.scope.xScale = this.xScale = d3\n      .scaleTime()\n      .domain([this.timeRange.from, this.timeRange.to])\n      .range([0, this.chartWidth]);\n\n    const ticks = this.chartWidth / DEFAULT_X_TICK_SIZE_PX;\n    const grafanaTimeFormatter = ticksUtils.grafanaTimeFormat(ticks, this.timeRange.from, this.timeRange.to);\n    let timeFormat;\n    const dashboardTimeZone = this.ctrl.dashboard.getTimezone();\n    if (dashboardTimeZone === 'utc') {\n      timeFormat = d3.utcFormat(grafanaTimeFormatter);\n    } else {\n      timeFormat = d3.timeFormat(grafanaTimeFormatter);\n    }\n\n    const xAxis = d3\n      .axisBottom(this.xScale)\n      .ticks(ticks)\n      .tickFormat(timeFormat)\n      .tickPadding(X_AXIS_TICK_PADDING)\n      .tickSize(this.chartHeight);\n\n    const posY = this.margin.top;\n    const posX = this.yAxisWidth;\n    this.heatmap\n      .append('g')\n      .attr('class', 'axis axis-x')\n      .attr('transform', 'translate(' + posX + ',' + posY + ')')\n      .call(xAxis);\n\n    // Remove horizontal line in the top of axis labels (called domain in d3)\n    this.heatmap\n      .select('.axis-x')\n      .select('.domain')\n      .remove();\n  }\n\n  addYAxis() {\n    let ticks = Math.ceil(this.chartHeight / DEFAULT_Y_TICK_SIZE_PX);\n    let tickInterval = ticksUtils.tickStep(this.data.heatmapStats.min, this.data.heatmapStats.max, ticks);\n    let { yMin, yMax } = this.wideYAxisRange(this.data.heatmapStats.min, this.data.heatmapStats.max, tickInterval);\n\n    // Rewrite min and max if it have been set explicitly\n    yMin = this.panel.yAxis.min !== null ? this.panel.yAxis.min : yMin;\n    yMax = this.panel.yAxis.max !== null ? this.panel.yAxis.max : yMax;\n\n    // Adjust ticks after Y range widening\n    tickInterval = ticksUtils.tickStep(yMin, yMax, ticks);\n    ticks = Math.ceil((yMax - yMin) / tickInterval);\n\n    const decimalsAuto = ticksUtils.getPrecision(tickInterval);\n    let decimals = this.panel.yAxis.decimals === null ? decimalsAuto : this.panel.yAxis.decimals;\n    // Calculate scaledDecimals for log scales using tick size (as in jquery.flot.js)\n    const flotTickSize = ticksUtils.getFlotTickSize(yMin, yMax, ticks, decimalsAuto);\n    const scaledDecimals = ticksUtils.getScaledDecimals(decimals, flotTickSize);\n    this.ctrl.decimals = decimals;\n    this.ctrl.scaledDecimals = scaledDecimals;\n\n    // Set default Y min and max if no data\n    if (_.isEmpty(this.data.buckets)) {\n      yMax = 1;\n      yMin = -1;\n      ticks = 3;\n      decimals = 1;\n    }\n\n    this.data.yAxis = {\n      min: yMin,\n      max: yMax,\n      ticks: ticks,\n    };\n\n    this.scope.yScale = this.yScale = d3\n      .scaleLinear()\n      .domain([yMin, yMax])\n      .range([this.chartHeight, 0]);\n\n    const yAxis = d3\n      .axisLeft(this.yScale)\n      .ticks(ticks)\n      .tickFormat(this.tickValueFormatter(decimals, scaledDecimals))\n      .tickSizeInner(0 - this.width)\n      .tickSizeOuter(0)\n      .tickPadding(Y_AXIS_TICK_PADDING);\n\n    this.heatmap\n      .append('g')\n      .attr('class', 'axis axis-y')\n      .call(yAxis);\n\n    // Calculate Y axis width first, then move axis into visible area\n    const posY = this.margin.top;\n    const posX = this.getYAxisWidth(this.heatmap) + Y_AXIS_TICK_PADDING;\n    this.heatmap.select('.axis-y').attr('transform', 'translate(' + posX + ',' + posY + ')');\n\n    // Remove vertical line in the right of axis labels (called domain in d3)\n    this.heatmap\n      .select('.axis-y')\n      .select('.domain')\n      .remove();\n  }\n\n  // Wide Y values range and anjust to bucket size\n  wideYAxisRange(min, max, tickInterval) {\n    const yWiding = (max * (this.dataRangeWidingFactor - 1) - min * (this.dataRangeWidingFactor - 1)) / 2;\n    let yMin, yMax;\n\n    if (tickInterval === 0) {\n      yMax = max * this.dataRangeWidingFactor;\n      yMin = min - min * (this.dataRangeWidingFactor - 1);\n      tickInterval = (yMax - yMin) / 2;\n    } else {\n      yMax = Math.ceil((max + yWiding) / tickInterval) * tickInterval;\n      yMin = Math.floor((min - yWiding) / tickInterval) * tickInterval;\n    }\n\n    // Don't wide axis below 0 if all values are positive\n    if (min >= 0 && yMin < 0) {\n      yMin = 0;\n    }\n\n    return { yMin, yMax };\n  }\n\n  addLogYAxis() {\n    const logBase = this.panel.yAxis.logBase;\n    let { yMin, yMax } = this.adjustLogRange(this.data.heatmapStats.minLog, this.data.heatmapStats.max, logBase);\n\n    yMin =\n      this.panel.yAxis.min && this.panel.yAxis.min !== '0' ? this.adjustLogMin(this.panel.yAxis.min, logBase) : yMin;\n    yMax = this.panel.yAxis.max !== null ? this.adjustLogMax(this.panel.yAxis.max, logBase) : yMax;\n\n    // Set default Y min and max if no data\n    if (_.isEmpty(this.data.buckets)) {\n      yMax = Math.pow(logBase, 2);\n      yMin = 1;\n    }\n\n    this.scope.yScale = this.yScale = d3\n      .scaleLog()\n      .base(this.panel.yAxis.logBase)\n      .domain([yMin, yMax])\n      .range([this.chartHeight, 0]);\n\n    const domain = this.yScale.domain();\n    const tickValues = this.logScaleTickValues(domain, logBase);\n\n    const decimalsAuto = ticksUtils.getPrecision(yMin);\n    const decimals = this.panel.yAxis.decimals || decimalsAuto;\n\n    // Calculate scaledDecimals for log scales using tick size (as in jquery.flot.js)\n    const flotTickSize = ticksUtils.getFlotTickSize(yMin, yMax, tickValues.length, decimalsAuto);\n    const scaledDecimals = ticksUtils.getScaledDecimals(decimals, flotTickSize);\n    this.ctrl.decimals = decimals;\n    this.ctrl.scaledDecimals = scaledDecimals;\n\n    this.data.yAxis = {\n      min: yMin,\n      max: yMax,\n      ticks: tickValues.length,\n    };\n\n    const yAxis = d3\n      .axisLeft(this.yScale)\n      .tickValues(tickValues)\n      .tickFormat(this.tickValueFormatter(decimals, scaledDecimals))\n      .tickSizeInner(0 - this.width)\n      .tickSizeOuter(0)\n      .tickPadding(Y_AXIS_TICK_PADDING);\n\n    this.heatmap\n      .append('g')\n      .attr('class', 'axis axis-y')\n      .call(yAxis);\n\n    // Calculate Y axis width first, then move axis into visible area\n    const posY = this.margin.top;\n    const posX = this.getYAxisWidth(this.heatmap) + Y_AXIS_TICK_PADDING;\n    this.heatmap.select('.axis-y').attr('transform', 'translate(' + posX + ',' + posY + ')');\n\n    // Set first tick as pseudo 0\n    if (yMin < 1) {\n      this.heatmap\n        .select('.axis-y')\n        .select('.tick text')\n        .text('0');\n    }\n\n    // Remove vertical line in the right of axis labels (called domain in d3)\n    this.heatmap\n      .select('.axis-y')\n      .select('.domain')\n      .remove();\n  }\n\n  addYAxisFromBuckets() {\n    const tsBuckets = this.data.tsBuckets;\n\n    this.scope.yScale = this.yScale = d3\n      .scaleLinear()\n      .domain([0, tsBuckets.length - 1])\n      .range([this.chartHeight, 0]);\n\n    const tickValues = _.map(tsBuckets, (b, i) => i);\n    const decimalsAuto = _.max(_.map(tsBuckets, ticksUtils.getStringPrecision));\n    const decimals = this.panel.yAxis.decimals === null ? decimalsAuto : this.panel.yAxis.decimals;\n    this.ctrl.decimals = decimals;\n\n    const tickValueFormatter = this.tickValueFormatter.bind(this);\n    function tickFormatter(valIndex) {\n      let valueFormatted = tsBuckets[valIndex];\n      if (!_.isNaN(_.toNumber(valueFormatted)) && valueFormatted !== '') {\n        // Try to format numeric tick labels\n        valueFormatted = tickValueFormatter(decimals)(_.toNumber(valueFormatted));\n      }\n      return valueFormatted;\n    }\n\n    const tsBucketsFormatted = _.map(tsBuckets, (v, i) => tickFormatter(i));\n    this.data.tsBucketsFormatted = tsBucketsFormatted;\n\n    const yAxis = d3\n      .axisLeft(this.yScale)\n      .tickValues(tickValues)\n      .tickFormat(tickFormatter)\n      .tickSizeInner(0 - this.width)\n      .tickSizeOuter(0)\n      .tickPadding(Y_AXIS_TICK_PADDING);\n\n    this.heatmap\n      .append('g')\n      .attr('class', 'axis axis-y')\n      .call(yAxis);\n\n    // Calculate Y axis width first, then move axis into visible area\n    const posY = this.margin.top;\n    const posX = this.getYAxisWidth(this.heatmap) + Y_AXIS_TICK_PADDING;\n    this.heatmap.select('.axis-y').attr('transform', 'translate(' + posX + ',' + posY + ')');\n\n    // Remove vertical line in the right of axis labels (called domain in d3)\n    this.heatmap\n      .select('.axis-y')\n      .select('.domain')\n      .remove();\n  }\n\n  // Adjust data range to log base\n  adjustLogRange(min, max, logBase) {\n    let yMin, yMax;\n\n    yMin = this.data.heatmapStats.minLog;\n    if (this.data.heatmapStats.minLog > 1 || !this.data.heatmapStats.minLog) {\n      yMin = 1;\n    } else {\n      yMin = this.adjustLogMin(this.data.heatmapStats.minLog, logBase);\n    }\n\n    // Adjust max Y value to log base\n    yMax = this.adjustLogMax(this.data.heatmapStats.max, logBase);\n\n    return { yMin, yMax };\n  }\n\n  adjustLogMax(max, base) {\n    return Math.pow(base, Math.ceil(ticksUtils.logp(max, base)));\n  }\n\n  adjustLogMin(min, base) {\n    return Math.pow(base, Math.floor(ticksUtils.logp(min, base)));\n  }\n\n  logScaleTickValues(domain, base) {\n    const domainMin = domain[0];\n    const domainMax = domain[1];\n    const tickValues = [];\n\n    if (domainMin < 1) {\n      const underOneTicks = Math.floor(ticksUtils.logp(domainMin, base));\n      for (let i = underOneTicks; i < 0; i++) {\n        const tickValue = Math.pow(base, i);\n        tickValues.push(tickValue);\n      }\n    }\n\n    const ticks = Math.ceil(ticksUtils.logp(domainMax, base));\n    for (let i = 0; i <= ticks; i++) {\n      const tickValue = Math.pow(base, i);\n      tickValues.push(tickValue);\n    }\n\n    return tickValues;\n  }\n\n  tickValueFormatter(decimals, scaledDecimals = null) {\n    const format = this.panel.yAxis.format;\n    return value => {\n      try {\n        return format !== 'none' ? kbn.valueFormats[format](value, decimals, scaledDecimals) : value;\n      } catch (err) {\n        console.error(err.message || err);\n        return value;\n      }\n    };\n  }\n\n  fixYAxisTickSize() {\n    this.heatmap\n      .select('.axis-y')\n      .selectAll('.tick line')\n      .attr('x2', this.chartWidth);\n  }\n\n  addAxes() {\n    this.chartHeight = this.height - this.margin.top - this.margin.bottom;\n    this.chartTop = this.margin.top;\n    this.chartBottom = this.chartTop + this.chartHeight;\n    if (this.panel.dataFormat === 'tsbuckets') {\n      this.addYAxisFromBuckets();\n    } else {\n      if (this.panel.yAxis.logBase === 1) {\n        this.addYAxis();\n      } else {\n        this.addLogYAxis();\n      }\n    }\n\n    this.yAxisWidth = this.getYAxisWidth(this.heatmap) + Y_AXIS_TICK_PADDING;\n    this.chartWidth = this.width - this.yAxisWidth - this.margin.right;\n    this.fixYAxisTickSize();\n\n    this.addXAxis();\n    this.xAxisHeight = this.getXAxisHeight(this.heatmap);\n\n    if (!this.panel.yAxis.show) {\n      this.heatmap\n        .select('.axis-y')\n        .selectAll('line')\n        .style('opacity', 0);\n    }\n\n    if (!this.panel.xAxis.show) {\n      this.heatmap\n        .select('.axis-x')\n        .selectAll('line')\n        .style('opacity', 0);\n    }\n  }\n\n  addHeatmapCanvas() {\n    const heatmapElem = this.$heatmap[0];\n\n    this.width = Math.floor(this.$heatmap.width()) - this.padding.right;\n    this.height = Math.floor(this.$heatmap.height()) - this.padding.bottom;\n\n    this.cardPadding = this.panel.cards.cardPadding !== null ? this.panel.cards.cardPadding : CARD_PADDING;\n    this.cardRound = this.panel.cards.cardRound !== null ? this.panel.cards.cardRound : CARD_ROUND;\n\n    if (this.heatmap) {\n      this.heatmap.remove();\n    }\n\n    this.heatmap = d3\n      .select(heatmapElem)\n      .append('svg')\n      .attr('width', this.width)\n      .attr('height', this.height);\n  }\n\n  addHeatmap() {\n    this.addHeatmapCanvas();\n    this.addAxes();\n\n    if (this.panel.yAxis.logBase !== 1 && this.panel.dataFormat !== 'tsbuckets') {\n      const logBase = this.panel.yAxis.logBase;\n      const domain = this.yScale.domain();\n      const tickValues = this.logScaleTickValues(domain, logBase);\n      this.data.buckets = mergeZeroBuckets(this.data.buckets, _.min(tickValues));\n    }\n\n    const cardsData = this.data.cards;\n    const maxValueAuto = this.data.cardStats.max;\n    const maxValue = this.panel.color.max || maxValueAuto;\n    const minValue = this.panel.color.min || 0;\n\n    const colorScheme = _.find(this.ctrl.colorSchemes, {\n      value: this.panel.color.colorScheme,\n    });\n    this.colorScale = getColorScale(colorScheme, contextSrv.user.lightTheme, maxValue, minValue);\n    this.opacityScale = getOpacityScale(this.panel.color, maxValue);\n    this.setCardSize();\n\n    let cards = this.heatmap.selectAll('.heatmap-card').data(cardsData);\n    cards.append('title');\n    cards = cards\n      .enter()\n      .append('rect')\n      .attr('x', this.getCardX.bind(this))\n      .attr('width', this.getCardWidth.bind(this))\n      .attr('y', this.getCardY.bind(this))\n      .attr('height', this.getCardHeight.bind(this))\n      .attr('rx', this.cardRound)\n      .attr('ry', this.cardRound)\n      .attr('class', 'bordered heatmap-card')\n      .style('fill', this.getCardColor.bind(this))\n      .style('stroke', this.getCardColor.bind(this))\n      .style('stroke-width', 0)\n      .style('opacity', this.getCardOpacity.bind(this));\n\n    const $cards = this.$heatmap.find('.heatmap-card');\n    $cards\n      .on('mouseenter', event => {\n        this.tooltip.mouseOverBucket = true;\n        this.highlightCard(event);\n      })\n      .on('mouseleave', event => {\n        this.tooltip.mouseOverBucket = false;\n        this.resetCardHighLight(event);\n      });\n  }\n\n  highlightCard(event) {\n    const color = d3.select(event.target).style('fill');\n    const highlightColor = d3.color(color).darker(2);\n    const strokeColor = d3.color(color).brighter(4);\n    const currentCard = d3.select(event.target);\n    this.tooltip.originalFillColor = color;\n    currentCard\n      .style('fill', highlightColor.toString())\n      .style('stroke', strokeColor.toString())\n      .style('stroke-width', 1);\n  }\n\n  resetCardHighLight(event) {\n    d3\n      .select(event.target)\n      .style('fill', this.tooltip.originalFillColor)\n      .style('stroke', this.tooltip.originalFillColor)\n      .style('stroke-width', 0);\n  }\n\n  setCardSize() {\n    const xGridSize = Math.floor(this.xScale(this.data.xBucketSize) - this.xScale(0));\n    let yGridSize = Math.floor(this.yScale(this.yScale.invert(0) - this.data.yBucketSize));\n\n    if (this.panel.yAxis.logBase !== 1) {\n      const base = this.panel.yAxis.logBase;\n      const splitFactor = this.data.yBucketSize || 1;\n      yGridSize = Math.floor((this.yScale(1) - this.yScale(base)) / splitFactor);\n    }\n\n    this.cardWidth = xGridSize - this.cardPadding * 2;\n    this.cardHeight = yGridSize ? yGridSize - this.cardPadding * 2 : 0;\n  }\n\n  getCardX(d) {\n    let x;\n    if (this.xScale(d.x) < 0) {\n      // Cut card left to prevent overlay\n      x = this.yAxisWidth + this.cardPadding;\n    } else {\n      x = this.xScale(d.x) + this.yAxisWidth + this.cardPadding;\n    }\n\n    return x;\n  }\n\n  getCardWidth(d) {\n    let w;\n    if (this.xScale(d.x) < 0) {\n      // Cut card left to prevent overlay\n      const cuttedWidth = this.xScale(d.x) + this.cardWidth;\n      w = cuttedWidth > 0 ? cuttedWidth : 0;\n    } else if (this.xScale(d.x) + this.cardWidth > this.chartWidth) {\n      // Cut card right to prevent overlay\n      w = this.chartWidth - this.xScale(d.x) - this.cardPadding;\n    } else {\n      w = this.cardWidth;\n    }\n\n    // Card width should be MIN_CARD_SIZE at least\n    w = Math.max(w, MIN_CARD_SIZE);\n    return w;\n  }\n\n  getCardY(d) {\n    let y = this.yScale(d.y) + this.chartTop - this.cardHeight - this.cardPadding;\n    if (this.panel.yAxis.logBase !== 1 && d.y === 0) {\n      y = this.chartBottom - this.cardHeight - this.cardPadding;\n    } else {\n      if (y < this.chartTop) {\n        y = this.chartTop;\n      }\n    }\n\n    return y;\n  }\n\n  getCardHeight(d) {\n    const y = this.yScale(d.y) + this.chartTop - this.cardHeight - this.cardPadding;\n    let h = this.cardHeight;\n\n    if (this.panel.yAxis.logBase !== 1 && d.y === 0) {\n      return this.cardHeight;\n    }\n\n    // Cut card height to prevent overlay\n    if (y < this.chartTop) {\n      h = this.yScale(d.y) - this.cardPadding;\n    } else if (this.yScale(d.y) > this.chartBottom) {\n      h = this.chartBottom - y;\n    } else if (y + this.cardHeight > this.chartBottom) {\n      h = this.chartBottom - y;\n    }\n\n    // Height can't be more than chart height\n    h = Math.min(h, this.chartHeight);\n    // Card height should be MIN_CARD_SIZE at least\n    h = Math.max(h, MIN_CARD_SIZE);\n\n    return h;\n  }\n\n  getCardColor(d) {\n    if (this.panel.color.mode === 'opacity') {\n      return this.panel.color.cardColor;\n    } else {\n      return this.colorScale(d.count);\n    }\n  }\n\n  getCardOpacity(d) {\n    if (this.panel.color.mode === 'opacity') {\n      return this.opacityScale(d.count);\n    } else {\n      return 1;\n    }\n  }\n\n  getEventOffset(event) {\n    const elemOffset = this.$heatmap.offset();\n    const x = Math.floor(event.clientX - elemOffset.left);\n    const y = Math.floor(event.clientY - elemOffset.top);\n    return { x, y };\n  }\n\n  onMouseDown(event) {\n    const offset = this.getEventOffset(event);\n    this.selection.active = true;\n    this.selection.x1 = offset.x;\n\n    this.mouseUpHandler = () => {\n      this.onMouseUp();\n    };\n\n    $(document).one('mouseup', this.mouseUpHandler.bind(this));\n  }\n\n  onMouseUp() {\n    $(document).unbind('mouseup', this.mouseUpHandler.bind(this));\n    this.mouseUpHandler = null;\n    this.selection.active = false;\n\n    const selectionRange = Math.abs(this.selection.x2 - this.selection.x1);\n    if (this.selection.x2 >= 0 && selectionRange > MIN_SELECTION_WIDTH) {\n      const timeFrom = this.xScale.invert(Math.min(this.selection.x1, this.selection.x2) - this.yAxisWidth);\n      const timeTo = this.xScale.invert(Math.max(this.selection.x1, this.selection.x2) - this.yAxisWidth);\n\n      this.ctrl.timeSrv.setTime({\n        from: moment.utc(timeFrom),\n        to: moment.utc(timeTo),\n      });\n    }\n\n    this.clearSelection();\n  }\n\n  onMouseLeave() {\n    appEvents.emit('graph-hover-clear');\n    this.clearCrosshair();\n  }\n\n  onMouseMove(event) {\n    if (!this.heatmap) {\n      return;\n    }\n\n    const offset = this.getEventOffset(event);\n    if (this.selection.active) {\n      // Clear crosshair and tooltip\n      this.clearCrosshair();\n      this.tooltip.destroy();\n\n      this.selection.x2 = this.limitSelection(offset.x);\n      this.drawSelection(this.selection.x1, this.selection.x2);\n    } else {\n      const pos = this.getEventPos(event, offset);\n      this.drawCrosshair(offset.x);\n      this.tooltip.show(pos, this.data);\n      this.emitGraphHoverEvent(pos);\n    }\n  }\n\n  getEventPos(event, offset) {\n    const x = this.xScale.invert(offset.x - this.yAxisWidth).valueOf();\n    const y = this.yScale.invert(offset.y - this.chartTop);\n    const pos = {\n      pageX: event.pageX,\n      pageY: event.pageY,\n      x: x,\n      x1: x,\n      y: y,\n      y1: y,\n      panelRelY: null,\n      offset,\n    };\n\n    return pos;\n  }\n\n  emitGraphHoverEvent(pos) {\n    // Set minimum offset to prevent showing legend from another panel\n    pos.panelRelY = Math.max(pos.offset.y / this.height, 0.001);\n    // broadcast to other graph panels that we are hovering\n    appEvents.emit('graph-hover', { pos: pos, panel: this.panel });\n  }\n\n  limitSelection(x2) {\n    x2 = Math.max(x2, this.yAxisWidth);\n    x2 = Math.min(x2, this.chartWidth + this.yAxisWidth);\n    return x2;\n  }\n\n  drawSelection(posX1, posX2) {\n    if (this.heatmap) {\n      this.heatmap.selectAll('.heatmap-selection').remove();\n      const selectionX = Math.min(posX1, posX2);\n      const selectionWidth = Math.abs(posX1 - posX2);\n\n      if (selectionWidth > MIN_SELECTION_WIDTH) {\n        this.heatmap\n          .append('rect')\n          .attr('class', 'heatmap-selection')\n          .attr('x', selectionX)\n          .attr('width', selectionWidth)\n          .attr('y', this.chartTop)\n          .attr('height', this.chartHeight);\n      }\n    }\n  }\n\n  clearSelection() {\n    this.selection.x1 = -1;\n    this.selection.x2 = -1;\n\n    if (this.heatmap) {\n      this.heatmap.selectAll('.heatmap-selection').remove();\n    }\n  }\n\n  drawCrosshair(position) {\n    if (this.heatmap) {\n      this.heatmap.selectAll('.heatmap-crosshair').remove();\n\n      let posX = position;\n      posX = Math.max(posX, this.yAxisWidth);\n      posX = Math.min(posX, this.chartWidth + this.yAxisWidth);\n\n      this.heatmap\n        .append('g')\n        .attr('class', 'heatmap-crosshair')\n        .attr('transform', 'translate(' + posX + ',0)')\n        .append('line')\n        .attr('x1', 1)\n        .attr('y1', this.chartTop)\n        .attr('x2', 1)\n        .attr('y2', this.chartBottom)\n        .attr('stroke-width', 1);\n    }\n  }\n\n  drawSharedCrosshair(pos) {\n    if (this.heatmap && this.ctrl.dashboard.graphTooltip !== 0) {\n      const posX = this.xScale(pos.x) + this.yAxisWidth;\n      this.drawCrosshair(posX);\n    }\n  }\n\n  clearCrosshair() {\n    if (this.heatmap) {\n      this.heatmap.selectAll('.heatmap-crosshair').remove();\n    }\n  }\n\n  render() {\n    this.data = this.ctrl.data;\n    this.panel = this.ctrl.panel;\n    this.timeRange = this.ctrl.range;\n\n    if (!this.setElementHeight() || !this.data) {\n      return;\n    }\n\n    // Draw default axes and return if no data\n    if (_.isEmpty(this.data.buckets)) {\n      this.addHeatmapCanvas();\n      this.addAxes();\n      return;\n    }\n\n    this.addHeatmap();\n    this.scope.yAxisWidth = this.yAxisWidth;\n    this.scope.xAxisHeight = this.xAxisHeight;\n    this.scope.chartHeight = this.chartHeight;\n    this.scope.chartWidth = this.chartWidth;\n    this.scope.chartTop = this.chartTop;\n  }\n}\n","import { MetricsPanelCtrl } from 'app/plugins/sdk';\nimport _ from 'lodash';\nimport kbn from 'app/core/utils/kbn';\nimport TimeSeries from 'app/core/time_series2';\nimport { axesEditor } from './axes_editor';\nimport { heatmapDisplayEditor } from './display_editor';\nimport rendering from './rendering';\nimport {\n  convertToHeatMap,\n  convertToCards,\n  histogramToHeatmap,\n  calculateBucketSize,\n  sortSeriesByLabel,\n} from './heatmap_data_converter';\n\nconst X_BUCKET_NUMBER_DEFAULT = 30;\nconst Y_BUCKET_NUMBER_DEFAULT = 10;\n\nconst panelDefaults = {\n  heatmap: {},\n  cards: {\n    cardPadding: null,\n    cardRound: null,\n  },\n  color: {\n    mode: 'spectrum',\n    cardColor: '#b4ff00',\n    colorScale: 'sqrt',\n    exponent: 0.5,\n    colorScheme: 'interpolateOranges',\n  },\n  legend: {\n    show: false,\n  },\n  dataFormat: 'timeseries',\n  yBucketBound: 'auto',\n  xAxis: {\n    show: true,\n  },\n  yAxis: {\n    show: true,\n    format: 'short',\n    decimals: null,\n    logBase: 1,\n    splitFactor: null,\n    min: null,\n    max: null,\n  },\n  xBucketSize: null,\n  xBucketNumber: null,\n  yBucketSize: null,\n  yBucketNumber: null,\n  tooltip: {\n    show: true,\n    showHistogram: false,\n  },\n  highlightCards: true,\n};\n\nconst colorModes = ['opacity', 'spectrum'];\nconst opacityScales = ['linear', 'sqrt'];\n\n// Schemes from d3-scale-chromatic\n// https://github.com/d3/d3-scale-chromatic\nconst colorSchemes = [\n  // Diverging\n  { name: 'Spectral', value: 'interpolateSpectral', invert: 'always' },\n  { name: 'RdYlGn', value: 'interpolateRdYlGn', invert: 'always' },\n\n  // Sequential (Single Hue)\n  { name: 'Blues', value: 'interpolateBlues', invert: 'dark' },\n  { name: 'Greens', value: 'interpolateGreens', invert: 'dark' },\n  { name: 'Greys', value: 'interpolateGreys', invert: 'dark' },\n  { name: 'Oranges', value: 'interpolateOranges', invert: 'dark' },\n  { name: 'Purples', value: 'interpolatePurples', invert: 'dark' },\n  { name: 'Reds', value: 'interpolateReds', invert: 'dark' },\n\n  // Sequential (Multi-Hue)\n  { name: 'Viridis', value: 'interpolateViridis', invert: 'light' },\n  { name: 'Magma', value: 'interpolateMagma', invert: 'light' },\n  { name: 'Inferno', value: 'interpolateInferno', invert: 'light' },\n  { name: 'Plasma', value: 'interpolatePlasma', invert: 'light' },\n  { name: 'Warm', value: 'interpolateWarm', invert: 'light' },\n  { name: 'Cool', value: 'interpolateCool', invert: 'light' },\n  { name: 'Cubehelix', value: 'interpolateCubehelixDefault', invert: 'light' },\n  { name: 'BuGn', value: 'interpolateBuGn', invert: 'dark' },\n  { name: 'BuPu', value: 'interpolateBuPu', invert: 'dark' },\n  { name: 'GnBu', value: 'interpolateGnBu', invert: 'dark' },\n  { name: 'OrRd', value: 'interpolateOrRd', invert: 'dark' },\n  { name: 'PuBuGn', value: 'interpolatePuBuGn', invert: 'dark' },\n  { name: 'PuBu', value: 'interpolatePuBu', invert: 'dark' },\n  { name: 'PuRd', value: 'interpolatePuRd', invert: 'dark' },\n  { name: 'RdPu', value: 'interpolateRdPu', invert: 'dark' },\n  { name: 'YlGnBu', value: 'interpolateYlGnBu', invert: 'dark' },\n  { name: 'YlGn', value: 'interpolateYlGn', invert: 'dark' },\n  { name: 'YlOrBr', value: 'interpolateYlOrBr', invert: 'dark' },\n  { name: 'YlOrRd', value: 'interpolateYlOrRd', invert: 'dark' },\n];\n\nconst dsSupportHistogramSort = ['prometheus', 'elasticsearch'];\n\nexport class HeatmapCtrl extends MetricsPanelCtrl {\n  static templateUrl = 'module.html';\n\n  opacityScales: any = [];\n  colorModes: any = [];\n  colorSchemes: any = [];\n  selectionActivated: boolean;\n  unitFormats: any;\n  data: any;\n  series: any;\n  timeSrv: any;\n  dataWarning: any;\n  decimals: number;\n  scaledDecimals: number;\n\n  /** @ngInject */\n  constructor($scope, $injector, timeSrv) {\n    super($scope, $injector);\n    this.timeSrv = timeSrv;\n    this.selectionActivated = false;\n\n    _.defaultsDeep(this.panel, panelDefaults);\n    this.opacityScales = opacityScales;\n    this.colorModes = colorModes;\n    this.colorSchemes = colorSchemes;\n\n    // Bind grafana panel events\n    this.events.on('render', this.onRender.bind(this));\n    this.events.on('data-received', this.onDataReceived.bind(this));\n    this.events.on('data-error', this.onDataError.bind(this));\n    this.events.on('data-snapshot-load', this.onDataReceived.bind(this));\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n\n    this.onCardColorChange = this.onCardColorChange.bind(this);\n  }\n\n  onInitEditMode() {\n    this.addEditorTab('Axes', axesEditor, 2);\n    this.addEditorTab('Display', heatmapDisplayEditor, 3);\n    this.unitFormats = kbn.getUnitFormats();\n  }\n\n  zoomOut(evt) {\n    this.publishAppEvent('zoom-out', 2);\n  }\n\n  onRender() {\n    if (!this.range) {\n      return;\n    }\n\n    if (this.panel.dataFormat === 'tsbuckets') {\n      this.convertHistogramToHeatmapData();\n    } else {\n      this.convertTimeSeriesToHeatmapData();\n    }\n  }\n\n  convertTimeSeriesToHeatmapData() {\n    let xBucketSize, yBucketSize, bucketsData, heatmapStats;\n    const logBase = this.panel.yAxis.logBase;\n\n    const xBucketNumber = this.panel.xBucketNumber || X_BUCKET_NUMBER_DEFAULT;\n    const xBucketSizeByNumber = Math.floor((this.range.to - this.range.from) / xBucketNumber);\n\n    // Parse X bucket size (number or interval)\n    const isIntervalString = kbn.interval_regex.test(this.panel.xBucketSize);\n    if (isIntervalString) {\n      xBucketSize = kbn.interval_to_ms(this.panel.xBucketSize);\n    } else if (\n      isNaN(Number(this.panel.xBucketSize)) ||\n      this.panel.xBucketSize === '' ||\n      this.panel.xBucketSize === null\n    ) {\n      xBucketSize = xBucketSizeByNumber;\n    } else {\n      xBucketSize = Number(this.panel.xBucketSize);\n    }\n\n    // Calculate Y bucket size\n    heatmapStats = this.parseSeries(this.series);\n    const yBucketNumber = this.panel.yBucketNumber || Y_BUCKET_NUMBER_DEFAULT;\n    if (logBase !== 1) {\n      yBucketSize = this.panel.yAxis.splitFactor;\n    } else {\n      if (heatmapStats.max === heatmapStats.min) {\n        if (heatmapStats.max) {\n          yBucketSize = heatmapStats.max / Y_BUCKET_NUMBER_DEFAULT;\n        } else {\n          yBucketSize = 1;\n        }\n      } else {\n        yBucketSize = (heatmapStats.max - heatmapStats.min) / yBucketNumber;\n      }\n      yBucketSize = this.panel.yBucketSize || yBucketSize;\n    }\n\n    bucketsData = convertToHeatMap(this.series, yBucketSize, xBucketSize, logBase);\n\n    // Set default Y range if no data\n    if (!heatmapStats.min && !heatmapStats.max) {\n      heatmapStats = { min: -1, max: 1, minLog: 1 };\n      yBucketSize = 1;\n    }\n\n    const { cards, cardStats } = convertToCards(bucketsData);\n\n    this.data = {\n      buckets: bucketsData,\n      heatmapStats: heatmapStats,\n      xBucketSize: xBucketSize,\n      yBucketSize: yBucketSize,\n      cards: cards,\n      cardStats: cardStats,\n    };\n  }\n\n  convertHistogramToHeatmapData() {\n    const panelDatasource = this.getPanelDataSourceType();\n    let xBucketSize, yBucketSize, bucketsData, tsBuckets;\n\n    // Try to sort series by bucket bound, if datasource doesn't do it.\n    if (!_.includes(dsSupportHistogramSort, panelDatasource)) {\n      this.series.sort(sortSeriesByLabel);\n    }\n\n    // Convert histogram to heatmap. Each histogram bucket represented by the series which name is\n    // a top (or bottom, depends of datasource) bucket bound. Further, these values will be used as X axis labels.\n    bucketsData = histogramToHeatmap(this.series);\n\n    tsBuckets = _.map(this.series, 'label');\n    const yBucketBound = this.panel.yBucketBound;\n    if ((panelDatasource === 'prometheus' && yBucketBound !== 'lower') || yBucketBound === 'upper') {\n      // Prometheus labels are upper inclusive bounds, so add empty bottom bucket label.\n      tsBuckets = [''].concat(tsBuckets);\n    } else {\n      // Elasticsearch uses labels as lower bucket bounds, so add empty top bucket label.\n      // Use this as a default mode as well.\n      tsBuckets.push('');\n    }\n\n    // Calculate bucket size based on heatmap data\n    const xBucketBoundSet = _.map(_.keys(bucketsData), key => Number(key));\n    xBucketSize = calculateBucketSize(xBucketBoundSet);\n    // Always let yBucketSize=1 in 'tsbuckets' mode\n    yBucketSize = 1;\n\n    const { cards, cardStats } = convertToCards(bucketsData);\n\n    this.data = {\n      buckets: bucketsData,\n      xBucketSize: xBucketSize,\n      yBucketSize: yBucketSize,\n      tsBuckets: tsBuckets,\n      cards: cards,\n      cardStats: cardStats,\n    };\n  }\n\n  getPanelDataSourceType() {\n    if (this.datasource.meta && this.datasource.meta.id) {\n      return this.datasource.meta.id;\n    } else {\n      return 'unknown';\n    }\n  }\n\n  onDataReceived(dataList) {\n    this.series = dataList.map(this.seriesHandler.bind(this));\n\n    this.dataWarning = null;\n    const datapointsCount = _.reduce(\n      this.series,\n      (sum, series) => {\n        return sum + series.datapoints.length;\n      },\n      0\n    );\n\n    if (datapointsCount === 0) {\n      this.dataWarning = {\n        title: 'No data points',\n        tip: 'No datapoints returned from data query',\n      };\n    } else {\n      for (const series of this.series) {\n        if (series.isOutsideRange) {\n          this.dataWarning = {\n            title: 'Data points outside time range',\n            tip: 'Can be caused by timezone mismatch or missing time filter in query',\n          };\n          break;\n        }\n      }\n    }\n\n    this.render();\n  }\n\n  onDataError() {\n    this.series = [];\n    this.render();\n  }\n\n  onCardColorChange(newColor) {\n    this.panel.color.cardColor = newColor;\n    this.render();\n  }\n\n  seriesHandler(seriesData) {\n    if (seriesData.datapoints === undefined) {\n      throw new Error('Heatmap error: data should be a time series');\n    }\n\n    const series = new TimeSeries({\n      datapoints: seriesData.datapoints,\n      alias: seriesData.target,\n    });\n\n    series.flotpairs = series.getFlotPairs(this.panel.nullPointMode);\n\n    const datapoints = seriesData.datapoints || [];\n    if (datapoints && datapoints.length > 0) {\n      const last = datapoints[datapoints.length - 1][1];\n      const from = this.range.from;\n      if (last - from < -10000) {\n        series.isOutsideRange = true;\n      }\n    }\n\n    return series;\n  }\n\n  parseSeries(series) {\n    const min = _.min(_.map(series, s => s.stats.min));\n    const minLog = _.min(_.map(series, s => s.stats.logmin));\n    const max = _.max(_.map(series, s => s.stats.max));\n\n    return {\n      max: max,\n      min: min,\n      minLog: minLog,\n    };\n  }\n\n  parseHistogramSeries(series) {\n    const bounds = _.map(series, s => Number(s.alias));\n    const min = _.min(bounds);\n    const minLog = _.min(bounds);\n    const max = _.max(bounds);\n\n    return {\n      max: max,\n      min: min,\n      minLog: minLog,\n    };\n  }\n\n  link(scope, elem, attrs, ctrl) {\n    rendering(scope, elem, attrs, ctrl);\n  }\n}\n","import './color_legend';\nimport { HeatmapCtrl } from './heatmap_ctrl';\n\nexport { HeatmapCtrl as PanelCtrl };\n","import _ from 'lodash';\nimport flatten from '../../../core/utils/flatten';\nimport TimeSeries from '../../../core/time_series2';\nimport TableModel from '../../../core/table_model';\n\nconst transformers = {};\n\ntransformers['timeseries_to_rows'] = {\n  description: 'Time series to rows',\n  getColumns: () => {\n    return [];\n  },\n  transform: (data, panel, model) => {\n    model.columns = [{ text: 'Time', type: 'date' }, { text: 'Metric' }, { text: 'Value' }];\n\n    for (let i = 0; i < data.length; i++) {\n      const series = data[i];\n      for (let y = 0; y < series.datapoints.length; y++) {\n        const dp = series.datapoints[y];\n        model.rows.push([dp[1], series.target, dp[0]]);\n      }\n    }\n  },\n};\n\ntransformers['timeseries_to_columns'] = {\n  description: 'Time series to columns',\n  getColumns: () => {\n    return [];\n  },\n  transform: (data, panel, model) => {\n    model.columns.push({ text: 'Time', type: 'date' });\n\n    // group by time\n    const points = {};\n\n    for (let i = 0; i < data.length; i++) {\n      const series = data[i];\n      model.columns.push({ text: series.target });\n\n      for (let y = 0; y < series.datapoints.length; y++) {\n        const dp = series.datapoints[y];\n        const timeKey = dp[1].toString();\n\n        if (!points[timeKey]) {\n          points[timeKey] = { time: dp[1] };\n          points[timeKey][i] = dp[0];\n        } else {\n          points[timeKey][i] = dp[0];\n        }\n      }\n    }\n\n    for (const time in points) {\n      const point = points[time];\n      const values = [point.time];\n\n      for (let i = 0; i < data.length; i++) {\n        const value = point[i];\n        values.push(value);\n      }\n\n      model.rows.push(values);\n    }\n  },\n};\n\ntransformers['timeseries_aggregations'] = {\n  description: 'Time series aggregations',\n  getColumns: () => {\n    return [\n      { text: 'Avg', value: 'avg' },\n      { text: 'Min', value: 'min' },\n      { text: 'Max', value: 'max' },\n      { text: 'Total', value: 'total' },\n      { text: 'Current', value: 'current' },\n      { text: 'Count', value: 'count' },\n    ];\n  },\n  transform: (data, panel, model) => {\n    let i, y;\n    model.columns.push({ text: 'Metric' });\n\n    for (i = 0; i < panel.columns.length; i++) {\n      model.columns.push({ text: panel.columns[i].text });\n    }\n\n    for (i = 0; i < data.length; i++) {\n      const series = new TimeSeries({\n        datapoints: data[i].datapoints,\n        alias: data[i].target,\n      });\n\n      series.getFlotPairs('connected');\n      const cells = [series.alias];\n\n      for (y = 0; y < panel.columns.length; y++) {\n        cells.push(series.stats[panel.columns[y].value]);\n      }\n\n      model.rows.push(cells);\n    }\n  },\n};\n\ntransformers['annotations'] = {\n  description: 'Annotations',\n  getColumns: () => {\n    return [];\n  },\n  transform: (data, panel, model) => {\n    model.columns.push({ text: 'Time', type: 'date' });\n    model.columns.push({ text: 'Title' });\n    model.columns.push({ text: 'Text' });\n    model.columns.push({ text: 'Tags' });\n\n    if (!data || !data.annotations || data.annotations.length === 0) {\n      return;\n    }\n\n    for (let i = 0; i < data.annotations.length; i++) {\n      const evt = data.annotations[i];\n      model.rows.push([evt.time, evt.title, evt.text, evt.tags]);\n    }\n  },\n};\n\ntransformers['table'] = {\n  description: 'Table',\n  getColumns: data => {\n    if (!data || data.length === 0) {\n      return [];\n    }\n\n    // Single query returns data columns as is\n    if (data.length === 1) {\n      return [...data[0].columns];\n    }\n\n    // Track column indexes: name -> index\n    const columnNames = {};\n\n    // Union of all columns\n    const columns = data.reduce((acc, series) => {\n      series.columns.forEach(col => {\n        const { text } = col;\n        if (columnNames[text] === undefined) {\n          columnNames[text] = acc.length;\n          acc.push(col);\n        }\n      });\n      return acc;\n    }, []);\n\n    return columns;\n  },\n  transform: (data, panel, model) => {\n    if (!data || data.length === 0) {\n      return;\n    }\n\n    const noTableIndex = _.findIndex(data, d => d.type !== 'table');\n    if (noTableIndex > -1) {\n      throw {\n        message: `Result of query #${String.fromCharCode(\n          65 + noTableIndex\n        )} is not in table format, try using another transform.`,\n      };\n    }\n\n    // Single query returns data columns and rows as is\n    if (data.length === 1) {\n      model.columns = [...data[0].columns];\n      model.rows = [...data[0].rows];\n      return;\n    }\n\n    // Track column indexes of union: name -> index\n    const columnNames = {};\n\n    // Union of all non-value columns\n    const columnsUnion = data.reduce((acc, series) => {\n      series.columns.forEach(col => {\n        const { text } = col;\n        if (columnNames[text] === undefined) {\n          columnNames[text] = acc.length;\n          acc.push(col);\n        }\n      });\n      return acc;\n    }, []);\n\n    // Map old column index to union index per series, e.g.,\n    // given columnNames {A: 0, B: 1} and\n    // data [{columns: [{ text: 'A' }]}, {columns: [{ text: 'B' }]}] => [[0], [1]]\n    const columnIndexMapper = data.map(series => series.columns.map(col => columnNames[col.text]));\n\n    // Flatten rows of all series and adjust new column indexes\n    const flattenedRows = data.reduce((acc, series, seriesIndex) => {\n      const mapper = columnIndexMapper[seriesIndex];\n      series.rows.forEach(row => {\n        const alteredRow = [];\n        // Shifting entries according to index mapper\n        mapper.forEach((to, from) => {\n          alteredRow[to] = row[from];\n        });\n        acc.push(alteredRow);\n      });\n      return acc;\n    }, []);\n\n    // Returns true if both rows have matching non-empty fields as well as matching\n    // indexes where one field is empty and the other is not\n    function areRowsMatching(columns, row, otherRow) {\n      let foundFieldToMatch = false;\n      for (let columnIndex = 0; columnIndex < columns.length; columnIndex++) {\n        if (row[columnIndex] !== undefined && otherRow[columnIndex] !== undefined) {\n          if (row[columnIndex] !== otherRow[columnIndex]) {\n            return false;\n          }\n        } else if (row[columnIndex] === undefined || otherRow[columnIndex] === undefined) {\n          foundFieldToMatch = true;\n        }\n      }\n      return foundFieldToMatch;\n    }\n\n    // Merge rows that have same values for columns\n    const mergedRows = {};\n    const compactedRows = flattenedRows.reduce((acc, row, rowIndex) => {\n      if (!mergedRows[rowIndex]) {\n        // Look from current row onwards\n        let offset = rowIndex + 1;\n        // More than one row can be merged into current row\n        while (offset < flattenedRows.length) {\n          // Find next row that could be merged\n          const match = _.findIndex(flattenedRows, otherRow => areRowsMatching(columnsUnion, row, otherRow), offset);\n          if (match > -1) {\n            const matchedRow = flattenedRows[match];\n            // Merge values from match into current row if there is a gap in the current row\n            for (let columnIndex = 0; columnIndex < columnsUnion.length; columnIndex++) {\n              if (row[columnIndex] === undefined && matchedRow[columnIndex] !== undefined) {\n                row[columnIndex] = matchedRow[columnIndex];\n              }\n            }\n            // Don't visit this row again\n            mergedRows[match] = matchedRow;\n            // Keep looking for more rows to merge\n            offset = match + 1;\n          } else {\n            // No match found, stop looking\n            break;\n          }\n        }\n        acc.push(row);\n      }\n      return acc;\n    }, []);\n\n    model.columns = columnsUnion;\n    model.rows = compactedRows;\n  },\n};\n\ntransformers['json'] = {\n  description: 'JSON Data',\n  getColumns: data => {\n    if (!data || data.length === 0) {\n      return [];\n    }\n\n    const names: any = {};\n    for (let i = 0; i < data.length; i++) {\n      const series = data[i];\n      if (series.type !== 'docs') {\n        continue;\n      }\n\n      // only look at 100 docs\n      const maxDocs = Math.min(series.datapoints.length, 100);\n      for (let y = 0; y < maxDocs; y++) {\n        const doc = series.datapoints[y];\n        const flattened = flatten(doc, null);\n        for (const propName in flattened) {\n          names[propName] = true;\n        }\n      }\n    }\n\n    return _.map(names, (value, key) => {\n      return { text: key, value: key };\n    });\n  },\n  transform: (data, panel, model) => {\n    let i, y, z;\n\n    for (const column of panel.columns) {\n      const tableCol: any = { text: column.text };\n\n      // if filterable data then set columns to filterable\n      if (data.length > 0 && data[0].filterable) {\n        tableCol.filterable = true;\n      }\n\n      model.columns.push(tableCol);\n    }\n\n    if (model.columns.length === 0) {\n      model.columns.push({ text: 'JSON' });\n    }\n\n    for (i = 0; i < data.length; i++) {\n      const series = data[i];\n\n      for (y = 0; y < series.datapoints.length; y++) {\n        const dp = series.datapoints[y];\n        const values = [];\n\n        if (_.isObject(dp) && panel.columns.length > 0) {\n          const flattened = flatten(dp, null);\n          for (z = 0; z < panel.columns.length; z++) {\n            values.push(flattened[panel.columns[z].value]);\n          }\n        } else {\n          values.push(JSON.stringify(dp));\n        }\n\n        model.rows.push(values);\n      }\n    }\n  },\n};\n\nfunction transformDataToTable(data, panel) {\n  const model = new TableModel();\n\n  if (!data || data.length === 0) {\n    return model;\n  }\n\n  const transformer = transformers[panel.transform];\n  if (!transformer) {\n    throw { message: 'Transformer ' + panel.transform + ' not found' };\n  }\n\n  transformer.transform(data, panel, model);\n  return model;\n}\n\nexport { transformers, transformDataToTable };\n","import _ from 'lodash';\nimport { transformers } from './transformers';\n\nexport class TablePanelEditorCtrl {\n  panel: any;\n  panelCtrl: any;\n  transformers: any;\n  fontSizes: any;\n  addColumnSegment: any;\n  getColumnNames: any;\n  canSetColumns: boolean;\n  columnsHelpMessage: string;\n\n  /** @ngInject */\n  constructor($scope, private $q, private uiSegmentSrv) {\n    $scope.editor = this;\n    this.panelCtrl = $scope.ctrl;\n    this.panel = this.panelCtrl.panel;\n    this.transformers = transformers;\n    this.fontSizes = ['80%', '90%', '100%', '110%', '120%', '130%', '150%', '160%', '180%', '200%', '220%', '250%'];\n    this.addColumnSegment = uiSegmentSrv.newPlusButton();\n    this.updateTransformHints();\n  }\n\n  updateTransformHints() {\n    this.canSetColumns = false;\n    this.columnsHelpMessage = '';\n\n    switch (this.panel.transform) {\n      case 'timeseries_aggregations': {\n        this.canSetColumns = true;\n        break;\n      }\n      case 'json': {\n        this.canSetColumns = true;\n        break;\n      }\n      case 'table': {\n        this.columnsHelpMessage = 'Columns and their order are determined by the data query';\n      }\n    }\n  }\n\n  getColumnOptions() {\n    if (!this.panelCtrl.dataRaw) {\n      return this.$q.when([]);\n    }\n    const columns = this.transformers[this.panel.transform].getColumns(this.panelCtrl.dataRaw);\n    const segments = _.map(columns, (c: any) => this.uiSegmentSrv.newSegment({ value: c.text }));\n    return this.$q.when(segments);\n  }\n\n  addColumn() {\n    const columns = transformers[this.panel.transform].getColumns(this.panelCtrl.dataRaw);\n    const column = _.find(columns, { text: this.addColumnSegment.value });\n\n    if (column) {\n      this.panel.columns.push(column);\n      this.render();\n    }\n\n    const plusButton = this.uiSegmentSrv.newPlusButton();\n    this.addColumnSegment.html = plusButton.html;\n    this.addColumnSegment.value = plusButton.value;\n  }\n\n  transformChanged() {\n    this.panel.columns = [];\n    if (this.panel.transform === 'timeseries_aggregations') {\n      this.panel.columns.push({ text: 'Avg', value: 'avg' });\n    }\n\n    this.updateTransformHints();\n    this.render();\n  }\n\n  render() {\n    this.panelCtrl.render();\n  }\n\n  removeColumn(column) {\n    this.panel.columns = _.without(this.panel.columns, column);\n    this.panelCtrl.render();\n  }\n}\n\n/** @ngInject */\nexport function tablePanelEditor($q, uiSegmentSrv) {\n  'use strict';\n  return {\n    restrict: 'E',\n    scope: true,\n    templateUrl: 'public/app/plugins/panel/table/editor.html',\n    controller: TablePanelEditorCtrl,\n  };\n}\n","import _ from 'lodash';\nimport kbn from 'app/core/utils/kbn';\n\nexport class ColumnOptionsCtrl {\n  panel: any;\n  panelCtrl: any;\n  colorModes: any;\n  columnStyles: any;\n  columnTypes: any;\n  fontSizes: any;\n  dateFormats: any;\n  addColumnSegment: any;\n  unitFormats: any;\n  getColumnNames: any;\n  activeStyleIndex: number;\n  mappingTypes: any;\n\n  /** @ngInject */\n  constructor($scope) {\n    $scope.editor = this;\n\n    this.activeStyleIndex = 0;\n    this.panelCtrl = $scope.ctrl;\n    this.panel = this.panelCtrl.panel;\n    this.unitFormats = kbn.getUnitFormats();\n    this.colorModes = [\n      { text: 'Disabled', value: null },\n      { text: 'Cell', value: 'cell' },\n      { text: 'Value', value: 'value' },\n      { text: 'Row', value: 'row' },\n    ];\n    this.columnTypes = [\n      { text: 'Number', value: 'number' },\n      { text: 'String', value: 'string' },\n      { text: 'Date', value: 'date' },\n      { text: 'Hidden', value: 'hidden' },\n    ];\n    this.fontSizes = ['80%', '90%', '100%', '110%', '120%', '130%', '150%', '160%', '180%', '200%', '220%', '250%'];\n    this.dateFormats = [\n      { text: 'YYYY-MM-DD HH:mm:ss', value: 'YYYY-MM-DD HH:mm:ss' },\n      { text: 'YYYY-MM-DD HH:mm:ss.SSS', value: 'YYYY-MM-DD HH:mm:ss.SSS' },\n      { text: 'MM/DD/YY h:mm:ss a', value: 'MM/DD/YY h:mm:ss a' },\n      { text: 'MMMM D, YYYY LT', value: 'MMMM D, YYYY LT' },\n    ];\n    this.mappingTypes = [{ text: 'Value to text', value: 1 }, { text: 'Range to text', value: 2 }];\n\n    this.getColumnNames = () => {\n      if (!this.panelCtrl.table) {\n        return [];\n      }\n      return _.map(this.panelCtrl.table.columns, (col: any) => {\n        return col.text;\n      });\n    };\n\n    this.onColorChange = this.onColorChange.bind(this);\n  }\n\n  render() {\n    this.panelCtrl.render();\n  }\n\n  setUnitFormat(column, subItem) {\n    column.unit = subItem.value;\n    this.panelCtrl.render();\n  }\n\n  addColumnStyle() {\n    const newStyleRule = {\n      unit: 'short',\n      type: 'number',\n      alias: '',\n      decimals: 2,\n      colors: ['rgba(245, 54, 54, 0.9)', 'rgba(237, 129, 40, 0.89)', 'rgba(50, 172, 45, 0.97)'],\n      colorMode: null,\n      pattern: '',\n      dateFormat: 'YYYY-MM-DD HH:mm:ss',\n      thresholds: [],\n      mappingType: 1,\n    };\n\n    const styles = this.panel.styles;\n    const stylesCount = styles.length;\n    let indexToInsert = stylesCount;\n\n    // check if last is a catch all rule, then add it before that one\n    if (stylesCount > 0) {\n      const last = styles[stylesCount - 1];\n      if (last.pattern === '/.*/') {\n        indexToInsert = stylesCount - 1;\n      }\n    }\n\n    styles.splice(indexToInsert, 0, newStyleRule);\n    this.activeStyleIndex = indexToInsert;\n  }\n\n  removeColumnStyle(style) {\n    this.panel.styles = _.without(this.panel.styles, style);\n  }\n\n  invertColorOrder(index) {\n    const ref = this.panel.styles[index].colors;\n    const copy = ref[0];\n    ref[0] = ref[2];\n    ref[2] = copy;\n    this.panelCtrl.render();\n  }\n\n  onColorChange(styleIndex, colorIndex) {\n    return newColor => {\n      this.panel.styles[styleIndex].colors[colorIndex] = newColor;\n      this.render();\n    };\n  }\n\n  addValueMap(style) {\n    if (!style.valueMaps) {\n      style.valueMaps = [];\n    }\n    style.valueMaps.push({ value: '', text: '' });\n    this.panelCtrl.render();\n  }\n\n  removeValueMap(style, index) {\n    style.valueMaps.splice(index, 1);\n    this.panelCtrl.render();\n  }\n\n  addRangeMap(style) {\n    if (!style.rangeMaps) {\n      style.rangeMaps = [];\n    }\n    style.rangeMaps.push({ from: '', to: '', text: '' });\n    this.panelCtrl.render();\n  }\n\n  removeRangeMap(style, index) {\n    style.rangeMaps.splice(index, 1);\n    this.panelCtrl.render();\n  }\n}\n\n/** @ngInject */\nexport function columnOptionsTab($q, uiSegmentSrv) {\n  'use strict';\n  return {\n    restrict: 'E',\n    scope: true,\n    templateUrl: 'public/app/plugins/panel/table/column_options.html',\n    controller: ColumnOptionsCtrl,\n  };\n}\n","import _ from 'lodash';\nimport moment from 'moment';\nimport kbn from 'app/core/utils/kbn';\n\nexport class TableRenderer {\n  formatters: any[];\n  colorState: any;\n\n  constructor(private panel, private table, private isUtc, private sanitize, private templateSrv) {\n    this.initColumns();\n  }\n\n  setTable(table) {\n    this.table = table;\n\n    this.initColumns();\n  }\n\n  initColumns() {\n    this.formatters = [];\n    this.colorState = {};\n\n    for (let colIndex = 0; colIndex < this.table.columns.length; colIndex++) {\n      const column = this.table.columns[colIndex];\n      column.title = column.text;\n\n      for (let i = 0; i < this.panel.styles.length; i++) {\n        const style = this.panel.styles[i];\n\n        const regex = kbn.stringToJsRegex(style.pattern);\n        if (column.text.match(regex)) {\n          column.style = style;\n\n          if (style.alias) {\n            column.title = column.text.replace(regex, style.alias);\n          }\n\n          break;\n        }\n      }\n\n      this.formatters[colIndex] = this.createColumnFormatter(column);\n    }\n  }\n\n  getColorForValue(value, style) {\n    if (!style.thresholds) {\n      return null;\n    }\n    for (let i = style.thresholds.length; i > 0; i--) {\n      if (value >= style.thresholds[i - 1]) {\n        return style.colors[i];\n      }\n    }\n    return _.first(style.colors);\n  }\n\n  defaultCellFormatter(v, style) {\n    if (v === null || v === void 0 || v === undefined) {\n      return '';\n    }\n\n    if (_.isArray(v)) {\n      v = v.join(', ');\n    }\n\n    if (style && style.sanitize) {\n      return this.sanitize(v);\n    } else {\n      return _.escape(v);\n    }\n  }\n\n  createColumnFormatter(column) {\n    if (!column.style) {\n      return this.defaultCellFormatter;\n    }\n\n    if (column.style.type === 'hidden') {\n      return v => {\n        return undefined;\n      };\n    }\n\n    if (column.style.type === 'date') {\n      return v => {\n        if (v === undefined || v === null) {\n          return '-';\n        }\n\n        if (_.isArray(v)) {\n          v = v[0];\n        }\n        let date = moment(v);\n        if (this.isUtc) {\n          date = date.utc();\n        }\n        return date.format(column.style.dateFormat);\n      };\n    }\n\n    if (column.style.type === 'string') {\n      return v => {\n        if (_.isArray(v)) {\n          v = v.join(', ');\n        }\n\n        const mappingType = column.style.mappingType || 0;\n\n        if (mappingType === 1 && column.style.valueMaps) {\n          for (let i = 0; i < column.style.valueMaps.length; i++) {\n            const map = column.style.valueMaps[i];\n\n            if (v === null) {\n              if (map.value === 'null') {\n                return map.text;\n              }\n              continue;\n            }\n\n            // Allow both numeric and string values to be mapped\n            if ((!_.isString(v) && Number(map.value) === Number(v)) || map.value === v) {\n              this.setColorState(v, column.style);\n              return this.defaultCellFormatter(map.text, column.style);\n            }\n          }\n        }\n\n        if (mappingType === 2 && column.style.rangeMaps) {\n          for (let i = 0; i < column.style.rangeMaps.length; i++) {\n            const map = column.style.rangeMaps[i];\n\n            if (v === null) {\n              if (map.from === 'null' && map.to === 'null') {\n                return map.text;\n              }\n              continue;\n            }\n\n            if (Number(map.from) <= Number(v) && Number(map.to) >= Number(v)) {\n              this.setColorState(v, column.style);\n              return this.defaultCellFormatter(map.text, column.style);\n            }\n          }\n        }\n\n        if (v === null || v === void 0) {\n          return '-';\n        }\n\n        this.setColorState(v, column.style);\n        return this.defaultCellFormatter(v, column.style);\n      };\n    }\n\n    if (column.style.type === 'number') {\n      const valueFormatter = kbn.valueFormats[column.unit || column.style.unit];\n\n      return v => {\n        if (v === null || v === void 0) {\n          return '-';\n        }\n\n        if (_.isString(v) || _.isArray(v)) {\n          return this.defaultCellFormatter(v, column.style);\n        }\n\n        this.setColorState(v, column.style);\n        return valueFormatter(v, column.style.decimals, null);\n      };\n    }\n\n    return value => {\n      return this.defaultCellFormatter(value, column.style);\n    };\n  }\n\n  setColorState(value, style) {\n    if (!style.colorMode) {\n      return;\n    }\n\n    if (value === null || value === void 0 || _.isArray(value)) {\n      return;\n    }\n\n    const numericValue = Number(value);\n    if (isNaN(numericValue)) {\n      return;\n    }\n\n    this.colorState[style.colorMode] = this.getColorForValue(numericValue, style);\n  }\n\n  renderRowVariables(rowIndex) {\n    const scopedVars = {};\n    let cellVariable;\n    const row = this.table.rows[rowIndex];\n    for (let i = 0; i < row.length; i++) {\n      cellVariable = `__cell_${i}`;\n      scopedVars[cellVariable] = { value: row[i] };\n    }\n    return scopedVars;\n  }\n\n  formatColumnValue(colIndex, value) {\n    return this.formatters[colIndex] ? this.formatters[colIndex](value) : value;\n  }\n\n  renderCell(columnIndex, rowIndex, value, addWidthHack = false) {\n    value = this.formatColumnValue(columnIndex, value);\n\n    const column = this.table.columns[columnIndex];\n    let style = '';\n    const cellClasses = [];\n    let cellClass = '';\n\n    if (this.colorState.cell) {\n      style = ' style=\"background-color:' + this.colorState.cell + '\"';\n      cellClasses.push('table-panel-color-cell');\n      this.colorState.cell = null;\n    } else if (this.colorState.value) {\n      style = ' style=\"color:' + this.colorState.value + '\"';\n      this.colorState.value = null;\n    }\n    // because of the fixed table headers css only solution\n    // there is an issue if header cell is wider the cell\n    // this hack adds header content to cell (not visible)\n    let columnHtml = '';\n    if (addWidthHack) {\n      columnHtml = '<div class=\"table-panel-width-hack\">' + this.table.columns[columnIndex].title + '</div>';\n    }\n\n    if (value === undefined) {\n      style = ' style=\"display:none;\"';\n      column.hidden = true;\n    } else {\n      column.hidden = false;\n    }\n\n    if (column.hidden === true) {\n      return '';\n    }\n\n    if (column.style && column.style.preserveFormat) {\n      cellClasses.push('table-panel-cell-pre');\n    }\n\n    if (column.style && column.style.link) {\n      // Render cell as link\n      const scopedVars = this.renderRowVariables(rowIndex);\n      scopedVars['__cell'] = { value: value };\n\n      const cellLink = this.templateSrv.replace(column.style.linkUrl, scopedVars, encodeURIComponent);\n      const cellLinkTooltip = this.templateSrv.replace(column.style.linkTooltip, scopedVars);\n      const cellTarget = column.style.linkTargetBlank ? '_blank' : '';\n\n      cellClasses.push('table-panel-cell-link');\n\n      columnHtml += `\n        <a href=\"${cellLink}\" target=\"${cellTarget}\" data-link-tooltip data-original-title=\"${cellLinkTooltip}\" data-placement=\"right\"${style}>\n          ${value}\n        </a>\n      `;\n    } else {\n      columnHtml += value;\n    }\n\n    if (column.filterable) {\n      cellClasses.push('table-panel-cell-filterable');\n      columnHtml += `\n        <a class=\"table-panel-filter-link\" data-link-tooltip data-original-title=\"Filter out value\" data-placement=\"bottom\"\n           data-row=\"${rowIndex}\" data-column=\"${columnIndex}\" data-operator=\"!=\">\n          <i class=\"fa fa-search-minus\"></i>\n        </a>\n        <a class=\"table-panel-filter-link\" data-link-tooltip data-original-title=\"Filter for value\" data-placement=\"bottom\"\n           data-row=\"${rowIndex}\" data-column=\"${columnIndex}\" data-operator=\"=\">\n          <i class=\"fa fa-search-plus\"></i>\n        </a>`;\n    }\n\n    if (cellClasses.length) {\n      cellClass = ' class=\"' + cellClasses.join(' ') + '\"';\n    }\n\n    columnHtml = '<td' + cellClass + style + '>' + columnHtml + '</td>';\n    return columnHtml;\n  }\n\n  render(page) {\n    const pageSize = this.panel.pageSize || 100;\n    const startPos = page * pageSize;\n    const endPos = Math.min(startPos + pageSize, this.table.rows.length);\n    let html = '';\n    const rowClasses = [];\n    let rowClass = '';\n\n    for (let y = startPos; y < endPos; y++) {\n      const row = this.table.rows[y];\n      let cellHtml = '';\n      let rowStyle = '';\n      for (let i = 0; i < this.table.columns.length; i++) {\n        cellHtml += this.renderCell(i, y, row[i], y === startPos);\n      }\n\n      if (this.colorState.row) {\n        rowStyle = ' style=\"background-color:' + this.colorState.row + '\"';\n        rowClasses.push('table-panel-color-row');\n        this.colorState.row = null;\n      }\n\n      if (rowClasses.length) {\n        rowClass = ' class=\"' + rowClasses.join(' ') + '\"';\n      }\n\n      html += '<tr ' + rowClass + rowStyle + '>' + cellHtml + '</tr>';\n    }\n\n    return html;\n  }\n\n  render_values() {\n    const rows = [];\n\n    for (let y = 0; y < this.table.rows.length; y++) {\n      const row = this.table.rows[y];\n      const newRow = [];\n      for (let i = 0; i < this.table.columns.length; i++) {\n        newRow.push(this.formatColumnValue(i, row[i]));\n      }\n      rows.push(newRow);\n    }\n    return {\n      columns: this.table.columns,\n      rows: rows,\n    };\n  }\n}\n","import _ from 'lodash';\nimport $ from 'jquery';\nimport { MetricsPanelCtrl } from 'app/plugins/sdk';\nimport { transformDataToTable } from './transformers';\nimport { tablePanelEditor } from './editor';\nimport { columnOptionsTab } from './column_options';\nimport { TableRenderer } from './renderer';\n\nclass TablePanelCtrl extends MetricsPanelCtrl {\n  static templateUrl = 'module.html';\n\n  pageIndex: number;\n  dataRaw: any;\n  table: any;\n  renderer: any;\n\n  panelDefaults = {\n    targets: [{}],\n    transform: 'timeseries_to_columns',\n    pageSize: null,\n    showHeader: true,\n    styles: [\n      {\n        type: 'date',\n        pattern: 'Time',\n        alias: 'Time',\n        dateFormat: 'YYYY-MM-DD HH:mm:ss',\n      },\n      {\n        unit: 'short',\n        type: 'number',\n        alias: '',\n        decimals: 2,\n        colors: ['rgba(245, 54, 54, 0.9)', 'rgba(237, 129, 40, 0.89)', 'rgba(50, 172, 45, 0.97)'],\n        colorMode: null,\n        pattern: '/.*/',\n        thresholds: [],\n      },\n    ],\n    columns: [],\n    scroll: true,\n    fontSize: '100%',\n    sort: { col: 0, desc: true },\n  };\n\n  /** @ngInject */\n  constructor($scope, $injector, templateSrv, private annotationsSrv, private $sanitize, private variableSrv) {\n    super($scope, $injector);\n\n    this.pageIndex = 0;\n\n    if (this.panel.styles === void 0) {\n      this.panel.styles = this.panel.columns;\n      this.panel.columns = this.panel.fields;\n      delete this.panel.columns;\n      delete this.panel.fields;\n    }\n\n    _.defaults(this.panel, this.panelDefaults);\n\n    this.events.on('data-received', this.onDataReceived.bind(this));\n    this.events.on('data-error', this.onDataError.bind(this));\n    this.events.on('data-snapshot-load', this.onDataReceived.bind(this));\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n    this.events.on('init-panel-actions', this.onInitPanelActions.bind(this));\n  }\n\n  onInitEditMode() {\n    this.addEditorTab('Options', tablePanelEditor, 2);\n    this.addEditorTab('Column Styles', columnOptionsTab, 3);\n  }\n\n  onInitPanelActions(actions) {\n    actions.push({ text: 'Export CSV', click: 'ctrl.exportCsv()' });\n  }\n\n  issueQueries(datasource) {\n    this.pageIndex = 0;\n\n    if (this.panel.transform === 'annotations') {\n      this.setTimeQueryStart();\n      return this.annotationsSrv\n        .getAnnotations({\n          dashboard: this.dashboard,\n          panel: this.panel,\n          range: this.range,\n        })\n        .then(annotations => {\n          return { data: annotations };\n        });\n    }\n\n    return super.issueQueries(datasource);\n  }\n\n  onDataError(err) {\n    this.dataRaw = [];\n    this.render();\n  }\n\n  onDataReceived(dataList) {\n    this.dataRaw = dataList;\n    this.pageIndex = 0;\n\n    // automatically correct transform mode based on data\n    if (this.dataRaw && this.dataRaw.length) {\n      if (this.dataRaw[0].type === 'table') {\n        this.panel.transform = 'table';\n      } else {\n        if (this.dataRaw[0].type === 'docs') {\n          this.panel.transform = 'json';\n        } else {\n          if (this.panel.transform === 'table' || this.panel.transform === 'json') {\n            this.panel.transform = 'timeseries_to_rows';\n          }\n        }\n      }\n    }\n\n    this.render();\n  }\n\n  render() {\n    this.table = transformDataToTable(this.dataRaw, this.panel);\n    this.table.sort(this.panel.sort);\n\n    this.renderer = new TableRenderer(\n      this.panel,\n      this.table,\n      this.dashboard.isTimezoneUtc(),\n      this.$sanitize,\n      this.templateSrv\n    );\n\n    return super.render(this.table);\n  }\n\n  toggleColumnSort(col, colIndex) {\n    // remove sort flag from current column\n    if (this.table.columns[this.panel.sort.col]) {\n      this.table.columns[this.panel.sort.col].sort = false;\n    }\n\n    if (this.panel.sort.col === colIndex) {\n      if (this.panel.sort.desc) {\n        this.panel.sort.desc = false;\n      } else {\n        this.panel.sort.col = null;\n      }\n    } else {\n      this.panel.sort.col = colIndex;\n      this.panel.sort.desc = true;\n    }\n    this.render();\n  }\n\n  moveQuery(target, direction) {\n    super.moveQuery(target, direction);\n    super.refresh();\n  }\n\n  exportCsv() {\n    const scope = this.$scope.$new(true);\n    scope.tableData = this.renderer.render_values();\n    scope.panel = 'table';\n    this.publishAppEvent('show-modal', {\n      templateHtml: '<export-data-modal panel=\"panel\" data=\"tableData\"></export-data-modal>',\n      scope,\n      modalClass: 'modal--narrow',\n    });\n  }\n\n  link(scope, elem, attrs, ctrl: TablePanelCtrl) {\n    let data;\n    const panel = ctrl.panel;\n    let pageCount = 0;\n\n    function getTableHeight() {\n      let panelHeight = ctrl.height;\n\n      if (pageCount > 1) {\n        panelHeight -= 26;\n      }\n\n      return panelHeight - 31 + 'px';\n    }\n\n    function appendTableRows(tbodyElem) {\n      ctrl.renderer.setTable(data);\n      tbodyElem.empty();\n      tbodyElem.html(ctrl.renderer.render(ctrl.pageIndex));\n    }\n\n    function switchPage(e) {\n      const el = $(e.currentTarget);\n      ctrl.pageIndex = parseInt(el.text(), 10) - 1;\n      renderPanel();\n    }\n\n    function appendPaginationControls(footerElem) {\n      footerElem.empty();\n\n      const pageSize = panel.pageSize || 100;\n      pageCount = Math.ceil(data.rows.length / pageSize);\n      if (pageCount === 1) {\n        return;\n      }\n\n      const startPage = Math.max(ctrl.pageIndex - 3, 0);\n      const endPage = Math.min(pageCount, startPage + 9);\n\n      const paginationList = $('<ul></ul>');\n\n      for (let i = startPage; i < endPage; i++) {\n        const activeClass = i === ctrl.pageIndex ? 'active' : '';\n        const pageLinkElem = $(\n          '<li><a class=\"table-panel-page-link pointer ' + activeClass + '\">' + (i + 1) + '</a></li>'\n        );\n        paginationList.append(pageLinkElem);\n      }\n\n      footerElem.append(paginationList);\n    }\n\n    function renderPanel() {\n      const panelElem = elem.parents('.panel-content');\n      const rootElem = elem.find('.table-panel-scroll');\n      const tbodyElem = elem.find('tbody');\n      const footerElem = elem.find('.table-panel-footer');\n\n      elem.css({ 'font-size': panel.fontSize });\n      panelElem.addClass('table-panel-content');\n\n      appendTableRows(tbodyElem);\n      appendPaginationControls(footerElem);\n\n      rootElem.css({ 'max-height': panel.scroll ? getTableHeight() : '' });\n    }\n\n    // hook up link tooltips\n    elem.tooltip({\n      selector: '[data-link-tooltip]',\n    });\n\n    function addFilterClicked(e) {\n      const filterData = $(e.currentTarget).data();\n      const options = {\n        datasource: panel.datasource,\n        key: data.columns[filterData.column].text,\n        value: data.rows[filterData.row][filterData.column],\n        operator: filterData.operator,\n      };\n\n      ctrl.variableSrv.setAdhocFilter(options);\n    }\n\n    elem.on('click', '.table-panel-page-link', switchPage);\n    elem.on('click', '.table-panel-filter-link', addFilterClicked);\n\n    const unbindDestroy = scope.$on('$destroy', () => {\n      elem.off('click', '.table-panel-page-link');\n      elem.off('click', '.table-panel-filter-link');\n      unbindDestroy();\n    });\n\n    ctrl.events.on('render', renderData => {\n      data = renderData || data;\n      if (data) {\n        renderPanel();\n      }\n      ctrl.renderingCompleted();\n    });\n  }\n}\n\nexport { TablePanelCtrl, TablePanelCtrl as PanelCtrl };\n","import angular from 'angular';\nimport _ from 'lodash';\nimport kbn from 'app/core/utils/kbn';\n\nexport class LinkSrv {\n  /** @ngInject */\n  constructor(private templateSrv, private timeSrv) {}\n\n  getLinkUrl(link) {\n    const url = this.templateSrv.replace(link.url || '');\n    const params = {};\n\n    if (link.keepTime) {\n      const range = this.timeSrv.timeRangeForUrl();\n      params['from'] = range.from;\n      params['to'] = range.to;\n    }\n\n    if (link.includeVars) {\n      this.templateSrv.fillVariableValuesForUrl(params);\n    }\n\n    return this.addParamsToUrl(url, params);\n  }\n\n  addParamsToUrl(url, params) {\n    const paramsArray = [];\n\n    _.each(params, (value, key) => {\n      if (value === null) {\n        return;\n      }\n      if (value === true) {\n        paramsArray.push(key);\n      } else if (_.isArray(value)) {\n        _.each(value, instance => {\n          paramsArray.push(key + '=' + encodeURIComponent(instance));\n        });\n      } else {\n        paramsArray.push(key + '=' + encodeURIComponent(value));\n      }\n    });\n\n    if (paramsArray.length === 0) {\n      return url;\n    }\n\n    return this.appendToQueryString(url, paramsArray.join('&'));\n  }\n\n  appendToQueryString(url, stringToAppend) {\n    if (!_.isUndefined(stringToAppend) && stringToAppend !== null && stringToAppend !== '') {\n      const pos = url.indexOf('?');\n      if (pos !== -1) {\n        if (url.length - pos > 1) {\n          url += '&';\n        }\n      } else {\n        url += '?';\n      }\n      url += stringToAppend;\n    }\n\n    return url;\n  }\n\n  getAnchorInfo(link) {\n    const info: any = {};\n    info.href = this.getLinkUrl(link);\n    info.title = this.templateSrv.replace(link.title || '');\n    return info;\n  }\n\n  getPanelLinkAnchorInfo(link, scopedVars) {\n    const info: any = {};\n    if (link.type === 'absolute') {\n      info.target = link.targetBlank ? '_blank' : '_self';\n      info.href = this.templateSrv.replace(link.url || '', scopedVars);\n      info.title = this.templateSrv.replace(link.title || '', scopedVars);\n    } else if (link.url) {\n      info.href = link.url;\n      info.title = this.templateSrv.replace(link.title || '', scopedVars);\n      info.target = link.targetBlank ? '_blank' : '';\n    } else if (link.dashUri) {\n      info.href = 'dashboard/' + link.dashUri + '?';\n      info.title = this.templateSrv.replace(link.title || '', scopedVars);\n      info.target = link.targetBlank ? '_blank' : '';\n    } else {\n      info.title = this.templateSrv.replace(link.title || '', scopedVars);\n      const slug = kbn.slugifyForUrl(link.dashboard || '');\n      info.href = 'dashboard/db/' + slug + '?';\n    }\n\n    const params = {};\n\n    if (link.keepTime) {\n      const range = this.timeSrv.timeRangeForUrl();\n      params['from'] = range.from;\n      params['to'] = range.to;\n    }\n\n    if (link.includeVars) {\n      this.templateSrv.fillVariableValuesForUrl(params, scopedVars);\n    }\n\n    info.href = this.addParamsToUrl(info.href, params);\n\n    if (link.params) {\n      info.href = this.appendToQueryString(info.href, this.templateSrv.replace(link.params, scopedVars));\n    }\n\n    return info;\n  }\n}\n\nangular.module('grafana.services').service('linkSrv', LinkSrv);\n","import _ from 'lodash';\nimport $ from 'jquery';\nimport 'vendor/flot/jquery.flot';\nimport 'vendor/flot/jquery.flot.gauge';\nimport 'app/features/dashboard/panellinks/link_srv';\n\nimport kbn from 'app/core/utils/kbn';\nimport config from 'app/core/config';\nimport TimeSeries from 'app/core/time_series2';\nimport { MetricsPanelCtrl } from 'app/plugins/sdk';\n\nclass SingleStatCtrl extends MetricsPanelCtrl {\n  static templateUrl = 'module.html';\n\n  dataType = 'timeseries';\n  series: any[];\n  data: any;\n  fontSizes: any[];\n  unitFormats: any[];\n  invalidGaugeRange: boolean;\n  panel: any;\n  events: any;\n  valueNameOptions: any[] = [\n    { value: 'min', text: 'Min' },\n    { value: 'max', text: 'Max' },\n    { value: 'avg', text: 'Average' },\n    { value: 'current', text: 'Current' },\n    { value: 'total', text: 'Total' },\n    { value: 'name', text: 'Name' },\n    { value: 'first', text: 'First' },\n    { value: 'delta', text: 'Delta' },\n    { value: 'diff', text: 'Difference' },\n    { value: 'range', text: 'Range' },\n    { value: 'last_time', text: 'Time of last point' },\n  ];\n  tableColumnOptions: any;\n\n  // Set and populate defaults\n  panelDefaults = {\n    links: [],\n    datasource: null,\n    maxDataPoints: 100,\n    interval: null,\n    targets: [{}],\n    cacheTimeout: null,\n    format: 'none',\n    prefix: '',\n    postfix: '',\n    nullText: null,\n    valueMaps: [{ value: 'null', op: '=', text: 'N/A' }],\n    mappingTypes: [{ name: 'value to text', value: 1 }, { name: 'range to text', value: 2 }],\n    rangeMaps: [{ from: 'null', to: 'null', text: 'N/A' }],\n    mappingType: 1,\n    nullPointMode: 'connected',\n    valueName: 'avg',\n    prefixFontSize: '50%',\n    valueFontSize: '80%',\n    postfixFontSize: '50%',\n    thresholds: '',\n    colorBackground: false,\n    colorValue: false,\n    colors: ['#299c46', 'rgba(237, 129, 40, 0.89)', '#d44a3a'],\n    sparkline: {\n      show: false,\n      full: false,\n      lineColor: 'rgb(31, 120, 193)',\n      fillColor: 'rgba(31, 118, 189, 0.18)',\n    },\n    gauge: {\n      show: false,\n      minValue: 0,\n      maxValue: 100,\n      thresholdMarkers: true,\n      thresholdLabels: false,\n    },\n    tableColumn: '',\n  };\n\n  /** @ngInject */\n  constructor($scope, $injector, private linkSrv) {\n    super($scope, $injector);\n    _.defaults(this.panel, this.panelDefaults);\n\n    this.events.on('data-received', this.onDataReceived.bind(this));\n    this.events.on('data-error', this.onDataError.bind(this));\n    this.events.on('data-snapshot-load', this.onDataReceived.bind(this));\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n\n    this.onSparklineColorChange = this.onSparklineColorChange.bind(this);\n    this.onSparklineFillChange = this.onSparklineFillChange.bind(this);\n  }\n\n  onInitEditMode() {\n    this.fontSizes = ['20%', '30%', '50%', '70%', '80%', '100%', '110%', '120%', '150%', '170%', '200%'];\n    this.addEditorTab('Options', 'public/app/plugins/panel/singlestat/editor.html', 2);\n    this.addEditorTab('Value Mappings', 'public/app/plugins/panel/singlestat/mappings.html', 3);\n    this.unitFormats = kbn.getUnitFormats();\n  }\n\n  setUnitFormat(subItem) {\n    this.panel.format = subItem.value;\n    this.refresh();\n  }\n\n  onDataError(err) {\n    this.onDataReceived([]);\n  }\n\n  onDataReceived(dataList) {\n    const data: any = {};\n    if (dataList.length > 0 && dataList[0].type === 'table') {\n      this.dataType = 'table';\n      const tableData = dataList.map(this.tableHandler.bind(this));\n      this.setTableValues(tableData, data);\n    } else {\n      this.dataType = 'timeseries';\n      this.series = dataList.map(this.seriesHandler.bind(this));\n      this.setValues(data);\n    }\n    this.data = data;\n    this.render();\n  }\n\n  seriesHandler(seriesData) {\n    const series = new TimeSeries({\n      datapoints: seriesData.datapoints || [],\n      alias: seriesData.target,\n    });\n\n    series.flotpairs = series.getFlotPairs(this.panel.nullPointMode);\n    return series;\n  }\n\n  tableHandler(tableData) {\n    const datapoints = [];\n    const columnNames = {};\n\n    tableData.columns.forEach((column, columnIndex) => {\n      columnNames[columnIndex] = column.text;\n    });\n\n    this.tableColumnOptions = columnNames;\n    if (!_.find(tableData.columns, ['text', this.panel.tableColumn])) {\n      this.setTableColumnToSensibleDefault(tableData);\n    }\n\n    tableData.rows.forEach(row => {\n      const datapoint = {};\n\n      row.forEach((value, columnIndex) => {\n        const key = columnNames[columnIndex];\n        datapoint[key] = value;\n      });\n\n      datapoints.push(datapoint);\n    });\n\n    return datapoints;\n  }\n\n  setTableColumnToSensibleDefault(tableData) {\n    if (tableData.columns.length === 1) {\n      this.panel.tableColumn = tableData.columns[0].text;\n    } else {\n      this.panel.tableColumn = _.find(tableData.columns, col => {\n        return col.type !== 'time';\n      }).text;\n    }\n  }\n\n  setTableValues(tableData, data) {\n    if (!tableData || tableData.length === 0) {\n      return;\n    }\n\n    if (tableData[0].length === 0 || tableData[0][0][this.panel.tableColumn] === undefined) {\n      return;\n    }\n\n    const datapoint = tableData[0][0];\n    data.value = datapoint[this.panel.tableColumn];\n\n    if (_.isString(data.value)) {\n      data.valueFormatted = _.escape(data.value);\n      data.value = 0;\n      data.valueRounded = 0;\n    } else {\n      const decimalInfo = this.getDecimalsForValue(data.value);\n      const formatFunc = kbn.valueFormats[this.panel.format];\n      data.valueFormatted = formatFunc(\n        datapoint[this.panel.tableColumn],\n        decimalInfo.decimals,\n        decimalInfo.scaledDecimals\n      );\n      data.valueRounded = kbn.roundValue(data.value, this.panel.decimals || 0);\n    }\n\n    this.setValueMapping(data);\n  }\n\n  canModifyText() {\n    return !this.panel.gauge.show;\n  }\n\n  setColoring(options) {\n    if (options.background) {\n      this.panel.colorValue = false;\n      this.panel.colors = ['rgba(71, 212, 59, 0.4)', 'rgba(245, 150, 40, 0.73)', 'rgba(225, 40, 40, 0.59)'];\n    } else {\n      this.panel.colorBackground = false;\n      this.panel.colors = ['rgba(50, 172, 45, 0.97)', 'rgba(237, 129, 40, 0.89)', 'rgba(245, 54, 54, 0.9)'];\n    }\n    this.render();\n  }\n\n  invertColorOrder() {\n    const tmp = this.panel.colors[0];\n    this.panel.colors[0] = this.panel.colors[2];\n    this.panel.colors[2] = tmp;\n    this.render();\n  }\n\n  onColorChange(panelColorIndex) {\n    return color => {\n      this.panel.colors[panelColorIndex] = color;\n      this.render();\n    };\n  }\n\n  onSparklineColorChange(newColor) {\n    this.panel.sparkline.lineColor = newColor;\n    this.render();\n  }\n\n  onSparklineFillChange(newColor) {\n    this.panel.sparkline.fillColor = newColor;\n    this.render();\n  }\n\n  getDecimalsForValue(value) {\n    if (_.isNumber(this.panel.decimals)) {\n      return { decimals: this.panel.decimals, scaledDecimals: null };\n    }\n\n    const delta = value / 2;\n    let dec = -Math.floor(Math.log(delta) / Math.LN10);\n\n    const magn = Math.pow(10, -dec);\n    const norm = delta / magn; // norm is between 1.0 and 10.0\n    let size;\n\n    if (norm < 1.5) {\n      size = 1;\n    } else if (norm < 3) {\n      size = 2;\n      // special case for 2.5, requires an extra decimal\n      if (norm > 2.25) {\n        size = 2.5;\n        ++dec;\n      }\n    } else if (norm < 7.5) {\n      size = 5;\n    } else {\n      size = 10;\n    }\n\n    size *= magn;\n\n    // reduce starting decimals if not needed\n    if (Math.floor(value) === value) {\n      dec = 0;\n    }\n\n    const result: any = {};\n    result.decimals = Math.max(0, dec);\n    result.scaledDecimals = result.decimals - Math.floor(Math.log(size) / Math.LN10) + 2;\n\n    return result;\n  }\n\n  setValues(data) {\n    data.flotpairs = [];\n\n    if (this.series.length > 1) {\n      const error: any = new Error();\n      error.message = 'Multiple Series Error';\n      error.data =\n        'Metric query returns ' +\n        this.series.length +\n        ' series. Single Stat Panel expects a single series.\\n\\nResponse:\\n' +\n        JSON.stringify(this.series);\n      throw error;\n    }\n\n    if (this.series && this.series.length > 0) {\n      const lastPoint = _.last(this.series[0].datapoints);\n      const lastValue = _.isArray(lastPoint) ? lastPoint[0] : null;\n\n      if (this.panel.valueName === 'name') {\n        data.value = 0;\n        data.valueRounded = 0;\n        data.valueFormatted = this.series[0].alias;\n      } else if (_.isString(lastValue)) {\n        data.value = 0;\n        data.valueFormatted = _.escape(lastValue);\n        data.valueRounded = 0;\n      } else if (this.panel.valueName === 'last_time') {\n        const formatFunc = kbn.valueFormats[this.panel.format];\n        data.value = lastPoint[1];\n        data.valueRounded = data.value;\n        data.valueFormatted = formatFunc(data.value, this.dashboard.isTimezoneUtc());\n      } else {\n        data.value = this.series[0].stats[this.panel.valueName];\n        data.flotpairs = this.series[0].flotpairs;\n\n        const decimalInfo = this.getDecimalsForValue(data.value);\n        const formatFunc = kbn.valueFormats[this.panel.format];\n        data.valueFormatted = formatFunc(data.value, decimalInfo.decimals, decimalInfo.scaledDecimals);\n        data.valueRounded = kbn.roundValue(data.value, decimalInfo.decimals);\n      }\n\n      // Add $__name variable for using in prefix or postfix\n      data.scopedVars = _.extend({}, this.panel.scopedVars);\n      data.scopedVars['__name'] = { value: this.series[0].label };\n    }\n    this.setValueMapping(data);\n  }\n\n  setValueMapping(data) {\n    // check value to text mappings if its enabled\n    if (this.panel.mappingType === 1) {\n      for (let i = 0; i < this.panel.valueMaps.length; i++) {\n        const map = this.panel.valueMaps[i];\n        // special null case\n        if (map.value === 'null') {\n          if (data.value === null || data.value === void 0) {\n            data.valueFormatted = map.text;\n            return;\n          }\n          continue;\n        }\n\n        // value/number to text mapping\n        const value = parseFloat(map.value);\n        if (value === data.valueRounded) {\n          data.valueFormatted = map.text;\n          return;\n        }\n      }\n    } else if (this.panel.mappingType === 2) {\n      for (let i = 0; i < this.panel.rangeMaps.length; i++) {\n        const map = this.panel.rangeMaps[i];\n        // special null case\n        if (map.from === 'null' && map.to === 'null') {\n          if (data.value === null || data.value === void 0) {\n            data.valueFormatted = map.text;\n            return;\n          }\n          continue;\n        }\n\n        // value/number to range mapping\n        const from = parseFloat(map.from);\n        const to = parseFloat(map.to);\n        if (to >= data.valueRounded && from <= data.valueRounded) {\n          data.valueFormatted = map.text;\n          return;\n        }\n      }\n    }\n\n    if (data.value === null || data.value === void 0) {\n      data.valueFormatted = 'no value';\n    }\n  }\n\n  removeValueMap(map) {\n    const index = _.indexOf(this.panel.valueMaps, map);\n    this.panel.valueMaps.splice(index, 1);\n    this.render();\n  }\n\n  addValueMap() {\n    this.panel.valueMaps.push({ value: '', op: '=', text: '' });\n  }\n\n  removeRangeMap(rangeMap) {\n    const index = _.indexOf(this.panel.rangeMaps, rangeMap);\n    this.panel.rangeMaps.splice(index, 1);\n    this.render();\n  }\n\n  addRangeMap() {\n    this.panel.rangeMaps.push({ from: '', to: '', text: '' });\n  }\n\n  link(scope, elem, attrs, ctrl) {\n    const $location = this.$location;\n    const linkSrv = this.linkSrv;\n    const $timeout = this.$timeout;\n    const panel = ctrl.panel;\n    const templateSrv = this.templateSrv;\n    let data, linkInfo;\n    const $panelContainer = elem.find('.panel-container');\n    elem = elem.find('.singlestat-panel');\n\n    function applyColoringThresholds(value, valueString) {\n      const color = getColorForValue(data, value);\n      if (color) {\n        return '<span style=\"color:' + color + '\">' + valueString + '</span>';\n      }\n\n      return valueString;\n    }\n\n    function getSpan(className, fontSize, value) {\n      value = templateSrv.replace(value, data.scopedVars);\n      return '<span class=\"' + className + '\" style=\"font-size:' + fontSize + '\">' + value + '</span>';\n    }\n\n    function getBigValueHtml() {\n      let body = '<div class=\"singlestat-panel-value-container\">';\n\n      if (panel.prefix) {\n        let prefix = panel.prefix;\n        if (panel.colorPrefix) {\n          prefix = applyColoringThresholds(data.value, panel.prefix);\n        }\n        body += getSpan('singlestat-panel-prefix', panel.prefixFontSize, prefix);\n      }\n\n      let value = data.valueFormatted;\n      if (panel.colorValue) {\n        value = applyColoringThresholds(data.value, value);\n      }\n      body += getSpan('singlestat-panel-value', panel.valueFontSize, value);\n\n      if (panel.postfix) {\n        let postfix = panel.postfix;\n        if (panel.colorPostfix) {\n          postfix = applyColoringThresholds(data.value, panel.postfix);\n        }\n        body += getSpan('singlestat-panel-postfix', panel.postfixFontSize, postfix);\n      }\n\n      body += '</div>';\n\n      return body;\n    }\n\n    function getValueText() {\n      let result = panel.prefix ? templateSrv.replace(panel.prefix, data.scopedVars) : '';\n      result += data.valueFormatted;\n      result += panel.postfix ? templateSrv.replace(panel.postfix, data.scopedVars) : '';\n\n      return result;\n    }\n\n    function addGauge() {\n      const width = elem.width();\n      const height = elem.height();\n      // Allow to use a bit more space for wide gauges\n      const dimension = Math.min(width, height * 1.3);\n\n      ctrl.invalidGaugeRange = false;\n      if (panel.gauge.minValue > panel.gauge.maxValue) {\n        ctrl.invalidGaugeRange = true;\n        return;\n      }\n\n      const plotCanvas = $('<div></div>');\n      const plotCss = {\n        top: '10px',\n        margin: 'auto',\n        position: 'relative',\n        height: height * 0.9 + 'px',\n        width: dimension + 'px',\n      };\n\n      plotCanvas.css(plotCss);\n\n      const thresholds = [];\n      for (let i = 0; i < data.thresholds.length; i++) {\n        thresholds.push({\n          value: data.thresholds[i],\n          color: data.colorMap[i],\n        });\n      }\n      thresholds.push({\n        value: panel.gauge.maxValue,\n        color: data.colorMap[data.colorMap.length - 1],\n      });\n\n      const bgColor = config.bootData.user.lightTheme ? 'rgb(230,230,230)' : 'rgb(38,38,38)';\n\n      const fontScale = parseInt(panel.valueFontSize, 10) / 100;\n      const fontSize = Math.min(dimension / 5, 100) * fontScale;\n      // Reduce gauge width if threshold labels enabled\n      const gaugeWidthReduceRatio = panel.gauge.thresholdLabels ? 1.5 : 1;\n      const gaugeWidth = Math.min(dimension / 6, 60) / gaugeWidthReduceRatio;\n      const thresholdMarkersWidth = gaugeWidth / 5;\n      const thresholdLabelFontSize = fontSize / 2.5;\n\n      const options = {\n        series: {\n          gauges: {\n            gauge: {\n              min: panel.gauge.minValue,\n              max: panel.gauge.maxValue,\n              background: { color: bgColor },\n              border: { color: null },\n              shadow: { show: false },\n              width: gaugeWidth,\n            },\n            frame: { show: false },\n            label: { show: false },\n            layout: { margin: 0, thresholdWidth: 0 },\n            cell: { border: { width: 0 } },\n            threshold: {\n              values: thresholds,\n              label: {\n                show: panel.gauge.thresholdLabels,\n                margin: thresholdMarkersWidth + 1,\n                font: { size: thresholdLabelFontSize },\n              },\n              show: panel.gauge.thresholdMarkers,\n              width: thresholdMarkersWidth,\n            },\n            value: {\n              color: panel.colorValue ? getColorForValue(data, data.valueRounded) : null,\n              formatter: () => {\n                return getValueText();\n              },\n              font: {\n                size: fontSize,\n                family: '\"Helvetica Neue\", Helvetica, Arial, sans-serif',\n              },\n            },\n            show: true,\n          },\n        },\n      };\n\n      elem.append(plotCanvas);\n\n      const plotSeries = {\n        data: [[0, data.value]],\n      };\n\n      $.plot(plotCanvas, [plotSeries], options);\n    }\n\n    function addSparkline() {\n      const width = elem.width() + 20;\n      if (width < 30) {\n        // element has not gotten it's width yet\n        // delay sparkline render\n        setTimeout(addSparkline, 30);\n        return;\n      }\n\n      const height = ctrl.height;\n      const plotCanvas = $('<div></div>');\n      const plotCss: any = {};\n      plotCss.position = 'absolute';\n\n      if (panel.sparkline.full) {\n        plotCss.bottom = '5px';\n        plotCss.left = '-5px';\n        plotCss.width = width - 10 + 'px';\n        const dynamicHeightMargin = height <= 100 ? 5 : Math.round(height / 100) * 15 + 5;\n        plotCss.height = height - dynamicHeightMargin + 'px';\n      } else {\n        plotCss.bottom = '0px';\n        plotCss.left = '-5px';\n        plotCss.width = width - 10 + 'px';\n        plotCss.height = Math.floor(height * 0.25) + 'px';\n      }\n\n      plotCanvas.css(plotCss);\n\n      const options = {\n        legend: { show: false },\n        series: {\n          lines: {\n            show: true,\n            fill: 1,\n            zero: false,\n            lineWidth: 1,\n            fillColor: panel.sparkline.fillColor,\n          },\n        },\n        yaxes: { show: false },\n        xaxis: {\n          show: false,\n          mode: 'time',\n          min: ctrl.range.from.valueOf(),\n          max: ctrl.range.to.valueOf(),\n        },\n        grid: { hoverable: false, show: false },\n      };\n\n      elem.append(plotCanvas);\n\n      const plotSeries = {\n        data: data.flotpairs,\n        color: panel.sparkline.lineColor,\n      };\n\n      $.plot(plotCanvas, [plotSeries], options);\n    }\n\n    function render() {\n      if (!ctrl.data) {\n        return;\n      }\n      data = ctrl.data;\n\n      // get thresholds\n      data.thresholds = panel.thresholds.split(',').map(strVale => {\n        return Number(strVale.trim());\n      });\n      data.colorMap = panel.colors;\n\n      const body = panel.gauge.show ? '' : getBigValueHtml();\n\n      if (panel.colorBackground) {\n        const color = getColorForValue(data, data.value);\n        if (color) {\n          $panelContainer.css('background-color', color);\n          if (scope.fullscreen) {\n            elem.css('background-color', color);\n          } else {\n            elem.css('background-color', '');\n          }\n        }\n      } else {\n        $panelContainer.css('background-color', '');\n        elem.css('background-color', '');\n      }\n\n      elem.html(body);\n\n      if (panel.sparkline.show) {\n        addSparkline();\n      }\n\n      if (panel.gauge.show) {\n        addGauge();\n      }\n\n      elem.toggleClass('pointer', panel.links.length > 0);\n\n      if (panel.links.length > 0) {\n        linkInfo = linkSrv.getPanelLinkAnchorInfo(panel.links[0], data.scopedVars);\n      } else {\n        linkInfo = null;\n      }\n    }\n\n    function hookupDrilldownLinkTooltip() {\n      // drilldown link tooltip\n      const drilldownTooltip = $('<div id=\"tooltip\" class=\"\">hello</div>\"');\n\n      elem.mouseleave(() => {\n        if (panel.links.length === 0) {\n          return;\n        }\n        $timeout(() => {\n          drilldownTooltip.detach();\n        });\n      });\n\n      elem.click(evt => {\n        if (!linkInfo) {\n          return;\n        }\n        // ignore title clicks in title\n        if ($(evt).parents('.panel-header').length > 0) {\n          return;\n        }\n\n        if (linkInfo.target === '_blank') {\n          window.open(linkInfo.href, '_blank');\n          return;\n        }\n\n        if (linkInfo.href.indexOf('http') === 0) {\n          window.location.href = linkInfo.href;\n        } else {\n          $timeout(() => {\n            $location.url(linkInfo.href);\n          });\n        }\n\n        drilldownTooltip.detach();\n      });\n\n      elem.mousemove(e => {\n        if (!linkInfo) {\n          return;\n        }\n\n        drilldownTooltip.text('click to go to: ' + linkInfo.title);\n        drilldownTooltip.place_tt(e.pageX, e.pageY - 50);\n      });\n    }\n\n    hookupDrilldownLinkTooltip();\n\n    this.events.on('render', () => {\n      render();\n      ctrl.renderingCompleted();\n    });\n  }\n}\n\nfunction getColorForValue(data, value) {\n  if (!_.isFinite(value)) {\n    return null;\n  }\n\n  for (let i = data.thresholds.length; i > 0; i--) {\n    if (value >= data.thresholds[i - 1]) {\n      return data.colorMap[i];\n    }\n  }\n\n  return _.first(data.colorMap);\n}\n\nexport { SingleStatCtrl, SingleStatCtrl as PanelCtrl, getColorForValue };\n","import { PanelCtrl } from 'app/plugins/sdk';\n\nimport { contextSrv } from 'app/core/core';\n\nclass GettingStartedPanelCtrl extends PanelCtrl {\n  static templateUrl = 'public/app/plugins/panel/gettingstarted/module.html';\n  checksDone: boolean;\n  stepIndex: number;\n  steps: any;\n\n  /** @ngInject */\n  constructor($scope, $injector, private backendSrv, datasourceSrv, private $q) {\n    super($scope, $injector);\n\n    this.stepIndex = 0;\n    this.steps = [];\n\n    this.steps.push({\n      title: 'Install Grafana',\n      icon: 'icon-gf icon-gf-check',\n      href: 'http://docs.grafana.org/',\n      target: '_blank',\n      note: 'Review the installation docs',\n      check: () => $q.when(true),\n    });\n\n    this.steps.push({\n      title: 'Create your first data source',\n      cta: 'Add data source',\n      icon: 'icon-gf icon-gf-datasources',\n      href: 'datasources/new?gettingstarted',\n      check: () => {\n        return $q.when(\n          datasourceSrv.getMetricSources().filter(item => {\n            return item.meta.builtIn !== true;\n          }).length > 0\n        );\n      },\n    });\n\n    this.steps.push({\n      title: 'Create your first dashboard',\n      cta: 'New dashboard',\n      icon: 'icon-gf icon-gf-dashboard',\n      href: 'dashboard/new?gettingstarted',\n      check: () => {\n        return this.backendSrv.search({ limit: 1 }).then(result => {\n          return result.length > 0;\n        });\n      },\n    });\n\n    this.steps.push({\n      title: 'Invite your team',\n      cta: 'Add Users',\n      icon: 'icon-gf icon-gf-users',\n      href: 'org/users?gettingstarted',\n      check: () => {\n        return this.backendSrv.get('/api/org/users').then(res => {\n          return res.length > 1;\n        });\n      },\n    });\n\n    this.steps.push({\n      title: 'Install apps & plugins',\n      cta: 'Explore plugin repository',\n      icon: 'icon-gf icon-gf-apps',\n      href: 'https://grafana.com/plugins?utm_source=grafana_getting_started',\n      check: () => {\n        return this.backendSrv.get('/api/plugins', { embedded: 0, core: 0 }).then(plugins => {\n          return plugins.length > 0;\n        });\n      },\n    });\n  }\n\n  $onInit() {\n    this.stepIndex = -1;\n    return this.nextStep().then(res => {\n      this.checksDone = true;\n    });\n  }\n\n  nextStep() {\n    if (this.stepIndex === this.steps.length - 1) {\n      return this.$q.when();\n    }\n\n    this.stepIndex += 1;\n    const currentStep = this.steps[this.stepIndex];\n    return currentStep.check().then(passed => {\n      if (passed) {\n        currentStep.cssClass = 'completed';\n        return this.nextStep();\n      }\n\n      currentStep.cssClass = 'active';\n      return this.$q.when();\n    });\n  }\n\n  dismiss() {\n    this.dashboard.removePanel(this.panel, false);\n\n    this.backendSrv\n      .request({\n        method: 'PUT',\n        url: '/api/user/helpflags/1',\n        showSuccessAlert: false,\n      })\n      .then(res => {\n        contextSrv.user.helpFlags1 = res.helpFlags1;\n      });\n  }\n}\n\nexport { GettingStartedPanelCtrl, GettingStartedPanelCtrl as PanelCtrl };\n","import * as graphitePlugin from 'app/plugins/datasource/graphite/module';\nimport * as cloudwatchPlugin from 'app/plugins/datasource/cloudwatch/module';\nimport * as elasticsearchPlugin from 'app/plugins/datasource/elasticsearch/module';\nimport * as opentsdbPlugin from 'app/plugins/datasource/opentsdb/module';\nimport * as grafanaPlugin from 'app/plugins/datasource/grafana/module';\nimport * as influxdbPlugin from 'app/plugins/datasource/influxdb/module';\nimport * as loggingPlugin from 'app/plugins/datasource/logging/module';\nimport * as mixedPlugin from 'app/plugins/datasource/mixed/module';\nimport * as mysqlPlugin from 'app/plugins/datasource/mysql/module';\nimport * as postgresPlugin from 'app/plugins/datasource/postgres/module';\nimport * as prometheusPlugin from 'app/plugins/datasource/prometheus/module';\nimport * as mssqlPlugin from 'app/plugins/datasource/mssql/module';\nimport * as testDataDSPlugin from 'app/plugins/datasource/testdata/module';\nimport * as stackdriverPlugin from 'app/plugins/datasource/stackdriver/module';\n\nimport * as textPanel from 'app/plugins/panel/text/module';\nimport * as graphPanel from 'app/plugins/panel/graph/module';\nimport * as dashListPanel from 'app/plugins/panel/dashlist/module';\nimport * as pluginsListPanel from 'app/plugins/panel/pluginlist/module';\nimport * as alertListPanel from 'app/plugins/panel/alertlist/module';\nimport * as heatmapPanel from 'app/plugins/panel/heatmap/module';\nimport * as tablePanel from 'app/plugins/panel/table/module';\nimport * as singlestatPanel from 'app/plugins/panel/singlestat/module';\nimport * as gettingStartedPanel from 'app/plugins/panel/gettingstarted/module';\n\nconst builtInPlugins = {\n  'app/plugins/datasource/graphite/module': graphitePlugin,\n  'app/plugins/datasource/cloudwatch/module': cloudwatchPlugin,\n  'app/plugins/datasource/elasticsearch/module': elasticsearchPlugin,\n  'app/plugins/datasource/opentsdb/module': opentsdbPlugin,\n  'app/plugins/datasource/grafana/module': grafanaPlugin,\n  'app/plugins/datasource/influxdb/module': influxdbPlugin,\n  'app/plugins/datasource/logging/module': loggingPlugin,\n  'app/plugins/datasource/mixed/module': mixedPlugin,\n  'app/plugins/datasource/mysql/module': mysqlPlugin,\n  'app/plugins/datasource/postgres/module': postgresPlugin,\n  'app/plugins/datasource/mssql/module': mssqlPlugin,\n  'app/plugins/datasource/prometheus/module': prometheusPlugin,\n  'app/plugins/datasource/testdata/module': testDataDSPlugin,\n  'app/plugins/datasource/stackdriver/module': stackdriverPlugin,\n\n  'app/plugins/panel/text/module': textPanel,\n  'app/plugins/panel/graph/module': graphPanel,\n  'app/plugins/panel/dashlist/module': dashListPanel,\n  'app/plugins/panel/pluginlist/module': pluginsListPanel,\n  'app/plugins/panel/alertlist/module': alertListPanel,\n  'app/plugins/panel/heatmap/module': heatmapPanel,\n  'app/plugins/panel/table/module': tablePanel,\n  'app/plugins/panel/singlestat/module': singlestatPanel,\n  'app/plugins/panel/gettingstarted/module': gettingStartedPanel,\n};\n\nexport default builtInPlugins;\n","import System from 'systemjs/dist/system.js';\nimport _ from 'lodash';\nimport * as sdk from 'app/plugins/sdk';\nimport kbn from 'app/core/utils/kbn';\nimport moment from 'moment';\nimport angular from 'angular';\nimport jquery from 'jquery';\n\n// Experimental module exports\nimport prismjs from 'prismjs';\nimport slate from 'slate';\nimport slateReact from 'slate-react';\nimport slatePlain from 'slate-plain-serializer';\nimport react from 'react';\nimport reactDom from 'react-dom';\n\nimport config from 'app/core/config';\nimport TimeSeries from 'app/core/time_series2';\nimport TableModel from 'app/core/table_model';\nimport { coreModule, appEvents, contextSrv } from 'app/core/core';\nimport * as datemath from 'app/core/utils/datemath';\nimport * as fileExport from 'app/core/utils/file_export';\nimport * as flatten from 'app/core/utils/flatten';\nimport * as ticks from 'app/core/utils/ticks';\nimport impressionSrv from 'app/core/services/impression_srv';\nimport builtInPlugins from './built_in_plugins';\nimport * as d3 from 'd3';\n\n// rxjs\nimport { Observable } from 'rxjs/Observable';\nimport { Subject } from 'rxjs/Subject';\n\n// these imports add functions to Observable\nimport 'rxjs/add/observable/empty';\nimport 'rxjs/add/observable/from';\nimport 'rxjs/add/operator/map';\nimport 'rxjs/add/operator/combineAll';\n\n// add cache busting\nconst bust = `?_cache=${Date.now()}`;\nfunction locate(load) {\n  return load.address + bust;\n}\nSystem.registry.set('plugin-loader', System.newModule({ locate: locate }));\n\nSystem.config({\n  baseURL: 'public',\n  defaultExtension: 'js',\n  packages: {\n    plugins: {\n      defaultExtension: 'js',\n    },\n  },\n  map: {\n    text: 'vendor/plugin-text/text.js',\n    css: 'vendor/plugin-css/css.js',\n  },\n  meta: {\n    '/*': {\n      esModule: true,\n      authorization: true,\n      loader: 'plugin-loader',\n    },\n  },\n});\n\nfunction exposeToPlugin(name: string, component: any) {\n  System.registerDynamic(name, [], true, (require, exports, module) => {\n    module.exports = component;\n  });\n}\n\nexposeToPlugin('lodash', _);\nexposeToPlugin('moment', moment);\nexposeToPlugin('jquery', jquery);\nexposeToPlugin('angular', angular);\nexposeToPlugin('d3', d3);\nexposeToPlugin('rxjs/Subject', Subject);\nexposeToPlugin('rxjs/Observable', Observable);\n\n// Experimental modules\nexposeToPlugin('prismjs', prismjs);\nexposeToPlugin('slate', slate);\nexposeToPlugin('slate-react', slateReact);\nexposeToPlugin('slate-plain-serializer', slatePlain);\nexposeToPlugin('react', react);\nexposeToPlugin('react-dom', reactDom);\n\n// backward compatible path\nexposeToPlugin('vendor/npm/rxjs/Rx', {\n  Subject: Subject,\n  Observable: Observable,\n});\n\nexposeToPlugin('app/features/dashboard/impression_store', {\n  impressions: impressionSrv,\n  __esModule: true,\n});\n\nexposeToPlugin('app/plugins/sdk', sdk);\nexposeToPlugin('app/core/utils/datemath', datemath);\nexposeToPlugin('app/core/utils/file_export', fileExport);\nexposeToPlugin('app/core/utils/flatten', flatten);\nexposeToPlugin('app/core/utils/kbn', kbn);\nexposeToPlugin('app/core/utils/ticks', ticks);\n\nexposeToPlugin('app/core/config', config);\nexposeToPlugin('app/core/time_series', TimeSeries);\nexposeToPlugin('app/core/time_series2', TimeSeries);\nexposeToPlugin('app/core/table_model', TableModel);\nexposeToPlugin('app/core/app_events', appEvents);\nexposeToPlugin('app/core/core_module', coreModule);\nexposeToPlugin('app/core/core', {\n  coreModule: coreModule,\n  appEvents: appEvents,\n  contextSrv: contextSrv,\n  __esModule: true,\n});\n\nimport 'vendor/flot/jquery.flot';\nimport 'vendor/flot/jquery.flot.selection';\nimport 'vendor/flot/jquery.flot.time';\nimport 'vendor/flot/jquery.flot.stack';\nimport 'vendor/flot/jquery.flot.pie';\nimport 'vendor/flot/jquery.flot.stackpercent';\nimport 'vendor/flot/jquery.flot.fillbelow';\nimport 'vendor/flot/jquery.flot.crosshair';\nimport 'vendor/flot/jquery.flot.dashes';\nimport 'vendor/flot/jquery.flot.gauge';\n\nconst flotDeps = [\n  'jquery.flot',\n  'jquery.flot.pie',\n  'jquery.flot.time',\n  'jquery.flot.fillbelow',\n  'jquery.flot.crosshair',\n  'jquery.flot.stack',\n  'jquery.flot.selection',\n  'jquery.flot.stackpercent',\n  'jquery.flot.events',\n  'jquery.flot.gauge',\n];\nfor (const flotDep of flotDeps) {\n  exposeToPlugin(flotDep, { fakeDep: 1 });\n}\n\nexport function importPluginModule(path: string): Promise<any> {\n  const builtIn = builtInPlugins[path];\n  if (builtIn) {\n    return Promise.resolve(builtIn);\n  }\n  return System.import(path);\n}\n\nexport function loadPluginCss(options) {\n  if (config.bootData.user.lightTheme) {\n    System.import(options.light + '!css');\n  } else {\n    System.import(options.dark + '!css');\n  }\n}\n","import _ from 'lodash';\nimport coreModule from 'app/core/core_module';\nimport config from 'app/core/config';\nimport { importPluginModule } from './plugin_loader';\n\nexport class DatasourceSrv {\n  datasources: any;\n\n  /** @ngInject */\n  constructor(private $q, private $injector, private $rootScope, private templateSrv) {\n    this.init();\n  }\n\n  init() {\n    this.datasources = {};\n  }\n\n  get(name?) {\n    if (!name) {\n      return this.get(config.defaultDatasource);\n    }\n\n    name = this.templateSrv.replace(name);\n\n    if (name === 'default') {\n      return this.get(config.defaultDatasource);\n    }\n\n    if (this.datasources[name]) {\n      return this.$q.when(this.datasources[name]);\n    }\n\n    return this.loadDatasource(name);\n  }\n\n  loadDatasource(name) {\n    const dsConfig = config.datasources[name];\n    if (!dsConfig) {\n      return this.$q.reject({ message: 'Datasource named ' + name + ' was not found' });\n    }\n\n    const deferred = this.$q.defer();\n    const pluginDef = dsConfig.meta;\n\n    importPluginModule(pluginDef.module)\n      .then(plugin => {\n        // check if its in cache now\n        if (this.datasources[name]) {\n          deferred.resolve(this.datasources[name]);\n          return;\n        }\n\n        // plugin module needs to export a constructor function named Datasource\n        if (!plugin.Datasource) {\n          throw new Error('Plugin module is missing Datasource constructor');\n        }\n\n        const instance = this.$injector.instantiate(plugin.Datasource, { instanceSettings: dsConfig });\n        instance.meta = pluginDef;\n        instance.name = name;\n        this.datasources[name] = instance;\n        deferred.resolve(instance);\n      })\n      .catch(err => {\n        this.$rootScope.appEvent('alert-error', [dsConfig.name + ' plugin failed', err.toString()]);\n      });\n\n    return deferred.promise;\n  }\n\n  getAll() {\n    return config.datasources;\n  }\n\n  getAnnotationSources() {\n    const sources = [];\n\n    this.addDataSourceVariables(sources);\n\n    _.each(config.datasources, value => {\n      if (value.meta && value.meta.annotations) {\n        sources.push(value);\n      }\n    });\n\n    return sources;\n  }\n\n  getExploreSources() {\n    const { datasources } = config;\n    const es = Object.keys(datasources)\n      .map(name => datasources[name])\n      .filter(ds => ds.meta && ds.meta.explore);\n    return _.sortBy(es, ['name']);\n  }\n\n  getMetricSources(options) {\n    const metricSources = [];\n\n    _.each(config.datasources, (value, key) => {\n      if (value.meta && value.meta.metrics) {\n        let metricSource = { value: key, name: key, meta: value.meta, sort: key };\n\n        //Make sure grafana and mixed are sorted at the bottom\n        if (value.meta.id === 'grafana') {\n          metricSource.sort = String.fromCharCode(253);\n        } else if (value.meta.id === 'mixed') {\n          metricSource.sort = String.fromCharCode(254);\n        }\n\n        metricSources.push(metricSource);\n\n        if (key === config.defaultDatasource) {\n          metricSource = { value: null, name: 'default', meta: value.meta, sort: key };\n          metricSources.push(metricSource);\n        }\n      }\n    });\n\n    if (!options || !options.skipVariables) {\n      this.addDataSourceVariables(metricSources);\n    }\n\n    metricSources.sort((a, b) => {\n      if (a.sort.toLowerCase() > b.sort.toLowerCase()) {\n        return 1;\n      }\n      if (a.sort.toLowerCase() < b.sort.toLowerCase()) {\n        return -1;\n      }\n      return 0;\n    });\n\n    return metricSources;\n  }\n\n  addDataSourceVariables(list) {\n    // look for data source variables\n    for (let i = 0; i < this.templateSrv.variables.length; i++) {\n      const variable = this.templateSrv.variables[i];\n      if (variable.type !== 'datasource') {\n        continue;\n      }\n\n      let first = variable.current.value;\n      if (first === 'default') {\n        first = config.defaultDatasource;\n      }\n\n      const ds = config.datasources[first];\n\n      if (ds) {\n        const key = `$${variable.name}`;\n        list.push({\n          name: key,\n          value: key,\n          meta: ds.meta,\n          sort: key,\n        });\n      }\n    }\n  }\n}\n\ncoreModule.service('datasourceSrv', DatasourceSrv);\nexport default DatasourceSrv;\n","import angular from 'angular';\nimport _ from 'lodash';\n\nimport config from 'app/core/config';\nimport coreModule from 'app/core/core_module';\nimport { importPluginModule } from './plugin_loader';\n\nimport { UnknownPanelCtrl } from 'app/plugins/panel/unknown/module';\n\n/** @ngInject */\nfunction pluginDirectiveLoader($compile, datasourceSrv, $rootScope, $q, $http, $templateCache) {\n  function getTemplate(component) {\n    if (component.template) {\n      return $q.when(component.template);\n    }\n    const cached = $templateCache.get(component.templateUrl);\n    if (cached) {\n      return $q.when(cached);\n    }\n    return $http.get(component.templateUrl).then(res => {\n      return res.data;\n    });\n  }\n\n  function relativeTemplateUrlToAbs(templateUrl, baseUrl) {\n    if (!templateUrl) {\n      return undefined;\n    }\n    if (templateUrl.indexOf('public') === 0) {\n      return templateUrl;\n    }\n    return baseUrl + '/' + templateUrl;\n  }\n\n  function getPluginComponentDirective(options) {\n    // handle relative template urls for plugin templates\n    options.Component.templateUrl = relativeTemplateUrlToAbs(options.Component.templateUrl, options.baseUrl);\n\n    return () => {\n      return {\n        templateUrl: options.Component.templateUrl,\n        template: options.Component.template,\n        restrict: 'E',\n        controller: options.Component,\n        controllerAs: 'ctrl',\n        bindToController: true,\n        scope: options.bindings,\n        link: (scope, elem, attrs, ctrl) => {\n          if (ctrl.link) {\n            ctrl.link(scope, elem, attrs, ctrl);\n          }\n          if (ctrl.init) {\n            ctrl.init();\n          }\n        },\n      };\n    };\n  }\n\n  function loadPanelComponentInfo(scope, attrs) {\n    const componentInfo: any = {\n      name: 'panel-plugin-' + scope.panel.type,\n      bindings: { dashboard: '=', panel: '=', row: '=' },\n      attrs: {\n        dashboard: 'dashboard',\n        panel: 'panel',\n        class: 'panel-height-helper',\n      },\n    };\n\n    const panelInfo = config.panels[scope.panel.type];\n    let panelCtrlPromise = Promise.resolve(UnknownPanelCtrl);\n    if (panelInfo) {\n      panelCtrlPromise = importPluginModule(panelInfo.module).then(panelModule => {\n        return panelModule.PanelCtrl;\n      });\n    }\n\n    return panelCtrlPromise.then((PanelCtrl: any) => {\n      componentInfo.Component = PanelCtrl;\n\n      if (!PanelCtrl || PanelCtrl.registered) {\n        return componentInfo;\n      }\n\n      if (PanelCtrl.templatePromise) {\n        return PanelCtrl.templatePromise.then(res => {\n          return componentInfo;\n        });\n      }\n\n      if (panelInfo) {\n        PanelCtrl.templateUrl = relativeTemplateUrlToAbs(PanelCtrl.templateUrl, panelInfo.baseUrl);\n      }\n\n      PanelCtrl.templatePromise = getTemplate(PanelCtrl).then(template => {\n        PanelCtrl.templateUrl = null;\n        PanelCtrl.template = `<grafana-panel ctrl=\"ctrl\" class=\"panel-height-helper\">${template}</grafana-panel>`;\n        return componentInfo;\n      });\n\n      return PanelCtrl.templatePromise;\n    });\n  }\n\n  function getModule(scope, attrs) {\n    switch (attrs.type) {\n      // QueryCtrl\n      case 'query-ctrl': {\n        const datasource = scope.target.datasource || scope.ctrl.panel.datasource;\n        return datasourceSrv.get(datasource).then(ds => {\n          scope.datasource = ds;\n\n          return importPluginModule(ds.meta.module).then(dsModule => {\n            return {\n              baseUrl: ds.meta.baseUrl,\n              name: 'query-ctrl-' + ds.meta.id,\n              bindings: { target: '=', panelCtrl: '=', datasource: '=' },\n              attrs: {\n                target: 'target',\n                'panel-ctrl': 'ctrl.panelCtrl',\n                datasource: 'datasource',\n              },\n              Component: dsModule.QueryCtrl,\n            };\n          });\n        });\n      }\n      // Annotations\n      case 'annotations-query-ctrl': {\n        return importPluginModule(scope.ctrl.currentDatasource.meta.module).then(dsModule => {\n          return {\n            baseUrl: scope.ctrl.currentDatasource.meta.baseUrl,\n            name: 'annotations-query-ctrl-' + scope.ctrl.currentDatasource.meta.id,\n            bindings: { annotation: '=', datasource: '=' },\n            attrs: {\n              annotation: 'ctrl.currentAnnotation',\n              datasource: 'ctrl.currentDatasource',\n            },\n            Component: dsModule.AnnotationsQueryCtrl,\n          };\n        });\n      }\n      // Datasource ConfigCtrl\n      case 'datasource-config-ctrl': {\n        const dsMeta = scope.ctrl.datasourceMeta;\n        return importPluginModule(dsMeta.module).then((dsModule): any => {\n          if (!dsModule.ConfigCtrl) {\n            return { notFound: true };\n          }\n\n          return {\n            baseUrl: dsMeta.baseUrl,\n            name: 'ds-config-' + dsMeta.id,\n            bindings: { meta: '=', current: '=' },\n            attrs: { meta: 'ctrl.datasourceMeta', current: 'ctrl.current' },\n            Component: dsModule.ConfigCtrl,\n          };\n        });\n      }\n      // AppConfigCtrl\n      case 'app-config-ctrl': {\n        const model = scope.ctrl.model;\n        return importPluginModule(model.module).then(appModule => {\n          return {\n            baseUrl: model.baseUrl,\n            name: 'app-config-' + model.id,\n            bindings: { appModel: '=', appEditCtrl: '=' },\n            attrs: { 'app-model': 'ctrl.model', 'app-edit-ctrl': 'ctrl' },\n            Component: appModule.ConfigCtrl,\n          };\n        });\n      }\n      // App Page\n      case 'app-page': {\n        const appModel = scope.ctrl.appModel;\n        return importPluginModule(appModel.module).then(appModule => {\n          return {\n            baseUrl: appModel.baseUrl,\n            name: 'app-page-' + appModel.id + '-' + scope.ctrl.page.slug,\n            bindings: { appModel: '=' },\n            attrs: { 'app-model': 'ctrl.appModel' },\n            Component: appModule[scope.ctrl.page.component],\n          };\n        });\n      }\n      // Panel\n      case 'panel': {\n        return loadPanelComponentInfo(scope, attrs);\n      }\n      default: {\n        return $q.reject({\n          message: 'Could not find component type: ' + attrs.type,\n        });\n      }\n    }\n  }\n\n  function appendAndCompile(scope, elem, componentInfo) {\n    const child = angular.element(document.createElement(componentInfo.name));\n    _.each(componentInfo.attrs, (value, key) => {\n      child.attr(key, value);\n    });\n\n    $compile(child)(scope);\n    elem.empty();\n\n    // let a binding digest cycle complete before adding to dom\n    setTimeout(() => {\n      elem.append(child);\n      scope.$applyAsync(() => {\n        scope.$broadcast('component-did-mount');\n        scope.$broadcast('refresh');\n      });\n    });\n  }\n\n  function registerPluginComponent(scope, elem, attrs, componentInfo) {\n    if (componentInfo.notFound) {\n      elem.empty();\n      return;\n    }\n\n    if (!componentInfo.Component) {\n      throw {\n        message: 'Failed to find exported plugin component for ' + componentInfo.name,\n      };\n    }\n\n    if (!componentInfo.Component.registered) {\n      const directiveName = attrs.$normalize(componentInfo.name);\n      const directiveFn = getPluginComponentDirective(componentInfo);\n      coreModule.directive(directiveName, directiveFn);\n      componentInfo.Component.registered = true;\n    }\n\n    appendAndCompile(scope, elem, componentInfo);\n  }\n\n  return {\n    restrict: 'E',\n    link: (scope, elem, attrs) => {\n      getModule(scope, attrs)\n        .then(componentInfo => {\n          registerPluginComponent(scope, elem, attrs, componentInfo);\n        })\n        .catch(err => {\n          $rootScope.appEvent('alert-error', ['Plugin Error', err.message || err]);\n          console.log('Plugin component error', err);\n        });\n    },\n  };\n}\n\ncoreModule.directive('pluginComponent', pluginDirectiveLoader);\n","import { PanelCtrl } from 'app/features/panel/panel_ctrl';\n\nexport class UnknownPanelCtrl extends PanelCtrl {\n  static templateUrl = 'public/app/plugins/panel/unknown/module.html';\n\n  /** @ngInject */\n  constructor($scope, $injector) {\n    super($scope, $injector);\n  }\n}\n","import config from 'app/core/config';\n\nimport coreModule from 'app/core/core_module';\nimport { PanelContainer } from './dashgrid/PanelContainer';\nimport { DashboardModel } from './dashboard_model';\nimport { PanelModel } from './panel_model';\n\nexport class DashboardCtrl implements PanelContainer {\n  dashboard: DashboardModel;\n  dashboardViewState: any;\n  loadedFallbackDashboard: boolean;\n  editTab: number;\n\n  /** @ngInject */\n  constructor(\n    private $scope,\n    private $rootScope,\n    private keybindingSrv,\n    private timeSrv,\n    private variableSrv,\n    private alertingSrv,\n    private dashboardSrv,\n    private unsavedChangesSrv,\n    private dashboardViewStateSrv,\n    public playlistSrv,\n    private panelLoader\n  ) {\n    // temp hack due to way dashboards are loaded\n    // can't use controllerAs on route yet\n    $scope.ctrl = this;\n\n    // TODO: break out settings view to separate view & controller\n    this.editTab = 0;\n\n    // funcs called from React component bindings and needs this binding\n    this.getPanelContainer = this.getPanelContainer.bind(this);\n  }\n\n  setupDashboard(data) {\n    try {\n      this.setupDashboardInternal(data);\n    } catch (err) {\n      this.onInitFailed(err, 'Dashboard init failed', true);\n    }\n  }\n\n  setupDashboardInternal(data) {\n    const dashboard = this.dashboardSrv.create(data.dashboard, data.meta);\n    this.dashboardSrv.setCurrent(dashboard);\n\n    // init services\n    this.timeSrv.init(dashboard);\n    this.alertingSrv.init(dashboard, data.alerts);\n\n    // template values service needs to initialize completely before\n    // the rest of the dashboard can load\n    this.variableSrv\n      .init(dashboard)\n      // template values failes are non fatal\n      .catch(this.onInitFailed.bind(this, 'Templating init failed', false))\n      // continue\n      .finally(() => {\n        this.dashboard = dashboard;\n        this.dashboard.processRepeats();\n        this.dashboard.updateSubmenuVisibility();\n        this.dashboard.autoFitPanels(window.innerHeight);\n\n        this.unsavedChangesSrv.init(dashboard, this.$scope);\n\n        // TODO refactor ViewStateSrv\n        this.$scope.dashboard = dashboard;\n        this.dashboardViewState = this.dashboardViewStateSrv.create(this.$scope);\n\n        this.keybindingSrv.setupDashboardBindings(this.$scope, dashboard);\n        this.setWindowTitleAndTheme();\n\n        this.$scope.appEvent('dashboard-initialized', dashboard);\n      })\n      .catch(this.onInitFailed.bind(this, 'Dashboard init failed', true));\n  }\n\n  onInitFailed(msg, fatal, err) {\n    console.log(msg, err);\n\n    if (err.data && err.data.message) {\n      err.message = err.data.message;\n    } else if (!err.message) {\n      err = { message: err.toString() };\n    }\n\n    this.$scope.appEvent('alert-error', [msg, err.message]);\n\n    // protect against  recursive fallbacks\n    if (fatal && !this.loadedFallbackDashboard) {\n      this.loadedFallbackDashboard = true;\n      this.setupDashboard({ dashboard: { title: 'Dashboard Init failed' } });\n    }\n  }\n\n  templateVariableUpdated() {\n    this.dashboard.processRepeats();\n  }\n\n  setWindowTitleAndTheme() {\n    window.document.title = config.windowTitlePrefix + this.dashboard.title;\n  }\n\n  showJsonEditor(evt, options) {\n    const editScope = this.$rootScope.$new();\n    editScope.object = options.object;\n    editScope.updateHandler = options.updateHandler;\n    this.$scope.appEvent('show-dash-editor', {\n      src: 'public/app/partials/edit_json.html',\n      scope: editScope,\n    });\n  }\n\n  getDashboard() {\n    return this.dashboard;\n  }\n\n  getPanelLoader() {\n    return this.panelLoader;\n  }\n\n  timezoneChanged() {\n    this.$rootScope.$broadcast('refresh');\n  }\n\n  getPanelContainer() {\n    return this;\n  }\n\n  onRemovingPanel(evt, options) {\n    options = options || {};\n    if (!options.panelId) {\n      return;\n    }\n\n    const panelInfo = this.dashboard.getPanelInfoById(options.panelId);\n    this.removePanel(panelInfo.panel, true);\n  }\n\n  removePanel(panel: PanelModel, ask: boolean) {\n    // confirm deletion\n    if (ask !== false) {\n      let text2, confirmText;\n\n      if (panel.alert) {\n        text2 = 'Panel includes an alert rule, removing panel will also remove alert rule';\n        confirmText = 'YES';\n      }\n\n      this.$scope.appEvent('confirm-modal', {\n        title: 'Remove Panel',\n        text: 'Are you sure you want to remove this panel?',\n        text2: text2,\n        icon: 'fa-trash',\n        confirmText: confirmText,\n        yesText: 'Remove',\n        onConfirm: () => {\n          this.removePanel(panel, false);\n        },\n      });\n      return;\n    }\n\n    this.dashboard.removePanel(panel);\n  }\n\n  init(dashboard) {\n    this.$scope.onAppEvent('show-json-editor', this.showJsonEditor.bind(this));\n    this.$scope.onAppEvent('template-variable-value-updated', this.templateVariableUpdated.bind(this));\n    this.$scope.onAppEvent('panel-remove', this.onRemovingPanel.bind(this));\n    this.setupDashboard(dashboard);\n  }\n}\n\ncoreModule.controller('DashboardCtrl', DashboardCtrl);\n","import './plugin_edit_ctrl';\nimport './plugin_page_ctrl';\nimport './import_list/import_list';\nimport './ds_edit_ctrl';\nimport './ds_dashboards_ctrl';\nimport './datasource_srv';\nimport './plugin_component';\n","import './history_srv';\n\nimport _ from 'lodash';\nimport angular from 'angular';\nimport moment from 'moment';\n\nimport locationUtil from 'app/core/utils/location_util';\nimport { DashboardModel } from '../dashboard_model';\nimport { HistoryListOpts, RevisionsModel, CalculateDiffOptions, HistorySrv } from './history_srv';\n\nexport class HistoryListCtrl {\n  appending: boolean;\n  dashboard: DashboardModel;\n  delta: { basic: string; json: string };\n  diff: string;\n  limit: number;\n  loading: boolean;\n  max: number;\n  mode: string;\n  revisions: RevisionsModel[];\n  start: number;\n  newInfo: RevisionsModel;\n  baseInfo: RevisionsModel;\n  canCompare: boolean;\n  isNewLatest: boolean;\n\n  /** @ngInject */\n  constructor(\n    private $route,\n    private $rootScope,\n    private $location,\n    private $q,\n    private historySrv: HistorySrv,\n    public $scope\n  ) {\n    this.appending = false;\n    this.diff = 'basic';\n    this.limit = 10;\n    this.loading = false;\n    this.max = 2;\n    this.mode = 'list';\n    this.start = 0;\n    this.canCompare = false;\n\n    this.$rootScope.onAppEvent('dashboard-saved', this.onDashboardSaved.bind(this), $scope);\n    this.resetFromSource();\n  }\n\n  onDashboardSaved() {\n    this.resetFromSource();\n  }\n\n  switchMode(mode: string) {\n    this.mode = mode;\n    if (this.mode === 'list') {\n      this.reset();\n    }\n  }\n\n  dismiss() {\n    this.$rootScope.appEvent('hide-dash-editor');\n  }\n\n  addToLog() {\n    this.start = this.start + this.limit;\n    this.getLog(true);\n  }\n\n  revisionSelectionChanged() {\n    const selected = _.filter(this.revisions, { checked: true }).length;\n    this.canCompare = selected === 2;\n  }\n\n  formatDate(date) {\n    return this.dashboard.formatDate(date);\n  }\n\n  formatBasicDate(date) {\n    const now = this.dashboard.timezone === 'browser' ? moment() : moment.utc();\n    const then = this.dashboard.timezone === 'browser' ? moment(date) : moment.utc(date);\n    return then.from(now);\n  }\n\n  getDiff(diff: string) {\n    this.diff = diff;\n    this.mode = 'compare';\n\n    // have it already been fetched?\n    if (this.delta[this.diff]) {\n      return this.$q.when(this.delta[this.diff]);\n    }\n\n    const selected = _.filter(this.revisions, { checked: true });\n\n    this.newInfo = selected[0];\n    this.baseInfo = selected[1];\n    this.isNewLatest = this.newInfo.version === this.dashboard.version;\n\n    this.loading = true;\n    const options: CalculateDiffOptions = {\n      new: {\n        dashboardId: this.dashboard.id,\n        version: this.newInfo.version,\n      },\n      base: {\n        dashboardId: this.dashboard.id,\n        version: this.baseInfo.version,\n      },\n      diffType: diff,\n    };\n\n    return this.historySrv\n      .calculateDiff(options)\n      .then(response => {\n        this.delta[this.diff] = response;\n      })\n      .catch(() => {\n        this.mode = 'list';\n      })\n      .finally(() => {\n        this.loading = false;\n      });\n  }\n\n  getLog(append = false) {\n    this.loading = !append;\n    this.appending = append;\n    const options: HistoryListOpts = {\n      limit: this.limit,\n      start: this.start,\n    };\n\n    return this.historySrv\n      .getHistoryList(this.dashboard, options)\n      .then(revisions => {\n        // set formatted dates & default values\n        for (const rev of revisions) {\n          rev.createdDateString = this.formatDate(rev.created);\n          rev.ageString = this.formatBasicDate(rev.created);\n          rev.checked = false;\n        }\n\n        this.revisions = append ? this.revisions.concat(revisions) : revisions;\n      })\n      .catch(err => {\n        this.loading = false;\n      })\n      .finally(() => {\n        this.loading = false;\n        this.appending = false;\n      });\n  }\n\n  isLastPage() {\n    return _.find(this.revisions, rev => rev.version === 1);\n  }\n\n  reset() {\n    this.delta = { basic: '', json: '' };\n    this.diff = 'basic';\n    this.mode = 'list';\n    this.revisions = _.map(this.revisions, rev => _.extend({}, rev, { checked: false }));\n    this.canCompare = false;\n    this.start = 0;\n    this.isNewLatest = false;\n  }\n\n  resetFromSource() {\n    this.revisions = [];\n    return this.getLog().then(this.reset.bind(this));\n  }\n\n  restore(version: number) {\n    this.$rootScope.appEvent('confirm-modal', {\n      title: 'Restore version',\n      text: '',\n      text2: `Are you sure you want to restore the dashboard to version ${version}? All unsaved changes will be lost.`,\n      icon: 'fa-history',\n      yesText: `Yes, restore to version ${version}`,\n      onConfirm: this.restoreConfirm.bind(this, version),\n    });\n  }\n\n  restoreConfirm(version: number) {\n    this.loading = true;\n    return this.historySrv\n      .restoreDashboard(this.dashboard, version)\n      .then(response => {\n        this.$location.url(locationUtil.stripBaseFromUrl(response.url)).replace();\n        this.$route.reload();\n        this.$rootScope.appEvent('alert-success', ['Dashboard restored', 'Restored from version ' + version]);\n      })\n      .catch(() => {\n        this.mode = 'list';\n        this.loading = false;\n      });\n  }\n}\n\nexport function dashboardHistoryDirective() {\n  return {\n    restrict: 'E',\n    templateUrl: 'public/app/features/dashboard/history/history.html',\n    controller: HistoryListCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: {\n      dashboard: '=',\n    },\n  };\n}\n\nangular.module('grafana.directives').directive('gfDashboardHistory', dashboardHistoryDirective);\n","import coreModule from 'app/core/core_module';\n\nexport class AlertingSrv {\n  dashboard: any;\n  alerts: any[];\n\n  init(dashboard, alerts) {\n    this.dashboard = dashboard;\n    this.alerts = alerts || [];\n  }\n}\n\ncoreModule.service('alertingSrv', AlertingSrv);\n","import _ from 'lodash';\nimport coreModule from 'app/core/core_module';\nimport { DashboardModel } from '../dashboard_model';\n\nexport interface HistoryListOpts {\n  limit: number;\n  start: number;\n}\n\nexport interface RevisionsModel {\n  id: number;\n  checked: boolean;\n  dashboardId: number;\n  parentVersion: number;\n  version: number;\n  created: Date;\n  createdBy: string;\n  message: string;\n}\n\nexport interface CalculateDiffOptions {\n  new: DiffTarget;\n  base: DiffTarget;\n  diffType: string;\n}\n\nexport interface DiffTarget {\n  dashboardId: number;\n  version: number;\n  unsavedDashboard?: DashboardModel; // when doing diffs against unsaved dashboard version\n}\n\nexport class HistorySrv {\n  /** @ngInject */\n  constructor(private backendSrv) {}\n\n  getHistoryList(dashboard: DashboardModel, options: HistoryListOpts) {\n    const id = dashboard && dashboard.id ? dashboard.id : void 0;\n    return id ? this.backendSrv.get(`api/dashboards/id/${id}/versions`, options) : Promise.resolve([]);\n  }\n\n  calculateDiff(options: CalculateDiffOptions) {\n    return this.backendSrv.post('api/dashboards/calculate-diff', options);\n  }\n\n  restoreDashboard(dashboard: DashboardModel, version: number) {\n    const id = dashboard && dashboard.id ? dashboard.id : void 0;\n    const url = `api/dashboards/id/${id}/restore`;\n\n    return id && _.isNumber(version) ? this.backendSrv.post(url, { version }) : Promise.resolve({});\n  }\n}\n\ncoreModule.service('historySrv', HistorySrv);\n","import angular from 'angular';\nimport moment from 'moment';\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport kbn from 'app/core/utils/kbn';\nimport * as dateMath from 'app/core/utils/datemath';\nimport impressionSrv from 'app/core/services/impression_srv';\n\nexport class DashboardLoaderSrv {\n  /** @ngInject */\n  constructor(\n    private backendSrv,\n    private dashboardSrv,\n    private datasourceSrv,\n    private $http,\n    private $q,\n    private $timeout,\n    contextSrv,\n    private $routeParams,\n    private $rootScope\n  ) {}\n\n  _dashboardLoadFailed(title, snapshot?) {\n    snapshot = snapshot || false;\n    return {\n      meta: {\n        canStar: false,\n        isSnapshot: snapshot,\n        canDelete: false,\n        canSave: false,\n        canEdit: false,\n        dashboardNotFound: true,\n      },\n      dashboard: { title: title },\n    };\n  }\n\n  loadDashboard(type, slug, uid) {\n    let promise;\n\n    if (type === 'script') {\n      promise = this._loadScriptedDashboard(slug);\n    } else if (type === 'snapshot') {\n      promise = this.backendSrv.get('/api/snapshots/' + slug).catch(() => {\n        return this._dashboardLoadFailed('Snapshot not found', true);\n      });\n    } else {\n      promise = this.backendSrv\n        .getDashboardByUid(uid)\n        .then(result => {\n          if (result.meta.isFolder) {\n            this.$rootScope.appEvent('alert-error', ['Dashboard not found']);\n            throw new Error('Dashboard not found');\n          }\n          return result;\n        })\n        .catch(() => {\n          return this._dashboardLoadFailed('Not found', true);\n        });\n    }\n\n    promise.then(result => {\n      if (result.meta.dashboardNotFound !== true) {\n        impressionSrv.addDashboardImpression(result.dashboard.id);\n      }\n\n      return result;\n    });\n\n    return promise;\n  }\n\n  _loadScriptedDashboard(file) {\n    const url = 'public/dashboards/' + file.replace(/\\.(?!js)/, '/') + '?' + new Date().getTime();\n\n    return this.$http({ url: url, method: 'GET' })\n      .then(this._executeScript.bind(this))\n      .then(\n        result => {\n          return {\n            meta: {\n              fromScript: true,\n              canDelete: false,\n              canSave: false,\n              canStar: false,\n            },\n            dashboard: result.data,\n          };\n        },\n        err => {\n          console.log('Script dashboard error ' + err);\n          this.$rootScope.appEvent('alert-error', [\n            'Script Error',\n            'Please make sure it exists and returns a valid dashboard',\n          ]);\n          return this._dashboardLoadFailed('Scripted dashboard');\n        }\n      );\n  }\n\n  _executeScript(result) {\n    const services = {\n      dashboardSrv: this.dashboardSrv,\n      datasourceSrv: this.datasourceSrv,\n      $q: this.$q,\n    };\n\n    /*jshint -W054 */\n    const scriptFunc = new Function(\n      'ARGS',\n      'kbn',\n      'dateMath',\n      '_',\n      'moment',\n      'window',\n      'document',\n      '$',\n      'jQuery',\n      'services',\n      result.data\n    );\n    const scriptResult = scriptFunc(this.$routeParams, kbn, dateMath, _, moment, window, document, $, $, services);\n\n    // Handle async dashboard scripts\n    if (_.isFunction(scriptResult)) {\n      const deferred = this.$q.defer();\n      scriptResult(dashboard => {\n        this.$timeout(() => {\n          deferred.resolve({ data: dashboard });\n        });\n      });\n      return deferred.promise;\n    }\n\n    return { data: scriptResult };\n  }\n}\n\nangular.module('grafana.services').service('dashboardLoaderSrv', DashboardLoaderSrv);\n","import moment from 'moment';\nimport angular from 'angular';\nimport { appEvents, NavModel } from 'app/core/core';\nimport { DashboardModel } from '../dashboard_model';\n\nexport class DashNavCtrl {\n  dashboard: DashboardModel;\n  navModel: NavModel;\n  titleTooltip: string;\n\n  /** @ngInject */\n  constructor(private $scope, private dashboardSrv, private $location, public playlistSrv) {\n    appEvents.on('save-dashboard', this.saveDashboard.bind(this), $scope);\n\n    if (this.dashboard.meta.isSnapshot) {\n      const meta = this.dashboard.meta;\n      this.titleTooltip = 'Created: &nbsp;' + moment(meta.created).calendar();\n      if (meta.expires) {\n        this.titleTooltip += '<br>Expires: &nbsp;' + moment(meta.expires).fromNow() + '<br>';\n      }\n    }\n  }\n\n  toggleSettings() {\n    const search = this.$location.search();\n    if (search.editview) {\n      delete search.editview;\n    } else {\n      search.editview = 'settings';\n    }\n    this.$location.search(search);\n  }\n\n  toggleViewMode() {\n    appEvents.emit('toggle-kiosk-mode');\n  }\n\n  close() {\n    const search = this.$location.search();\n    if (search.editview) {\n      delete search.editview;\n    } else if (search.fullscreen) {\n      delete search.fullscreen;\n      delete search.edit;\n    }\n    this.$location.search(search);\n  }\n\n  starDashboard() {\n    this.dashboardSrv.starDashboard(this.dashboard.id, this.dashboard.meta.isStarred).then(newState => {\n      this.dashboard.meta.isStarred = newState;\n    });\n  }\n\n  shareDashboard(tabIndex) {\n    const modalScope = this.$scope.$new();\n    modalScope.tabIndex = tabIndex;\n    modalScope.dashboard = this.dashboard;\n\n    appEvents.emit('show-modal', {\n      src: 'public/app/features/dashboard/partials/shareModal.html',\n      scope: modalScope,\n    });\n  }\n\n  hideTooltip(evt) {\n    angular.element(evt.currentTarget).tooltip('hide');\n  }\n\n  saveDashboard() {\n    return this.dashboardSrv.saveDashboard();\n  }\n\n  showSearch() {\n    appEvents.emit('show-dash-search');\n  }\n\n  addPanel() {\n    appEvents.emit('dash-scroll', { animate: true, evt: 0 });\n\n    if (this.dashboard.panels.length > 0 && this.dashboard.panels[0].type === 'add-panel') {\n      return; // Return if the \"Add panel\" exists already\n    }\n\n    this.dashboard.addPanel({\n      type: 'add-panel',\n      gridPos: { x: 0, y: 0, w: 12, h: 9 },\n      title: 'Panel Title',\n    });\n  }\n\n  navItemClicked(navItem, evt) {\n    if (navItem.clickHandler) {\n      navItem.clickHandler();\n      evt.preventDefault();\n    }\n  }\n}\n\nexport function dashNavDirective() {\n  return {\n    restrict: 'E',\n    templateUrl: 'public/app/features/dashboard/dashnav/dashnav.html',\n    controller: DashNavCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    transclude: true,\n    scope: { dashboard: '=' },\n  };\n}\n\nangular.module('grafana.directives').directive('dashnav', dashNavDirective);\n","import angular from 'angular';\nimport _ from 'lodash';\n\nexport class SubmenuCtrl {\n  annotations: any;\n  variables: any;\n  dashboard: any;\n\n  /** @ngInject */\n  constructor(private $rootScope, private variableSrv, private $location) {\n    this.annotations = this.dashboard.templating.list;\n    this.variables = this.variableSrv.variables;\n  }\n\n  annotationStateChanged() {\n    this.$rootScope.$broadcast('refresh');\n  }\n\n  variableUpdated(variable) {\n    this.variableSrv.variableUpdated(variable, true);\n  }\n\n  openEditView(editview) {\n    const search = _.extend(this.$location.search(), { editview: editview });\n    this.$location.search(search);\n  }\n}\n\nexport function submenuDirective() {\n  return {\n    restrict: 'E',\n    templateUrl: 'public/app/features/dashboard/submenu/submenu.html',\n    controller: SubmenuCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: {\n      dashboard: '=',\n    },\n  };\n}\n\nangular.module('grafana.directives').directive('dashboardSubmenu', submenuDirective);\n","import coreModule from 'app/core/core_module';\n\nconst template = `\n<div class=\"modal-body\">\n\t<div class=\"modal-header\">\n\t\t<h2 class=\"modal-header-title\">\n\t\t\t<i class=\"fa fa-copy\"></i>\n\t\t\t<span class=\"p-l-1\">Save As...</span>\n\t\t</h2>\n\n\t\t<a class=\"modal-header-close\" ng-click=\"ctrl.dismiss();\">\n\t\t\t<i class=\"fa fa-remove\"></i>\n\t\t</a>\n\t</div>\n\n\t<form name=\"ctrl.saveForm\" class=\"modal-content\" novalidate>\n\t\t<div class=\"p-t-2\">\n\t\t\t<div class=\"gf-form\">\n\t\t\t\t<label class=\"gf-form-label width-7\">New name</label>\n\t\t\t\t<input type=\"text\" class=\"gf-form-input\" ng-model=\"ctrl.clone.title\" give-focus=\"true\" required>\n\t\t\t</div>\n      <div class=\"gf-form\">\n        <folder-picker initial-folder-id=\"ctrl.folderId\"\n                       on-change=\"ctrl.onFolderChange($folder)\"\n                       enter-folder-creation=\"ctrl.onEnterFolderCreation()\"\n                       exit-folder-creation=\"ctrl.onExitFolderCreation()\"\n                       enable-create-new=\"true\"\n                       label-class=\"width-7\">\n        </folder-picker>\n      </div>\n\t\t</div>\n\n\t\t<div class=\"gf-form-button-row text-center\">\n\t\t\t<button type=\"submit\" class=\"btn btn-success\" ng-click=\"ctrl.save()\" ng-disabled=\"!ctrl.isValidFolderSelection\">Save</button>\n\t\t\t<a class=\"btn-text\" ng-click=\"ctrl.dismiss();\">Cancel</a>\n\t\t</div>\n\t</form>\n</div>\n`;\n\nexport class SaveDashboardAsModalCtrl {\n  clone: any;\n  folderId: any;\n  dismiss: () => void;\n  isValidFolderSelection = true;\n\n  /** @ngInject */\n  constructor(private dashboardSrv) {\n    const dashboard = this.dashboardSrv.getCurrent();\n    this.clone = dashboard.getSaveModelClone();\n    this.clone.id = null;\n    this.clone.uid = '';\n    this.clone.title += ' Copy';\n    this.clone.editable = true;\n    this.clone.hideControls = false;\n    this.folderId = dashboard.meta.folderId;\n\n    // remove alerts if source dashboard is already persisted\n    // do not want to create alert dupes\n    if (dashboard.id > 0) {\n      this.clone.panels.forEach(panel => {\n        if (panel.type === 'graph' && panel.alert) {\n          delete panel.thresholds;\n        }\n        delete panel.alert;\n      });\n    }\n\n    delete this.clone.autoUpdate;\n  }\n\n  save() {\n    return this.dashboardSrv.save(this.clone, { folderId: this.folderId }).then(this.dismiss);\n  }\n\n  keyDown(evt) {\n    if (evt.keyCode === 13) {\n      this.save();\n    }\n  }\n\n  onFolderChange(folder) {\n    this.folderId = folder.id;\n  }\n\n  onEnterFolderCreation() {\n    this.isValidFolderSelection = false;\n  }\n\n  onExitFolderCreation() {\n    this.isValidFolderSelection = true;\n  }\n}\n\nexport function saveDashboardAsDirective() {\n  return {\n    restrict: 'E',\n    template: template,\n    controller: SaveDashboardAsModalCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: { dismiss: '&' },\n  };\n}\n\ncoreModule.directive('saveDashboardAsModal', saveDashboardAsDirective);\n","import coreModule from 'app/core/core_module';\n\nconst template = `\n<div class=\"modal-body\">\n  <div class=\"modal-header\">\n    <h2 class=\"modal-header-title\">\n      <i class=\"fa fa-save\"></i>\n      <span class=\"p-l-1\">Save changes</span>\n    </h2>\n\n    <a class=\"modal-header-close\" ng-click=\"ctrl.dismiss();\">\n      <i class=\"fa fa-remove\"></i>\n    </a>\n  </div>\n\n  <form name=\"ctrl.saveForm\" ng-submit=\"ctrl.save()\" class=\"modal-content\" novalidate>\n    <div class=\"p-t-1\">\n      <div class=\"gf-form-group\" ng-if=\"ctrl.timeChange || ctrl.variableValueChange\">\n\t\t    <gf-form-switch class=\"gf-form\"\n\t\t\t    label=\"Save current time range\" ng-if=\"ctrl.timeChange\" label-class=\"width-12\" switch-class=\"max-width-6\"\n\t\t\t    checked=\"ctrl.saveTimerange\" on-change=\"buildUrl()\">\n\t\t    </gf-form-switch>\n\t\t    <gf-form-switch class=\"gf-form\"\n\t\t\t    label=\"Save current variables\" ng-if=\"ctrl.variableValueChange\" label-class=\"width-12\" switch-class=\"max-width-6\"\n\t\t\t    checked=\"ctrl.saveVariables\" on-change=\"buildUrl()\">\n\t\t    </gf-form-switch>\n\t    </div>\n      <div class=\"gf-form\">\n        <label class=\"gf-form-hint\">\n          <input\n            type=\"text\"\n            name=\"message\"\n            class=\"gf-form-input\"\n            placeholder=\"Add a note to describe your changes &hellip;\"\n            give-focus=\"true\"\n            ng-model=\"ctrl.message\"\n            ng-model-options=\"{allowInvalid: true}\"\n            ng-maxlength=\"this.max\"\n            maxlength=\"64\"\n            autocomplete=\"off\" />\n          <small class=\"gf-form-hint-text muted\" ng-cloak>\n            <span ng-class=\"{'text-error': ctrl.saveForm.message.$invalid && ctrl.saveForm.message.$dirty }\">\n              {{ctrl.message.length || 0}}\n            </span>\n            / {{ctrl.max}} characters\n          </small>\n        </label>\n      </div>\n    </div>\n\n    <div class=\"gf-form-button-row text-center\">\n      <button\n        id=\"saveBtn\"\n        type=\"submit\"\n        class=\"btn btn-success\"\n        ng-class=\"{'btn-success--processing': ctrl.isSaving}\"\n        ng-disabled=\"ctrl.saveForm.$invalid || ctrl.isSaving\"\n      >\n        <span ng-if=\"!ctrl.isSaving\">Save</span>\n        <span ng-if=\"ctrl.isSaving === true\">Saving...</span>\n      </button>\n      <button class=\"btn btn-inverse\" ng-click=\"ctrl.dismiss();\">Cancel</button>\n    </div>\n  </form>\n</div>\n`;\n\nexport class SaveDashboardModalCtrl {\n  message: string;\n  saveVariables = false;\n  saveTimerange = false;\n  time: any;\n  originalTime: any;\n  current = [];\n  originalCurrent = [];\n  max: number;\n  saveForm: any;\n  isSaving: boolean;\n  dismiss: () => void;\n  timeChange = false;\n  variableValueChange = false;\n\n  /** @ngInject */\n  constructor(private dashboardSrv) {\n    this.message = '';\n    this.max = 64;\n    this.isSaving = false;\n    this.timeChange = this.dashboardSrv.getCurrent().hasTimeChanged();\n    this.variableValueChange = this.dashboardSrv.getCurrent().hasVariableValuesChanged();\n  }\n\n  save() {\n    if (!this.saveForm.$valid) {\n      return;\n    }\n\n    const options = {\n      saveVariables: this.saveVariables,\n      saveTimerange: this.saveTimerange,\n      message: this.message,\n    };\n\n    const dashboard = this.dashboardSrv.getCurrent();\n    const saveModel = dashboard.getSaveModelClone(options);\n\n    this.isSaving = true;\n\n    return this.dashboardSrv.save(saveModel, options).then(this.postSave.bind(this, options));\n  }\n\n  postSave(options) {\n    if (options.saveVariables) {\n      this.dashboardSrv.getCurrent().resetOriginalVariables();\n    }\n\n    if (options.saveTimerange) {\n      this.dashboardSrv.getCurrent().resetOriginalTime();\n    }\n\n    this.dismiss();\n  }\n}\n\nexport function saveDashboardModalDirective() {\n  return {\n    restrict: 'E',\n    template: template,\n    controller: SaveDashboardModalCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: { dismiss: '&' },\n  };\n}\n\ncoreModule.directive('saveDashboardModal', saveDashboardModalDirective);\n","import angular from 'angular';\nimport { saveAs } from 'file-saver';\nimport coreModule from 'app/core/core_module';\n\nconst template = `\n<div class=\"modal-body\">\n  <div class=\"modal-header\">\n    <h2 class=\"modal-header-title\">\n      <i class=\"fa fa-save\"></i><span class=\"p-l-1\">Cannot save provisioned dashboard</span>\n    </h2>\n\n    <a class=\"modal-header-close\" ng-click=\"ctrl.dismiss();\">\n      <i class=\"fa fa-remove\"></i>\n    </a>\n  </div>\n\n  <div class=\"modal-content\">\n    <small>\n      This dashboard cannot be saved from Grafana's UI since it has been provisioned from another source.\n      Copy the JSON or save it to a file below. Then you can update your dashboard in corresponding provisioning source.<br/>\n      <i>See <a class=\"external-link\" href=\"http://docs.grafana.org/administration/provisioning/#dashboards\" target=\"_blank\">\n      documentation</a> for more information about provisioning.</i>\n    </small>\n    <div class=\"p-t-2\">\n      <div class=\"gf-form\">\n        <code-editor content=\"ctrl.dashboardJson\" data-mode=\"json\" data-max-lines=15></code-editor>\n      </div>\n      <div class=\"gf-form-button-row\">\n        <button class=\"btn btn-success\" clipboard-button=\"ctrl.getJsonForClipboard()\">\n          <i class=\"fa fa-clipboard\"></i>&nbsp;Copy JSON to Clipboard\n        </button>\n        <button class=\"btn btn-secondary\" clipboard-button=\"ctrl.save()\">\n          <i class=\"fa fa-save\"></i>&nbsp;Save JSON to file\n        </button>\n        <a class=\"btn btn-link\" ng-click=\"ctrl.dismiss();\">Cancel</a>\n      </div>\n    </div>\n  </div>\n</div>\n`;\n\nexport class SaveProvisionedDashboardModalCtrl {\n  dash: any;\n  dashboardJson: string;\n  dismiss: () => void;\n\n  /** @ngInject */\n  constructor(dashboardSrv) {\n    this.dash = dashboardSrv.getCurrent().getSaveModelClone();\n    delete this.dash.id;\n    this.dashboardJson = angular.toJson(this.dash, true);\n  }\n\n  save() {\n    const blob = new Blob([angular.toJson(this.dash, true)], {\n      type: 'application/json;charset=utf-8',\n    });\n    saveAs(blob, this.dash.title + '-' + new Date().getTime() + '.json');\n  }\n\n  getJsonForClipboard() {\n    return this.dashboardJson;\n  }\n}\n\nexport function saveProvisionedDashboardModalDirective() {\n  return {\n    restrict: 'E',\n    template: template,\n    controller: SaveProvisionedDashboardModalCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: { dismiss: '&' },\n  };\n}\n\ncoreModule.directive('saveProvisionedDashboardModal', saveProvisionedDashboardModalDirective);\n","import angular from 'angular';\nimport config from 'app/core/config';\nimport moment from 'moment';\n\n/** @ngInject */\nexport function ShareModalCtrl($scope, $rootScope, $location, $timeout, timeSrv, templateSrv, linkSrv) {\n  $scope.options = {\n    forCurrent: true,\n    includeTemplateVars: true,\n    theme: 'current',\n  };\n  $scope.editor = { index: $scope.tabIndex || 0 };\n\n  $scope.init = () => {\n    $scope.modeSharePanel = $scope.panel ? true : false;\n\n    $scope.tabs = [{ title: 'Link', src: 'shareLink.html' }];\n\n    if ($scope.modeSharePanel) {\n      $scope.modalTitle = 'Share Panel';\n      $scope.tabs.push({ title: 'Embed', src: 'shareEmbed.html' });\n    } else {\n      $scope.modalTitle = 'Share';\n    }\n\n    if (!$scope.dashboard.meta.isSnapshot) {\n      $scope.tabs.push({ title: 'Snapshot', src: 'shareSnapshot.html' });\n    }\n\n    if (!$scope.dashboard.meta.isSnapshot && !$scope.modeSharePanel) {\n      $scope.tabs.push({ title: 'Export', src: 'shareExport.html' });\n    }\n\n    $scope.buildUrl();\n  };\n\n  $scope.buildUrl = () => {\n    let baseUrl = $location.absUrl();\n    const queryStart = baseUrl.indexOf('?');\n\n    if (queryStart !== -1) {\n      baseUrl = baseUrl.substring(0, queryStart);\n    }\n\n    const params = angular.copy($location.search());\n\n    const range = timeSrv.timeRange();\n    params.from = range.from.valueOf();\n    params.to = range.to.valueOf();\n    params.orgId = config.bootData.user.orgId;\n\n    if ($scope.options.includeTemplateVars) {\n      templateSrv.fillVariableValuesForUrl(params);\n    }\n\n    if (!$scope.options.forCurrent) {\n      delete params.from;\n      delete params.to;\n    }\n\n    if ($scope.options.theme !== 'current') {\n      params.theme = $scope.options.theme;\n    }\n\n    if ($scope.modeSharePanel) {\n      params.panelId = $scope.panel.id;\n      params.fullscreen = true;\n    } else {\n      delete params.panelId;\n      delete params.fullscreen;\n    }\n\n    $scope.shareUrl = linkSrv.addParamsToUrl(baseUrl, params);\n\n    let soloUrl = baseUrl.replace(config.appSubUrl + '/dashboard/', config.appSubUrl + '/dashboard-solo/');\n    soloUrl = soloUrl.replace(config.appSubUrl + '/d/', config.appSubUrl + '/d-solo/');\n    delete params.fullscreen;\n    delete params.edit;\n    soloUrl = linkSrv.addParamsToUrl(soloUrl, params);\n\n    $scope.iframeHtml = '<iframe src=\"' + soloUrl + '\" width=\"450\" height=\"200\" frameborder=\"0\"></iframe>';\n\n    $scope.imageUrl = soloUrl.replace(\n      config.appSubUrl + '/dashboard-solo/',\n      config.appSubUrl + '/render/dashboard-solo/'\n    );\n    $scope.imageUrl = $scope.imageUrl.replace(config.appSubUrl + '/d-solo/', config.appSubUrl + '/render/d-solo/');\n    $scope.imageUrl += '&width=1000&height=500' + $scope.getLocalTimeZone();\n  };\n\n  // This function will try to return the proper full name of the local timezone\n  // Chrome does not handle the timezone offset (but phantomjs does)\n  $scope.getLocalTimeZone = () => {\n    const utcOffset = '&tz=UTC' + encodeURIComponent(moment().format('Z'));\n\n    // Older browser does not the internationalization API\n    if (!(window as any).Intl) {\n      return utcOffset;\n    }\n\n    const dateFormat = (window as any).Intl.DateTimeFormat();\n    if (!dateFormat.resolvedOptions) {\n      return utcOffset;\n    }\n\n    const options = dateFormat.resolvedOptions();\n    if (!options.timeZone) {\n      return utcOffset;\n    }\n\n    return '&tz=' + encodeURIComponent(options.timeZone);\n  };\n\n  $scope.getShareUrl = () => {\n    return $scope.shareUrl;\n  };\n}\n\nangular.module('grafana.controllers').controller('ShareModalCtrl', ShareModalCtrl);\n","import angular from 'angular';\nimport _ from 'lodash';\n\nexport class ShareSnapshotCtrl {\n  /** @ngInject */\n  constructor($scope, $rootScope, $location, backendSrv, $timeout, timeSrv) {\n    $scope.snapshot = {\n      name: $scope.dashboard.title,\n      expires: 0,\n      timeoutSeconds: 4,\n    };\n\n    $scope.step = 1;\n\n    $scope.expireOptions = [\n      { text: '1 Hour', value: 60 * 60 },\n      { text: '1 Day', value: 60 * 60 * 24 },\n      { text: '7 Days', value: 60 * 60 * 24 * 7 },\n      { text: 'Never', value: 0 },\n    ];\n\n    $scope.accessOptions = [\n      { text: 'Anyone with the link', value: 1 },\n      { text: 'Organization users', value: 2 },\n      { text: 'Public on the web', value: 3 },\n    ];\n\n    $scope.init = () => {\n      backendSrv.get('/api/snapshot/shared-options').then(options => {\n        $scope.externalUrl = options['externalSnapshotURL'];\n        $scope.sharingButtonText = options['externalSnapshotName'];\n        $scope.externalEnabled = options['externalEnabled'];\n      });\n    };\n\n    $scope.apiUrl = '/api/snapshots';\n\n    $scope.createSnapshot = external => {\n      $scope.dashboard.snapshot = {\n        timestamp: new Date(),\n      };\n\n      if (!external) {\n        $scope.dashboard.snapshot.originalUrl = $location.absUrl();\n      }\n\n      $scope.loading = true;\n      $scope.snapshot.external = external;\n\n      $rootScope.$broadcast('refresh');\n\n      $timeout(() => {\n        $scope.saveSnapshot(external);\n      }, $scope.snapshot.timeoutSeconds * 1000);\n    };\n\n    $scope.saveSnapshot = external => {\n      const dash = $scope.dashboard.getSaveModelClone();\n      $scope.scrubDashboard(dash);\n\n      const cmdData = {\n        dashboard: dash,\n        name: dash.title,\n        expires: $scope.snapshot.expires,\n      };\n\n      const postUrl = external ? $scope.externalUrl + $scope.apiUrl : $scope.apiUrl;\n\n      backendSrv.post(postUrl, cmdData).then(\n        results => {\n          $scope.loading = false;\n\n          if (external) {\n            $scope.deleteUrl = results.deleteUrl;\n            $scope.snapshotUrl = results.url;\n            $scope.saveExternalSnapshotRef(cmdData, results);\n          } else {\n            const url = $location.url();\n            let baseUrl = $location.absUrl();\n\n            if (url !== '/') {\n              baseUrl = baseUrl.replace(url, '') + '/';\n            }\n\n            $scope.snapshotUrl = baseUrl + 'dashboard/snapshot/' + results.key;\n            $scope.deleteUrl = baseUrl + 'api/snapshots-delete/' + results.deleteKey;\n          }\n\n          $scope.step = 2;\n        },\n        () => {\n          $scope.loading = false;\n        }\n      );\n    };\n\n    $scope.getSnapshotUrl = () => {\n      return $scope.snapshotUrl;\n    };\n\n    $scope.scrubDashboard = dash => {\n      // change title\n      dash.title = $scope.snapshot.name;\n\n      // make relative times absolute\n      dash.time = timeSrv.timeRange();\n\n      // remove panel queries & links\n      _.each(dash.panels, panel => {\n        panel.targets = [];\n        panel.links = [];\n        panel.datasource = null;\n      });\n\n      // remove annotation queries\n      dash.annotations.list = _.chain(dash.annotations.list)\n        .filter(annotation => {\n          return annotation.enable;\n        })\n        .map(annotation => {\n          return {\n            name: annotation.name,\n            enable: annotation.enable,\n            iconColor: annotation.iconColor,\n            snapshotData: annotation.snapshotData,\n            type: annotation.type,\n            builtIn: annotation.builtIn,\n            hide: annotation.hide,\n          };\n        })\n        .value();\n\n      // remove template queries\n      _.each(dash.templating.list, variable => {\n        variable.query = '';\n        variable.options = variable.current;\n        variable.refresh = false;\n      });\n\n      // snapshot single panel\n      if ($scope.modeSharePanel) {\n        const singlePanel = $scope.panel.getSaveModel();\n        singlePanel.gridPos.w = 24;\n        singlePanel.gridPos.x = 0;\n        singlePanel.gridPos.y = 0;\n        singlePanel.gridPos.h = 20;\n        dash.panels = [singlePanel];\n      }\n\n      // cleanup snapshotData\n      delete $scope.dashboard.snapshot;\n      $scope.dashboard.forEachPanel(panel => {\n        delete panel.snapshotData;\n      });\n      _.each($scope.dashboard.annotations.list, annotation => {\n        delete annotation.snapshotData;\n      });\n    };\n\n    $scope.deleteSnapshot = () => {\n      backendSrv.get($scope.deleteUrl).then(() => {\n        $scope.step = 3;\n      });\n    };\n\n    $scope.saveExternalSnapshotRef = (cmdData, results) => {\n      // save external in local instance as well\n      cmdData.external = true;\n      cmdData.key = results.key;\n      cmdData.deleteKey = results.deleteKey;\n      backendSrv.post('/api/snapshots/', cmdData);\n    };\n  }\n}\n\nangular.module('grafana.controllers').controller('ShareSnapshotCtrl', ShareSnapshotCtrl);\n","import coreModule from 'app/core/core_module';\nimport { DashboardModel } from './dashboard_model';\nimport locationUtil from 'app/core/utils/location_util';\n\nexport class DashboardSrv {\n  dash: any;\n\n  /** @ngInject */\n  constructor(private backendSrv, private $rootScope, private $location) {}\n\n  create(dashboard, meta) {\n    return new DashboardModel(dashboard, meta);\n  }\n\n  setCurrent(dashboard) {\n    this.dash = dashboard;\n  }\n\n  getCurrent() {\n    return this.dash;\n  }\n\n  handleSaveDashboardError(clone, options, err) {\n    options = options || {};\n    options.overwrite = true;\n\n    if (err.data && err.data.status === 'version-mismatch') {\n      err.isHandled = true;\n\n      this.$rootScope.appEvent('confirm-modal', {\n        title: 'Conflict',\n        text: 'Someone else has updated this dashboard.',\n        text2: 'Would you still like to save this dashboard?',\n        yesText: 'Save & Overwrite',\n        icon: 'fa-warning',\n        onConfirm: () => {\n          this.save(clone, options);\n        },\n      });\n    }\n\n    if (err.data && err.data.status === 'name-exists') {\n      err.isHandled = true;\n\n      this.$rootScope.appEvent('confirm-modal', {\n        title: 'Conflict',\n        text: 'A dashboard with the same name in selected folder already exists.',\n        text2: 'Would you still like to save this dashboard?',\n        yesText: 'Save & Overwrite',\n        icon: 'fa-warning',\n        onConfirm: () => {\n          this.save(clone, options);\n        },\n      });\n    }\n\n    if (err.data && err.data.status === 'plugin-dashboard') {\n      err.isHandled = true;\n\n      this.$rootScope.appEvent('confirm-modal', {\n        title: 'Plugin Dashboard',\n        text: err.data.message,\n        text2: 'Your changes will be lost when you update the plugin. Use Save As to create custom version.',\n        yesText: 'Overwrite',\n        icon: 'fa-warning',\n        altActionText: 'Save As',\n        onAltAction: () => {\n          this.showSaveAsModal();\n        },\n        onConfirm: () => {\n          this.save(clone, { overwrite: true });\n        },\n      });\n    }\n  }\n\n  postSave(clone, data) {\n    this.dash.version = data.version;\n\n    const newUrl = locationUtil.stripBaseFromUrl(data.url);\n    const currentPath = this.$location.path();\n\n    if (newUrl !== currentPath) {\n      this.$location.url(newUrl).replace();\n    }\n\n    this.$rootScope.appEvent('dashboard-saved', this.dash);\n    this.$rootScope.appEvent('alert-success', ['Dashboard saved']);\n\n    return this.dash;\n  }\n\n  save(clone, options) {\n    options = options || {};\n    options.folderId = options.folderId >= 0 ? options.folderId : this.dash.meta.folderId || clone.folderId;\n\n    return this.backendSrv\n      .saveDashboard(clone, options)\n      .then(this.postSave.bind(this, clone))\n      .catch(this.handleSaveDashboardError.bind(this, clone, options));\n  }\n\n  saveDashboard(options?, clone?) {\n    if (clone) {\n      this.setCurrent(this.create(clone, this.dash.meta));\n    }\n\n    if (this.dash.meta.provisioned) {\n      return this.showDashboardProvisionedModal();\n    }\n\n    if (!this.dash.meta.canSave && options.makeEditable !== true) {\n      return Promise.resolve();\n    }\n\n    if (this.dash.title === 'New dashboard') {\n      return this.showSaveAsModal();\n    }\n\n    if (this.dash.version > 0) {\n      return this.showSaveModal();\n    }\n\n    return this.save(this.dash.getSaveModelClone(), options);\n  }\n\n  saveJSONDashboard(json: string) {\n    return this.save(JSON.parse(json), {});\n  }\n\n  showDashboardProvisionedModal() {\n    this.$rootScope.appEvent('show-modal', {\n      templateHtml: '<save-provisioned-dashboard-modal dismiss=\"dismiss()\"></save-provisioned-dashboard-modal>',\n    });\n  }\n\n  showSaveAsModal() {\n    this.$rootScope.appEvent('show-modal', {\n      templateHtml: '<save-dashboard-as-modal dismiss=\"dismiss()\"></save-dashboard-as-modal>',\n      modalClass: 'modal--narrow',\n    });\n  }\n\n  showSaveModal() {\n    this.$rootScope.appEvent('show-modal', {\n      templateHtml: '<save-dashboard-modal dismiss=\"dismiss()\"></save-dashboard-modal>',\n      modalClass: 'modal--narrow',\n    });\n  }\n\n  starDashboard(dashboardId, isStarred) {\n    let promise;\n\n    if (isStarred) {\n      promise = this.backendSrv.delete('/api/user/stars/dashboard/' + dashboardId).then(() => {\n        return false;\n      });\n    } else {\n      promise = this.backendSrv.post('/api/user/stars/dashboard/' + dashboardId).then(() => {\n        return true;\n      });\n    }\n\n    return promise.then(res => {\n      if (this.dash && this.dash.id === dashboardId) {\n        this.dash.meta.isStarred = res;\n      }\n      return res;\n    });\n  }\n}\n\ncoreModule.service('dashboardSrv', DashboardSrv);\n","import angular from 'angular';\nimport _ from 'lodash';\nimport config from 'app/core/config';\nimport { DashboardModel } from './dashboard_model';\n\n// represents the transient view state\n// like fullscreen panel & edit\nexport class DashboardViewState {\n  state: any;\n  panelScopes: any;\n  $scope: any;\n  dashboard: DashboardModel;\n  editStateChanged: any;\n  fullscreenPanel: any;\n  oldTimeRange: any;\n\n  /** @ngInject */\n  constructor($scope, private $location, private $timeout, private $rootScope) {\n    const self = this;\n    self.state = {};\n    self.panelScopes = [];\n    self.$scope = $scope;\n    self.dashboard = $scope.dashboard;\n\n    $scope.onAppEvent('$routeUpdate', () => {\n      const urlState = self.getQueryStringState();\n      if (self.needsSync(urlState)) {\n        self.update(urlState, true);\n      }\n    });\n\n    $scope.onAppEvent('panel-change-view', (evt, payload) => {\n      self.update(payload);\n    });\n\n    $scope.onAppEvent('panel-initialized', (evt, payload) => {\n      self.registerPanel(payload.scope);\n    });\n\n    // this marks changes to location during this digest cycle as not to add history item\n    // don't want url changes like adding orgId to add browser history\n    $location.replace();\n    this.update(this.getQueryStringState());\n  }\n\n  needsSync(urlState) {\n    return _.isEqual(this.state, urlState) === false;\n  }\n\n  getQueryStringState() {\n    const state = this.$location.search();\n    state.panelId = parseInt(state.panelId, 10) || null;\n    state.fullscreen = state.fullscreen ? true : null;\n    state.edit = state.edit === 'true' || state.edit === true || null;\n    state.editview = state.editview || null;\n    state.orgId = config.bootData.user.orgId;\n    return state;\n  }\n\n  serializeToUrl() {\n    const urlState = _.clone(this.state);\n    urlState.fullscreen = this.state.fullscreen ? true : null;\n    urlState.edit = this.state.edit ? true : null;\n    return urlState;\n  }\n\n  update(state, fromRouteUpdated?) {\n    // implement toggle logic\n    if (state.toggle) {\n      delete state.toggle;\n      if (this.state.fullscreen && state.fullscreen) {\n        if (this.state.edit === state.edit) {\n          state.fullscreen = !state.fullscreen;\n        }\n      }\n    }\n\n    // remember if editStateChanged\n    this.editStateChanged = (state.edit || false) !== (this.state.edit || false);\n\n    _.extend(this.state, state);\n    this.dashboard.meta.fullscreen = this.state.fullscreen;\n\n    if (!this.state.fullscreen) {\n      this.state.fullscreen = null;\n      this.state.edit = null;\n      // clear panel id unless in solo mode\n      if (!this.dashboard.meta.soloMode) {\n        this.state.panelId = null;\n      }\n    }\n\n    if ((this.state.fullscreen || this.dashboard.meta.soloMode) && this.state.panelId) {\n      // Trying to render panel in fullscreen when it's in the collapsed row causes an issue.\n      // So in this case expand collapsed row first.\n      this.toggleCollapsedPanelRow(this.state.panelId);\n    }\n\n    // if no edit state cleanup tab parm\n    if (!this.state.edit) {\n      delete this.state.tab;\n    }\n\n    // do not update url params if we are here\n    // from routeUpdated event\n    if (fromRouteUpdated !== true) {\n      this.$location.search(this.serializeToUrl());\n    }\n\n    this.syncState();\n  }\n\n  toggleCollapsedPanelRow(panelId) {\n    for (const panel of this.dashboard.panels) {\n      if (panel.collapsed) {\n        for (const rowPanel of panel.panels) {\n          if (rowPanel.id === panelId) {\n            this.dashboard.toggleRow(panel);\n            return;\n          }\n        }\n      }\n    }\n  }\n\n  syncState() {\n    if (this.panelScopes.length === 0) {\n      return;\n    }\n\n    if (this.dashboard.meta.fullscreen) {\n      const panelScope = this.getPanelScope(this.state.panelId);\n      if (!panelScope) {\n        return;\n      }\n\n      if (this.fullscreenPanel) {\n        // if already fullscreen\n        if (this.fullscreenPanel === panelScope && this.editStateChanged === false) {\n          return;\n        } else {\n          this.leaveFullscreen(false);\n        }\n      }\n\n      if (!panelScope.ctrl.editModeInitiated) {\n        panelScope.ctrl.initEditMode();\n      }\n\n      if (!panelScope.ctrl.fullscreen) {\n        this.enterFullscreen(panelScope);\n      }\n    } else if (this.fullscreenPanel) {\n      this.leaveFullscreen(true);\n    }\n  }\n\n  getPanelScope(id) {\n    return _.find(this.panelScopes, panelScope => {\n      return panelScope.ctrl.panel.id === id;\n    });\n  }\n\n  leaveFullscreen(render) {\n    const self = this;\n    const ctrl = self.fullscreenPanel.ctrl;\n\n    ctrl.editMode = false;\n    ctrl.fullscreen = false;\n\n    this.dashboard.setViewMode(ctrl.panel, false, false);\n    this.$scope.appEvent('panel-fullscreen-exit', { panelId: ctrl.panel.id });\n    this.$scope.appEvent('dash-scroll', { restore: true });\n\n    if (!render) {\n      return false;\n    }\n\n    this.$timeout(() => {\n      if (self.oldTimeRange !== ctrl.range) {\n        self.$rootScope.$broadcast('refresh');\n      } else {\n        self.$rootScope.$broadcast('render');\n      }\n      delete self.fullscreenPanel;\n    });\n    return true;\n  }\n\n  enterFullscreen(panelScope) {\n    const ctrl = panelScope.ctrl;\n\n    ctrl.editMode = this.state.edit && this.dashboard.meta.canEdit;\n    ctrl.fullscreen = true;\n\n    this.oldTimeRange = ctrl.range;\n    this.fullscreenPanel = panelScope;\n\n    // Firefox doesn't return scrollTop position properly if 'dash-scroll' is emitted after setViewMode()\n    this.$scope.appEvent('dash-scroll', { animate: false, pos: 0 });\n    this.dashboard.setViewMode(ctrl.panel, true, ctrl.editMode);\n    this.$scope.appEvent('panel-fullscreen-enter', { panelId: ctrl.panel.id });\n  }\n\n  registerPanel(panelScope) {\n    const self = this;\n    self.panelScopes.push(panelScope);\n\n    if (!self.dashboard.meta.soloMode) {\n      if (self.state.panelId === panelScope.ctrl.panel.id) {\n        if (self.state.edit) {\n          panelScope.ctrl.editPanel();\n        } else {\n          panelScope.ctrl.viewPanel();\n        }\n      }\n    }\n\n    const unbind = panelScope.$on('$destroy', () => {\n      self.panelScopes = _.without(self.panelScopes, panelScope);\n      unbind();\n    });\n  }\n}\n\n/** @ngInject */\nexport function dashboardViewStateSrv($location, $timeout, $rootScope) {\n  return {\n    create: $scope => {\n      return new DashboardViewState($scope, $location, $timeout, $rootScope);\n    },\n  };\n}\n\nangular.module('grafana.services').factory('dashboardViewStateSrv', dashboardViewStateSrv);\n","import coreModule from 'app/core/core_module';\n\nconst hitTypes = {\n  FOLDER: 'dash-folder',\n  DASHBOARD: 'dash-db',\n};\n\nexport class ValidationSrv {\n  rootName = 'general';\n\n  /** @ngInject */\n  constructor(private $q, private backendSrv) {}\n\n  validateNewDashboardName(folderId, name) {\n    return this.validate(folderId, name, 'A dashboard in this folder with the same name already exists');\n  }\n\n  validateNewFolderName(name) {\n    return this.validate(0, name, 'A folder or dashboard in the general folder with the same name already exists');\n  }\n\n  private validate(folderId, name, existingErrorMessage) {\n    name = (name || '').trim();\n    const nameLowerCased = name.toLowerCase();\n\n    if (name.length === 0) {\n      return this.$q.reject({\n        type: 'REQUIRED',\n        message: 'Name is required',\n      });\n    }\n\n    if (folderId === 0 && nameLowerCased === this.rootName) {\n      return this.$q.reject({\n        type: 'EXISTING',\n        message: 'This is a reserved name and cannot be used for a folder.',\n      });\n    }\n\n    const deferred = this.$q.defer();\n\n    const promises = [];\n    promises.push(this.backendSrv.search({ type: hitTypes.FOLDER, folderIds: [folderId], query: name }));\n    promises.push(this.backendSrv.search({ type: hitTypes.DASHBOARD, folderIds: [folderId], query: name }));\n\n    this.$q.all(promises).then(res => {\n      let hits = [];\n\n      if (res.length > 0 && res[0].length > 0) {\n        hits = res[0];\n      }\n\n      if (res.length > 1 && res[1].length > 0) {\n        hits = hits.concat(res[1]);\n      }\n\n      for (const hit of hits) {\n        if (nameLowerCased === hit.title.toLowerCase()) {\n          deferred.reject({\n            type: 'EXISTING',\n            message: existingErrorMessage,\n          });\n          break;\n        }\n      }\n\n      deferred.resolve();\n    });\n\n    return deferred.promise;\n  }\n}\n\ncoreModule.service('validationSrv', ValidationSrv);\n","import moment from 'moment';\nimport _ from 'lodash';\nimport coreModule from 'app/core/core_module';\nimport kbn from 'app/core/utils/kbn';\nimport * as dateMath from 'app/core/utils/datemath';\n\nexport class TimeSrv {\n  time: any;\n  refreshTimer: any;\n  refresh: boolean;\n  oldRefresh: boolean;\n  dashboard: any;\n  timeAtLoad: any;\n  private autoRefreshBlocked: boolean;\n\n  /** @ngInject */\n  constructor(private $rootScope, private $timeout, private $location, private timer, private contextSrv) {\n    // default time\n    this.time = { from: '6h', to: 'now' };\n\n    $rootScope.$on('zoom-out', this.zoomOut.bind(this));\n    $rootScope.$on('$routeUpdate', this.routeUpdated.bind(this));\n\n    document.addEventListener('visibilitychange', () => {\n      if (this.autoRefreshBlocked && document.visibilityState === 'visible') {\n        this.autoRefreshBlocked = false;\n\n        this.refreshDashboard();\n      }\n    });\n  }\n\n  init(dashboard) {\n    this.timer.cancelAll();\n\n    this.dashboard = dashboard;\n    this.time = dashboard.time;\n    this.refresh = dashboard.refresh;\n\n    this.initTimeFromUrl();\n    this.parseTime();\n\n    // remember time at load so we can go back to it\n    this.timeAtLoad = _.cloneDeep(this.time);\n\n    if (this.refresh) {\n      this.setAutoRefresh(this.refresh);\n    }\n  }\n\n  private parseTime() {\n    // when absolute time is saved in json it is turned to a string\n    if (_.isString(this.time.from) && this.time.from.indexOf('Z') >= 0) {\n      this.time.from = moment(this.time.from).utc();\n    }\n    if (_.isString(this.time.to) && this.time.to.indexOf('Z') >= 0) {\n      this.time.to = moment(this.time.to).utc();\n    }\n  }\n\n  private parseUrlParam(value) {\n    if (value.indexOf('now') !== -1) {\n      return value;\n    }\n    if (value.length === 8) {\n      return moment.utc(value, 'YYYYMMDD');\n    }\n    if (value.length === 15) {\n      return moment.utc(value, 'YYYYMMDDTHHmmss');\n    }\n\n    if (!isNaN(value)) {\n      const epoch = parseInt(value, 10);\n      return moment.utc(epoch);\n    }\n\n    return null;\n  }\n\n  private initTimeFromUrl() {\n    const params = this.$location.search();\n    if (params.from) {\n      this.time.from = this.parseUrlParam(params.from) || this.time.from;\n    }\n    if (params.to) {\n      this.time.to = this.parseUrlParam(params.to) || this.time.to;\n    }\n    // if absolute ignore refresh option saved to dashboard\n    if (params.to && params.to.indexOf('now') === -1) {\n      this.refresh = false;\n      this.dashboard.refresh = false;\n    }\n    // but if refresh explicitly set then use that\n    if (params.refresh) {\n      this.refresh = params.refresh || this.refresh;\n    }\n  }\n\n  private routeUpdated() {\n    const params = this.$location.search();\n    const urlRange = this.timeRangeForUrl();\n    // check if url has time range\n    if (params.from && params.to) {\n      // is it different from what our current time range?\n      if (params.from !== urlRange.from || params.to !== urlRange.to) {\n        // issue update\n        this.initTimeFromUrl();\n        this.setTime(this.time, true);\n      }\n    } else if (this.timeHasChangedSinceLoad()) {\n      this.setTime(this.timeAtLoad, true);\n    }\n  }\n\n  private timeHasChangedSinceLoad() {\n    return this.timeAtLoad && (this.timeAtLoad.from !== this.time.from || this.timeAtLoad.to !== this.time.to);\n  }\n\n  setAutoRefresh(interval) {\n    this.dashboard.refresh = interval;\n    this.cancelNextRefresh();\n    if (interval) {\n      const intervalMs = kbn.interval_to_ms(interval);\n\n      this.refreshTimer = this.timer.register(\n        this.$timeout(() => {\n          this.startNextRefreshTimer(intervalMs);\n          this.refreshDashboard();\n        }, intervalMs)\n      );\n    }\n\n    // update url\n    const params = this.$location.search();\n    if (interval) {\n      params.refresh = interval;\n      this.$location.search(params);\n    } else if (params.refresh) {\n      delete params.refresh;\n      this.$location.search(params);\n    }\n  }\n\n  refreshDashboard() {\n    this.$rootScope.$broadcast('refresh');\n  }\n\n  private startNextRefreshTimer(afterMs) {\n    this.cancelNextRefresh();\n    this.refreshTimer = this.timer.register(\n      this.$timeout(() => {\n        this.startNextRefreshTimer(afterMs);\n        if (this.contextSrv.isGrafanaVisible()) {\n          this.refreshDashboard();\n        } else {\n          this.autoRefreshBlocked = true;\n        }\n      }, afterMs)\n    );\n  }\n\n  private cancelNextRefresh() {\n    this.timer.cancel(this.refreshTimer);\n  }\n\n  setTime(time, fromRouteUpdate?) {\n    _.extend(this.time, time);\n\n    // disable refresh if zoom in or zoom out\n    if (moment.isMoment(time.to)) {\n      this.oldRefresh = this.dashboard.refresh || this.oldRefresh;\n      this.setAutoRefresh(false);\n    } else if (this.oldRefresh && this.oldRefresh !== this.dashboard.refresh) {\n      this.setAutoRefresh(this.oldRefresh);\n      this.oldRefresh = null;\n    }\n\n    // update url\n    if (fromRouteUpdate !== true) {\n      const urlRange = this.timeRangeForUrl();\n      const urlParams = this.$location.search();\n      urlParams.from = urlRange.from;\n      urlParams.to = urlRange.to;\n      this.$location.search(urlParams);\n    }\n\n    this.$rootScope.appEvent('time-range-changed', this.time);\n    this.$timeout(this.refreshDashboard.bind(this), 0);\n  }\n\n  timeRangeForUrl() {\n    const range = this.timeRange().raw;\n\n    if (moment.isMoment(range.from)) {\n      range.from = range.from.valueOf().toString();\n    }\n    if (moment.isMoment(range.to)) {\n      range.to = range.to.valueOf().toString();\n    }\n\n    return range;\n  }\n\n  timeRange() {\n    // make copies if they are moment  (do not want to return out internal moment, because they are mutable!)\n    const raw = {\n      from: moment.isMoment(this.time.from) ? moment(this.time.from) : this.time.from,\n      to: moment.isMoment(this.time.to) ? moment(this.time.to) : this.time.to,\n    };\n\n    const timezone = this.dashboard && this.dashboard.getTimezone();\n\n    return {\n      from: dateMath.parse(raw.from, false, timezone),\n      to: dateMath.parse(raw.to, true, timezone),\n      raw: raw,\n    };\n  }\n\n  zoomOut(e, factor) {\n    const range = this.timeRange();\n\n    const timespan = range.to.valueOf() - range.from.valueOf();\n    const center = range.to.valueOf() - timespan / 2;\n\n    let to = center + timespan * factor / 2;\n    let from = center - timespan * factor / 2;\n\n    if (to > Date.now() && range.to <= Date.now()) {\n      const offset = to - Date.now();\n      from = from - offset;\n      to = Date.now();\n    }\n\n    this.setTime({ from: moment.utc(from), to: moment.utc(to) });\n  }\n}\n\ncoreModule.service('timeSrv', TimeSrv);\n","import angular from 'angular';\nimport _ from 'lodash';\nimport { DashboardModel } from './dashboard_model';\n\nexport class ChangeTracker {\n  current: any;\n  originalPath: any;\n  scope: any;\n  original: any;\n  next: any;\n  $window: any;\n\n  /** @ngInject */\n  constructor(\n    dashboard,\n    scope,\n    originalCopyDelay,\n    private $location,\n    $window,\n    private $timeout,\n    private contextSrv,\n    private $rootScope\n  ) {\n    this.$location = $location;\n    this.$window = $window;\n\n    this.current = dashboard;\n    this.originalPath = $location.path();\n    this.scope = scope;\n\n    // register events\n    scope.onAppEvent('dashboard-saved', () => {\n      this.original = this.current.getSaveModelClone();\n      this.originalPath = $location.path();\n    });\n\n    $window.onbeforeunload = () => {\n      if (this.ignoreChanges()) {\n        return undefined;\n      }\n      if (this.hasChanges()) {\n        return 'There are unsaved changes to this dashboard';\n      }\n      return undefined;\n    };\n\n    scope.$on('$locationChangeStart', (event, next) => {\n      // check if we should look for changes\n      if (this.originalPath === $location.path()) {\n        return true;\n      }\n      if (this.ignoreChanges()) {\n        return true;\n      }\n\n      if (this.hasChanges()) {\n        event.preventDefault();\n        this.next = next;\n\n        this.$timeout(() => {\n          this.open_modal();\n        });\n      }\n      return false;\n    });\n\n    if (originalCopyDelay) {\n      this.$timeout(() => {\n        // wait for different services to patch the dashboard (missing properties)\n        this.original = dashboard.getSaveModelClone();\n      }, originalCopyDelay);\n    } else {\n      this.original = dashboard.getSaveModelClone();\n    }\n  }\n\n  // for some dashboards and users\n  // changes should be ignored\n  ignoreChanges() {\n    if (!this.original) {\n      return true;\n    }\n    if (!this.contextSrv.isEditor) {\n      return true;\n    }\n    if (!this.current || !this.current.meta) {\n      return true;\n    }\n\n    const meta = this.current.meta;\n    return !meta.canSave || meta.fromScript || meta.fromFile;\n  }\n\n  // remove stuff that should not count in diff\n  cleanDashboardFromIgnoredChanges(dashData) {\n    // need to new up the domain model class to get access to expand / collapse row logic\n    const model = new DashboardModel(dashData);\n\n    // Expand all rows before making comparison. This is required because row expand / collapse\n    // change order of panel array and panel positions.\n    model.expandRows();\n\n    const dash = model.getSaveModelClone();\n\n    // ignore time and refresh\n    dash.time = 0;\n    dash.refresh = 0;\n    dash.schemaVersion = 0;\n\n    // ignore iteration property\n    delete dash.iteration;\n\n    dash.panels = _.filter(dash.panels, panel => {\n      if (panel.repeatPanelId) {\n        return false;\n      }\n\n      // remove scopedVars\n      panel.scopedVars = null;\n\n      // ignore panel legend sort\n      if (panel.legend) {\n        delete panel.legend.sort;\n        delete panel.legend.sortDesc;\n      }\n\n      return true;\n    });\n\n    // ignore template variable values\n    _.each(dash.templating.list, value => {\n      value.current = null;\n      value.options = null;\n      value.filters = null;\n    });\n\n    return dash;\n  }\n\n  hasChanges() {\n    const current = this.cleanDashboardFromIgnoredChanges(this.current.getSaveModelClone());\n    const original = this.cleanDashboardFromIgnoredChanges(this.original);\n\n    const currentTimepicker = _.find(current.nav, { type: 'timepicker' });\n    const originalTimepicker = _.find(original.nav, { type: 'timepicker' });\n\n    if (currentTimepicker && originalTimepicker) {\n      currentTimepicker.now = originalTimepicker.now;\n    }\n\n    const currentJson = angular.toJson(current, true);\n    const originalJson = angular.toJson(original, true);\n\n    return currentJson !== originalJson;\n  }\n\n  discardChanges() {\n    this.original = null;\n    this.gotoNext();\n  }\n\n  open_modal() {\n    this.$rootScope.appEvent('show-modal', {\n      templateHtml: '<unsaved-changes-modal dismiss=\"dismiss()\"></unsaved-changes-modal>',\n      modalClass: 'modal--narrow confirm-modal',\n    });\n  }\n\n  saveChanges() {\n    const self = this;\n    const cancel = this.$rootScope.$on('dashboard-saved', () => {\n      cancel();\n      this.$timeout(() => {\n        self.gotoNext();\n      });\n    });\n\n    this.$rootScope.appEvent('save-dashboard');\n  }\n\n  gotoNext() {\n    const baseLen = this.$location.absUrl().length - this.$location.url().length;\n    const nextUrl = this.next.substring(baseLen);\n    this.$location.url(nextUrl);\n  }\n}\n","import angular from 'angular';\nimport { ChangeTracker } from './change_tracker';\n\n/** @ngInject */\nexport function unsavedChangesSrv(this: any, $rootScope, $q, $location, $timeout, contextSrv, dashboardSrv, $window) {\n  this.init = function(dashboard, scope) {\n    this.tracker = new ChangeTracker(dashboard, scope, 1000, $location, $window, $timeout, contextSrv, $rootScope);\n    return this.tracker;\n  };\n}\n\nangular.module('grafana.services').service('unsavedChangesSrv', unsavedChangesSrv);\n","import coreModule from 'app/core/core_module';\n\nconst template = `\n<div class=\"modal-body\">\n  <div class=\"modal-header\">\n    <h2 class=\"modal-header-title\">\n      <i class=\"fa fa-exclamation\"></i>\n      <span class=\"p-l-1\">Unsaved changes</span>\n    </h2>\n\n    <a class=\"modal-header-close\" ng-click=\"ctrl.dismiss();\">\n      <i class=\"fa fa-remove\"></i>\n    </a>\n  </div>\n\n  <div class=\"modal-content text-center\">\n\n    <div class=\"confirm-modal-text\">\n      Do you want to save your changes?\n    </div>\n\n    <div class=\"confirm-modal-buttons\">\n      <button type=\"button\" class=\"btn btn-success\" ng-click=\"ctrl.save()\">Save</button>\n      <button type=\"button\" class=\"btn btn-danger\" ng-click=\"ctrl.discard()\">Discard</button>\n      <button type=\"button\" class=\"btn btn-inverse\" ng-click=\"ctrl.dismiss()\">Cancel</button>\n    </div>\n  </div>\n</div>\n`;\n\nexport class UnsavedChangesModalCtrl {\n  clone: any;\n  dismiss: () => void;\n\n  /** @ngInject */\n  constructor(private unsavedChangesSrv) {}\n\n  discard() {\n    this.dismiss();\n    this.unsavedChangesSrv.tracker.discardChanges();\n  }\n\n  save() {\n    this.dismiss();\n    this.unsavedChangesSrv.tracker.saveChanges();\n  }\n}\n\nexport function unsavedChangesModalDirective() {\n  return {\n    restrict: 'E',\n    template: template,\n    controller: UnsavedChangesModalCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: { dismiss: '&' },\n  };\n}\n\ncoreModule.directive('unsavedChangesModal', unsavedChangesModalDirective);\n","import moment from 'moment';\nimport * as dateMath from 'app/core/utils/datemath';\n\nexport function inputDateDirective() {\n  return {\n    restrict: 'A',\n    require: 'ngModel',\n    link: ($scope, $elem, attrs, ngModel) => {\n      const format = 'YYYY-MM-DD HH:mm:ss';\n\n      const fromUser = text => {\n        if (text.indexOf('now') !== -1) {\n          if (!dateMath.isValid(text)) {\n            ngModel.$setValidity('error', false);\n            return undefined;\n          }\n          ngModel.$setValidity('error', true);\n          return text;\n        }\n\n        let parsed;\n        if ($scope.ctrl.isUtc) {\n          parsed = moment.utc(text, format);\n        } else {\n          parsed = moment(text, format);\n        }\n\n        if (!parsed.isValid()) {\n          ngModel.$setValidity('error', false);\n          return undefined;\n        }\n\n        ngModel.$setValidity('error', true);\n        return parsed;\n      };\n\n      const toUser = currentValue => {\n        if (moment.isMoment(currentValue)) {\n          return currentValue.format(format);\n        } else {\n          return currentValue;\n        }\n      };\n\n      ngModel.$parsers.push(fromUser);\n      ngModel.$formatters.push(toUser);\n    },\n  };\n}\n","import _ from 'lodash';\nimport angular from 'angular';\nimport moment from 'moment';\n\nimport * as rangeUtil from 'app/core/utils/rangeutil';\n\nexport class TimePickerCtrl {\n  static tooltipFormat = 'MMM D, YYYY HH:mm:ss';\n  static defaults = {\n    time_options: ['5m', '15m', '1h', '6h', '12h', '24h', '2d', '7d', '30d'],\n    refresh_intervals: ['5s', '10s', '30s', '1m', '5m', '15m', '30m', '1h', '2h', '1d'],\n  };\n\n  dashboard: any;\n  panel: any;\n  absolute: any;\n  timeRaw: any;\n  editTimeRaw: any;\n  tooltip: string;\n  rangeString: string;\n  timeOptions: any;\n  refresh: any;\n  isUtc: boolean;\n  firstDayOfWeek: number;\n  isOpen: boolean;\n  isAbsolute: boolean;\n\n  /** @ngInject */\n  constructor(private $scope, private $rootScope, private timeSrv) {\n    this.$scope.ctrl = this;\n\n    $rootScope.onAppEvent('shift-time-forward', () => this.move(1), $scope);\n    $rootScope.onAppEvent('shift-time-backward', () => this.move(-1), $scope);\n    $rootScope.onAppEvent('refresh', this.onRefresh.bind(this), $scope);\n    $rootScope.onAppEvent('closeTimepicker', this.openDropdown.bind(this), $scope);\n\n    // init options\n    this.panel = this.dashboard.timepicker;\n    _.defaults(this.panel, TimePickerCtrl.defaults);\n    this.firstDayOfWeek = moment.localeData().firstDayOfWeek();\n\n    // init time stuff\n    this.onRefresh();\n  }\n\n  onRefresh() {\n    const time = angular.copy(this.timeSrv.timeRange());\n    const timeRaw = angular.copy(time.raw);\n\n    if (!this.dashboard.isTimezoneUtc()) {\n      time.from.local();\n      time.to.local();\n      if (moment.isMoment(timeRaw.from)) {\n        timeRaw.from.local();\n      }\n      if (moment.isMoment(timeRaw.to)) {\n        timeRaw.to.local();\n      }\n      this.isUtc = false;\n    } else {\n      this.isUtc = true;\n    }\n\n    this.rangeString = rangeUtil.describeTimeRange(timeRaw);\n    this.absolute = { fromJs: time.from.toDate(), toJs: time.to.toDate() };\n    this.tooltip = this.dashboard.formatDate(time.from) + ' <br>to<br>';\n    this.tooltip += this.dashboard.formatDate(time.to);\n    this.timeRaw = timeRaw;\n    this.isAbsolute = moment.isMoment(this.timeRaw.to);\n  }\n\n  zoom(factor) {\n    this.$rootScope.appEvent('zoom-out', 2);\n  }\n\n  move(direction) {\n    const range = this.timeSrv.timeRange();\n\n    const timespan = (range.to.valueOf() - range.from.valueOf()) / 2;\n    let to, from;\n    if (direction === -1) {\n      to = range.to.valueOf() - timespan;\n      from = range.from.valueOf() - timespan;\n    } else if (direction === 1) {\n      to = range.to.valueOf() + timespan;\n      from = range.from.valueOf() + timespan;\n      if (to > Date.now() && range.to < Date.now()) {\n        to = Date.now();\n        from = range.from.valueOf();\n      }\n    } else {\n      to = range.to.valueOf();\n      from = range.from.valueOf();\n    }\n\n    this.timeSrv.setTime({ from: moment.utc(from), to: moment.utc(to) });\n  }\n\n  openDropdown() {\n    if (this.isOpen) {\n      this.closeDropdown();\n      return;\n    }\n\n    this.onRefresh();\n    this.editTimeRaw = this.timeRaw;\n    this.timeOptions = rangeUtil.getRelativeTimesList(this.panel, this.rangeString);\n    this.refresh = {\n      value: this.dashboard.refresh,\n      options: _.map(this.panel.refresh_intervals, (interval: any) => {\n        return { text: interval, value: interval };\n      }),\n    };\n\n    this.refresh.options.unshift({ text: 'off' });\n    this.isOpen = true;\n    this.$rootScope.appEvent('timepickerOpen');\n  }\n\n  closeDropdown() {\n    this.isOpen = false;\n    this.$rootScope.appEvent('timepickerClosed');\n  }\n\n  applyCustom() {\n    if (this.refresh.value !== this.dashboard.refresh) {\n      this.timeSrv.setAutoRefresh(this.refresh.value);\n    }\n\n    this.timeSrv.setTime(this.editTimeRaw);\n    this.closeDropdown();\n  }\n\n  absoluteFromChanged() {\n    this.editTimeRaw.from = this.getAbsoluteMomentForTimezone(this.absolute.fromJs);\n  }\n\n  absoluteToChanged() {\n    this.editTimeRaw.to = this.getAbsoluteMomentForTimezone(this.absolute.toJs);\n  }\n\n  getAbsoluteMomentForTimezone(jsDate) {\n    return this.dashboard.isTimezoneUtc() ? moment(jsDate).utc() : moment(jsDate);\n  }\n\n  setRelativeFilter(timespan) {\n    const range = { from: timespan.from, to: timespan.to };\n\n    if (this.panel.nowDelay && range.to === 'now') {\n      range.to = 'now-' + this.panel.nowDelay;\n    }\n\n    this.timeSrv.setTime(range);\n    this.closeDropdown();\n  }\n}\n\nexport function settingsDirective() {\n  return {\n    restrict: 'E',\n    templateUrl: 'public/app/features/dashboard/timepicker/settings.html',\n    controller: TimePickerCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: {\n      dashboard: '=',\n    },\n  };\n}\n\nexport function timePickerDirective() {\n  return {\n    restrict: 'E',\n    templateUrl: 'public/app/features/dashboard/timepicker/timepicker.html',\n    controller: TimePickerCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: {\n      dashboard: '=',\n    },\n  };\n}\n\nangular.module('grafana.directives').directive('gfTimePickerSettings', settingsDirective);\nangular.module('grafana.directives').directive('gfTimePicker', timePickerDirective);\n\nimport { inputDateDirective } from './input_date';\nangular.module('grafana.directives').directive('inputDatetime', inputDateDirective);\n","import coreModule from 'app/core/core_module';\nimport appEvents from 'app/core/app_events';\nimport angular from 'angular';\n\nconst template = `\n<input type=\"file\" id=\"dashupload\" name=\"dashupload\" class=\"hide\" onchange=\"angular.element(this).scope().file_selected\"/>\n<label class=\"btn btn-success\" for=\"dashupload\">\n  <i class=\"fa fa-upload\"></i>\n  {{btnText}}\n</label>\n`;\n\n/** @ngInject */\nfunction uploadDashboardDirective(timer, alertSrv, $location) {\n  return {\n    restrict: 'E',\n    template: template,\n    scope: {\n      onUpload: '&',\n      btnText: '@?',\n    },\n    link: (scope, elem) => {\n      scope.btnText = angular.isDefined(scope.btnText) ? scope.btnText : 'Upload .json File';\n\n      function file_selected(evt) {\n        const files = evt.target.files; // FileList object\n        const readerOnload = () => {\n          return e => {\n            let dash;\n            try {\n              dash = JSON.parse(e.target.result);\n            } catch (err) {\n              console.log(err);\n              appEvents.emit('alert-error', ['Import failed', 'JSON -> JS Serialization failed: ' + err.message]);\n              return;\n            }\n\n            scope.$apply(() => {\n              scope.onUpload({ dash: dash });\n            });\n          };\n        };\n\n        let i = 0;\n        let file = files[i];\n\n        while (file) {\n          const reader = new FileReader();\n          reader.onload = readerOnload();\n          reader.readAsText(file);\n          i += 1;\n          file = files[i];\n        }\n      }\n\n      const wnd: any = window;\n      // Check for the various File API support.\n      if (wnd.File && wnd.FileReader && wnd.FileList && wnd.Blob) {\n        // Something\n        elem[0].addEventListener('change', file_selected, false);\n      } else {\n        alertSrv.set('Oops', 'Sorry, the HTML5 File APIs are not fully supported in this browser.', 'error');\n      }\n    },\n  };\n}\n\ncoreModule.directive('dashUpload', uploadDashboardDirective);\n","import config from 'app/core/config';\nimport _ from 'lodash';\nimport { DashboardModel } from '../dashboard_model';\n\nexport class DashboardExporter {\n  constructor(private datasourceSrv) {}\n\n  makeExportable(dashboard: DashboardModel) {\n    // clean up repeated rows and panels,\n    // this is done on the live real dashboard instance, not on a clone\n    // so we need to undo this\n    // this is pretty hacky and needs to be changed\n    dashboard.cleanUpRepeats();\n\n    const saveModel = dashboard.getSaveModelClone();\n    saveModel.id = null;\n\n    // undo repeat cleanup\n    dashboard.processRepeats();\n\n    const inputs = [];\n    const requires = {};\n    const datasources = {};\n    const promises = [];\n    const variableLookup: any = {};\n\n    for (const variable of saveModel.templating.list) {\n      variableLookup[variable.name] = variable;\n    }\n\n    const templateizeDatasourceUsage = obj => {\n      let datasource = obj.datasource;\n      let datasourceVariable = null;\n\n      // ignore data source properties that contain a variable\n      if (datasource && datasource.indexOf('$') === 0) {\n        datasourceVariable = variableLookup[datasource.substring(1)];\n        if (datasourceVariable && datasourceVariable.current) {\n          datasource = datasourceVariable.current.value;\n        }\n      }\n\n      promises.push(\n        this.datasourceSrv.get(datasource).then(ds => {\n          if (ds.meta.builtIn) {\n            return;\n          }\n\n          // add data source type to require list\n          requires['datasource' + ds.meta.id] = {\n            type: 'datasource',\n            id: ds.meta.id,\n            name: ds.meta.name,\n            version: ds.meta.info.version || '1.0.0',\n          };\n\n          // if used via variable we can skip templatizing usage\n          if (datasourceVariable) {\n            return;\n          }\n\n          const refName = 'DS_' + ds.name.replace(' ', '_').toUpperCase();\n          datasources[refName] = {\n            name: refName,\n            label: ds.name,\n            description: '',\n            type: 'datasource',\n            pluginId: ds.meta.id,\n            pluginName: ds.meta.name,\n          };\n\n          obj.datasource = '${' + refName + '}';\n        })\n      );\n    };\n\n    const processPanel = panel => {\n      if (panel.datasource !== undefined) {\n        templateizeDatasourceUsage(panel);\n      }\n\n      if (panel.targets) {\n        for (const target of panel.targets) {\n          if (target.datasource !== undefined) {\n            templateizeDatasourceUsage(target);\n          }\n        }\n      }\n\n      const panelDef = config.panels[panel.type];\n      if (panelDef) {\n        requires['panel' + panelDef.id] = {\n          type: 'panel',\n          id: panelDef.id,\n          name: panelDef.name,\n          version: panelDef.info.version,\n        };\n      }\n    };\n\n    // check up panel data sources\n    for (const panel of saveModel.panels) {\n      processPanel(panel);\n\n      // handle collapsed rows\n      if (panel.collapsed !== undefined && panel.collapsed === true && panel.panels) {\n        for (const rowPanel of panel.panels) {\n          processPanel(rowPanel);\n        }\n      }\n    }\n\n    // templatize template vars\n    for (const variable of saveModel.templating.list) {\n      if (variable.type === 'query') {\n        templateizeDatasourceUsage(variable);\n        variable.options = [];\n        variable.current = {};\n        variable.refresh = variable.refresh > 0 ? variable.refresh : 1;\n      }\n    }\n\n    // templatize annotations vars\n    for (const annotationDef of saveModel.annotations.list) {\n      templateizeDatasourceUsage(annotationDef);\n    }\n\n    // add grafana version\n    requires['grafana'] = {\n      type: 'grafana',\n      id: 'grafana',\n      name: 'Grafana',\n      version: config.buildInfo.version,\n    };\n\n    return Promise.all(promises)\n      .then(() => {\n        _.each(datasources, (value, key) => {\n          inputs.push(value);\n        });\n\n        // templatize constants\n        for (const variable of saveModel.templating.list) {\n          if (variable.type === 'constant') {\n            const refName = 'VAR_' + variable.name.replace(' ', '_').toUpperCase();\n            inputs.push({\n              name: refName,\n              type: 'constant',\n              label: variable.label || variable.name,\n              value: variable.current.value,\n              description: '',\n            });\n            // update current and option\n            variable.query = '${' + refName + '}';\n            variable.options[0] = variable.current = {\n              value: variable.query,\n              text: variable.query,\n            };\n          }\n        }\n\n        // make inputs and requires a top thing\n        const newObj = {};\n        newObj['__inputs'] = inputs;\n        newObj['__requires'] = _.sortBy(requires, ['id']);\n\n        _.defaults(newObj, saveModel);\n        return newObj;\n      })\n      .catch(err => {\n        console.log('Export failed:', err);\n        return {\n          error: err,\n        };\n      });\n  }\n}\n","import angular from 'angular';\nimport * as fileExport from 'app/core/utils/file_export';\nimport appEvents from 'app/core/app_events';\n\nexport class ExportDataModalCtrl {\n  private data: any[];\n  private panel: string;\n  asRows = true;\n  dateTimeFormat = 'YYYY-MM-DDTHH:mm:ssZ';\n  excel = false;\n\n  export() {\n    if (this.panel === 'table') {\n      fileExport.exportTableDataToCsv(this.data, this.excel);\n    } else {\n      if (this.asRows) {\n        fileExport.exportSeriesListToCsv(this.data, this.dateTimeFormat, this.excel);\n      } else {\n        fileExport.exportSeriesListToCsvColumns(this.data, this.dateTimeFormat, this.excel);\n      }\n    }\n\n    this.dismiss();\n  }\n\n  dismiss() {\n    appEvents.emit('hide-modal');\n  }\n}\n\nexport function exportDataModal() {\n  return {\n    restrict: 'E',\n    templateUrl: 'public/app/features/dashboard/export_data/export_data_modal.html',\n    controller: ExportDataModalCtrl,\n    controllerAs: 'ctrl',\n    scope: {\n      panel: '<',\n      data: '<', // The difference to '=' is that the bound properties are not watched\n    },\n    bindToController: true,\n  };\n}\n\nangular.module('grafana.directives').directive('exportDataModal', exportDataModal);\n","import angular from 'angular';\nimport { saveAs } from 'file-saver';\n\nimport coreModule from 'app/core/core_module';\nimport { DashboardExporter } from './exporter';\n\nexport class DashExportCtrl {\n  dash: any;\n  exporter: DashboardExporter;\n  dismiss: () => void;\n  shareExternally: boolean;\n\n  /** @ngInject */\n  constructor(private dashboardSrv, datasourceSrv, private $scope, private $rootScope) {\n    this.exporter = new DashboardExporter(datasourceSrv);\n\n    this.dash = this.dashboardSrv.getCurrent();\n  }\n\n  saveDashboardAsFile() {\n    if (this.shareExternally) {\n      this.exporter.makeExportable(this.dash).then((dashboardJson: any) => {\n        this.$scope.$apply(() => {\n          this.openSaveAsDialog(dashboardJson);\n        });\n      });\n    } else {\n      this.openSaveAsDialog(this.dash.getSaveModelClone());\n    }\n  }\n\n  viewJson() {\n    if (this.shareExternally) {\n      this.exporter.makeExportable(this.dash).then((dashboardJson: any) => {\n        this.$scope.$apply(() => {\n          this.openJsonModal(dashboardJson);\n        });\n      });\n    } else {\n      this.openJsonModal(this.dash.getSaveModelClone());\n    }\n  }\n\n  private openSaveAsDialog(dash: any) {\n    const blob = new Blob([angular.toJson(dash, true)], {\n      type: 'application/json;charset=utf-8',\n    });\n    saveAs(blob, dash.title + '-' + new Date().getTime() + '.json');\n  }\n\n  private openJsonModal(clone: any) {\n    const editScope = this.$rootScope.$new();\n    editScope.object = clone;\n    editScope.enableCopy = true;\n\n    this.$rootScope.appEvent('show-modal', {\n      src: 'public/app/partials/edit_json.html',\n      scope: editScope,\n    });\n\n    this.dismiss();\n  }\n}\n\nexport function dashExportDirective() {\n  return {\n    restrict: 'E',\n    templateUrl: 'public/app/features/dashboard/export/export_modal.html',\n    controller: DashExportCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: { dismiss: '&' },\n  };\n}\n\ncoreModule.directive('dashExportModal', dashExportDirective);\n","import _ from 'lodash';\nimport angular from 'angular';\nimport coreModule from 'app/core/core_module';\n\nexport class AdHocFiltersCtrl {\n  segments: any;\n  variable: any;\n  removeTagFilterSegment: any;\n\n  /** @ngInject */\n  constructor(\n    private uiSegmentSrv,\n    private datasourceSrv,\n    private $q,\n    private variableSrv,\n    $scope,\n    private $rootScope\n  ) {\n    this.removeTagFilterSegment = uiSegmentSrv.newSegment({\n      fake: true,\n      value: '-- remove filter --',\n    });\n    this.buildSegmentModel();\n    this.$rootScope.onAppEvent('template-variable-value-updated', this.buildSegmentModel.bind(this), $scope);\n  }\n\n  buildSegmentModel() {\n    this.segments = [];\n\n    if (this.variable.value && !_.isArray(this.variable.value)) {\n    }\n\n    for (const tag of this.variable.filters) {\n      if (this.segments.length > 0) {\n        this.segments.push(this.uiSegmentSrv.newCondition('AND'));\n      }\n\n      if (tag.key !== undefined && tag.value !== undefined) {\n        this.segments.push(this.uiSegmentSrv.newKey(tag.key));\n        this.segments.push(this.uiSegmentSrv.newOperator(tag.operator));\n        this.segments.push(this.uiSegmentSrv.newKeyValue(tag.value));\n      }\n    }\n\n    this.segments.push(this.uiSegmentSrv.newPlusButton());\n  }\n\n  getOptions(segment, index) {\n    if (segment.type === 'operator') {\n      return this.$q.when(this.uiSegmentSrv.newOperators(['=', '!=', '<', '>', '=~', '!~']));\n    }\n\n    if (segment.type === 'condition') {\n      return this.$q.when([this.uiSegmentSrv.newSegment('AND')]);\n    }\n\n    return this.datasourceSrv.get(this.variable.datasource).then(ds => {\n      const options: any = {};\n      let promise = null;\n\n      if (segment.type !== 'value') {\n        promise = ds.getTagKeys ? ds.getTagKeys() : Promise.resolve([]);\n      } else {\n        options.key = this.segments[index - 2].value;\n        promise = ds.getTagValues ? ds.getTagValues(options) : Promise.resolve([]);\n      }\n\n      return promise.then(results => {\n        results = _.map(results, segment => {\n          return this.uiSegmentSrv.newSegment({ value: segment.text });\n        });\n\n        // add remove option for keys\n        if (segment.type === 'key') {\n          results.splice(0, 0, angular.copy(this.removeTagFilterSegment));\n        }\n        return results;\n      });\n    });\n  }\n\n  segmentChanged(segment, index) {\n    this.segments[index] = segment;\n\n    // handle remove tag condition\n    if (segment.value === this.removeTagFilterSegment.value) {\n      this.segments.splice(index, 3);\n      if (this.segments.length === 0) {\n        this.segments.push(this.uiSegmentSrv.newPlusButton());\n      } else if (this.segments.length > 2) {\n        this.segments.splice(Math.max(index - 1, 0), 1);\n        if (this.segments[this.segments.length - 1].type !== 'plus-button') {\n          this.segments.push(this.uiSegmentSrv.newPlusButton());\n        }\n      }\n    } else {\n      if (segment.type === 'plus-button') {\n        if (index > 2) {\n          this.segments.splice(index, 0, this.uiSegmentSrv.newCondition('AND'));\n        }\n        this.segments.push(this.uiSegmentSrv.newOperator('='));\n        this.segments.push(this.uiSegmentSrv.newFake('select value', 'value', 'query-segment-value'));\n        segment.type = 'key';\n        segment.cssClass = 'query-segment-key';\n      }\n\n      if (index + 1 === this.segments.length) {\n        this.segments.push(this.uiSegmentSrv.newPlusButton());\n      }\n    }\n\n    this.updateVariableModel();\n  }\n\n  updateVariableModel() {\n    const filters = [];\n    let filterIndex = -1;\n    let hasFakes = false;\n\n    this.segments.forEach(segment => {\n      if (segment.type === 'value' && segment.fake) {\n        hasFakes = true;\n        return;\n      }\n\n      switch (segment.type) {\n        case 'key': {\n          filters.push({ key: segment.value });\n          filterIndex += 1;\n          break;\n        }\n        case 'value': {\n          filters[filterIndex].value = segment.value;\n          break;\n        }\n        case 'operator': {\n          filters[filterIndex].operator = segment.value;\n          break;\n        }\n        case 'condition': {\n          filters[filterIndex].condition = segment.value;\n          break;\n        }\n      }\n    });\n\n    if (hasFakes) {\n      return;\n    }\n\n    this.variable.setFilters(filters);\n    this.variableSrv.variableUpdated(this.variable, true);\n  }\n}\n\nconst template = `\n<div class=\"gf-form-inline\">\n  <div class=\"gf-form\" ng-repeat=\"segment in ctrl.segments\">\n    <metric-segment segment=\"segment\" get-options=\"ctrl.getOptions(segment, $index)\"\n                    on-change=\"ctrl.segmentChanged(segment, $index)\"></metric-segment>\n  </div>\n</div>\n`;\n\nexport function adHocFiltersComponent() {\n  return {\n    restrict: 'E',\n    template: template,\n    controller: AdHocFiltersCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: {\n      variable: '=',\n    },\n  };\n}\n\ncoreModule.directive('adHocFilters', adHocFiltersComponent);\n","import { coreModule } from 'app/core/core';\n\nconst template = `\n<div class=\"gf-form-select-wrapper max-width-18\">\n  <select class=\"gf-form-input\" ng-model=\"panel.repeat\" ng-options=\"f.value as f.text for f in variables\" ng-change=\"optionChanged()\">\n  <option value=\"\"></option>\n</div>\n`;\n\n/** @ngInject */\nfunction dashRepeatOptionDirective(variableSrv) {\n  return {\n    restrict: 'E',\n    template: template,\n    scope: {\n      panel: '=',\n    },\n    link: (scope, element) => {\n      element.css({ display: 'block', width: '100%' });\n\n      scope.variables = variableSrv.variables.map(item => {\n        return { text: item.name, value: item.name };\n      });\n\n      if (scope.variables.length === 0) {\n        scope.variables.unshift({\n          text: 'No template variables found',\n          value: null,\n        });\n      }\n\n      scope.variables.unshift({ text: 'Disabled', value: null });\n\n      // if repeat is set and no direction set to horizontal\n      if (scope.panel.repeat && !scope.panel.repeatDirection) {\n        scope.panel.repeatDirection = 'h';\n      }\n\n      scope.optionChanged = () => {\n        if (scope.panel.repeat) {\n          scope.panel.repeatDirection = 'h';\n        }\n      };\n    },\n  };\n}\n\ncoreModule.directive('dashRepeatOption', dashRepeatOptionDirective);\n","import React from 'react';\nimport classNames from 'classnames';\nimport { PanelModel } from '../panel_model';\nimport { PanelContainer } from './PanelContainer';\nimport templateSrv from 'app/features/templating/template_srv';\nimport appEvents from 'app/core/app_events';\n\nexport interface DashboardRowProps {\n  panel: PanelModel;\n  getPanelContainer: () => PanelContainer;\n}\n\nexport class DashboardRow extends React.Component<DashboardRowProps, any> {\n  dashboard: any;\n  panelContainer: any;\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      collapsed: this.props.panel.collapsed,\n    };\n\n    this.panelContainer = this.props.getPanelContainer();\n    this.dashboard = this.panelContainer.getDashboard();\n\n    this.toggle = this.toggle.bind(this);\n    this.openSettings = this.openSettings.bind(this);\n    this.delete = this.delete.bind(this);\n    this.update = this.update.bind(this);\n  }\n\n  toggle() {\n    this.dashboard.toggleRow(this.props.panel);\n\n    this.setState(prevState => {\n      return { collapsed: !prevState.collapsed };\n    });\n  }\n\n  update() {\n    this.dashboard.processRepeats();\n    this.forceUpdate();\n  }\n\n  openSettings() {\n    appEvents.emit('show-modal', {\n      templateHtml: `<row-options row=\"model.row\" on-updated=\"model.onUpdated()\" dismiss=\"dismiss()\"></row-options>`,\n      modalClass: 'modal--narrow',\n      model: {\n        row: this.props.panel,\n        onUpdated: this.update.bind(this),\n      },\n    });\n  }\n\n  delete() {\n    appEvents.emit('confirm-modal', {\n      title: 'Delete Row',\n      text: 'Are you sure you want to remove this row and all its panels?',\n      altActionText: 'Delete row only',\n      icon: 'fa-trash',\n      onConfirm: () => {\n        const panelContainer = this.props.getPanelContainer();\n        const dashboard = panelContainer.getDashboard();\n        dashboard.removeRow(this.props.panel, true);\n      },\n      onAltAction: () => {\n        const panelContainer = this.props.getPanelContainer();\n        const dashboard = panelContainer.getDashboard();\n        dashboard.removeRow(this.props.panel, false);\n      },\n    });\n  }\n\n  render() {\n    const classes = classNames({\n      'dashboard-row': true,\n      'dashboard-row--collapsed': this.state.collapsed,\n    });\n    const chevronClass = classNames({\n      fa: true,\n      'fa-chevron-down': !this.state.collapsed,\n      'fa-chevron-right': this.state.collapsed,\n    });\n\n    const title = templateSrv.replaceWithText(this.props.panel.title, this.props.panel.scopedVars);\n    const count = this.props.panel.panels ? this.props.panel.panels.length : 0;\n    const panels = count === 1 ? 'panel' : 'panels';\n\n    return (\n      <div className={classes}>\n        <a className=\"dashboard-row__title pointer\" onClick={this.toggle}>\n          <i className={chevronClass} />\n          {title}\n          <span className=\"dashboard-row__panel_count\">\n            ({count} {panels})\n          </span>\n        </a>\n        {this.dashboard.meta.canEdit === true && (\n          <div className=\"dashboard-row__actions\">\n            <a className=\"pointer\" onClick={this.openSettings}>\n              <i className=\"fa fa-cog\" />\n            </a>\n            <a className=\"pointer\" onClick={this.delete}>\n              <i className=\"fa fa-trash\" />\n            </a>\n          </div>\n        )}\n        {this.state.collapsed === true && (\n          <div className=\"dashboard-row__toggle-target\" onClick={this.toggle}>\n            &nbsp;\n          </div>\n        )}\n        <div className=\"dashboard-row__drag grid-drag-handle\" />\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport baron from 'baron';\n\nexport interface Props {\n  children: any;\n  className: string;\n}\n\nexport default class ScrollBar extends React.Component<Props, any> {\n  private container: any;\n  private scrollbar: baron;\n\n  constructor(props) {\n    super(props);\n  }\n\n  componentDidMount() {\n    this.scrollbar = baron({\n      root: this.container.parentElement,\n      scroller: this.container,\n      bar: '.baron__bar',\n      barOnCls: '_scrollbar',\n      scrollingCls: '_scrolling',\n      track: '.baron__track',\n    });\n  }\n\n  componentDidUpdate() {\n    this.scrollbar.update();\n  }\n\n  componentWillUnmount() {\n    this.scrollbar.dispose();\n  }\n\n  // methods can be invoked by outside\n  setScrollTop(top) {\n    if (this.container) {\n      this.container.scrollTop = top;\n      this.scrollbar.update();\n\n      return true;\n    }\n    return false;\n  }\n\n  setScrollLeft(left) {\n    if (this.container) {\n      this.container.scrollLeft = left;\n      this.scrollbar.update();\n\n      return true;\n    }\n    return false;\n  }\n\n  update() {\n    this.scrollbar.update();\n  }\n\n  handleRef = ref => {\n    this.container = ref;\n  };\n\n  render() {\n    return (\n      <div className=\"baron baron__root baron__clipper\">\n        <div className={this.props.className + ' baron__scroller'} ref={this.handleRef}>\n          {this.props.children}\n        </div>\n\n        <div className=\"baron__track\">\n          <div className=\"baron__bar\" />\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport config from 'app/core/config';\nimport { PanelModel } from '../panel_model';\nimport { PanelContainer } from './PanelContainer';\nimport ScrollBar from 'app/core/components/ScrollBar/ScrollBar';\nimport store from 'app/core/store';\nimport { LS_PANEL_COPY_KEY } from 'app/core/constants';\nimport Highlighter from 'react-highlight-words';\n\nexport interface AddPanelPanelProps {\n  panel: PanelModel;\n  getPanelContainer: () => PanelContainer;\n}\n\nexport interface AddPanelPanelState {\n  filter: string;\n  panelPlugins: any[];\n  copiedPanelPlugins: any[];\n  tab: string;\n}\n\nexport class AddPanelPanel extends React.Component<AddPanelPanelProps, AddPanelPanelState> {\n  private scrollbar: ScrollBar;\n\n  constructor(props) {\n    super(props);\n    this.handleCloseAddPanel = this.handleCloseAddPanel.bind(this);\n    this.renderPanelItem = this.renderPanelItem.bind(this);\n    this.panelSizeChanged = this.panelSizeChanged.bind(this);\n\n    this.state = {\n      panelPlugins: this.getPanelPlugins(''),\n      copiedPanelPlugins: this.getCopiedPanelPlugins(''),\n      filter: '',\n      tab: 'Add',\n    };\n  }\n\n  componentDidMount() {\n    this.props.panel.events.on('panel-size-changed', this.panelSizeChanged);\n  }\n\n  componentWillUnmount() {\n    this.props.panel.events.off('panel-size-changed', this.panelSizeChanged);\n  }\n\n  panelSizeChanged() {\n    setTimeout(() => {\n      this.scrollbar.update();\n    });\n  }\n\n  getPanelPlugins(filter) {\n    let panels = _.chain(config.panels)\n      .filter({ hideFromList: false })\n      .map(item => item)\n      .value();\n\n    // add special row type\n    panels.push({ id: 'row', name: 'Row', sort: 8, info: { logos: { small: 'public/img/icn-row.svg' } } });\n\n    panels = this.filterPanels(panels, filter);\n\n    // add sort by sort property\n    return _.sortBy(panels, 'sort');\n  }\n\n  getCopiedPanelPlugins(filter) {\n    const panels = _.chain(config.panels)\n      .filter({ hideFromList: false })\n      .map(item => item)\n      .value();\n    let copiedPanels = [];\n\n    const copiedPanelJson = store.get(LS_PANEL_COPY_KEY);\n    if (copiedPanelJson) {\n      const copiedPanel = JSON.parse(copiedPanelJson);\n      const pluginInfo = _.find(panels, { id: copiedPanel.type });\n      if (pluginInfo) {\n        const pluginCopy = _.cloneDeep(pluginInfo);\n        pluginCopy.name = copiedPanel.title;\n        pluginCopy.sort = -1;\n        pluginCopy.defaults = copiedPanel;\n        copiedPanels.push(pluginCopy);\n      }\n    }\n\n    copiedPanels = this.filterPanels(copiedPanels, filter);\n\n    return _.sortBy(copiedPanels, 'sort');\n  }\n\n  onAddPanel = panelPluginInfo => {\n    const panelContainer = this.props.getPanelContainer();\n    const dashboard = panelContainer.getDashboard();\n    const { gridPos } = this.props.panel;\n\n    const newPanel: any = {\n      type: panelPluginInfo.id,\n      title: 'Panel Title',\n      gridPos: { x: gridPos.x, y: gridPos.y, w: gridPos.w, h: gridPos.h },\n    };\n\n    if (panelPluginInfo.id === 'row') {\n      newPanel.title = 'Row title';\n      newPanel.gridPos = { x: 0, y: 0 };\n    }\n\n    // apply panel template / defaults\n    if (panelPluginInfo.defaults) {\n      _.defaults(newPanel, panelPluginInfo.defaults);\n      newPanel.gridPos.w = panelPluginInfo.defaults.gridPos.w;\n      newPanel.gridPos.h = panelPluginInfo.defaults.gridPos.h;\n      newPanel.title = panelPluginInfo.defaults.title;\n      store.delete(LS_PANEL_COPY_KEY);\n    }\n\n    dashboard.addPanel(newPanel);\n    dashboard.removePanel(this.props.panel);\n  };\n\n  handleCloseAddPanel(evt) {\n    evt.preventDefault();\n    const panelContainer = this.props.getPanelContainer();\n    const dashboard = panelContainer.getDashboard();\n    dashboard.removePanel(dashboard.panels[0]);\n  }\n\n  renderText(text: string) {\n    const searchWords = this.state.filter.split('');\n    return <Highlighter highlightClassName=\"highlight-search-match\" textToHighlight={text} searchWords={searchWords} />;\n  }\n\n  renderPanelItem(panel, index) {\n    return (\n      <div key={index} className=\"add-panel__item\" onClick={() => this.onAddPanel(panel)} title={panel.name}>\n        <img className=\"add-panel__item-img\" src={panel.info.logos.small} />\n        <div className=\"add-panel__item-name\">{this.renderText(panel.name)}</div>\n      </div>\n    );\n  }\n\n  noCopiedPanelPlugins() {\n    return <div className=\"add-panel__no-panels\">No copied panels yet.</div>;\n  }\n\n  filterChange(evt) {\n    this.setState({\n      filter: evt.target.value,\n      panelPlugins: this.getPanelPlugins(evt.target.value),\n      copiedPanelPlugins: this.getCopiedPanelPlugins(evt.target.value),\n    });\n  }\n\n  filterKeyPress(evt) {\n    if (evt.key === 'Enter') {\n      const panel = _.head(this.state.panelPlugins);\n      if (panel) {\n        this.onAddPanel(panel);\n      }\n    }\n  }\n\n  filterPanels(panels, filter) {\n    const regex = new RegExp(filter, 'i');\n    return panels.filter(panel => {\n      return regex.test(panel.name);\n    });\n  }\n\n  openCopy() {\n    this.setState({\n      tab: 'Copy',\n      filter: '',\n      panelPlugins: this.getPanelPlugins(''),\n      copiedPanelPlugins: this.getCopiedPanelPlugins(''),\n    });\n  }\n\n  openAdd() {\n    this.setState({\n      tab: 'Add',\n      filter: '',\n      panelPlugins: this.getPanelPlugins(''),\n      copiedPanelPlugins: this.getCopiedPanelPlugins(''),\n    });\n  }\n\n  render() {\n    const addClass = classNames({\n      'active active--panel': this.state.tab === 'Add',\n      '': this.state.tab === 'Copy',\n    });\n\n    const copyClass = classNames({\n      '': this.state.tab === 'Add',\n      'active active--panel': this.state.tab === 'Copy',\n    });\n\n    let panelTab;\n\n    if (this.state.tab === 'Add') {\n      panelTab = this.state.panelPlugins.map(this.renderPanelItem);\n    } else if (this.state.tab === 'Copy') {\n      if (this.state.copiedPanelPlugins.length > 0) {\n        panelTab = this.state.copiedPanelPlugins.map(this.renderPanelItem);\n      } else {\n        panelTab = this.noCopiedPanelPlugins();\n      }\n    }\n\n    return (\n      <div className=\"panel-container add-panel-container\">\n        <div className=\"add-panel\">\n          <div className=\"add-panel__header\">\n            <i className=\"gicon gicon-add-panel\" />\n            <span className=\"add-panel__title\">New Panel</span>\n            <ul className=\"gf-tabs\">\n              <li className=\"gf-tabs-item\">\n                <div className={'gf-tabs-link pointer ' + addClass} onClick={this.openAdd.bind(this)}>\n                  Add\n                </div>\n              </li>\n              <li className=\"gf-tabs-item\">\n                <div className={'gf-tabs-link pointer ' + copyClass} onClick={this.openCopy.bind(this)}>\n                  Paste\n                </div>\n              </li>\n            </ul>\n            <button className=\"add-panel__close\" onClick={this.handleCloseAddPanel}>\n              <i className=\"fa fa-close\" />\n            </button>\n          </div>\n          <ScrollBar ref={element => (this.scrollbar = element)} className=\"add-panel__items\">\n            <div className=\"add-panel__searchbar\">\n              <label className=\"gf-form gf-form--grow gf-form--has-input-icon\">\n                <input\n                  type=\"text\"\n                  autoFocus\n                  className=\"gf-form-input gf-form--grow\"\n                  placeholder=\"Panel Search Filter\"\n                  value={this.state.filter}\n                  onChange={this.filterChange.bind(this)}\n                  onKeyPress={this.filterKeyPress.bind(this)}\n                />\n                <i className=\"gf-form-input-icon fa fa-search\" />\n              </label>\n            </div>\n            {panelTab}\n          </ScrollBar>\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport ReactGridLayout from 'react-grid-layout';\nimport { GRID_CELL_HEIGHT, GRID_CELL_VMARGIN, GRID_COLUMN_COUNT } from 'app/core/constants';\nimport { DashboardPanel } from './DashboardPanel';\nimport { DashboardModel } from '../dashboard_model';\nimport { PanelContainer } from './PanelContainer';\nimport { PanelModel } from '../panel_model';\nimport classNames from 'classnames';\nimport sizeMe from 'react-sizeme';\n\nlet lastGridWidth = 1200;\n\nfunction GridWrapper({\n  size,\n  layout,\n  onLayoutChange,\n  children,\n  onDragStop,\n  onResize,\n  onResizeStop,\n  onWidthChange,\n  className,\n  isResizable,\n  isDraggable,\n}) {\n  if (size.width === 0) {\n    console.log('size is zero!');\n  }\n\n  const width = size.width > 0 ? size.width : lastGridWidth;\n  if (width !== lastGridWidth) {\n    onWidthChange();\n    lastGridWidth = width;\n  }\n\n  return (\n    <ReactGridLayout\n      width={lastGridWidth}\n      className={className}\n      isDraggable={isDraggable}\n      isResizable={isResizable}\n      measureBeforeMount={false}\n      containerPadding={[0, 0]}\n      useCSSTransforms={true}\n      margin={[GRID_CELL_VMARGIN, GRID_CELL_VMARGIN]}\n      cols={GRID_COLUMN_COUNT}\n      rowHeight={GRID_CELL_HEIGHT}\n      draggableHandle=\".grid-drag-handle\"\n      layout={layout}\n      onResize={onResize}\n      onResizeStop={onResizeStop}\n      onDragStop={onDragStop}\n      onLayoutChange={onLayoutChange}\n    >\n      {children}\n    </ReactGridLayout>\n  );\n}\n\nconst SizedReactLayoutGrid = sizeMe({ monitorWidth: true })(GridWrapper);\n\nexport interface DashboardGridProps {\n  getPanelContainer: () => PanelContainer;\n}\n\nexport class DashboardGrid extends React.Component<DashboardGridProps, any> {\n  gridToPanelMap: any;\n  panelContainer: PanelContainer;\n  dashboard: DashboardModel;\n  panelMap: { [id: string]: PanelModel };\n\n  constructor(props) {\n    super(props);\n    this.panelContainer = this.props.getPanelContainer();\n    this.onLayoutChange = this.onLayoutChange.bind(this);\n    this.onResize = this.onResize.bind(this);\n    this.onResizeStop = this.onResizeStop.bind(this);\n    this.onDragStop = this.onDragStop.bind(this);\n    this.onWidthChange = this.onWidthChange.bind(this);\n\n    this.state = { animated: false };\n\n    // subscribe to dashboard events\n    this.dashboard = this.panelContainer.getDashboard();\n    this.dashboard.on('panel-added', this.triggerForceUpdate.bind(this));\n    this.dashboard.on('panel-removed', this.triggerForceUpdate.bind(this));\n    this.dashboard.on('repeats-processed', this.triggerForceUpdate.bind(this));\n    this.dashboard.on('view-mode-changed', this.triggerForceUpdate.bind(this));\n    this.dashboard.on('row-collapsed', this.triggerForceUpdate.bind(this));\n    this.dashboard.on('row-expanded', this.triggerForceUpdate.bind(this));\n  }\n\n  buildLayout() {\n    const layout = [];\n    this.panelMap = {};\n\n    for (const panel of this.dashboard.panels) {\n      const stringId = panel.id.toString();\n      this.panelMap[stringId] = panel;\n\n      if (!panel.gridPos) {\n        console.log('panel without gridpos');\n        continue;\n      }\n\n      const panelPos: any = {\n        i: stringId,\n        x: panel.gridPos.x,\n        y: panel.gridPos.y,\n        w: panel.gridPos.w,\n        h: panel.gridPos.h,\n      };\n\n      if (panel.type === 'row') {\n        panelPos.w = GRID_COLUMN_COUNT;\n        panelPos.h = 1;\n        panelPos.isResizable = false;\n        panelPos.isDraggable = panel.collapsed;\n      }\n\n      layout.push(panelPos);\n    }\n\n    return layout;\n  }\n\n  onLayoutChange(newLayout) {\n    for (const newPos of newLayout) {\n      this.panelMap[newPos.i].updateGridPos(newPos);\n    }\n\n    this.dashboard.sortPanelsByGridPos();\n  }\n\n  triggerForceUpdate() {\n    this.forceUpdate();\n  }\n\n  onWidthChange() {\n    for (const panel of this.dashboard.panels) {\n      panel.resizeDone();\n    }\n  }\n\n  updateGridPos(item, layout) {\n    this.panelMap[item.i].updateGridPos(item);\n\n    // react-grid-layout has a bug (#670), and onLayoutChange() is only called when the component is mounted.\n    // So it's required to call it explicitly when panel resized or moved to save layout changes.\n    this.onLayoutChange(layout);\n  }\n\n  onResize(layout, oldItem, newItem) {\n    this.panelMap[newItem.i].updateGridPos(newItem);\n  }\n\n  onResizeStop(layout, oldItem, newItem) {\n    this.updateGridPos(newItem, layout);\n    this.panelMap[newItem.i].resizeDone();\n  }\n\n  onDragStop(layout, oldItem, newItem) {\n    this.updateGridPos(newItem, layout);\n  }\n\n  componentDidMount() {\n    setTimeout(() => {\n      this.setState(() => {\n        return { animated: true };\n      });\n    });\n  }\n\n  renderPanels() {\n    const panelElements = [];\n\n    for (const panel of this.dashboard.panels) {\n      const panelClasses = classNames({ panel: true, 'panel--fullscreen': panel.fullscreen });\n      panelElements.push(\n        /** panel-id is set for html bookmarks */\n        <div key={panel.id.toString()} className={panelClasses} id={`panel-${panel.id.toString()}`}>\n          <DashboardPanel panel={panel} getPanelContainer={this.props.getPanelContainer} />\n        </div>\n      );\n    }\n\n    return panelElements;\n  }\n\n  render() {\n    return (\n      <SizedReactLayoutGrid\n        className={classNames({ layout: true, animated: this.state.animated })}\n        layout={this.buildLayout()}\n        isResizable={this.dashboard.meta.canEdit}\n        isDraggable={this.dashboard.meta.canEdit}\n        onLayoutChange={this.onLayoutChange}\n        onWidthChange={this.onWidthChange}\n        onDragStop={this.onDragStop}\n        onResize={this.onResize}\n        onResizeStop={this.onResizeStop}\n      >\n        {this.renderPanels()}\n      </SizedReactLayoutGrid>\n    );\n  }\n}\n","import React from 'react';\nimport {PanelModel} from '../panel_model';\nimport {PanelContainer} from './PanelContainer';\nimport {AttachedPanel} from './PanelLoader';\nimport {DashboardRow} from './DashboardRow';\nimport {AddPanelPanel} from './AddPanelPanel';\n\nexport interface DashboardPanelProps {\n  panel: PanelModel;\n  getPanelContainer: () => PanelContainer;\n}\n\nexport class DashboardPanel extends React.Component<DashboardPanelProps, any> {\n  element: any;\n  attachedPanel: AttachedPanel;\n\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  componentDidMount() {\n    if (!this.element) {\n      return;\n    }\n\n    const panelContainer = this.props.getPanelContainer();\n    const dashboard = panelContainer.getDashboard();\n    const loader = panelContainer.getPanelLoader();\n    this.attachedPanel = loader.load(this.element, this.props.panel, dashboard);\n  }\n\n  componentWillUnmount() {\n    if (this.attachedPanel) {\n      this.attachedPanel.destroy();\n    }\n  }\n\n  render() {\n    // special handling for rows\n    if (this.props.panel.type === 'row') {\n      return <DashboardRow panel={this.props.panel} getPanelContainer={this.props.getPanelContainer} />;\n    }\n\n    if (this.props.panel.type === 'add-panel') {\n      return <AddPanelPanel panel={this.props.panel} getPanelContainer={this.props.getPanelContainer} />;\n    }\n\n    return (\n      <div ref={element => this.element = element} className=\"panel-height-helper\" />\n    );\n  }\n}\n\n","import angular from 'angular';\nimport coreModule from 'app/core/core_module';\n\nexport interface AttachedPanel {\n  destroy();\n}\n\nexport class PanelLoader {\n  /** @ngInject */\n  constructor(private $compile, private $rootScope) {}\n\n  load(elem, panel, dashboard): AttachedPanel {\n    const template = '<plugin-component type=\"panel\" class=\"panel-height-helper\"></plugin-component>';\n    const panelScope = this.$rootScope.$new();\n    panelScope.panel = panel;\n    panelScope.dashboard = dashboard;\n\n    const compiledElem = this.$compile(template)(panelScope);\n    const rootNode = angular.element(elem);\n    rootNode.append(compiledElem);\n\n    return {\n      destroy: () => {\n        panelScope.$destroy();\n        compiledElem.remove();\n      },\n    };\n  }\n}\n\ncoreModule.service('panelLoader', PanelLoader);\n","import { react2AngularDirective } from 'app/core/utils/react2angular';\nimport { DashboardGrid } from './DashboardGrid';\n\nreact2AngularDirective('dashboardGrid', DashboardGrid, [\n  ['getPanelContainer', { watchDepth: 'reference', wrapApply: false }],\n]);\n","import _ from 'lodash';\nimport coreModule from 'app/core/core_module';\nimport appEvents from 'app/core/app_events';\n\nexport class FolderPickerCtrl {\n  initialTitle: string;\n  initialFolderId?: number;\n  labelClass: string;\n  onChange: any;\n  onLoad: any;\n  onCreateFolder: any;\n  enterFolderCreation: any;\n  exitFolderCreation: any;\n  enableCreateNew: boolean;\n  enableReset: boolean;\n  rootName = 'General';\n  folder: any;\n  createNewFolder: boolean;\n  newFolderName: string;\n  newFolderNameTouched: boolean;\n  hasValidationError: boolean;\n  validationError: any;\n  isEditor: boolean;\n\n  /** @ngInject */\n  constructor(private backendSrv, private validationSrv, private contextSrv) {\n    this.isEditor = this.contextSrv.isEditor;\n\n    if (!this.labelClass) {\n      this.labelClass = 'width-7';\n    }\n\n    this.loadInitialValue();\n  }\n\n  getOptions(query) {\n    const params = {\n      query: query,\n      type: 'dash-folder',\n      permission: 'Edit',\n    };\n\n    return this.backendSrv.get('api/search', params).then(result => {\n      if (\n        this.isEditor &&\n        (query === '' ||\n          query.toLowerCase() === 'g' ||\n          query.toLowerCase() === 'ge' ||\n          query.toLowerCase() === 'gen' ||\n          query.toLowerCase() === 'gene' ||\n          query.toLowerCase() === 'gener' ||\n          query.toLowerCase() === 'genera' ||\n          query.toLowerCase() === 'general')\n      ) {\n        result.unshift({ title: this.rootName, id: 0 });\n      }\n\n      if (this.isEditor && this.enableCreateNew && query === '') {\n        result.unshift({ title: '-- New Folder --', id: -1 });\n      }\n\n      if (this.enableReset && query === '' && this.initialTitle !== '') {\n        result.unshift({ title: this.initialTitle, id: null });\n      }\n\n      return _.map(result, item => {\n        return { text: item.title, value: item.id };\n      });\n    });\n  }\n\n  onFolderChange(option) {\n    if (!option) {\n      option = { value: 0, text: this.rootName };\n    } else if (option.value === -1) {\n      this.createNewFolder = true;\n      this.enterFolderCreation();\n      return;\n    }\n    this.onChange({ $folder: { id: option.value, title: option.text } });\n  }\n\n  newFolderNameChanged() {\n    this.newFolderNameTouched = true;\n\n    this.validationSrv\n      .validateNewFolderName(this.newFolderName)\n      .then(() => {\n        this.hasValidationError = false;\n      })\n      .catch(err => {\n        this.hasValidationError = true;\n        this.validationError = err.message;\n      });\n  }\n\n  createFolder(evt) {\n    if (evt) {\n      evt.stopPropagation();\n      evt.preventDefault();\n    }\n\n    return this.backendSrv.createFolder({ title: this.newFolderName }).then(result => {\n      appEvents.emit('alert-success', ['Folder Created', 'OK']);\n\n      this.closeCreateFolder();\n      this.folder = { text: result.title, value: result.id };\n      this.onFolderChange(this.folder);\n    });\n  }\n\n  cancelCreateFolder(evt) {\n    if (evt) {\n      evt.stopPropagation();\n      evt.preventDefault();\n    }\n\n    this.closeCreateFolder();\n    this.loadInitialValue();\n  }\n\n  private closeCreateFolder() {\n    this.exitFolderCreation();\n    this.createNewFolder = false;\n    this.hasValidationError = false;\n    this.validationError = null;\n    this.newFolderName = '';\n    this.newFolderNameTouched = false;\n  }\n\n  private loadInitialValue() {\n    const resetFolder = { text: this.initialTitle, value: null };\n    const rootFolder = { text: this.rootName, value: 0 };\n\n    this.getOptions('').then(result => {\n      let folder;\n      if (this.initialFolderId) {\n        folder = _.find(result, { value: this.initialFolderId });\n      } else if (this.enableReset && this.initialTitle && this.initialFolderId === null) {\n        folder = resetFolder;\n      }\n\n      if (!folder) {\n        if (this.isEditor) {\n          folder = rootFolder;\n        } else {\n          folder = result.length > 0 ? result[0] : resetFolder;\n        }\n      }\n\n      this.folder = folder;\n\n      // if this is not the same as our initial value notify parent\n      if (this.folder.value !== this.initialFolderId) {\n        this.onChange({ $folder: { id: this.folder.value, title: this.folder.text } });\n      }\n    });\n  }\n}\n\nexport function folderPicker() {\n  return {\n    restrict: 'E',\n    templateUrl: 'public/app/features/dashboard/folder_picker/folder_picker.html',\n    controller: FolderPickerCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: {\n      initialTitle: '<',\n      initialFolderId: '<',\n      labelClass: '@',\n      rootName: '@',\n      onChange: '&',\n      onCreateFolder: '&',\n      enterFolderCreation: '&',\n      exitFolderCreation: '&',\n      enableCreateNew: '@',\n      enableReset: '@',\n    },\n  };\n}\n\ncoreModule.directive('folderPicker', folderPicker);\n","import { coreModule } from 'app/core/core';\n\nexport class RowOptionsCtrl {\n  row: any;\n  source: any;\n  dismiss: any;\n  onUpdated: any;\n  showDelete: boolean;\n\n  /** @ngInject */\n  constructor() {\n    this.source = this.row;\n    this.row = this.row.getSaveModel();\n  }\n\n  update() {\n    this.source.title = this.row.title;\n    this.source.repeat = this.row.repeat;\n    this.onUpdated();\n    this.dismiss();\n  }\n}\n\nexport function rowOptionsDirective() {\n  return {\n    restrict: 'E',\n    templateUrl: 'public/app/features/dashboard/partials/row_options.html',\n    controller: RowOptionsCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: {\n      row: '=',\n      dismiss: '&',\n      onUpdated: '&',\n    },\n  };\n}\n\ncoreModule.directive('rowOptions', rowOptionsDirective);\n","import coreModule from 'app/core/core_module';\nimport appEvents from 'app/core/app_events';\n\nexport class MoveToFolderCtrl {\n  dashboards: any;\n  folder: any;\n  dismiss: any;\n  afterSave: any;\n  isValidFolderSelection = true;\n\n  /** @ngInject */\n  constructor(private backendSrv) {}\n\n  onFolderChange(folder) {\n    this.folder = folder;\n  }\n\n  save() {\n    return this.backendSrv.moveDashboards(this.dashboards, this.folder).then(result => {\n      if (result.successCount > 0) {\n        const header = `Dashboard${result.successCount === 1 ? '' : 's'} Moved`;\n        const msg = `${result.successCount} dashboard${result.successCount === 1 ? '' : 's'} moved to ${\n          this.folder.title\n        }`;\n        appEvents.emit('alert-success', [header, msg]);\n      }\n\n      if (result.totalCount === result.alreadyInFolderCount) {\n        appEvents.emit('alert-error', ['Error', `Dashboards already belongs to folder ${this.folder.title}`]);\n      }\n\n      this.dismiss();\n      return this.afterSave();\n    });\n  }\n\n  onEnterFolderCreation() {\n    this.isValidFolderSelection = false;\n  }\n\n  onExitFolderCreation() {\n    this.isValidFolderSelection = true;\n  }\n}\n\nexport function moveToFolderModal() {\n  return {\n    restrict: 'E',\n    templateUrl: 'public/app/features/dashboard/move_to_folder_modal/move_to_folder.html',\n    controller: MoveToFolderCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: {\n      dismiss: '&',\n      dashboards: '=',\n      afterSave: '&',\n    },\n  };\n}\n\ncoreModule.directive('moveToFolderModal', moveToFolderModal);\n","import { coreModule, appEvents, contextSrv } from 'app/core/core';\nimport { DashboardModel } from '../dashboard_model';\nimport $ from 'jquery';\nimport _ from 'lodash';\nimport angular from 'angular';\nimport config from 'app/core/config';\n\nexport class SettingsCtrl {\n  dashboard: DashboardModel;\n  isOpen: boolean;\n  viewId: string;\n  json: string;\n  alertCount: number;\n  canSaveAs: boolean;\n  canSave: boolean;\n  canDelete: boolean;\n  sections: any[];\n  hasUnsavedFolderChange: boolean;\n\n  /** @ngInject */\n  constructor(\n    private $scope,\n    private $route,\n    private $location,\n    private $rootScope,\n    private backendSrv,\n    private dashboardSrv\n  ) {\n    // temp hack for annotations and variables editors\n    // that rely on inherited scope\n    $scope.dashboard = this.dashboard;\n\n    this.$scope.$on('$destroy', () => {\n      this.dashboard.updateSubmenuVisibility();\n      this.$rootScope.$broadcast('refresh');\n      setTimeout(() => {\n        this.$rootScope.appEvent('dash-scroll', { restore: true });\n      });\n    });\n\n    this.canSaveAs = this.dashboard.meta.canEdit && contextSrv.hasEditPermissionInFolders;\n    this.canSave = this.dashboard.meta.canSave;\n    this.canDelete = this.dashboard.meta.canSave;\n\n    this.buildSectionList();\n    this.onRouteUpdated();\n\n    this.$rootScope.onAppEvent('$routeUpdate', this.onRouteUpdated.bind(this), $scope);\n    this.$rootScope.appEvent('dash-scroll', { animate: false, pos: 0 });\n    this.$rootScope.onAppEvent('dashboard-saved', this.onPostSave.bind(this), $scope);\n  }\n\n  buildSectionList() {\n    this.sections = [];\n\n    if (this.dashboard.meta.canEdit) {\n      this.sections.push({\n        title: 'General',\n        id: 'settings',\n        icon: 'gicon gicon-preferences',\n      });\n      this.sections.push({\n        title: 'Annotations',\n        id: 'annotations',\n        icon: 'gicon gicon-annotation',\n      });\n      this.sections.push({\n        title: 'Variables',\n        id: 'templating',\n        icon: 'gicon gicon-variable',\n      });\n      this.sections.push({\n        title: 'Links',\n        id: 'links',\n        icon: 'gicon gicon-link',\n      });\n    }\n\n    if (this.dashboard.id && this.dashboard.meta.canSave) {\n      this.sections.push({\n        title: 'Versions',\n        id: 'versions',\n        icon: 'fa fa-fw fa-history',\n      });\n    }\n\n    if (this.dashboard.id && this.dashboard.meta.canAdmin) {\n      this.sections.push({\n        title: 'Permissions',\n        id: 'permissions',\n        icon: 'fa fa-fw fa-lock',\n      });\n    }\n\n    if (this.dashboard.meta.canMakeEditable) {\n      this.sections.push({\n        title: 'General',\n        icon: 'gicon gicon-preferences',\n        id: 'make_editable',\n      });\n    }\n\n    this.sections.push({\n      title: 'JSON Model',\n      id: 'dashboard_json',\n      icon: 'gicon gicon-json',\n    });\n\n    const params = this.$location.search();\n    const url = this.$location.path();\n\n    for (const section of this.sections) {\n      const sectionParams = _.defaults({ editview: section.id }, params);\n      section.url = config.appSubUrl + url + '?' + $.param(sectionParams);\n    }\n  }\n\n  onRouteUpdated() {\n    this.viewId = this.$location.search().editview;\n\n    if (this.viewId) {\n      this.json = angular.toJson(this.dashboard.getSaveModelClone(), true);\n    }\n\n    if (this.viewId === 'settings' && this.dashboard.meta.canMakeEditable) {\n      this.viewId = 'make_editable';\n    }\n\n    const currentSection = _.find(this.sections, { id: this.viewId });\n    if (!currentSection) {\n      this.sections.unshift({\n        title: 'Not found',\n        id: '404',\n        icon: 'fa fa-fw fa-warning',\n      });\n      this.viewId = '404';\n    }\n  }\n\n  openSaveAsModal() {\n    this.dashboardSrv.showSaveAsModal();\n  }\n\n  saveDashboard() {\n    this.dashboardSrv.saveDashboard();\n  }\n\n  saveDashboardJson() {\n    this.dashboardSrv.saveJSONDashboard(this.json).then(() => {\n      this.$route.reload();\n    });\n  }\n\n  onPostSave() {\n    this.hasUnsavedFolderChange = false;\n  }\n\n  hideSettings() {\n    const urlParams = this.$location.search();\n    delete urlParams.editview;\n    setTimeout(() => {\n      this.$rootScope.$apply(() => {\n        this.$location.search(urlParams);\n      });\n    });\n  }\n\n  makeEditable() {\n    this.dashboard.editable = true;\n    this.dashboard.meta.canMakeEditable = false;\n    this.dashboard.meta.canEdit = true;\n    this.dashboard.meta.canSave = true;\n    this.canDelete = true;\n    this.viewId = 'settings';\n    this.buildSectionList();\n\n    const currentSection = _.find(this.sections, { id: this.viewId });\n    this.$location.url(currentSection.url);\n  }\n\n  deleteDashboard() {\n    let confirmText = '';\n    let text2 = this.dashboard.title;\n\n    const alerts = _.sumBy(this.dashboard.panels, panel => {\n      return panel.alert ? 1 : 0;\n    });\n\n    if (alerts > 0) {\n      confirmText = 'DELETE';\n      text2 = `This dashboard contains ${alerts} alerts. Deleting this dashboard will also delete those alerts`;\n    }\n\n    appEvents.emit('confirm-modal', {\n      title: 'Delete',\n      text: 'Do you want to delete this dashboard?',\n      text2: text2,\n      icon: 'fa-trash',\n      confirmText: confirmText,\n      yesText: 'Delete',\n      onConfirm: () => {\n        this.dashboard.meta.canSave = false;\n        this.deleteDashboardConfirmed();\n      },\n    });\n  }\n\n  deleteDashboardConfirmed() {\n    this.backendSrv.deleteDashboard(this.dashboard.uid).then(() => {\n      appEvents.emit('alert-success', ['Dashboard Deleted', this.dashboard.title + ' has been deleted']);\n      this.$location.url('/');\n    });\n  }\n\n  onFolderChange(folder) {\n    this.dashboard.meta.folderId = folder.id;\n    this.dashboard.meta.folderTitle = folder.title;\n    this.hasUnsavedFolderChange = true;\n  }\n\n  getFolder() {\n    return {\n      id: this.dashboard.meta.folderId,\n      title: this.dashboard.meta.folderTitle,\n      url: this.dashboard.meta.folderUrl,\n    };\n  }\n}\n\nexport function dashboardSettings() {\n  return {\n    restrict: 'E',\n    templateUrl: 'public/app/features/dashboard/settings/settings.html',\n    controller: SettingsCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    transclude: true,\n    scope: { dashboard: '=' },\n  };\n}\n\ncoreModule.directive('dashboardSettings', dashboardSettings);\n","import angular from 'angular';\nimport _ from 'lodash';\n\nexport let iconMap = {\n  'external link': 'fa-external-link',\n  dashboard: 'fa-th-large',\n  question: 'fa-question',\n  info: 'fa-info',\n  bolt: 'fa-bolt',\n  doc: 'fa-file-text-o',\n  cloud: 'fa-cloud',\n};\n\nexport class DashLinkEditorCtrl {\n  dashboard: any;\n  iconMap: any;\n  mode: any;\n  link: any;\n\n  /** @ngInject */\n  constructor($scope, $rootScope) {\n    this.iconMap = iconMap;\n    this.dashboard.links = this.dashboard.links || [];\n    this.mode = 'list';\n\n    $scope.$on('$destroy', () => {\n      $rootScope.appEvent('dash-links-updated');\n    });\n  }\n\n  backToList() {\n    this.mode = 'list';\n  }\n\n  setupNew() {\n    this.mode = 'new';\n    this.link = { type: 'dashboards', icon: 'external link' };\n  }\n\n  addLink() {\n    this.dashboard.links.push(this.link);\n    this.mode = 'list';\n  }\n\n  editLink(link) {\n    this.link = link;\n    this.mode = 'edit';\n    console.log(this.link);\n  }\n\n  saveLink() {\n    this.backToList();\n  }\n\n  moveLink(index, dir) {\n    _.move(this.dashboard.links, index, index + dir);\n  }\n\n  deleteLink(index) {\n    this.dashboard.links.splice(index, 1);\n    this.dashboard.updateSubmenuVisibility();\n  }\n}\n\nfunction dashLinksEditor() {\n  return {\n    restrict: 'E',\n    controller: DashLinkEditorCtrl,\n    templateUrl: 'public/app/features/dashboard/dashlinks/editor.html',\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: {\n      dashboard: '=',\n    },\n  };\n}\n\nangular.module('grafana.directives').directive('dashLinksEditor', dashLinksEditor);\n","import angular from 'angular';\nimport _ from 'lodash';\nimport './link_srv';\n\nfunction panelLinksEditor() {\n  return {\n    scope: {\n      panel: '=',\n    },\n    restrict: 'E',\n    controller: 'PanelLinksEditorCtrl',\n    templateUrl: 'public/app/features/dashboard/panellinks/module.html',\n    link: () => {},\n  };\n}\n\nexport class PanelLinksEditorCtrl {\n  /** @ngInject */\n  constructor($scope, backendSrv) {\n    $scope.panel.links = $scope.panel.links || [];\n\n    $scope.addLink = () => {\n      $scope.panel.links.push({\n        type: 'dashboard',\n      });\n    };\n\n    $scope.searchDashboards = (queryStr, callback) => {\n      backendSrv.search({ query: queryStr }).then(hits => {\n        const dashboards = _.map(hits, dash => {\n          return dash.title;\n        });\n\n        callback(dashboards);\n      });\n    };\n\n    $scope.dashboardChanged = link => {\n      backendSrv.search({ query: link.dashboard }).then(hits => {\n        const dashboard = _.find(hits, { title: link.dashboard });\n        if (dashboard) {\n          if (dashboard.url) {\n            link.url = dashboard.url;\n          } else {\n            // To support legacy url's\n            link.dashUri = dashboard.uri;\n          }\n          link.title = dashboard.title;\n        }\n      });\n    };\n\n    $scope.deleteLink = link => {\n      $scope.panel.links = _.without($scope.panel.links, link);\n    };\n  }\n}\n\nangular\n  .module('grafana.directives')\n  .directive('panelLinksEditor', panelLinksEditor)\n  .controller('PanelLinksEditorCtrl', PanelLinksEditorCtrl);\n","import angular from 'angular';\nimport _ from 'lodash';\nimport { iconMap } from './editor';\n\nfunction dashLinksContainer() {\n  return {\n    scope: {\n      links: '=',\n    },\n    restrict: 'E',\n    controller: 'DashLinksContainerCtrl',\n    template: '<dash-link ng-repeat=\"link in generatedLinks\" link=\"link\"></dash-link>',\n    link: () => {},\n  };\n}\n\n/** @ngInject */\nfunction dashLink($compile, $sanitize, linkSrv) {\n  return {\n    restrict: 'E',\n    link: (scope, elem) => {\n      const link = scope.link;\n      let template =\n        '<div class=\"gf-form\">' +\n        '<a class=\"pointer gf-form-label\" data-placement=\"bottom\"' +\n        (link.asDropdown ? ' ng-click=\"fillDropdown(link)\" data-toggle=\"dropdown\"' : '') +\n        '>' +\n        '<i></i> <span></span></a>';\n\n      if (link.asDropdown) {\n        template +=\n          '<ul class=\"dropdown-menu\" role=\"menu\">' +\n          '<li ng-repeat=\"dash in link.searchHits\">' +\n          '<a href=\"{{dash.url}}\" target=\"{{dash.target}}\">{{dash.title}}</a>' +\n          '</li>' +\n          '</ul>';\n      }\n\n      template += '</div>';\n\n      elem.html(template);\n      $compile(elem.contents())(scope);\n\n      function update() {\n        const linkInfo = linkSrv.getAnchorInfo(link);\n\n        const anchor = elem.find('a');\n        const span = elem.find('span');\n        span.text(linkInfo.title);\n\n        if (!link.asDropdown) {\n          anchor.attr('href', linkInfo.href);\n          sanitizeAnchor();\n        }\n        anchor.attr('data-placement', 'bottom');\n        // tooltip\n        anchor.tooltip({\n          title: $sanitize(scope.link.tooltip),\n          html: true,\n          container: 'body',\n        });\n      }\n\n      function sanitizeAnchor() {\n        const anchor = elem.find('a');\n        const anchorSanitized = $sanitize(anchor.parent().html());\n        anchor.parent().html(anchorSanitized);\n      }\n\n      elem.find('i').attr('class', 'fa fa-fw ' + scope.link.icon);\n      elem.find('a').attr('target', scope.link.target);\n\n      // fix for menus on the far right\n      if (link.asDropdown && scope.$last) {\n        elem.find('.dropdown-menu').addClass('pull-right');\n      }\n\n      update();\n      scope.$on('refresh', update);\n    },\n  };\n}\n\nexport class DashLinksContainerCtrl {\n  /** @ngInject */\n  constructor($scope, $rootScope, $q, backendSrv, dashboardSrv, linkSrv) {\n    const currentDashId = dashboardSrv.getCurrent().id;\n\n    function buildLinks(linkDef) {\n      if (linkDef.type === 'dashboards') {\n        if (!linkDef.tags) {\n          console.log('Dashboard link missing tag');\n          return $q.when([]);\n        }\n\n        if (linkDef.asDropdown) {\n          return $q.when([\n            {\n              title: linkDef.title,\n              tags: linkDef.tags,\n              keepTime: linkDef.keepTime,\n              includeVars: linkDef.includeVars,\n              target: linkDef.targetBlank ? '_blank' : '_self',\n              icon: 'fa fa-bars',\n              asDropdown: true,\n            },\n          ]);\n        }\n\n        return $scope.searchDashboards(linkDef, 7);\n      }\n\n      if (linkDef.type === 'link') {\n        return $q.when([\n          {\n            url: linkDef.url,\n            title: linkDef.title,\n            icon: iconMap[linkDef.icon],\n            tooltip: linkDef.tooltip,\n            target: linkDef.targetBlank ? '_blank' : '_self',\n            keepTime: linkDef.keepTime,\n            includeVars: linkDef.includeVars,\n          },\n        ]);\n      }\n\n      return $q.when([]);\n    }\n\n    function updateDashLinks() {\n      const promises = _.map($scope.links, buildLinks);\n\n      $q.all(promises).then(results => {\n        $scope.generatedLinks = _.flatten(results);\n      });\n    }\n\n    $scope.searchDashboards = (link, limit) => {\n      return backendSrv.search({ tag: link.tags, limit: limit }).then(results => {\n        return _.reduce(\n          results,\n          (memo, dash) => {\n            // do not add current dashboard\n            if (dash.id !== currentDashId) {\n              memo.push({\n                title: dash.title,\n                url: dash.url,\n                target: link.target === '_self' ? '' : link.target,\n                icon: 'fa fa-th-large',\n                keepTime: link.keepTime,\n                includeVars: link.includeVars,\n              });\n            }\n            return memo;\n          },\n          []\n        );\n      });\n    };\n\n    $scope.fillDropdown = link => {\n      $scope.searchDashboards(link, 100).then(results => {\n        _.each(results, hit => {\n          hit.url = linkSrv.getLinkUrl(hit);\n        });\n        link.searchHits = results;\n      });\n    };\n\n    updateDashLinks();\n    $rootScope.onAppEvent('dash-links-updated', updateDashLinks, $scope);\n  }\n}\n\nangular.module('grafana.directives').directive('dashLinksContainer', dashLinksContainer);\nangular.module('grafana.directives').directive('dashLink', dashLink);\nangular.module('grafana.directives').controller('DashLinksContainerCtrl', DashLinksContainerCtrl);\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport Tooltip from 'app/core/components/Tooltip/Tooltip';\nimport SlideDown from 'app/core/components/Animations/SlideDown';\nimport { StoreState, FolderInfo } from 'app/types';\nimport { DashboardAcl, PermissionLevel, NewDashboardAclItem } from 'app/types/acl';\nimport {\n  getDashboardPermissions,\n  addDashboardPermission,\n  removeDashboardPermission,\n  updateDashboardPermission,\n} from '../state/actions';\nimport PermissionList from 'app/core/components/PermissionList/PermissionList';\nimport AddPermission from 'app/core/components/PermissionList/AddPermission';\nimport PermissionsInfo from 'app/core/components/PermissionList/PermissionsInfo';\nimport { store } from 'app/store/configureStore';\n\nexport interface Props {\n  dashboardId: number;\n  folder?: FolderInfo;\n  permissions: DashboardAcl[];\n  getDashboardPermissions: typeof getDashboardPermissions;\n  updateDashboardPermission: typeof updateDashboardPermission;\n  removeDashboardPermission: typeof removeDashboardPermission;\n  addDashboardPermission: typeof addDashboardPermission;\n}\n\nexport interface State {\n  isAdding: boolean;\n}\n\nexport class DashboardPermissions extends PureComponent<Props, State> {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isAdding: false,\n    };\n  }\n\n  componentDidMount() {\n    this.props.getDashboardPermissions(this.props.dashboardId);\n  }\n\n  onOpenAddPermissions = () => {\n    this.setState({ isAdding: true });\n  };\n\n  onRemoveItem = (item: DashboardAcl) => {\n    this.props.removeDashboardPermission(this.props.dashboardId, item);\n  };\n\n  onPermissionChanged = (item: DashboardAcl, level: PermissionLevel) => {\n    this.props.updateDashboardPermission(this.props.dashboardId, item, level);\n  };\n\n  onAddPermission = (newItem: NewDashboardAclItem) => {\n    return this.props.addDashboardPermission(this.props.dashboardId, newItem);\n  };\n\n  onCancelAddPermission = () => {\n    this.setState({ isAdding: false });\n  };\n\n  render() {\n    const { permissions, folder } = this.props;\n    const { isAdding } = this.state;\n\n    return (\n      <div>\n        <div className=\"dashboard-settings__header\">\n          <div className=\"page-action-bar\">\n            <h3 className=\"d-inline-block\">Permissions</h3>\n            <Tooltip className=\"page-sub-heading-icon\" placement=\"auto\" content={PermissionsInfo}>\n              <i className=\"gicon gicon-question gicon--has-hover\" />\n            </Tooltip>\n            <div className=\"page-action-bar__spacer\" />\n            <button className=\"btn btn-success pull-right\" onClick={this.onOpenAddPermissions} disabled={isAdding}>\n              <i className=\"fa fa-plus\" /> Add Permission\n            </button>\n          </div>\n        </div>\n        <SlideDown in={isAdding}>\n          <AddPermission onAddPermission={this.onAddPermission} onCancel={this.onCancelAddPermission} />\n        </SlideDown>\n        <PermissionList\n          items={permissions}\n          onRemoveItem={this.onRemoveItem}\n          onPermissionChanged={this.onPermissionChanged}\n          isFetching={false}\n          folderInfo={folder}\n        />\n      </div>\n    );\n  }\n}\n\nfunction connectWithStore(WrappedComponent, ...args) {\n  const ConnectedWrappedComponent = connect(...args)(WrappedComponent);\n  return props => {\n    return <ConnectedWrappedComponent {...props} store={store} />;\n  };\n}\n\nconst mapStateToProps = (state: StoreState) => ({\n  permissions: state.dashboard.permissions,\n});\n\nconst mapDispatchToProps = {\n  getDashboardPermissions,\n  addDashboardPermission,\n  removeDashboardPermission,\n  updateDashboardPermission,\n};\n\nexport default connectWithStore(DashboardPermissions, mapStateToProps, mapDispatchToProps);\n","export class FolderPageLoader {\n  constructor(private backendSrv) {}\n\n  load(ctrl, uid, activeChildId) {\n    ctrl.navModel = {\n      main: {\n        icon: 'fa fa-folder-open',\n        id: 'manage-folder',\n        subTitle: 'Manage folder dashboards & permissions',\n        url: '',\n        text: '',\n        breadcrumbs: [{ title: 'Dashboards', url: 'dashboards' }],\n        children: [\n          {\n            active: activeChildId === 'manage-folder-dashboards',\n            icon: 'fa fa-fw fa-th-large',\n            id: 'manage-folder-dashboards',\n            text: 'Dashboards',\n            url: 'dashboards',\n          },\n          {\n            active: activeChildId === 'manage-folder-permissions',\n            icon: 'fa fa-fw fa-lock',\n            id: 'manage-folder-permissions',\n            text: 'Permissions',\n            url: 'dashboards/permissions',\n          },\n          {\n            active: activeChildId === 'manage-folder-settings',\n            icon: 'fa fa-fw fa-cog',\n            id: 'manage-folder-settings',\n            text: 'Settings',\n            url: 'dashboards/settings',\n          },\n        ],\n      },\n    };\n\n    return this.backendSrv.getFolderByUid(uid).then(folder => {\n      ctrl.folderId = folder.id;\n      const folderTitle = folder.title;\n      const folderUrl = folder.url;\n      ctrl.navModel.main.text = folderTitle;\n\n      const dashTab = ctrl.navModel.main.children.find(child => child.id === 'manage-folder-dashboards');\n      dashTab.url = folderUrl;\n\n      if (folder.canAdmin) {\n        const permTab = ctrl.navModel.main.children.find(child => child.id === 'manage-folder-permissions');\n        permTab.url = folderUrl + '/permissions';\n\n        const settingsTab = ctrl.navModel.main.children.find(child => child.id === 'manage-folder-settings');\n        settingsTab.url = folderUrl + '/settings';\n      } else {\n        ctrl.navModel.main.children = [dashTab];\n      }\n\n      return folder;\n    });\n  }\n}\n","import _ from 'lodash';\nimport config from 'app/core/config';\nimport locationUtil from 'app/core/utils/location_util';\n\nexport class DashboardImportCtrl {\n  navModel: any;\n  step: number;\n  jsonText: string;\n  parseError: string;\n  nameExists: boolean;\n  uidExists: boolean;\n  dash: any;\n  inputs: any[];\n  inputsValid: boolean;\n  gnetUrl: string;\n  gnetError: string;\n  gnetInfo: any;\n  titleTouched: boolean;\n  hasNameValidationError: boolean;\n  nameValidationError: any;\n  hasUidValidationError: boolean;\n  uidValidationError: any;\n  autoGenerateUid: boolean;\n  autoGenerateUidValue: string;\n  folderId: number;\n  initialFolderTitle: string;\n  isValidFolderSelection: boolean;\n\n  /** @ngInject */\n  constructor(private backendSrv, private validationSrv, navModelSrv, private $location, $routeParams) {\n    this.navModel = navModelSrv.getNav('create', 'import');\n\n    this.step = 1;\n    this.nameExists = false;\n    this.uidExists = false;\n    this.autoGenerateUid = true;\n    this.autoGenerateUidValue = 'auto-generated';\n    this.folderId = $routeParams.folderId ? Number($routeParams.folderId) || 0 : null;\n    this.initialFolderTitle = 'Select a folder';\n\n    // check gnetId in url\n    if ($routeParams.gnetId) {\n      this.gnetUrl = $routeParams.gnetId;\n      this.checkGnetDashboard();\n    }\n  }\n\n  onUpload(dash) {\n    this.dash = dash;\n    this.dash.id = null;\n    this.step = 2;\n    this.inputs = [];\n\n    if (this.dash.__inputs) {\n      for (const input of this.dash.__inputs) {\n        const inputModel = {\n          name: input.name,\n          label: input.label,\n          info: input.description,\n          value: input.value,\n          type: input.type,\n          pluginId: input.pluginId,\n          options: [],\n        };\n\n        if (input.type === 'datasource') {\n          this.setDatasourceOptions(input, inputModel);\n        } else if (!inputModel.info) {\n          inputModel.info = 'Specify a string constant';\n        }\n\n        this.inputs.push(inputModel);\n      }\n    }\n\n    this.inputsValid = this.inputs.length === 0;\n    this.titleChanged();\n    this.uidChanged(true);\n  }\n\n  setDatasourceOptions(input, inputModel) {\n    const sources = _.filter(config.datasources, val => {\n      return val.type === input.pluginId;\n    });\n\n    if (sources.length === 0) {\n      inputModel.info = 'No data sources of type ' + input.pluginName + ' found';\n    } else if (!inputModel.info) {\n      inputModel.info = 'Select a ' + input.pluginName + ' data source';\n    }\n\n    inputModel.options = sources.map(val => {\n      return { text: val.name, value: val.name };\n    });\n  }\n\n  inputValueChanged() {\n    this.inputsValid = true;\n    for (const input of this.inputs) {\n      if (!input.value) {\n        this.inputsValid = false;\n      }\n    }\n  }\n\n  titleChanged() {\n    this.titleTouched = true;\n    this.nameExists = false;\n\n    this.validationSrv\n      .validateNewDashboardName(this.folderId, this.dash.title)\n      .then(() => {\n        this.nameExists = false;\n        this.hasNameValidationError = false;\n      })\n      .catch(err => {\n        if (err.type === 'EXISTING') {\n          this.nameExists = true;\n        }\n\n        this.hasNameValidationError = true;\n        this.nameValidationError = err.message;\n      });\n  }\n\n  uidChanged(initial) {\n    this.uidExists = false;\n    this.hasUidValidationError = false;\n\n    if (initial === true && this.dash.uid) {\n      this.autoGenerateUidValue = 'value set';\n    }\n\n    this.backendSrv\n      .getDashboardByUid(this.dash.uid)\n      .then(res => {\n        this.uidExists = true;\n        this.hasUidValidationError = true;\n        this.uidValidationError = `Dashboard named '${res.dashboard.title}' in folder '${\n          res.meta.folderTitle\n        }' has the same uid`;\n      })\n      .catch(err => {\n        err.isHandled = true;\n      });\n  }\n\n  onFolderChange(folder) {\n    this.folderId = folder.id;\n    this.titleChanged();\n  }\n\n  onEnterFolderCreation() {\n    this.inputsValid = false;\n  }\n\n  onExitFolderCreation() {\n    this.inputValueChanged();\n  }\n\n  isValid() {\n    return this.inputsValid && this.folderId !== null;\n  }\n\n  saveDashboard() {\n    const inputs = this.inputs.map(input => {\n      return {\n        name: input.name,\n        type: input.type,\n        pluginId: input.pluginId,\n        value: input.value,\n      };\n    });\n\n    return this.backendSrv\n      .post('api/dashboards/import', {\n        dashboard: this.dash,\n        overwrite: true,\n        inputs: inputs,\n        folderId: this.folderId,\n      })\n      .then(res => {\n        const dashUrl = locationUtil.stripBaseFromUrl(res.importedUrl);\n        this.$location.url(dashUrl);\n      });\n  }\n\n  loadJsonText() {\n    try {\n      this.parseError = '';\n      const dash = JSON.parse(this.jsonText);\n      this.onUpload(dash);\n    } catch (err) {\n      console.log(err);\n      this.parseError = err.message;\n      return;\n    }\n  }\n\n  checkGnetDashboard() {\n    this.gnetError = '';\n\n    const match = /(^\\d+$)|dashboards\\/(\\d+)/.exec(this.gnetUrl);\n    let dashboardId;\n\n    if (match && match[1]) {\n      dashboardId = match[1];\n    } else if (match && match[2]) {\n      dashboardId = match[2];\n    } else {\n      this.gnetError = 'Could not find dashboard';\n    }\n\n    return this.backendSrv\n      .get('api/gnet/dashboards/' + dashboardId)\n      .then(res => {\n        this.gnetInfo = res;\n        // store reference to grafana.com\n        res.json.gnetId = res.id;\n        this.onUpload(res.json);\n      })\n      .catch(err => {\n        err.isHandled = true;\n        this.gnetError = err.data.message || err;\n      });\n  }\n\n  back() {\n    this.gnetUrl = '';\n    this.step = 1;\n    this.gnetError = '';\n    this.gnetInfo = '';\n  }\n}\n","import { FolderPageLoader } from './folder_page_loader';\nimport locationUtil from 'app/core/utils/location_util';\n\nexport class FolderDashboardsCtrl {\n  navModel: any;\n  folderId: number;\n  uid: string;\n\n  /** @ngInject */\n  constructor(private backendSrv, navModelSrv, private $routeParams, $location) {\n    if (this.$routeParams.uid) {\n      this.uid = $routeParams.uid;\n\n      const loader = new FolderPageLoader(this.backendSrv);\n\n      loader.load(this, this.uid, 'manage-folder-dashboards').then(folder => {\n        const url = locationUtil.stripBaseFromUrl(folder.url);\n\n        if (url !== $location.path()) {\n          $location.path(url).replace();\n        }\n      });\n    }\n  }\n}\n","import _ from 'lodash';\nimport coreModule from '../../core/core_module';\n\nexport class PlaylistsCtrl {\n  playlists: any;\n  navModel: any;\n\n  /** @ngInject */\n  constructor(private $scope, private backendSrv, navModelSrv) {\n    this.navModel = navModelSrv.getNav('dashboards', 'playlists', 0);\n\n    backendSrv.get('/api/playlists').then(result => {\n      this.playlists = result.map(item => {\n        item.startUrl = `playlists/play/${item.id}`;\n        return item;\n      });\n    });\n  }\n\n  removePlaylistConfirmed(playlist) {\n    _.remove(this.playlists, { id: playlist.id });\n\n    this.backendSrv.delete('/api/playlists/' + playlist.id).then(\n      () => {\n        this.$scope.appEvent('alert-success', ['Playlist deleted', '']);\n      },\n      () => {\n        this.$scope.appEvent('alert-error', ['Unable to delete playlist', '']);\n        this.playlists.push(playlist);\n      }\n    );\n  }\n\n  removePlaylist(playlist) {\n    this.$scope.appEvent('confirm-modal', {\n      title: 'Delete',\n      text: 'Are you sure you want to delete playlist ' + playlist.name + '?',\n      yesText: 'Delete',\n      icon: 'fa-trash',\n      onConfirm: () => {\n        this.removePlaylistConfirmed(playlist);\n      },\n    });\n  }\n}\n\ncoreModule.controller('PlaylistsCtrl', PlaylistsCtrl);\n","import appEvents from 'app/core/app_events';\nimport locationUtil from 'app/core/utils/location_util';\n\nexport class CreateFolderCtrl {\n  title = '';\n  navModel: any;\n  titleTouched = false;\n  hasValidationError: boolean;\n  validationError: any;\n\n  /** @ngInject */\n  constructor(private backendSrv, private $location, private validationSrv, navModelSrv) {\n    this.navModel = navModelSrv.getNav('dashboards', 'manage-dashboards', 0);\n  }\n\n  create() {\n    if (this.hasValidationError) {\n      return;\n    }\n\n    return this.backendSrv.createFolder({ title: this.title }).then(result => {\n      appEvents.emit('alert-success', ['Folder Created', 'OK']);\n      this.$location.url(locationUtil.stripBaseFromUrl(result.url));\n    });\n  }\n\n  titleChanged() {\n    this.titleTouched = true;\n\n    this.validationSrv\n      .validateNewFolderName(this.title)\n      .then(() => {\n        this.hasValidationError = false;\n      })\n      .catch(err => {\n        this.hasValidationError = true;\n        this.validationError = err.message;\n      });\n  }\n}\n","import './dashboard_ctrl';\nimport './alerting_srv';\nimport './history/history';\nimport './dashboard_loader_srv';\nimport './dashnav/dashnav';\nimport './submenu/submenu';\nimport './save_as_modal';\nimport './save_modal';\nimport './save_provisioned_modal';\nimport './shareModalCtrl';\nimport './share_snapshot_ctrl';\nimport './dashboard_srv';\nimport './view_state_srv';\nimport './validation_srv';\nimport './time_srv';\nimport './unsaved_changes_srv';\nimport './unsaved_changes_modal';\nimport './timepicker/timepicker';\nimport './upload';\nimport './export/export_modal';\nimport './export_data/export_data_modal';\nimport './ad_hoc_filters';\nimport './repeat_option/repeat_option';\nimport './dashgrid/DashboardGridDirective';\nimport './dashgrid/PanelLoader';\nimport './dashgrid/RowOptions';\nimport './folder_picker/folder_picker';\nimport './move_to_folder_modal/move_to_folder';\nimport './settings/settings';\nimport './panellinks/module';\nimport './dashlinks/module';\n\n// angular wrappers\nimport { react2AngularDirective } from 'app/core/utils/react2angular';\nimport DashboardPermissions from './permissions/DashboardPermissions';\n\nreact2AngularDirective('dashboardPermissions', DashboardPermissions, ['dashboardId', 'folder']);\n\nimport coreModule from 'app/core/core_module';\nimport { FolderDashboardsCtrl } from './folder_dashboards_ctrl';\nimport { DashboardImportCtrl } from './dashboard_import_ctrl';\nimport { CreateFolderCtrl } from './create_folder_ctrl';\n\ncoreModule.controller('FolderDashboardsCtrl', FolderDashboardsCtrl);\ncoreModule.controller('DashboardImportCtrl', DashboardImportCtrl);\ncoreModule.controller('CreateFolderCtrl', CreateFolderCtrl);\n","import coreModule from '../../core/core_module';\n\nexport class PlaylistSearchCtrl {\n  query: any;\n  tagsMode: boolean;\n\n  searchStarted: any;\n\n  /** @ngInject */\n  constructor($timeout, private backendSrv) {\n    this.query = { query: '', tag: [], starred: false, limit: 20 };\n\n    $timeout(() => {\n      this.query.query = '';\n      this.query.type = 'dash-db';\n      this.searchDashboards();\n    }, 100);\n  }\n\n  searchDashboards() {\n    this.tagsMode = false;\n    const prom: any = {};\n\n    prom.promise = this.backendSrv.search(this.query).then(result => {\n      return {\n        dashboardResult: result,\n        tagResult: [],\n      };\n    });\n\n    this.searchStarted(prom);\n  }\n\n  showStarred() {\n    this.query.starred = !this.query.starred;\n    this.searchDashboards();\n  }\n\n  queryHasNoFilters() {\n    return this.query.query === '' && this.query.starred === false && this.query.tag.length === 0;\n  }\n\n  filterByTag(tag, evt) {\n    this.query.tag.push(tag);\n    this.searchDashboards();\n    if (evt) {\n      evt.stopPropagation();\n      evt.preventDefault();\n    }\n  }\n\n  getTags() {\n    const prom: any = {};\n    prom.promise = this.backendSrv.get('/api/dashboards/tags').then(result => {\n      return {\n        dashboardResult: [],\n        tagResult: result,\n      };\n    });\n\n    this.searchStarted(prom);\n  }\n}\n\nexport function playlistSearchDirective() {\n  return {\n    restrict: 'E',\n    templateUrl: 'public/app/features/playlist/partials/playlist_search.html',\n    controller: PlaylistSearchCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: {\n      searchStarted: '&',\n    },\n  };\n}\n\ncoreModule.directive('playlistSearch', playlistSearchDirective);\n","import coreModule from '../../core/core_module';\nimport kbn from 'app/core/utils/kbn';\nimport appEvents from 'app/core/app_events';\nimport _ from 'lodash';\nimport { toUrlParams } from 'app/core/utils/url';\n\nclass PlaylistSrv {\n  private cancelPromise: any;\n  private dashboards: any;\n  private index: number;\n  private interval: any;\n  private startUrl: string;\n  isPlaying: boolean;\n\n  /** @ngInject */\n  constructor(private $location: any, private $timeout: any, private backendSrv: any) {}\n\n  next() {\n    this.$timeout.cancel(this.cancelPromise);\n\n    const playedAllDashboards = this.index > this.dashboards.length - 1;\n    if (playedAllDashboards) {\n      window.location.href = this.startUrl;\n      return;\n    }\n\n    const dash = this.dashboards[this.index];\n    const queryParams = this.$location.search();\n    const filteredParams = _.pickBy(queryParams, value => value !== null);\n\n    this.$location.url('dashboard/' + dash.uri + '?' + toUrlParams(filteredParams));\n\n    this.index++;\n    this.cancelPromise = this.$timeout(() => this.next(), this.interval);\n  }\n\n  prev() {\n    this.index = Math.max(this.index - 2, 0);\n    this.next();\n  }\n\n  start(playlistId) {\n    this.stop();\n\n    this.startUrl = window.location.href;\n    this.index = 0;\n    this.isPlaying = true;\n\n    this.backendSrv.get(`/api/playlists/${playlistId}`).then(playlist => {\n      this.backendSrv.get(`/api/playlists/${playlistId}/dashboards`).then(dashboards => {\n        this.dashboards = dashboards;\n        this.interval = kbn.interval_to_ms(playlist.interval);\n        this.next();\n      });\n    });\n  }\n\n  stop() {\n    if (this.isPlaying) {\n      const queryParams = this.$location.search();\n      if (queryParams.kiosk) {\n        appEvents.emit('toggle-kiosk-mode', { exit: true });\n      }\n    }\n\n    this.index = 0;\n    this.isPlaying = false;\n\n    if (this.cancelPromise) {\n      this.$timeout.cancel(this.cancelPromise);\n    }\n  }\n}\n\ncoreModule.service('playlistSrv', PlaylistSrv);\n","import _ from 'lodash';\nimport coreModule from '../../core/core_module';\n\nexport class PlaylistEditCtrl {\n  filteredDashboards: any = [];\n  filteredTags: any = [];\n  searchQuery = '';\n  loading = false;\n  playlist: any = {\n    interval: '5m',\n  };\n\n  playlistItems: any = [];\n  dashboardresult: any = [];\n  tagresult: any = [];\n  navModel: any;\n  isNew: boolean;\n\n  /** @ngInject */\n  constructor(private $scope, private backendSrv, private $location, $route, navModelSrv) {\n    this.navModel = navModelSrv.getNav('dashboards', 'playlists', 0);\n    this.isNew = !$route.current.params.id;\n\n    if ($route.current.params.id) {\n      const playlistId = $route.current.params.id;\n\n      backendSrv.get('/api/playlists/' + playlistId).then(result => {\n        this.playlist = result;\n      });\n\n      backendSrv.get('/api/playlists/' + playlistId + '/items').then(result => {\n        this.playlistItems = result;\n      });\n    }\n  }\n\n  filterFoundPlaylistItems() {\n    this.filteredDashboards = _.reject(this.dashboardresult, playlistItem => {\n      return _.find(this.playlistItems, listPlaylistItem => {\n        return parseInt(listPlaylistItem.value, 10) === playlistItem.id;\n      });\n    });\n\n    this.filteredTags = _.reject(this.tagresult, tag => {\n      return _.find(this.playlistItems, listPlaylistItem => {\n        return listPlaylistItem.value === tag.term;\n      });\n    });\n  }\n\n  addPlaylistItem(playlistItem) {\n    playlistItem.value = playlistItem.id.toString();\n    playlistItem.type = 'dashboard_by_id';\n    playlistItem.order = this.playlistItems.length + 1;\n\n    this.playlistItems.push(playlistItem);\n    this.filterFoundPlaylistItems();\n  }\n\n  addTagPlaylistItem(tag) {\n    const playlistItem: any = {\n      value: tag.term,\n      type: 'dashboard_by_tag',\n      order: this.playlistItems.length + 1,\n      title: tag.term,\n    };\n\n    this.playlistItems.push(playlistItem);\n    this.filterFoundPlaylistItems();\n  }\n\n  removePlaylistItem(playlistItem) {\n    _.remove(this.playlistItems, listedPlaylistItem => {\n      return playlistItem === listedPlaylistItem;\n    });\n    this.filterFoundPlaylistItems();\n  }\n\n  savePlaylist(playlist, playlistItems) {\n    let savePromise;\n\n    playlist.items = playlistItems;\n\n    savePromise = playlist.id\n      ? this.backendSrv.put('/api/playlists/' + playlist.id, playlist)\n      : this.backendSrv.post('/api/playlists', playlist);\n\n    savePromise.then(\n      () => {\n        this.$scope.appEvent('alert-success', ['Playlist saved', '']);\n        this.$location.path('/playlists');\n      },\n      () => {\n        this.$scope.appEvent('alert-error', ['Unable to save playlist', '']);\n      }\n    );\n  }\n\n  isPlaylistEmpty() {\n    return !this.playlistItems.length;\n  }\n\n  backToList() {\n    this.$location.path('/playlists');\n  }\n\n  searchStarted(promise) {\n    promise.then(data => {\n      this.dashboardresult = data.dashboardResult;\n      this.tagresult = data.tagResult;\n      this.filterFoundPlaylistItems();\n    });\n  }\n\n  movePlaylistItem(playlistItem, offset) {\n    const currentPosition = this.playlistItems.indexOf(playlistItem);\n    const newPosition = currentPosition + offset;\n\n    if (newPosition >= 0 && newPosition < this.playlistItems.length) {\n      this.playlistItems.splice(currentPosition, 1);\n      this.playlistItems.splice(newPosition, 0, playlistItem);\n    }\n  }\n\n  movePlaylistItemUp(playlistItem) {\n    this.movePlaylistItem(playlistItem, -1);\n  }\n\n  movePlaylistItemDown(playlistItem) {\n    this.movePlaylistItem(playlistItem, 1);\n  }\n}\n\ncoreModule.controller('PlaylistEditCtrl', PlaylistEditCtrl);\n","import angular from 'angular';\n\n/** @ngInject */\nfunction grafanaRoutes($routeProvider) {\n  $routeProvider\n    .when('/playlists', {\n      templateUrl: 'public/app/features/playlist/partials/playlists.html',\n      controllerAs: 'ctrl',\n      controller: 'PlaylistsCtrl',\n    })\n    .when('/playlists/create', {\n      templateUrl: 'public/app/features/playlist/partials/playlist.html',\n      controllerAs: 'ctrl',\n      controller: 'PlaylistEditCtrl',\n    })\n    .when('/playlists/edit/:id', {\n      templateUrl: 'public/app/features/playlist/partials/playlist.html',\n      controllerAs: 'ctrl',\n      controller: 'PlaylistEditCtrl',\n    })\n    .when('/playlists/play/:id', {\n      template: '',\n      resolve: {\n        init: (playlistSrv, $route) => {\n          const playlistId = $route.current.params.id;\n          playlistSrv.start(playlistId);\n        },\n      },\n    });\n}\n\nangular.module('grafana.routes').config(grafanaRoutes);\n","import $ from 'jquery';\nimport { coreModule } from 'app/core/core';\n\nconst template = `\n<span class=\"panel-title\">\n  <span class=\"icon-gf panel-alert-icon\"></span>\n  <span class=\"panel-title-text\">{{ctrl.panel.title | interpolateTemplateVars:this}}</span>\n  <span class=\"panel-menu-container dropdown\">\n    <span class=\"fa fa-caret-down panel-menu-toggle\" data-toggle=\"dropdown\"></span>\n    <ul class=\"dropdown-menu dropdown-menu--menu panel-menu\" role=\"menu\">\n      <li>\n        <a ng-click=\"ctrl.addDataQuery(datasource);\">\n          <i class=\"fa fa-cog\"></i> Edit <span class=\"dropdown-menu-item-shortcut\">e</span>\n        </a>\n      </li>\n      <li class=\"dropdown-submenu\">\n        <a ng-click=\"ctrl.addDataQuery(datasource);\"><i class=\"fa fa-cube\"></i> Actions</a>\n        <ul class=\"dropdown-menu panel-menu\">\n          <li><a ng-click=\"ctrl.addDataQuery(datasource);\"><i class=\"fa fa-flash\"></i> Add Annotation</a></li>\n          <li><a ng-click=\"ctrl.addDataQuery(datasource);\"><i class=\"fa fa-bullseye\"></i> Toggle Legend</a></li>\n          <li><a ng-click=\"ctrl.addDataQuery(datasource);\"><i class=\"fa fa-download\"></i> Export to CSV</a></li>\n          <li><a ng-click=\"ctrl.addDataQuery(datasource);\"><i class=\"fa fa-eye\"></i> View JSON</a></li>\n        </ul>\n      </li>\n      <li><a ng-click=\"ctrl.addDataQuery(datasource);\"><i class=\"fa fa-trash\"></i> Remove</a></li>\n    </ul>\n  </span>\n  <span class=\"panel-time-info\" ng-if=\"ctrl.timeInfo\"><i class=\"fa fa-clock-o\"></i> {{ctrl.timeInfo}}</span>\n</span>`;\n\nfunction renderMenuItem(item, ctrl) {\n  let html = '';\n  let listItemClass = '';\n\n  if (item.divider) {\n    return '<li class=\"divider\"></li>';\n  }\n\n  if (item.submenu) {\n    listItemClass = 'dropdown-submenu';\n  }\n\n  html += `<li class=\"${listItemClass}\"><a `;\n\n  if (item.click) {\n    html += ` ng-click=\"${item.click}\"`;\n  }\n  if (item.href) {\n    html += ` href=\"${item.href}\"`;\n  }\n\n  html += `><i class=\"${item.icon}\"></i>`;\n  html += `<span class=\"dropdown-item-text\">${item.text}</span>`;\n\n  if (item.shortcut) {\n    html += `<span class=\"dropdown-menu-item-shortcut\">${item.shortcut}</span>`;\n  }\n\n  html += `</a>`;\n\n  if (item.submenu) {\n    html += '<ul class=\"dropdown-menu dropdown-menu--menu panel-menu\">';\n    for (const subitem of item.submenu) {\n      html += renderMenuItem(subitem, ctrl);\n    }\n    html += '</ul>';\n  }\n\n  html += `</li>`;\n  return html;\n}\n\nfunction createMenuTemplate(ctrl) {\n  let html = '';\n\n  for (const item of ctrl.getMenu()) {\n    html += renderMenuItem(item, ctrl);\n  }\n\n  return html;\n}\n\n/** @ngInject */\nfunction panelHeader($compile) {\n  return {\n    restrict: 'E',\n    template: template,\n    link: (scope, elem, attrs) => {\n      const menuElem = elem.find('.panel-menu');\n      let menuScope;\n      let isDragged;\n\n      elem.click(evt => {\n        const targetClass = evt.target.className;\n\n        // remove existing scope\n        if (menuScope) {\n          menuScope.$destroy();\n        }\n\n        menuScope = scope.$new();\n        const menuHtml = createMenuTemplate(scope.ctrl);\n        menuElem.html(menuHtml);\n        $compile(menuElem)(menuScope);\n\n        if (targetClass.indexOf('panel-title-text') >= 0 || targetClass.indexOf('panel-title') >= 0) {\n          togglePanelMenu(evt);\n        }\n      });\n\n      elem.find('.panel-menu-toggle').click(() => {\n        togglePanelStackPosition();\n      });\n\n      function togglePanelMenu(e) {\n        if (!isDragged) {\n          e.stopPropagation();\n          togglePanelStackPosition();\n          elem.find('[data-toggle=dropdown]').dropdown('toggle');\n        }\n      }\n\n      /**\n       * Hack for adding special class 'dropdown-menu-open' to the panel.\n       * This class sets z-index for panel and prevents menu overlapping.\n       */\n      function togglePanelStackPosition() {\n        const menuOpenClass = 'dropdown-menu-open';\n        const panelGridClass = '.react-grid-item.panel';\n\n        let panelElem = elem\n          .find('[data-toggle=dropdown]')\n          .parentsUntil('.panel')\n          .parent();\n        const menuElem = elem.find('[data-toggle=dropdown]').parent();\n        panelElem = panelElem && panelElem.length ? panelElem[0] : undefined;\n        if (panelElem) {\n          panelElem = $(panelElem);\n          $(panelGridClass).removeClass(menuOpenClass);\n          const state = !menuElem.hasClass('open');\n          panelElem.toggleClass(menuOpenClass, state);\n        }\n      }\n\n      let mouseX, mouseY;\n      elem.mousedown(e => {\n        mouseX = e.pageX;\n        mouseY = e.pageY;\n      });\n\n      elem.mouseup(e => {\n        if (mouseX === e.pageX && mouseY === e.pageY) {\n          isDragged = false;\n        } else {\n          isDragged = true;\n        }\n      });\n    },\n  };\n}\n\ncoreModule.directive('panelHeader', panelHeader);\n","import './playlists_ctrl';\nimport './playlist_search';\nimport './playlist_srv';\nimport './playlist_edit_ctrl';\nimport './playlist_routes';\n","import angular from 'angular';\nimport $ from 'jquery';\nimport Drop from 'tether-drop';\nimport baron from 'baron';\n\nconst module = angular.module('grafana.directives');\n\nconst panelTemplate = `\n  <div class=\"panel-container\">\n    <div class=\"panel-header\" ng-class=\"{'grid-drag-handle': !ctrl.fullscreen}\">\n      <span class=\"panel-info-corner\">\n        <i class=\"fa\"></i>\n        <span class=\"panel-info-corner-inner\"></span>\n      </span>\n\n      <span class=\"panel-loading\" ng-show=\"ctrl.loading\">\n        <i class=\"fa fa-spinner fa-spin\"></i>\n      </span>\n\n      <panel-header class=\"panel-title-container\" panel-ctrl=\"ctrl\"></panel-header>\n    </div>\n\n    <div class=\"panel-content\">\n      <ng-transclude class=\"panel-height-helper\"></ng-transclude>\n    </div>\n  </div>\n\n  <div class=\"panel-full-edit\" ng-if=\"ctrl.editMode\">\n    <div class=\"tabbed-view tabbed-view--panel-edit\">\n      <div class=\"tabbed-view-header\">\n        <h3 class=\"tabbed-view-panel-title\">\n          {{ctrl.pluginName}}\n        </h3>\n\n        <ul class=\"gf-tabs\">\n          <li class=\"gf-tabs-item\" ng-repeat=\"tab in ::ctrl.editorTabs\">\n            <a class=\"gf-tabs-link\" ng-click=\"ctrl.changeTab($index)\" ng-class=\"{active: ctrl.editorTabIndex === $index}\">\n              {{::tab.title}}\n            </a>\n          </li>\n        </ul>\n\n        <button class=\"tabbed-view-close-btn\" ng-click=\"ctrl.exitFullscreen();\">\n          <i class=\"fa fa-remove\"></i>\n        </button>\n      </div>\n\n      <div class=\"tabbed-view-body\">\n        <div ng-repeat=\"tab in ctrl.editorTabs\" ng-if=\"ctrl.editorTabIndex === $index\">\n          <panel-editor-tab editor-tab=\"tab\" ctrl=\"ctrl\" index=\"$index\"></panel-editor-tab>\n        </div>\n      </div>\n    </div>\n  </div>\n`;\n\nmodule.directive('grafanaPanel', ($rootScope, $document, $timeout) => {\n  return {\n    restrict: 'E',\n    template: panelTemplate,\n    transclude: true,\n    scope: { ctrl: '=' },\n    link: (scope, elem) => {\n      const panelContainer = elem.find('.panel-container');\n      const panelContent = elem.find('.panel-content');\n      const cornerInfoElem = elem.find('.panel-info-corner');\n      const ctrl = scope.ctrl;\n      let infoDrop;\n      let panelScrollbar;\n\n      // the reason for handling these classes this way is for performance\n      // limit the watchers on panels etc\n      let transparentLastState = false;\n      let lastHasAlertRule = false;\n      let lastAlertState;\n      let hasAlertRule;\n\n      function mouseEnter() {\n        panelContainer.toggleClass('panel-hover-highlight', true);\n        ctrl.dashboard.setPanelFocus(ctrl.panel.id);\n      }\n\n      function mouseLeave() {\n        panelContainer.toggleClass('panel-hover-highlight', false);\n        ctrl.dashboard.setPanelFocus(0);\n      }\n\n      function panelHeightUpdated() {\n        panelContent.css({ height: ctrl.height + 'px' });\n      }\n\n      function resizeScrollableContent() {\n        if (panelScrollbar) {\n          panelScrollbar.update();\n        }\n      }\n\n      // set initial transparency\n      if (ctrl.panel.transparent) {\n        transparentLastState = true;\n        panelContainer.addClass('panel-transparent', true);\n      }\n\n      // update scrollbar after mounting\n      ctrl.events.on('component-did-mount', () => {\n        if (ctrl.__proto__.constructor.scrollable) {\n          const scrollRootClass = 'baron baron__root baron__clipper panel-content--scrollable';\n          const scrollerClass = 'baron__scroller';\n          const scrollBarHTML = `\n            <div class=\"baron__track\">\n              <div class=\"baron__bar\"></div>\n            </div>\n          `;\n\n          const scrollRoot = panelContent;\n          const scroller = panelContent.find(':first').find(':first');\n\n          scrollRoot.addClass(scrollRootClass);\n          $(scrollBarHTML).appendTo(scrollRoot);\n          scroller.addClass(scrollerClass);\n\n          panelScrollbar = baron({\n            root: scrollRoot[0],\n            scroller: scroller[0],\n            bar: '.baron__bar',\n            barOnCls: '_scrollbar',\n            scrollingCls: '_scrolling',\n          });\n\n          panelScrollbar.scroll();\n        }\n      });\n\n      ctrl.events.on('panel-size-changed', () => {\n        ctrl.calculatePanelHeight();\n        panelHeightUpdated();\n        $timeout(() => {\n          resizeScrollableContent();\n          ctrl.render();\n        });\n      });\n\n      // set initial height\n      ctrl.calculatePanelHeight();\n      panelHeightUpdated();\n\n      ctrl.events.on('render', () => {\n        if (transparentLastState !== ctrl.panel.transparent) {\n          panelContainer.toggleClass('panel-transparent', ctrl.panel.transparent === true);\n          transparentLastState = ctrl.panel.transparent;\n        }\n\n        hasAlertRule = ctrl.panel.alert !== undefined;\n        if (lastHasAlertRule !== hasAlertRule) {\n          panelContainer.toggleClass('panel-has-alert', hasAlertRule);\n\n          lastHasAlertRule = hasAlertRule;\n        }\n\n        if (ctrl.alertState) {\n          if (lastAlertState) {\n            panelContainer.removeClass('panel-alert-state--' + lastAlertState);\n          }\n\n          if (ctrl.alertState.state === 'ok' || ctrl.alertState.state === 'alerting') {\n            panelContainer.addClass('panel-alert-state--' + ctrl.alertState.state);\n          }\n\n          lastAlertState = ctrl.alertState.state;\n        } else if (lastAlertState) {\n          panelContainer.removeClass('panel-alert-state--' + lastAlertState);\n          lastAlertState = null;\n        }\n      });\n\n      function updatePanelCornerInfo() {\n        const cornerMode = ctrl.getInfoMode();\n        cornerInfoElem[0].className = 'panel-info-corner panel-info-corner--' + cornerMode;\n\n        if (cornerMode) {\n          if (infoDrop) {\n            infoDrop.destroy();\n          }\n\n          infoDrop = new Drop({\n            target: cornerInfoElem[0],\n            content: () => {\n              return ctrl.getInfoContent({ mode: 'tooltip' });\n            },\n            classes: ctrl.error ? 'drop-error' : 'drop-help',\n            openOn: 'hover',\n            hoverOpenDelay: 100,\n            tetherOptions: {\n              attachment: 'bottom left',\n              targetAttachment: 'top left',\n              constraints: [\n                {\n                  to: 'window',\n                  attachment: 'together',\n                  pin: true,\n                },\n              ],\n            },\n          });\n        }\n      }\n\n      scope.$watchGroup(['ctrl.error', 'ctrl.panel.description'], updatePanelCornerInfo);\n      scope.$watchCollection('ctrl.panel.links', updatePanelCornerInfo);\n\n      cornerInfoElem.on('click', () => {\n        infoDrop.close();\n        scope.$apply(ctrl.openInspector.bind(ctrl));\n      });\n\n      elem.on('mouseenter', mouseEnter);\n      elem.on('mouseleave', mouseLeave);\n\n      scope.$on('$destroy', () => {\n        elem.off();\n        cornerInfoElem.off();\n\n        if (infoDrop) {\n          infoDrop.destroy();\n        }\n\n        if (panelScrollbar) {\n          panelScrollbar.dispose();\n        }\n      });\n    },\n  };\n});\n\nmodule.directive('panelHelpCorner', $rootScope => {\n  return {\n    restrict: 'E',\n    template: `\n    <span class=\"alert-error panel-error small pointer\" ng-if=\"ctrl.error\" ng-click=\"ctrl.openInspector()\">\n    <span data-placement=\"top\" bs-tooltip=\"ctrl.error\">\n    <i class=\"fa fa-exclamation\"></i><span class=\"panel-error-arrow\"></span>\n    </span>\n    </span>\n    `,\n    link: (scope, elem) => {},\n  };\n});\n","import angular from 'angular';\nimport locationUtil from 'app/core/utils/location_util';\nimport appEvents from 'app/core/app_events';\n\nexport class SoloPanelCtrl {\n  /** @ngInject */\n  constructor($scope, $routeParams, $location, dashboardLoaderSrv, contextSrv, backendSrv) {\n    let panelId;\n\n    $scope.init = () => {\n      contextSrv.sidemenu = false;\n      appEvents.emit('toggle-sidemenu-hidden');\n\n      const params = $location.search();\n      panelId = parseInt(params.panelId, 10);\n\n      $scope.onAppEvent('dashboard-initialized', $scope.initPanelScope);\n\n      // if no uid, redirect to new route based on slug\n      if (!($routeParams.type === 'script' || $routeParams.type === 'snapshot') && !$routeParams.uid) {\n        backendSrv.getDashboardBySlug($routeParams.slug).then(res => {\n          if (res) {\n            const url = locationUtil.stripBaseFromUrl(res.meta.url.replace('/d/', '/d-solo/'));\n            $location.path(url).replace();\n          }\n        });\n        return;\n      }\n\n      dashboardLoaderSrv.loadDashboard($routeParams.type, $routeParams.slug, $routeParams.uid).then(result => {\n        result.meta.soloMode = true;\n        $scope.initDashboard(result, $scope);\n      });\n    };\n\n    $scope.initPanelScope = () => {\n      const panelInfo = $scope.dashboard.getPanelInfoById(panelId);\n\n      // fake row ctrl scope\n      $scope.ctrl = {\n        dashboard: $scope.dashboard,\n      };\n\n      $scope.panel = panelInfo.panel;\n      $scope.panel.soloMode = true;\n      $scope.$index = 0;\n\n      if (!$scope.panel) {\n        $scope.appEvent('alert-error', ['Panel not found', '']);\n        return;\n      }\n    };\n\n    $scope.init();\n  }\n}\n\nangular.module('grafana.routes').controller('SoloPanelCtrl', SoloPanelCtrl);\n","import angular from 'angular';\n\nconst directiveModule = angular.module('grafana.directives');\n\n/** @ngInject */\nfunction panelEditorTab(dynamicDirectiveSrv) {\n  return dynamicDirectiveSrv.create({\n    scope: {\n      ctrl: '=',\n      editorTab: '=',\n      index: '=',\n    },\n    directive: scope => {\n      const pluginId = scope.ctrl.pluginId;\n      const tabIndex = scope.index;\n      // create a wrapper for directiveFn\n      // required for metrics tab directive\n      // that is the same for many panels but\n      // given different names in this function\n      const fn = () => scope.editorTab.directiveFn();\n\n      return Promise.resolve({\n        name: `panel-editor-tab-${pluginId}${tabIndex}`,\n        fn: fn,\n      });\n    },\n  });\n}\n\ndirectiveModule.directive('panelEditorTab', panelEditorTab);\n","import angular from 'angular';\n\nconst module = angular.module('grafana.directives');\n\nexport class QueryRowCtrl {\n  collapsedText: string;\n  canCollapse: boolean;\n  getCollapsedText: any;\n  target: any;\n  queryCtrl: any;\n  panelCtrl: any;\n  panel: any;\n  collapsed: any;\n\n  constructor() {\n    this.panelCtrl = this.queryCtrl.panelCtrl;\n    this.target = this.queryCtrl.target;\n    this.panel = this.panelCtrl.panel;\n\n    if (!this.target.refId) {\n      this.target.refId = this.panelCtrl.dashboard.getNextQueryLetter(this.panel);\n    }\n\n    this.toggleCollapse(true);\n    if (this.target.isNew) {\n      delete this.target.isNew;\n      this.toggleCollapse(false);\n    }\n\n    if (this.panel.targets.length < 4) {\n      this.collapsed = false;\n    }\n  }\n\n  toggleHideQuery() {\n    this.target.hide = !this.target.hide;\n    this.panelCtrl.refresh();\n  }\n\n  toggleCollapse(init) {\n    if (!this.canCollapse) {\n      return;\n    }\n\n    if (!this.panelCtrl.__collapsedQueryCache) {\n      this.panelCtrl.__collapsedQueryCache = {};\n    }\n\n    if (init) {\n      this.collapsed = this.panelCtrl.__collapsedQueryCache[this.target.refId] !== false;\n    } else {\n      this.collapsed = !this.collapsed;\n      this.panelCtrl.__collapsedQueryCache[this.target.refId] = this.collapsed;\n    }\n\n    try {\n      this.collapsedText = this.queryCtrl.getCollapsedText();\n    } catch (e) {\n      const err = e.message || e.toString();\n      this.collapsedText = 'Error: ' + err;\n    }\n  }\n\n  toggleEditorMode() {\n    if (this.canCollapse && this.collapsed) {\n      this.collapsed = false;\n    }\n\n    this.queryCtrl.toggleEditorMode();\n  }\n\n  removeQuery() {\n    if (this.panelCtrl.__collapsedQueryCache) {\n      delete this.panelCtrl.__collapsedQueryCache[this.target.refId];\n    }\n\n    this.panelCtrl.removeQuery(this.target);\n  }\n\n  duplicateQuery() {\n    const clone = angular.copy(this.target);\n    this.panelCtrl.addQuery(clone);\n  }\n\n  moveQuery(direction) {\n    this.panelCtrl.moveQuery(this.target, direction);\n  }\n}\n\n/** @ngInject */\nfunction queryEditorRowDirective() {\n  return {\n    restrict: 'E',\n    controller: QueryRowCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    templateUrl: 'public/app/features/panel/partials/query_editor_row.html',\n    transclude: true,\n    scope: {\n      queryCtrl: '=',\n      canCollapse: '=',\n      hasTextEditMode: '=',\n    },\n  };\n}\n\nmodule.directive('queryEditorRow', queryEditorRowDirective);\n","import _ from 'lodash';\nimport appEvents from 'app/core/app_events';\nimport { coreModule, JsonExplorer } from 'app/core/core';\n\nconst template = `\n<div class=\"query-troubleshooter\" ng-if=\"ctrl.isOpen\">\n  <div class=\"query-troubleshooter__header\">\n    <a class=\"pointer\" ng-click=\"ctrl.toggleMocking()\">Mock Response</a>\n    <a class=\"pointer\" ng-click=\"ctrl.toggleExpand()\" ng-hide=\"ctrl.allNodesExpanded\">\n      <i class=\"fa fa-plus-square-o\"></i> Expand All\n    </a>\n    <a class=\"pointer\" ng-click=\"ctrl.toggleExpand()\" ng-show=\"ctrl.allNodesExpanded\">\n      <i class=\"fa fa-minus-square-o\"></i> Collapse All\n    </a>\n    <a class=\"pointer\" clipboard-button=\"ctrl.getClipboardText()\"><i class=\"fa fa-clipboard\"></i> Copy to Clipboard</a>\n  </div>\n  <div class=\"query-troubleshooter__body\" ng-hide=\"ctrl.isMocking\">\n    <i class=\"fa fa-spinner fa-spin\" ng-show=\"ctrl.isLoading\"></i>\n    <div class=\"query-troubleshooter-json\"></div>\n  </div>\n  <div class=\"query-troubleshooter__body\" ng-show=\"ctrl.isMocking\">\n    <div class=\"gf-form p-l-1 gf-form--v-stretch\">\n\t\t\t<textarea class=\"gf-form-input\" style=\"width: 95%\" rows=\"10\" ng-model=\"ctrl.mockedResponse\"  placeholder=\"JSON\"></textarea>\n    </div>\n  </div>\n</div>\n`;\n\nexport class QueryTroubleshooterCtrl {\n  isOpen: any;\n  isLoading: boolean;\n  showResponse: boolean;\n  panelCtrl: any;\n  renderJsonExplorer: (data) => void;\n  onRequestErrorEventListener: any;\n  onRequestResponseEventListener: any;\n  hasError: boolean;\n  allNodesExpanded: boolean;\n  isMocking: boolean;\n  mockedResponse: string;\n  jsonExplorer: JsonExplorer;\n\n  /** @ngInject */\n  constructor($scope, private $timeout) {\n    this.onRequestErrorEventListener = this.onRequestError.bind(this);\n    this.onRequestResponseEventListener = this.onRequestResponse.bind(this);\n\n    appEvents.on('ds-request-response', this.onRequestResponseEventListener);\n    appEvents.on('ds-request-error', this.onRequestErrorEventListener);\n\n    $scope.$on('$destroy', this.removeEventsListeners.bind(this));\n    $scope.$watch('ctrl.isOpen', this.stateChanged.bind(this));\n  }\n\n  removeEventsListeners() {\n    appEvents.off('ds-request-response', this.onRequestResponseEventListener);\n    appEvents.off('ds-request-error', this.onRequestErrorEventListener);\n  }\n\n  toggleMocking() {\n    this.isMocking = !this.isMocking;\n  }\n\n  onRequestError(err) {\n    // ignore if closed\n    if (!this.isOpen) {\n      return;\n    }\n\n    this.isOpen = true;\n    this.hasError = true;\n    this.onRequestResponse(err);\n  }\n\n  stateChanged() {\n    if (this.isOpen) {\n      this.panelCtrl.refresh();\n      this.isLoading = true;\n    }\n  }\n\n  getClipboardText(): string {\n    if (this.jsonExplorer) {\n      return JSON.stringify(this.jsonExplorer.json, null, 2);\n    }\n    return '';\n  }\n\n  handleMocking(data) {\n    let mockedData;\n    try {\n      mockedData = JSON.parse(this.mockedResponse);\n    } catch (err) {\n      appEvents.emit('alert-error', ['Failed to parse mocked response']);\n      return;\n    }\n\n    data.data = mockedData;\n  }\n\n  onRequestResponse(data) {\n    // ignore if closed\n    if (!this.isOpen) {\n      return;\n    }\n\n    if (this.isMocking) {\n      this.handleMocking(data);\n      return;\n    }\n\n    this.isLoading = false;\n    data = _.cloneDeep(data);\n\n    if (data.headers) {\n      delete data.headers;\n    }\n\n    if (data.config) {\n      data.request = data.config;\n      delete data.config;\n      delete data.request.transformRequest;\n      delete data.request.transformResponse;\n      delete data.request.paramSerializer;\n      delete data.request.jsonpCallbackParam;\n      delete data.request.headers;\n      delete data.request.requestId;\n      delete data.request.inspect;\n      delete data.request.retry;\n      delete data.request.timeout;\n    }\n\n    if (data.data) {\n      data.response = data.data;\n\n      if (data.status === 200) {\n        // if we are in error state, assume we automatically opened\n        // and auto close it again\n        if (this.hasError) {\n          this.hasError = false;\n          this.isOpen = false;\n        }\n      }\n\n      delete data.data;\n      delete data.status;\n      delete data.statusText;\n      delete data.$$config;\n    }\n\n    this.$timeout(_.partial(this.renderJsonExplorer, data));\n  }\n\n  toggleExpand(depth) {\n    if (this.jsonExplorer) {\n      this.allNodesExpanded = !this.allNodesExpanded;\n      this.jsonExplorer.openAtDepth(this.allNodesExpanded ? 20 : 1);\n    }\n  }\n}\n\nexport function queryTroubleshooter() {\n  return {\n    restrict: 'E',\n    template: template,\n    controller: QueryTroubleshooterCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    scope: {\n      panelCtrl: '=',\n      isOpen: '=',\n    },\n    link: (scope, elem, attrs, ctrl) => {\n      ctrl.renderJsonExplorer = data => {\n        const jsonElem = elem.find('.query-troubleshooter-json');\n\n        ctrl.jsonExplorer = new JsonExplorer(data, 3, {\n          animateOpen: true,\n        });\n\n        const html = ctrl.jsonExplorer.render(true);\n        jsonElem.html(html);\n      };\n    },\n  };\n}\n\ncoreModule.directive('queryTroubleshooter', queryTroubleshooter);\n","import './panel_header';\nimport './panel_directive';\nimport './solo_panel_ctrl';\nimport './query_ctrl';\nimport './panel_editor_tab';\nimport './query_editor_row';\nimport './query_troubleshooter';\n","import config from 'app/core/config';\nimport coreModule from 'app/core/core_module';\nimport Remarkable from 'remarkable';\nimport _ from 'lodash';\n\nexport class OrgUsersCtrl {\n  unfiltered: any;\n  users: any;\n  pendingInvites: any;\n  editor: any;\n  navModel: any;\n  externalUserMngLinkUrl: string;\n  externalUserMngLinkName: string;\n  externalUserMngInfo: string;\n  canInvite: boolean;\n  searchQuery: string;\n  showInvites: boolean;\n\n  /** @ngInject */\n  constructor(private $scope, private backendSrv, navModelSrv, $sce) {\n    this.navModel = navModelSrv.getNav('cfg', 'users', 0);\n\n    this.get();\n    this.externalUserMngLinkUrl = config.externalUserMngLinkUrl;\n    this.externalUserMngLinkName = config.externalUserMngLinkName;\n    this.canInvite = !config.disableLoginForm && !config.externalUserMngLinkName;\n\n    // render external user management info markdown\n    if (config.externalUserMngInfo) {\n      this.externalUserMngInfo = new Remarkable({\n        linkTarget: '__blank',\n      }).render(config.externalUserMngInfo);\n    }\n  }\n\n  get() {\n    this.backendSrv.get('/api/org/users').then(users => {\n      this.users = users;\n      this.unfiltered = users;\n    });\n    this.backendSrv.get('/api/org/invites').then(pendingInvites => {\n      this.pendingInvites = pendingInvites;\n    });\n  }\n\n  onQueryUpdated() {\n    const regex = new RegExp(this.searchQuery, 'ig');\n    this.users = _.filter(this.unfiltered, item => {\n      return regex.test(item.email) || regex.test(item.login);\n    });\n  }\n\n  updateOrgUser(user) {\n    this.backendSrv.patch('/api/org/users/' + user.userId, user);\n  }\n\n  removeUser(user) {\n    this.$scope.appEvent('confirm-modal', {\n      title: 'Delete',\n      text: 'Are you sure you want to delete user ' + user.login + '?',\n      yesText: 'Delete',\n      icon: 'fa-warning',\n      onConfirm: () => {\n        this.removeUserConfirmed(user);\n      },\n    });\n  }\n\n  removeUserConfirmed(user) {\n    this.backendSrv.delete('/api/org/users/' + user.userId).then(this.get.bind(this));\n  }\n\n  revokeInvite(invite, evt) {\n    evt.stopPropagation();\n    this.backendSrv.patch('/api/org/invites/' + invite.code + '/revoke').then(this.get.bind(this));\n  }\n\n  copyInviteToClipboard(evt) {\n    evt.stopPropagation();\n  }\n\n  getInviteUrl(invite) {\n    return invite.url;\n  }\n}\n\ncoreModule.controller('OrgUsersCtrl', OrgUsersCtrl);\n","import config from 'app/core/config';\nimport { coreModule } from 'app/core/core';\n\nexport class ProfileCtrl {\n  user: any;\n  oldTheme: any;\n  teams: any = [];\n  orgs: any = [];\n  userForm: any;\n  showTeamsList = false;\n  showOrgsList = false;\n  readonlyLoginFields = config.disableLoginForm;\n  navModel: any;\n\n  /** @ngInject */\n  constructor(private backendSrv, private contextSrv, private $location, navModelSrv) {\n    this.getUser();\n    this.getUserTeams();\n    this.getUserOrgs();\n    this.navModel = navModelSrv.getNav('profile', 'profile-settings', 0);\n  }\n\n  getUser() {\n    this.backendSrv.get('/api/user').then(user => {\n      this.user = user;\n      this.user.theme = user.theme || 'dark';\n    });\n  }\n\n  getUserTeams() {\n    this.backendSrv.get('/api/user/teams').then(teams => {\n      this.teams = teams;\n      this.showTeamsList = this.teams.length > 0;\n    });\n  }\n\n  getUserOrgs() {\n    this.backendSrv.get('/api/user/orgs').then(orgs => {\n      this.orgs = orgs;\n      this.showOrgsList = orgs.length > 1;\n    });\n  }\n\n  setUsingOrg(org) {\n    this.backendSrv.post('/api/user/using/' + org.orgId).then(() => {\n      window.location.href = config.appSubUrl + '/profile';\n    });\n  }\n\n  update() {\n    if (!this.userForm.$valid) {\n      return;\n    }\n\n    this.backendSrv.put('/api/user/', this.user).then(() => {\n      this.contextSrv.user.name = this.user.name || this.user.login;\n      if (this.oldTheme !== this.user.theme) {\n        window.location.href = config.appSubUrl + this.$location.path();\n      }\n    });\n  }\n}\n\ncoreModule.controller('ProfileCtrl', ProfileCtrl);\n","import angular from 'angular';\nimport config from 'app/core/config';\n\nexport class SelectOrgCtrl {\n  /** @ngInject */\n  constructor($scope, backendSrv, contextSrv) {\n    contextSrv.sidemenu = false;\n\n    $scope.navModel = {\n      main: {\n        icon: 'gicon gicon-branding',\n        subTitle: 'Preferences',\n        text: 'Select active organization',\n      },\n    };\n\n    $scope.init = () => {\n      $scope.getUserOrgs();\n    };\n\n    $scope.getUserOrgs = () => {\n      backendSrv.get('/api/user/orgs').then(orgs => {\n        $scope.orgs = orgs;\n      });\n    };\n\n    $scope.setUsingOrg = org => {\n      backendSrv.post('/api/user/using/' + org.orgId).then(() => {\n        window.location.href = config.appSubUrl + '/';\n      });\n    };\n\n    $scope.init();\n  }\n}\n\nangular.module('grafana.controllers').controller('SelectOrgCtrl', SelectOrgCtrl);\n","import angular from 'angular';\nimport config from 'app/core/config';\n\nexport class ChangePasswordCtrl {\n  /** @ngInject */\n  constructor($scope, backendSrv, $location, navModelSrv) {\n    $scope.command = {};\n    $scope.authProxyEnabled = config.authProxyEnabled;\n    $scope.ldapEnabled = config.ldapEnabled;\n    $scope.navModel = navModelSrv.getNav('profile', 'change-password', 0);\n\n    $scope.changePassword = () => {\n      if (!$scope.userForm.$valid) {\n        return;\n      }\n\n      if ($scope.command.newPassword !== $scope.command.confirmNew) {\n        $scope.appEvent('alert-warning', ['New passwords do not match', '']);\n        return;\n      }\n\n      backendSrv.put('/api/user/password', $scope.command).then(() => {\n        $location.path('profile');\n      });\n    };\n  }\n}\n\nangular.module('grafana.controllers').controller('ChangePasswordCtrl', ChangePasswordCtrl);\n","import angular from 'angular';\nimport config from 'app/core/config';\n\nexport class NewOrgCtrl {\n  /** @ngInject */\n  constructor($scope, $http, backendSrv, navModelSrv) {\n    $scope.navModel = navModelSrv.getNav('cfg', 'admin', 'global-orgs', 1);\n    $scope.newOrg = { name: '' };\n\n    $scope.createOrg = () => {\n      backendSrv.post('/api/orgs/', $scope.newOrg).then(result => {\n        backendSrv.post('/api/user/using/' + result.orgId).then(() => {\n          window.location.href = config.appSubUrl + '/org';\n        });\n      });\n    };\n  }\n}\n\nangular.module('grafana.controllers').controller('NewOrgCtrl', NewOrgCtrl);\n","import coreModule from 'app/core/core_module';\n\nexport class UserInviteCtrl {\n  navModel: any;\n  invite: any;\n  inviteForm: any;\n\n  /** @ngInject */\n  constructor(private backendSrv, navModelSrv, private $location) {\n    this.navModel = navModelSrv.getNav('cfg', 'users', 0);\n\n    this.invite = {\n      name: '',\n      email: '',\n      role: 'Editor',\n      sendEmail: true,\n    };\n  }\n\n  sendInvite() {\n    if (!this.inviteForm.$valid) {\n      return;\n    }\n\n    return this.backendSrv.post('/api/org/invites', this.invite).then(() => {\n      this.$location.path('org/users/');\n    });\n  }\n}\n\ncoreModule.controller('UserInviteCtrl', UserInviteCtrl);\n","import coreModule from 'app/core/core_module';\n\nexport default class CreateTeamCtrl {\n  name: string;\n  email: string;\n  navModel: any;\n\n  /** @ngInject */\n  constructor(private backendSrv, private $location, navModelSrv) {\n    this.navModel = navModelSrv.getNav('cfg', 'teams', 0);\n  }\n\n  create() {\n    const payload = {\n      name: this.name,\n      email: this.email,\n    };\n    this.backendSrv.post('/api/teams', payload).then(result => {\n      if (result.teamId) {\n        this.$location.path('/org/teams/edit/' + result.teamId);\n      }\n    });\n  }\n}\n\ncoreModule.controller('CreateTeamCtrl', CreateTeamCtrl);\n","import angular from 'angular';\n\nexport class OrgDetailsCtrl {\n  /** @ngInject */\n  constructor($scope, $http, backendSrv, contextSrv, navModelSrv) {\n    $scope.init = () => {\n      $scope.getOrgInfo();\n      $scope.navModel = navModelSrv.getNav('cfg', 'org-settings', 0);\n    };\n\n    $scope.getOrgInfo = () => {\n      backendSrv.get('/api/org').then(org => {\n        $scope.org = org;\n        $scope.address = org.address;\n        contextSrv.user.orgName = org.name;\n      });\n    };\n\n    $scope.update = () => {\n      if (!$scope.orgForm.$valid) {\n        return;\n      }\n      const data = { name: $scope.org.name };\n      backendSrv.put('/api/org', data).then($scope.getOrgInfo);\n    };\n\n    $scope.updateAddress = () => {\n      if (!$scope.addressForm.$valid) {\n        return;\n      }\n      backendSrv.put('/api/org/address', $scope.address).then($scope.getOrgInfo);\n    };\n\n    $scope.init();\n  }\n}\n\nangular.module('grafana.controllers').controller('OrgDetailsCtrl', OrgDetailsCtrl);\n","import config from 'app/core/config';\nimport coreModule from 'app/core/core_module';\n\nexport class PrefsControlCtrl {\n  prefs: any;\n  oldTheme: any;\n  prefsForm: any;\n  mode: string;\n\n  timezones: any = [\n    { value: '', text: 'Default' },\n    { value: 'browser', text: 'Local browser time' },\n    { value: 'utc', text: 'UTC' },\n  ];\n  themes: any = [{ value: '', text: 'Default' }, { value: 'dark', text: 'Dark' }, { value: 'light', text: 'Light' }];\n\n  /** @ngInject */\n  constructor(private backendSrv, private $location) {}\n\n  $onInit() {\n    return this.backendSrv.get(`/api/${this.mode}/preferences`).then(prefs => {\n      this.prefs = prefs;\n      this.oldTheme = prefs.theme;\n    });\n  }\n\n  updatePrefs() {\n    if (!this.prefsForm.$valid) {\n      return;\n    }\n\n    const cmd = {\n      theme: this.prefs.theme,\n      timezone: this.prefs.timezone,\n      homeDashboardId: this.prefs.homeDashboardId,\n    };\n\n    this.backendSrv.put(`/api/${this.mode}/preferences`, cmd).then(() => {\n      window.location.href = config.appSubUrl + this.$location.path();\n    });\n  }\n}\n\nconst template = `\n<form name=\"ctrl.prefsForm\" class=\"section gf-form-group\">\n  <h3 class=\"page-heading\">Preferences</h3>\n\n  <div class=\"gf-form\">\n    <span class=\"gf-form-label width-11\">UI Theme</span>\n    <div class=\"gf-form-select-wrapper max-width-20\">\n      <select class=\"gf-form-input\" ng-model=\"ctrl.prefs.theme\" ng-options=\"f.value as f.text for f in ctrl.themes\"></select>\n    </div>\n  </div>\n\n  <div class=\"gf-form\">\n    <span class=\"gf-form-label width-11\">\n      Home Dashboard\n      <info-popover mode=\"right-normal\">\n        Not finding dashboard you want? Star it first, then it should appear in this select box.\n      </info-popover>\n    </span>\n    <dashboard-selector class=\"gf-form-select-wrapper max-width-20\" model=\"ctrl.prefs.homeDashboardId\">\n    </dashboard-selector>\n  </div>\n\n  <div class=\"gf-form\">\n    <label class=\"gf-form-label width-11\">Timezone</label>\n    <div class=\"gf-form-select-wrapper max-width-20\">\n      <select class=\"gf-form-input\" ng-model=\"ctrl.prefs.timezone\" ng-options=\"f.value as f.text for f in ctrl.timezones\"></select>\n    </div>\n  </div>\n\n  <div class=\"gf-form-button-row\">\n    <button type=\"submit\" class=\"btn btn-success\" ng-click=\"ctrl.updatePrefs()\">Save</button>\n  </div>\n</form>\n`;\n\nexport function prefsControlDirective() {\n  return {\n    restrict: 'E',\n    controller: PrefsControlCtrl,\n    bindToController: true,\n    controllerAs: 'ctrl',\n    template: template,\n    scope: {\n      mode: '@',\n    },\n  };\n}\n\ncoreModule.directive('prefsControl', prefsControlDirective);\n","import './org_users_ctrl';\nimport './profile_ctrl';\nimport './org_users_ctrl';\nimport './select_org_ctrl';\nimport './change_password_ctrl';\nimport './new_org_ctrl';\nimport './user_invite_ctrl';\nimport './create_team_ctrl';\nimport './org_details_ctrl';\nimport './prefs_control';\n","export default class AdminListUsersCtrl {\n  users: any;\n  pages = [];\n  perPage = 50;\n  page = 1;\n  totalPages: number;\n  showPaging = false;\n  query: any;\n  navModel: any;\n\n  /** @ngInject */\n  constructor(private $scope, private backendSrv, navModelSrv) {\n    this.navModel = navModelSrv.getNav('cfg', 'admin', 'global-users', 1);\n    this.query = '';\n    this.getUsers();\n  }\n\n  getUsers() {\n    this.backendSrv\n      .get(`/api/users/search?perpage=${this.perPage}&page=${this.page}&query=${this.query}`)\n      .then(result => {\n        this.users = result.users;\n        this.page = result.page;\n        this.perPage = result.perPage;\n        this.totalPages = Math.ceil(result.totalCount / result.perPage);\n        this.showPaging = this.totalPages > 1;\n        this.pages = [];\n\n        for (let i = 1; i < this.totalPages + 1; i++) {\n          this.pages.push({ page: i, current: i === this.page });\n        }\n      });\n  }\n\n  navigateToPage(page) {\n    this.page = page.page;\n    this.getUsers();\n  }\n\n  deleteUser(user) {\n    this.$scope.appEvent('confirm-modal', {\n      title: 'Delete',\n      text: 'Do you want to delete ' + user.login + '?',\n      icon: 'fa-trash',\n      yesText: 'Delete',\n      onConfirm: () => {\n        this.backendSrv.delete('/api/admin/users/' + user.id).then(() => {\n          this.getUsers();\n        });\n      },\n    });\n  }\n}\n","import _ from 'lodash';\n\nexport default class AdminEditUserCtrl {\n  /** @ngInject */\n  constructor($scope, $routeParams, backendSrv, $location, navModelSrv) {\n    $scope.user = {};\n    $scope.newOrg = { name: '', role: 'Editor' };\n    $scope.permissions = {};\n    $scope.navModel = navModelSrv.getNav('cfg', 'admin', 'global-users', 1);\n\n    $scope.init = () => {\n      if ($routeParams.id) {\n        $scope.getUser($routeParams.id);\n        $scope.getUserOrgs($routeParams.id);\n      }\n    };\n\n    $scope.getUser = id => {\n      backendSrv.get('/api/users/' + id).then(user => {\n        $scope.user = user;\n        $scope.user_id = id;\n        $scope.permissions.isGrafanaAdmin = user.isGrafanaAdmin;\n      });\n    };\n\n    $scope.setPassword = () => {\n      if (!$scope.passwordForm.$valid) {\n        return;\n      }\n\n      const payload = { password: $scope.password };\n      backendSrv.put('/api/admin/users/' + $scope.user_id + '/password', payload).then(() => {\n        $location.path('/admin/users');\n      });\n    };\n\n    $scope.updatePermissions = () => {\n      const payload = $scope.permissions;\n\n      backendSrv.put('/api/admin/users/' + $scope.user_id + '/permissions', payload).then(() => {\n        $location.path('/admin/users');\n      });\n    };\n\n    $scope.create = () => {\n      if (!$scope.userForm.$valid) {\n        return;\n      }\n\n      backendSrv.post('/api/admin/users', $scope.user).then(() => {\n        $location.path('/admin/users');\n      });\n    };\n\n    $scope.getUserOrgs = id => {\n      backendSrv.get('/api/users/' + id + '/orgs').then(orgs => {\n        $scope.orgs = orgs;\n      });\n    };\n\n    $scope.update = () => {\n      if (!$scope.userForm.$valid) {\n        return;\n      }\n\n      backendSrv.put('/api/users/' + $scope.user_id, $scope.user).then(() => {\n        $location.path('/admin/users');\n      });\n    };\n\n    $scope.updateOrgUser = orgUser => {\n      backendSrv.patch('/api/orgs/' + orgUser.orgId + '/users/' + $scope.user_id, orgUser).then(() => {});\n    };\n\n    $scope.removeOrgUser = orgUser => {\n      backendSrv.delete('/api/orgs/' + orgUser.orgId + '/users/' + $scope.user_id).then(() => {\n        $scope.getUser($scope.user_id);\n        $scope.getUserOrgs($scope.user_id);\n      });\n    };\n\n    $scope.orgsSearchCache = [];\n\n    $scope.searchOrgs = (queryStr, callback) => {\n      if ($scope.orgsSearchCache.length > 0) {\n        callback(_.map($scope.orgsSearchCache, 'name'));\n        return;\n      }\n\n      backendSrv.get('/api/orgs', { query: '' }).then(result => {\n        $scope.orgsSearchCache = result;\n        callback(_.map(result, 'name'));\n      });\n    };\n\n    $scope.addOrgUser = () => {\n      if (!$scope.addOrgForm.$valid) {\n        return;\n      }\n\n      const orgInfo = _.find($scope.orgsSearchCache, {\n        name: $scope.newOrg.name,\n      });\n      if (!orgInfo) {\n        return;\n      }\n\n      $scope.newOrg.loginOrEmail = $scope.user.login;\n\n      backendSrv.post('/api/orgs/' + orgInfo.id + '/users/', $scope.newOrg).then(() => {\n        $scope.getUser($scope.user_id);\n        $scope.getUserOrgs($scope.user_id);\n      });\n    };\n\n    $scope.init();\n  }\n}\n","\nexport default class AdminEditOrgCtrl {\n  /** @ngInject */\n  constructor($scope, $routeParams, backendSrv, $location, navModelSrv) {\n    $scope.init = () => {\n      $scope.navModel = navModelSrv.getNav('cfg', 'admin', 'global-orgs', 1);\n\n      if ($routeParams.id) {\n        $scope.getOrg($routeParams.id);\n        $scope.getOrgUsers($routeParams.id);\n      }\n    };\n\n    $scope.getOrg = id => {\n      backendSrv.get('/api/orgs/' + id).then(org => {\n        $scope.org = org;\n      });\n    };\n\n    $scope.getOrgUsers = id => {\n      backendSrv.get('/api/orgs/' + id + '/users').then(orgUsers => {\n        $scope.orgUsers = orgUsers;\n      });\n    };\n\n    $scope.update = () => {\n      if (!$scope.orgDetailsForm.$valid) {\n        return;\n      }\n\n      backendSrv.put('/api/orgs/' + $scope.org.id, $scope.org).then(() => {\n        $location.path('/admin/orgs');\n      });\n    };\n\n    $scope.updateOrgUser = orgUser => {\n      backendSrv.patch('/api/orgs/' + orgUser.orgId + '/users/' + orgUser.userId, orgUser);\n    };\n\n    $scope.removeOrgUser = orgUser => {\n      backendSrv.delete('/api/orgs/' + orgUser.orgId + '/users/' + orgUser.userId).then(() => {\n        $scope.getOrgUsers($scope.org.id);\n      });\n    };\n\n    $scope.init();\n  }\n}\n\n","\nexport default class AdminListOrgsCtrl {\n  /** @ngInject */\n  constructor($scope, backendSrv, navModelSrv) {\n    $scope.init = () => {\n      $scope.navModel = navModelSrv.getNav('cfg', 'admin', 'global-orgs', 1);\n      $scope.getOrgs();\n    };\n\n    $scope.getOrgs = () => {\n      backendSrv.get('/api/orgs').then(orgs => {\n        $scope.orgs = orgs;\n      });\n    };\n\n    $scope.deleteOrg = org => {\n      $scope.appEvent('confirm-modal', {\n        title: 'Delete',\n        text: 'Do you want to delete organization ' + org.name + '?',\n        text2: 'All dashboards for this organization will be removed!',\n        icon: 'fa-trash',\n        yesText: 'Delete',\n        onConfirm: () => {\n          backendSrv.delete('/api/orgs/' + org.id).then(() => {\n            $scope.getOrgs();\n          });\n        },\n      });\n    };\n\n    $scope.init();\n  }\n}\n\n","import _ from 'lodash';\nimport { appEvents, coreModule } from 'app/core/core';\n\nexport class AlertNotificationEditCtrl {\n  theForm: any;\n  navModel: any;\n  testSeverity = 'critical';\n  notifiers: any;\n  notifierTemplateId: string;\n  isNew: boolean;\n  model: any;\n  defaults: any = {\n    type: 'email',\n    sendReminder: false,\n    frequency: '15m',\n    settings: {\n      httpMethod: 'POST',\n      autoResolve: true,\n      uploadImage: true,\n    },\n    isDefault: false,\n  };\n  getFrequencySuggestion: any;\n\n  /** @ngInject */\n  constructor(private $routeParams, private backendSrv, private $location, private $templateCache, navModelSrv) {\n    this.navModel = navModelSrv.getNav('alerting', 'channels', 0);\n    this.isNew = !this.$routeParams.id;\n\n    this.getFrequencySuggestion = () => {\n      return ['1m', '5m', '10m', '15m', '30m', '1h'];\n    };\n\n    this.backendSrv\n      .get(`/api/alert-notifiers`)\n      .then(notifiers => {\n        this.notifiers = notifiers;\n\n        // add option templates\n        for (const notifier of this.notifiers) {\n          this.$templateCache.put(this.getNotifierTemplateId(notifier.type), notifier.optionsTemplate);\n        }\n\n        if (!this.$routeParams.id) {\n          this.navModel.breadcrumbs.push({ text: 'New channel' });\n          this.navModel.node = { text: 'New channel' };\n          return _.defaults(this.model, this.defaults);\n        }\n\n        return this.backendSrv.get(`/api/alert-notifications/${this.$routeParams.id}`).then(result => {\n          this.navModel.breadcrumbs.push({ text: result.name });\n          this.navModel.node = { text: result.name };\n          result.settings = _.defaults(result.settings, this.defaults.settings);\n          return result;\n        });\n      })\n      .then(model => {\n        this.model = model;\n        this.notifierTemplateId = this.getNotifierTemplateId(this.model.type);\n      });\n  }\n\n  save() {\n    if (!this.theForm.$valid) {\n      return;\n    }\n\n    if (this.model.id) {\n      this.backendSrv\n        .put(`/api/alert-notifications/${this.model.id}`, this.model)\n        .then(res => {\n          this.model = res;\n          appEvents.emit('alert-success', ['Notification updated', '']);\n        })\n        .catch(err => {\n          if (err.data && err.data.error) {\n            appEvents.emit('alert-error', [err.data.error]);\n          }\n        });\n    } else {\n      this.backendSrv\n        .post(`/api/alert-notifications`, this.model)\n        .then(res => {\n          appEvents.emit('alert-success', ['Notification created', '']);\n          this.$location.path('alerting/notifications');\n        })\n        .catch(err => {\n          if (err.data && err.data.error) {\n            appEvents.emit('alert-error', [err.data.error]);\n          }\n        });\n    }\n  }\n\n  getNotifierTemplateId(type) {\n    return `notifier-options-${type}`;\n  }\n\n  typeChanged() {\n    this.model.settings = _.defaults({}, this.defaults.settings);\n    this.notifierTemplateId = this.getNotifierTemplateId(this.model.type);\n  }\n\n  testNotification() {\n    if (!this.theForm.$valid) {\n      return;\n    }\n\n    const payload = {\n      name: this.model.name,\n      type: this.model.type,\n      frequency: this.model.frequency,\n      settings: this.model.settings,\n    };\n\n    this.backendSrv.post(`/api/alert-notifications/test`, payload).then(res => {\n      appEvents.emit('alert-success', ['Test notification sent', '']);\n    });\n  }\n}\n\ncoreModule.controller('AlertNotificationEditCtrl', AlertNotificationEditCtrl);\n","import config from 'app/core/config';\n\nexport default class StyleGuideCtrl {\n  theme: string;\n  buttonNames = ['primary', 'secondary', 'inverse', 'success', 'warning', 'danger'];\n  buttonSizes = ['btn-small', '', 'btn-large'];\n  buttonVariants = ['-'];\n  navModel: any;\n\n  /** @ngInject */\n  constructor(private $routeParams, private backendSrv, navModelSrv) {\n    this.navModel = navModelSrv.getNav('cfg', 'admin', 'styleguide', 1);\n    this.theme = config.bootData.user.lightTheme ? 'light' : 'dark';\n  }\n\n  switchTheme() {\n    this.$routeParams.theme = this.theme === 'dark' ? 'light' : 'dark';\n\n    const cmd = {\n      theme: this.$routeParams.theme,\n    };\n\n    this.backendSrv.put('/api/user/preferences', cmd).then(() => {\n      window.location.href = window.location.href;\n    });\n  }\n}\n\n","import AdminListUsersCtrl from './AdminListUsersCtrl';\nimport AdminEditUserCtrl from './AdminEditUserCtrl';\nimport AdminListOrgsCtrl from './AdminListOrgsCtrl';\nimport AdminEditOrgCtrl from './AdminEditOrgCtrl';\nimport StyleGuideCtrl from './StyleGuideCtrl';\n\nimport coreModule from 'app/core/core_module';\n\nclass AdminSettingsCtrl {\n  navModel: any;\n\n  /** @ngInject */\n  constructor($scope, backendSrv, navModelSrv) {\n    this.navModel = navModelSrv.getNav('cfg', 'admin', 'server-settings', 1);\n\n    backendSrv.get('/api/admin/settings').then(settings => {\n      $scope.settings = settings;\n    });\n  }\n}\n\nclass AdminHomeCtrl {\n  navModel: any;\n\n  /** @ngInject */\n  constructor(navModelSrv) {\n    this.navModel = navModelSrv.getNav('cfg', 'admin', 1);\n  }\n}\n\ncoreModule.controller('AdminListUsersCtrl', AdminListUsersCtrl);\ncoreModule.controller('AdminEditUserCtrl', AdminEditUserCtrl);\ncoreModule.controller('AdminListOrgsCtrl', AdminListOrgsCtrl);\ncoreModule.controller('AdminEditOrgCtrl', AdminEditOrgCtrl);\ncoreModule.controller('AdminSettingsCtrl', AdminSettingsCtrl);\ncoreModule.controller('AdminHomeCtrl', AdminHomeCtrl);\ncoreModule.controller('StyleGuideCtrl', StyleGuideCtrl);\n","import { coreModule } from 'app/core/core';\n\nexport class AlertNotificationsListCtrl {\n  notifications: any;\n  navModel: any;\n\n  /** @ngInject */\n  constructor(private backendSrv, navModelSrv) {\n    this.loadNotifications();\n    this.navModel = navModelSrv.getNav('alerting', 'channels', 0);\n  }\n\n  loadNotifications() {\n    this.backendSrv.get(`/api/alert-notifications`).then(result => {\n      this.notifications = result;\n    });\n  }\n\n  deleteNotification(id) {\n    this.backendSrv.delete(`/api/alert-notifications/${id}`).then(() => {\n      this.notifications = this.notifications.filter(notification => {\n        return notification.id !== id;\n      });\n    });\n  }\n}\n\ncoreModule.controller('AlertNotificationsListCtrl', AlertNotificationsListCtrl);\n","export class DashboardListCtrl {\n  navModel: any;\n\n  /** @ngInject */\n  constructor(navModelSrv) {\n    this.navModel = navModelSrv.getNav('dashboards', 'manage-dashboards', 0);\n  }\n}\n","import _ from 'lodash';\n\nexport class SnapshotListCtrl {\n  navModel: any;\n  snapshots: any;\n\n  /** @ngInject */\n  constructor(private $rootScope, private backendSrv, navModelSrv) {\n    this.navModel = navModelSrv.getNav('dashboards', 'snapshots', 0);\n    this.backendSrv.get('/api/dashboard/snapshots').then(result => {\n      this.snapshots = result;\n    });\n  }\n\n  removeSnapshotConfirmed(snapshot) {\n    _.remove(this.snapshots, { key: snapshot.key });\n    this.backendSrv.delete('/api/snapshots/' + snapshot.key).then(\n      () => {},\n      () => {\n        this.snapshots.push(snapshot);\n      }\n    );\n  }\n\n  removeSnapshot(snapshot) {\n    this.$rootScope.appEvent('confirm-modal', {\n      title: 'Delete',\n      text: 'Are you sure you want to delete snapshot ' + snapshot.name + '?',\n      yesText: 'Delete',\n      icon: 'fa-trash',\n      onConfirm: () => {\n        this.removeSnapshotConfirmed(snapshot);\n      },\n    });\n  }\n}\n","import coreModule from 'app/core/core_module';\n\nimport { DashboardListCtrl } from './DashboardListCtrl';\nimport { SnapshotListCtrl } from './SnapshotListCtrl';\n\ncoreModule.controller('DashboardListCtrl', DashboardListCtrl);\ncoreModule.controller('SnapshotListCtrl', SnapshotListCtrl);\n","import './annotations/all';\nimport './templating/all';\nimport './plugins/all';\nimport './dashboard/all';\nimport './playlist/all';\nimport './panel/all';\nimport './org/all';\nimport './admin';\nimport './alerting/NotificationsEditCtrl';\nimport './alerting/NotificationsListCtrl';\nimport './manage-dashboards';\n"],"sourceRoot":""}