(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"1LJY":function(e,r,t){"use strict";t.d(r,"a",(function(){return n}));var n=function(e){return e.timeZone}},"5BoW":function(e,r,t){"use strict";t.d(r,"a",(function(){return u})),t.d(r,"b",(function(){return i}));var n=t("G4qV"),o=t("QJHg"),a=t("WnbS"),u=Object(n.a)((function(e){return e.logsResult&&e.logsResult.rows}),(function(e){return e.hiddenLogLevels}),(function(e){return e.dedupStrategy}),(function(e,r,t){if(!e||!e.length)return e;var n=Object(o.c)(e,new Set(r));return Object(o.b)(n,t)})),i=function(){return Object(a.a)().getExternal().map((function(e){return{value:e.name,name:e.name,meta:e.meta}}))}},Efza:function(e,r,t){"use strict";t.d(r,"a",(function(){return k})),t.d(r,"c",(function(){return D})),t.d(r,"e",(function(){return T})),t.d(r,"f",(function(){return P})),t.d(r,"h",(function(){return E})),t.d(r,"x",(function(){return R})),t.d(r,"g",(function(){return A})),t.d(r,"i",(function(){return L})),t.d(r,"b",(function(){return N})),t.d(r,"k",(function(){return G})),t.d(r,"l",(function(){return J})),t.d(r,"o",(function(){return U})),t.d(r,"w",(function(){return W})),t.d(r,"j",(function(){return Z})),t.d(r,"p",(function(){return V})),t.d(r,"q",(function(){return X})),t.d(r,"r",(function(){return Y})),t.d(r,"s",(function(){return K})),t.d(r,"t",(function(){return $})),t.d(r,"u",(function(){return ee})),t.d(r,"v",(function(){return re})),t.d(r,"d",(function(){return te})),t.d(r,"n",(function(){return ne})),t.d(r,"m",(function(){return oe}));var n=t("AJqF"),o=t("67Y/"),a=t("mChF"),u=t("kDLi"),i=t("Obii"),c=t("SMGL"),s=t("WnbS"),f=t("m257"),d=t("w9yp"),l=t("sBLX"),p=t("OTXG"),b=t("1LJY"),g=t("LCjV"),m=t("3SGO"),v=t("NPB1"),O=t("kHZm"),j=t("5BoW");function h(e){return function(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function x(e,r,t,n,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void t(e)}i.done?r(c):Promise.resolve(c).then(n,o)}function y(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function u(e){x(a,n,o,u,i,"next",e)}function i(e){x(a,n,o,u,i,"throw",e)}u(void 0)}))}}function w(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function I(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?w(Object(t),!0).forEach((function(r){S(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):w(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function S(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var q=function(e,r){return function(t){t(Object(p.I)(I({exploreId:e},r))),t(z())}};function k(e,r){return function(t,n){var o=n().explore[e].queries,a=Object(f.i)(o,r);t(Object(p.a)({exploreId:e,index:r,query:a}))}}function D(e,r){return function(){var t=y(regeneratorRuntime.mark((function t(n,o){var a,c,f,d,l,b,g,m,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r){t.next=6;break}return t.next=3,Object(s.a)().get();case 3:d=t.sent,t.next=9;break;case 6:return t.next=8,Object(s.a)().get(r);case 8:d=t.sent;case 9:if(l=o().explore[e].datasourceInstance,b=o().explore[e].queries,g=o().user.orgId,t.t0=d.getVersion,!t.t0){t.next=17;break}return t.next=16,d.getVersion();case 16:t.t0=t.sent;case 17:return m=t.t0,v="Prometheus"===(null==l?void 0:null===(a=l.meta)||void 0===a?void 0:a.name)&&"Loki"===(null===(c=d)||void 0===c?void 0:null===(f=c.meta)||void 0===f?void 0:f.name),n(Object(p.H)({exploreId:e,datasourceInstance:d,version:m,mode:v?i.ExploreMode.Logs:void 0})),t.next=22,n(B(e,b,l,d));case 22:return o().explore[e].isLive&&n(A(e,u.RefreshPicker.offOption.value)),t.next=25,n(F(e,d,g));case 25:n(U(e));case 26:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()}function T(e,r){return function(t){t(Object(p.d)({exploreId:e,mode:r}))}}function P(e,r,t){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(o,a){if(null===r){var u=a().explore[e].queries,i=u[t],c=i.refId,s=i.key;r=Object(f.j)({refId:c,key:s},u,t)}o(Object(p.e)({exploreId:e,query:r,index:t,override:n})),n&&o(U(e))}}function E(e,r){var t=r.height,n=r.width;return Object(p.h)({exploreId:e,height:t,width:n})}var R=function(e){return function(r,t){t().explore.syncedTimes?(r(Q(I({},e,{exploreId:l.a.left}))),r(U(l.a.left)),r(Q(I({},e,{exploreId:l.a.right}))),r(U(l.a.right))):(r(Q(I({},e))),r(U(e.exploreId)))}};function A(e,r){return Object(p.g)({exploreId:e,refreshInterval:r})}function L(e){return function(r){r(Object(p.x)({exploreId:e})),r(Object(p.i)({exploreId:e})),r(z())}}function N(e){return function(r){r(Object(p.x)({exploreId:e})),r(Object(p.b)({exploreId:e})),r(z())}}function H(e,r){return function(t){Object(j.b)().length>=1?t(D(e,r)):t(Object(p.m)({exploreId:e}))}}function G(e,r,t,n,o,a,u,i,c){return function(){var s=y(regeneratorRuntime.mark((function s(f,l){var b;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:f(H(e,r)),f(Object(p.l)({exploreId:e,containerWidth:a,eventBridge:u,queries:t,range:n,mode:o,ui:i,originPanelId:c})),f(Q({exploreId:e})),b=Object(d.j)(),f(Object(p.v)({richHistory:b}));case 5:case"end":return s.stop()}}),s)})));return function(e,r){return s.apply(this,arguments)}}()}var M=function(e,r,t){var n,o="grafana.explore.history.".concat(null===(n=r.meta)||void 0===n?void 0:n.id),a=c.a.getObject(o,[]);return c.a.set(Object(f.q)(t),r.name),Object(p.o)({exploreId:e,history:a})},B=function(e,r,t,n){return function(){var o=y(regeneratorRuntime.mark((function o(a){var u,i,c,s;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(t){o.next=3;break}return a(Object(p.q)({exploreId:e,queries:r})),o.abrupt("return");case 3:if(c=r,(null===(u=t.meta)||void 0===u?void 0:u.id)!==(null===(i=n.meta)||void 0===i?void 0:i.id)){o.next=8;break}c=h(r),o.next=15;break;case 8:if(!n.importQueries){o.next=14;break}return o.next=11,n.importQueries(r,t.meta);case 11:c=o.sent,o.next=15;break;case 14:c=Object(f.h)();case 15:s=Object(f.h)(c),a(Object(p.q)({exploreId:e,queries:s}));case 17:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}()},F=function(e,r,t){return function(){var n=y(regeneratorRuntime.mark((function n(o,a){var u;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(u=r.name,o(Object(p.n)({exploreId:e,requestedDatasourceName:u})),r.init)try{r.init()}catch(e){console.log(e)}if(u===a().explore[e].requestedDatasourceName){n.next=5;break}return n.abrupt("return");case 5:o(M(e,r,t));case 6:case"end":return n.stop()}}),n)})));return function(e,r){return n.apply(this,arguments)}}()};function J(e,r,t,n){return function(o){o(Object(p.p)({exploreId:e,modification:r,index:n,modifier:t})),r.preventSubmit||o(U(e))}}var U=function e(r){return function(t,u){t(Q({exploreId:r}));var c=u().explore.richHistory,s=u().explore[r],l=s.datasourceInstance,m=s.queries,v=s.containerWidth,j=s.isLive,h=s.range,x=s.scanning,y=s.queryResponse,w=s.querySubscription,I=s.history,S=s.mode,q=s.showingGraph,k=s.showingTable;if(!Object(f.p)(m))return t(Object(p.i)({exploreId:r})),void t(z());var D=l.interval;Object(f.x)(w);var T=l.meta.id,P={minInterval:D,maxDataPoints:S===i.ExploreMode.Logs&&"loki"===T?void 0:v,liveStreaming:j,showingGraph:q,showingTable:k,mode:S},E=s.requestedDatasourceName,R=Object(b.a)(u().user),A=Object(f.d)(m,P,h,x,R),L=!0;t(Object(p.c)({exploreId:r,loadingState:i.LoadingState.Loading}));var N=Object(O.c)(l,A.request).pipe(j?Object(n.a)(500):a.a,Object(o.a)((function(e){return Object(O.b)(e,y)}))).subscribe((function(n){if(!n.error&&L){var o=Object(f.y)(I,T,m),a=Object(d.b)(c||[],T,E,m,!1,"","");t(Object(p.k)({exploreId:r,history:o})),t(Object(p.v)({richHistory:a})),t(z())}if(L=!1,t(Object(p.s)({exploreId:r,response:n})),u().explore[r].scanning)if(n.state===i.LoadingState.Done&&0===n.series.length){var s=Object(g.a)(-1,u().explore[r].range);t(Q({exploreId:r,absoluteRange:s})),t(e(r))}else t(Object(p.x)({exploreId:r}))}));t(Object(p.r)({exploreId:r,querySubscription:N}))}},W=function(e,r,t){return function(n,o){var a;"starred"===r&&(a=Object(d.o)(o().explore.richHistory,e)),"comment"===r&&(a=Object(d.n)(o().explore.richHistory,e,t)),"delete"===r&&(a=Object(d.i)(o().explore.richHistory,e)),n(Object(p.v)({richHistory:a}))}},Z=function(){return function(e){Object(d.h)(),e(Object(p.v)({richHistory:[]}))}},C=function(e){var r=e.raw.from;Object(i.isDateTime)(r)&&(r=r.valueOf().toString(10));var t=e.raw.to;return Object(i.isDateTime)(t)&&(t=t.valueOf().toString(10)),{from:r,to:t}},z=function(){return function(e,r){var t=r().explore,n=t.left,o=t.right,a=t.split,u=r().user.orgId.toString(),i=n&&!1===n.urlReplaced,c={orgId:u},s={datasource:n.datasourceInstance.name,queries:n.queries.map(f.e),range:C(n.range),mode:n.mode,ui:{showingGraph:n.showingGraph,showingLogs:!0,showingTable:n.showingTable,dedupStrategy:n.dedupStrategy}};if(c.left=Object(f.u)(s,!0),a){var d={datasource:o.datasourceInstance.name,queries:o.queries.map(f.e),range:C(o.range),mode:o.mode,ui:{showingGraph:o.showingGraph,showingLogs:!0,showingTable:o.showingTable,dedupStrategy:o.dedupStrategy}};c.right=Object(f.u)(d,!0)}e(Object(m.c)({query:c,replace:i})),i&&e(Object(p.A)({exploreId:l.a.left}))}},Q=function(e){return function(r,t){var n=e.exploreId,o=e.absoluteRange,a=e.rawRange,u=t().explore[n],c=Object(b.a)(t().user),s=u.range.raw;o&&(s={from:Object(i.dateTimeForTimeZone)(c,o.from),to:Object(i.dateTimeForTimeZone)(c,o.to)}),a&&(s=a);var d=Object(f.n)(c,s),l={from:d.from.valueOf(),to:d.to.valueOf()};Object(v.a)().init({time:d.raw,refresh:!1,getTimezone:function(){return c},timeRangeUpdated:function(){}}),r(Object(p.f)({exploreId:n,range:d,absoluteRange:l}))}};function V(e){return function(r,t){r(Object(p.w)({exploreId:e}));var n=Object(g.a)(-1,t().explore[e].range);r(Q({exploreId:e,absoluteRange:n})),r(U(e))}}function X(e,r){return function(t,n){var o=n().explore[e].queries,a=r.map((function(e,r){return Object(f.j)(e,o,r)}));t(Object(p.z)({exploreId:e,queries:a})),t(U(e))}}function Y(e){return function(r){r(Object(p.B)({itemId:e})),r(z())}}function K(e){return function(){var r=y(regeneratorRuntime.mark((function r(t,n){var o,a,u,i,c,d;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=n().explore[l.a.left],a=I({},o),u=n().location.query[l.a.left],i=Object(f.r)(u),a.queries=o.queries.slice(),a.urlState=i,t(Object(p.C)({itemState:a})),!e){r.next=14;break}return c=[{query:e.query,refId:"A"}],d=Object(s.a)().getDataSourceSettingsByUid(e.datasourceUid),r.next=12,t(D(l.a.right,d.name));case 12:return r.next=14,t(Object(p.z)({exploreId:l.a.right,queries:c}));case 14:t(z());case 15:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}()}function $(e){return function(r,t){if(e===l.a.left){var n=t().explore.left;r(R({exploreId:l.a.right,rawRange:n.range.raw}))}else{var o=t().explore.right;r(R({exploreId:l.a.left,rawRange:o.range.raw}))}var a=t().explore.syncedTimes;r(Object(p.D)({syncedTimes:!a})),r(z())}}var _=function(e){return function(r,t){return function(n){var o,a=!t;switch(e.type){case p.E.type:o={showingGraph:!t};break;case p.G.type:o={showingTable:!t}}n(e({exploreId:r})),n(q(r,o)),a&&n(U(r))}}},ee=_(p.E),re=_(p.G),te=function(e,r){return function(t){t(q(e,{dedupStrategy:r}))}};function ne(e){return function(r,t){var n=t().explore[e];if(n.initialized){for(var o=n.urlState,a=n.update,u=n.containerWidth,i=n.eventBridge,c=o.datasource,s=o.queries,d=o.range,l=o.mode,g=o.ui,m=o.originPanelId,v=[],O=0;O<s.length;O++){var j=s[O];v.push(Object(f.j)(j,v,O))}var h=Object(b.a)(t().user),x=Object(f.o)(d,h);if(a.datasource){var y=Object(f.h)(s);r(G(e,c,y,x,l,u,i,g,m))}else a.range&&r(Q({exploreId:e,rawRange:x.raw})),a.ui&&r(Object(p.I)(I({},g,{exploreId:e}))),a.queries&&r(Object(p.z)({exploreId:e,queries:v})),a.mode&&r(Object(p.d)({exploreId:e,mode:l})),(a.queries||a.ui||a.range)&&r(U(e))}}}var oe=function(e,r){return function(){var t=y(regeneratorRuntime.mark((function t(n){var o,a,u,i,c,s,f,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=r.getDataSourceSrv,a=r.getTimeSrv,u=r.getExploreUrl,i=r.openInNewWindow,c=o(),t.next=4,c.get(e.datasource);case 4:return s=t.sent,t.next=7,u({panel:e,panelTargets:e.targets,panelDatasource:s,datasourceSrv:c,timeSrv:a()});case 7:if(f=t.sent,!i){t.next=11;break}return i(f),t.abrupt("return");case 11:d={},n(Object(m.c)({path:f,query:d}));case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},w9yp:function(e,r,t){"use strict";t.d(r,"a",(function(){return g})),t.d(r,"b",(function(){return m})),t.d(r,"j",(function(){return v})),t.d(r,"h",(function(){return O})),t.d(r,"o",(function(){return j})),t.d(r,"n",(function(){return h})),t.d(r,"i",(function(){return x})),t.d(r,"m",(function(){return y})),t.d(r,"c",(function(){return w})),t.d(r,"g",(function(){return I})),t.d(r,"k",(function(){return S})),t.d(r,"f",(function(){return q})),t.d(r,"e",(function(){return D})),t.d(r,"l",(function(){return T})),t.d(r,"d",(function(){return P}));var n=t("LvDl"),o=t.n(n),a=t("Obii"),u=t("Xmxp"),i=t("SMGL"),c=t("m257"),s=t("5BoW");function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function l(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function p(e){return function(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var b="grafana.explore.richHistory",g={retentionPeriod:"grafana.explore.richHistory.retentionPeriod",starredTabAsFirstTab:"grafana.explore.richHistory.starredTabAsFirstTab",activeDatasourceOnly:"grafana.explore.richHistory.activeDatasourceOnly",datasourceFilters:"grafana.explore.richHistory.datasourceFilters"};function m(e,r,t,n,c,s,f){var d=Date.now(),l=n&&n.filter((function(e){return function(e){var r=o.a.omit(e,["key","refId","datasource"]);if(Object.keys(r).length>0)return!0;return!1}(e)})),m=i.a.getObject(g.retentionPeriod,7),v=q(m,!1),O=e.filter((function(e){return e.ts>v||!0===e.starred}))||[];if(l.length>0){var j=l.map((function(e){return o.a.omit(e,["key","refId"])})),h=O.length>0&&O[0].queries.map((function(e){return o.a.omit(e,["key","refId"])}));if(o.a.isEqual(j,h))return e;var x=[{queries:l,ts:d,datasourceId:r,datasourceName:t,starred:c,comment:s,sessionName:f}].concat(p(O));try{return i.a.setObject(b,x),x}catch(r){return u.b.emit(a.AppEvents.alertError,[r]),e}}return e}function v(){return function(e){return e.map((function(e){var r=e.queries.map((function(e,r){return function(e,r,t){if("object"===f(r))return r;if(function(e){try{JSON.parse(e)}catch(e){return!1}return!0}(r))return JSON.parse(r);return{expr:r,refId:"ABCDEFGHIJKLMNOPQRSTUVXYZ"[t]}}(0,e,r)}));return function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?d(Object(t),!0).forEach((function(r){l(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({},e,{queries:r})}))}(i.a.getObject(b,[]))}function O(){return i.a.delete(b)}function j(e,r){var t=e.map((function(e){if(e.ts===r){var t=e.starred;return Object.assign({},e,{starred:!t})}return e}));try{return i.a.setObject(b,t),t}catch(r){return u.b.emit(a.AppEvents.alertError,[r]),e}}function h(e,r,t){var n=e.map((function(e){return e.ts===r?Object.assign({},e,{comment:t}):e}));try{return i.a.setObject(b,n),n}catch(r){return u.b.emit(a.AppEvents.alertError,[r]),e}}function x(e,r){var t=e.filter((function(e){return e.ts!==r}));try{return i.a.setObject(b,t),t}catch(r){return u.b.emit(a.AppEvents.alertError,[r]),e}}var y=function(e,r){var t;return r===c.c.Ascending&&(t=function(e,r){return e.ts<r.ts?-1:e.ts>r.ts?1:0}),r===c.c.Descending&&(t=function(e,r){return e.ts<r.ts?1:e.ts>r.ts?-1:0}),r===c.c.DatasourceZA&&(t=function(e,r){return e.datasourceName<r.datasourceName?-1:e.datasourceName>r.datasourceName?1:0}),r===c.c.DatasourceAZ&&(t=function(e,r){return e.datasourceName<r.datasourceName?1:e.datasourceName>r.datasourceName?-1:0}),e.sort(t)},w=function(e){var r=document.createElement("textarea");r.value=e,document.body.appendChild(r),r.select(),document.execCommand("copy"),document.body.removeChild(r)},I=function(e){var r={range:{from:"now-1h",to:"now"},datasource:e.datasourceName,queries:e.queries,mode:"loki"===e.datasourceId?a.ExploreMode.Logs:"jaeger"===e.datasourceId?a.ExploreMode.Tracing:a.ExploreMode.Metrics,ui:{showingGraph:!0,showingLogs:!0,showingTable:!0},context:"explore"},t=Object(c.u)(r,!0),n=/.*(?=\/explore)/.exec("".concat(window.location.href))[0];return a.urlUtil.renderUrl("".concat(n,"/explore"),{left:t})},S=function(e){var r;switch(e){case 0:r="today";break;case 1:r="yesterday";break;case 7:r="a week ago";break;case 14:r="two weeks ago";break;default:r="".concat(e," days ago")}return r},q=function(e,r){var t=new Date,n=new Date(t.setDate(t.getDate()-e));return r?n.setHours(24,0,0,0):n.setHours(0,0,0,0)};function k(e,r){var t,n="";return r===c.c.DatasourceAZ||r===c.c.DatasourceZA?n=e.datasourceName:(t=e.ts,n=Object(a.dateTimeFormat)(t,{format:"MMMM D"})),n}function D(e,r){return(null==r?void 0:r.getQueryDisplayText)?r.getQueryDisplayText(e):function(e){var r=o.a.omit(e,["key","refId","datasource"]);return JSON.stringify(r)}(e)}function T(e,r){var t={};return e.forEach((function(e){var n=k(e,r);t[n]=n in t?[].concat(p(t[n]),[e]):[e]})),t}function P(e){var r=Object(s.b)(),t=[];return e.forEach((function(e){var n=r.findIndex((function(r){return r.name===e}));-1!==n?t.push({label:e,value:e,imgUrl:r[n].meta.info.logos.small,isRemoved:!1}):t.push({label:e,value:e,imgUrl:"public/img/icn-datasource.svg",isRemoved:!0})})),t}}}]);
//# sourceMappingURL=default~DashboardPage~SoloPanelPage~explore.017a0d1a58b1119d038d.js.map