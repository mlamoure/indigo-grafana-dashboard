{"version":3,"sources":["webpack:///./public/app/features/alerting/NotificationsListPage.tsx","webpack:///./public/app/core/hooks/useNavModel.ts","webpack:///./node_modules/react-use/esm/useAsyncFn.js","webpack:///./node_modules/react-use/esm/useMountedState.js"],"names":["NotificationsListPage","id","navIndex","navModel","useSelector","state","getNavModel","useState","notifications","setNotifications","getNotifications","getBackendSrv","get","useAsyncFn","fetchNotifications","useEffect","then","res","deleteNotificationConfirmed","delete","Page","Contents","error","length","className","icon","href","style","minWidth","width","map","notification","key","name","type","justify","isDefault","disabled","variant","size","onClick","appEvents","emit","CoreEvents","showConfirmModal","title","text","text2","confirmText","yesText","onConfirm","deleteNotification","loading","EmptyListCTA","buttonIcon","buttonLink","buttonTitle","proTip","proTipLink","proTipLinkTitle","proTipTarget","fn","deps","initialState","lastCallId","_a","set","isMounted","args","_i","arguments","callId","current","apply","value","useMountedState","mountedRef"],"mappings":"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","file":"NotificationsListPage.017a0d1a58b1119d038d.js","sourcesContent":["import React, { useState, FC, useEffect } from 'react';\nimport EmptyListCTA from 'app/core/components/EmptyListCTA/EmptyListCTA';\nimport Page from 'app/core/components/Page/Page';\nimport { getBackendSrv } from '@grafana/runtime';\nimport { useAsyncFn } from 'react-use';\nimport { appEvents } from 'app/core/core';\nimport { useNavModel } from 'app/core/hooks/useNavModel';\nimport { HorizontalGroup, Button, LinkButton } from '@grafana/ui';\nimport { CoreEvents } from 'app/types';\nimport { AlertNotification } from 'app/types/alerting';\n\nconst NotificationsListPage: FC = () => {\n  const navModel = useNavModel('channels');\n\n  const [notifications, setNotifications] = useState<AlertNotification[]>([]);\n\n  const getNotifications = async () => {\n    return await getBackendSrv().get(`/api/alert-notifications`);\n  };\n\n  const [state, fetchNotifications] = useAsyncFn(getNotifications);\n  useEffect(() => {\n    fetchNotifications().then(res => {\n      setNotifications(res);\n    });\n  }, []);\n\n  const deleteNotification = (id: number) => {\n    appEvents.emit(CoreEvents.showConfirmModal, {\n      title: 'Delete',\n      text: 'Do you want to delete this notification channel?',\n      text2: `Deleting this notification channel will not delete from alerts any references to it`,\n      icon: 'trash-alt',\n      confirmText: 'Delete',\n      yesText: 'Delete',\n      onConfirm: async () => {\n        deleteNotificationConfirmed(id);\n      },\n    });\n  };\n\n  const deleteNotificationConfirmed = async (id: number) => {\n    await getBackendSrv().delete(`/api/alert-notifications/${id}`);\n    const notifications = await fetchNotifications();\n    setNotifications(notifications);\n  };\n\n  return (\n    <Page navModel={navModel}>\n      <Page.Contents>\n        {state.error && <p>{state.error}</p>}\n        {!!notifications.length && (\n          <>\n            <div className=\"page-action-bar\">\n              <div className=\"page-action-bar__spacer\" />\n              <LinkButton icon=\"channel-add\" href=\"alerting/notification/new\">\n                New channel\n              </LinkButton>\n            </div>\n            <table className=\"filter-table filter-table--hover\">\n              <thead>\n                <tr>\n                  <th style={{ minWidth: '200px' }}>\n                    <strong>Name</strong>\n                  </th>\n                  <th style={{ minWidth: '100px' }}>Type</th>\n                  <th style={{ width: '1%' }}></th>\n                </tr>\n              </thead>\n              <tbody>\n                {notifications.map(notification => (\n                  <tr key={notification.id}>\n                    <td className=\"link-td\">\n                      <a href={`alerting/notification/${notification.id}/edit`}>{notification.name}</a>\n                    </td>\n                    <td className=\"link-td\">\n                      <a href={`alerting/notification/${notification.id}/edit`}>{notification.type}</a>\n                    </td>\n                    <td className=\"text-right\">\n                      <HorizontalGroup justify=\"flex-end\">\n                        {notification.isDefault && (\n                          <Button disabled variant=\"secondary\" size=\"sm\">\n                            default\n                          </Button>\n                        )}\n                        <Button\n                          variant=\"destructive\"\n                          icon=\"times\"\n                          size=\"sm\"\n                          onClick={() => {\n                            deleteNotification(notification.id);\n                          }}\n                        />\n                      </HorizontalGroup>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </>\n        )}\n\n        {!(notifications.length || state.loading) && (\n          <EmptyListCTA\n            title=\"There are no notification channels defined yet\"\n            buttonIcon=\"channel-add\"\n            buttonLink=\"alerting/notification/new\"\n            buttonTitle=\"Add channel\"\n            proTip=\"You can include images in your alert notifications.\"\n            proTipLink=\"http://docs.grafana.org/alerting/notifications/\"\n            proTipLinkTitle=\"Learn more\"\n            proTipTarget=\"_blank\"\n          />\n        )}\n      </Page.Contents>\n    </Page>\n  );\n};\n\nexport default NotificationsListPage;\n","import { useSelector } from 'react-redux';\nimport { StoreState } from 'app/types/store';\nimport { getNavModel } from '../selectors/navModel';\nimport { NavModel } from '../core';\n\nexport const useNavModel = (id: string): NavModel => {\n  const navIndex = useSelector((state: StoreState) => state.navIndex);\n  return getNavModel(navIndex, id);\n};\n","/* eslint-disable */\nimport { useCallback, useState, useRef } from 'react';\nimport useMountedState from './useMountedState';\nexport default function useAsyncFn(fn, deps, initialState) {\n    if (deps === void 0) { deps = []; }\n    if (initialState === void 0) { initialState = { loading: false }; }\n    var lastCallId = useRef(0);\n    var _a = useState(initialState), state = _a[0], set = _a[1];\n    var isMounted = useMountedState();\n    var callback = useCallback(function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var callId = ++lastCallId.current;\n        set({ loading: true });\n        return fn.apply(void 0, args).then(function (value) {\n            isMounted() && callId === lastCallId.current && set({ value: value, loading: false });\n            return value;\n        }, function (error) {\n            isMounted() && callId === lastCallId.current && set({ error: error, loading: false });\n            return error;\n        });\n    }, deps);\n    return [state, callback];\n}\n","import { useCallback, useEffect, useRef } from 'react';\nexport default function useMountedState() {\n    var mountedRef = useRef(false);\n    var get = useCallback(function () { return mountedRef.current; }, []);\n    useEffect(function () {\n        mountedRef.current = true;\n        return function () {\n            mountedRef.current = false;\n        };\n    });\n    return get;\n}\n"],"sourceRoot":""}